<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[unity常见面试题]]></title>
      <url>https://blog.xiaomo.info/2020/unityInterviewQuestions/</url>
      <content type="html"><![CDATA[<p>算起来到现在为止面试的大多是游戏服务端或者web前端相关的类容，没有经历过一次正儿八经的Unity面试，通过面试题也可以侧面了解到Unity开发中有哪些常用的需要掌握的知识，因此搬运一篇号称“屎上最全”的博客当作备份。<br><a id="more"></a></p>
<h3 id="一．什么是渲染管道？"><a href="#一．什么是渲染管道？" class="headerlink" title="一．什么是渲染管道？"></a>一．什么是渲染管道？</h3><p>是指在显示器上为了显示出图像而经过的一系列必要操作。<br>渲染管道中的很多步骤，都要将几何物体从一个坐标系中变换到另一个坐标系中去。<br>主要步骤有：<br>本地坐标-&gt;视图坐标-&gt;背面裁剪-&gt;光照-&gt;裁剪-&gt;投影-&gt;视图变换-&gt;光栅化。</p>
<h3 id="二．如何优化内存？"><a href="#二．如何优化内存？" class="headerlink" title="二．如何优化内存？"></a>二．如何优化内存？</h3><p>有很多种方式，例如</p>
<ul>
<li>1.压缩自带类库；</li>
<li>2.将暂时不用的以后还需要使用的物体隐藏起来而不是直接Destroy掉；</li>
<li>3.释放AssetBundle占用的资源；</li>
<li>4.降低模型的片面数，降低模型的骨骼数量，降低贴图的大小；</li>
<li>5.使用光照贴图，使用多层次细节(LOD)，使用着色器(Shader)，使用预设(Prefab)。</li>
</ul>
<h3 id="三、动态加载资源的方式？-有时候也问区别，具体请百度"><a href="#三、动态加载资源的方式？-有时候也问区别，具体请百度" class="headerlink" title="三、动态加载资源的方式？(有时候也问区别，具体请百度)"></a>三、动态加载资源的方式？(有时候也问区别，具体请百度)</h3><ul>
<li>1.Resources.Load();</li>
<li>2.AssetBundle</li>
</ul>
<h3 id="四：什么是协同程序？"><a href="#四：什么是协同程序？" class="headerlink" title="四：什么是协同程序？"></a>四：什么是协同程序？</h3><p>在主线程运行的同时开启另一段逻辑处理，来协助当前程序的执行，协程很像多线程，但是不是多线程，Unity的协程实在每帧结束之后去检测yield的条件是否满足。<br>五：Unity3d中的碰撞器和触发器的区别？</p>
<p>碰撞器是触发器的载体，而触发器只是碰撞器身上的一个属性。当Is Trigger=false时，碰撞器根据物理引擎引发碰撞，产生碰撞的效果，可以调用OnCollisionEnter/Stay/Exit函数；当Is Trigger=true时，碰撞器被物理引擎所忽略，没有碰撞效果，可以调用OnTriggerEnter/Stay/Exit函数。如果既要检测到物体的接触又不想让碰撞检测影响物体移动或要检测一个物件是否经过空间中的某个区域这时就可以用到触发器</p>
<h3 id="六：物体发生碰撞的必要条件？"><a href="#六：物体发生碰撞的必要条件？" class="headerlink" title="六：物体发生碰撞的必要条件？"></a>六：物体发生碰撞的必要条件？</h3><p>两个物体都必须带有碰撞器（Collider），其中一个物体还必须带有Rigidbody刚体，而且必须是运动的物体带有Rigidbody脚本才能检测到碰撞。</p>
<h3 id="七：请简述ArrayList和List的主要区别？"><a href="#七：请简述ArrayList和List的主要区别？" class="headerlink" title="七：请简述ArrayList和List的主要区别？"></a>七：请简述ArrayList和List的主要区别？</h3><p>ArrayList存在不安全类型（ArrayList会把所有插入其中的数据都当做Object来处理） 装箱拆箱的操作（费时） List是接口，ArrayList是一个实现了该接口的类，可以被实例化</p>
<h3 id="八：如何安全的在不同工程间安全地迁移asset数据？三种方法"><a href="#八：如何安全的在不同工程间安全地迁移asset数据？三种方法" class="headerlink" title="八：如何安全的在不同工程间安全地迁移asset数据？三种方法"></a>八：如何安全的在不同工程间安全地迁移asset数据？三种方法</h3><ul>
<li>1.将Assets目录和Library目录一起迁移</li>
<li>2.导出包，export Package</li>
<li>3.用unity自带的assets Server功能</li>
</ul>
<h3 id="九：OnEnable、Awake、Start运行时的发生顺序？哪些可能在同一个对象周期中反复的发生"><a href="#九：OnEnable、Awake、Start运行时的发生顺序？哪些可能在同一个对象周期中反复的发生" class="headerlink" title="九：OnEnable、Awake、Start运行时的发生顺序？哪些可能在同一个对象周期中反复的发生"></a>九：OnEnable、Awake、Start运行时的发生顺序？哪些可能在同一个对象周期中反复的发生</h3><p>Awake –&gt;OnEnable-&gt;Start，OnEnable在同一周期中可以反复地发生。</p>
<h3 id="十：MeshRender中material和sharedmaterial的区别？"><a href="#十：MeshRender中material和sharedmaterial的区别？" class="headerlink" title="十：MeshRender中material和sharedmaterial的区别？"></a>十：MeshRender中material和sharedmaterial的区别？</h3><p>修改sharedMaterial将改变所有物体使用这个材质的外观，并且也改变储存在工程里的材质设置。不推荐修改由sharedMaterial返回的材质。如果你想修改渲染器的材质，使用material替代。</p>
<h3 id="十一：Unity提供了几种光源，分别是什么"><a href="#十一：Unity提供了几种光源，分别是什么" class="headerlink" title="十一：Unity提供了几种光源，分别是什么"></a>十一：Unity提供了几种光源，分别是什么</h3><p>四种。</p>
<ul>
<li>平行光：Directional Light</li>
<li>点光源：Point Light</li>
<li>聚光灯：Spot Light</li>
<li>区域光源：Area Light</li>
</ul>
<h3 id="十二：简述一下对象池，你觉得在FPS里哪些东西适合使用对象池"><a href="#十二：简述一下对象池，你觉得在FPS里哪些东西适合使用对象池" class="headerlink" title="十二：简述一下对象池，你觉得在FPS里哪些东西适合使用对象池"></a>十二：简述一下对象池，你觉得在FPS里哪些东西适合使用对象池</h3><p>对象池就存放需要被反复调用资源的一个空间，当一个对象回大量生成的时候如果每次都销毁创建会很费时间，通过对象池把暂时不用的对象放到一个池中（也就是一个集合），当下次要重新生成这个对象的时候先去池中查找一下是否有可用的对象，如果有的话就直接拿出来使用，不需要再创建，如果池中没有可用的对象，才需要重新创建，利用空间换时间来达到游戏的高速运行效果，在FPS游戏中要常被大量复制的对象包括子弹，敌人，粒子等</p>
<h3 id="十三：CharacterController和Rigidbody的区别"><a href="#十三：CharacterController和Rigidbody的区别" class="headerlink" title="十三：CharacterController和Rigidbody的区别"></a>十三：CharacterController和Rigidbody的区别</h3><p>Rigidbody具有完全真实物理的特性，Unity中物理系统最基本的一个组件，包含了常用的物理特性，而CharacterController可以说是受限的的Rigidbody，具有一定的物理效果但不是完全真实的，是Unity为了使开发者能方便的开发第一人称视角的游戏而封装的一个组件</p>
<h3 id="十四：简述prefab的用处"><a href="#十四：简述prefab的用处" class="headerlink" title="十四：简述prefab的用处"></a>十四：简述prefab的用处</h3><p>在游戏运行时实例化，prefab相当于一个模板，对你已经有的素材、脚本、参数做一个默认的配置，以便于以后的修改，同时prefab打包的内容简化了导出的操作，便于团队的交流。</p>
<h3 id="十五：请简述sealed关键字用在类声明时与函数声明时的作用"><a href="#十五：请简述sealed关键字用在类声明时与函数声明时的作用" class="headerlink" title="十五：请简述sealed关键字用在类声明时与函数声明时的作用"></a>十五：请简述sealed关键字用在类声明时与函数声明时的作用</h3><p>sealed修饰的类为密封类，类声明时可防止其他类继承此类，在方法中声明则可防止派生类重写此方法。</p>
<h3 id="十六：请简述private，public，protected，internal的区别"><a href="#十六：请简述private，public，protected，internal的区别" class="headerlink" title="十六：请简述private，public，protected，internal的区别"></a>十六：请简述private，public，protected，internal的区别</h3><ul>
<li>public：对任何类和成员都公开，无限制访问</li>
<li>private：仅对该类公开</li>
<li>protected：对该类和其派生类公开</li>
<li>internal：只能在包含该类的程序集中访问该类</li>
</ul>
<h3 id="十七：使用Unity3d实现2d游戏，有几种方式？"><a href="#十七：使用Unity3d实现2d游戏，有几种方式？" class="headerlink" title="十七：使用Unity3d实现2d游戏，有几种方式？"></a>十七：使用Unity3d实现2d游戏，有几种方式？</h3><ul>
<li>1.使用本身的GUI，在Unity4.6以后出现的UGUI</li>
<li>2.把摄像机的Projection(投影)值调为Orthographic(正交投影)，不考虑z轴；</li>
<li>3.使用2d插件，如：2DToolKit，和NGUI</li>
</ul>
<h3 id="十八：在物体发生碰撞的整个过程中，有几个阶段，分别列出对应的函数"><a href="#十八：在物体发生碰撞的整个过程中，有几个阶段，分别列出对应的函数" class="headerlink" title="十八：在物体发生碰撞的整个过程中，有几个阶段，分别列出对应的函数"></a>十八：在物体发生碰撞的整个过程中，有几个阶段，分别列出对应的函数</h3><p>三个阶段，1.OnCollisionEnter 2.OnCollisionStay 3.OnCollisionExit</p>
<h3 id="十九：Unity3d的物理引擎中，有几种施加力的方式，分别描述出来"><a href="#十九：Unity3d的物理引擎中，有几种施加力的方式，分别描述出来" class="headerlink" title="十九：Unity3d的物理引擎中，有几种施加力的方式，分别描述出来"></a>十九：Unity3d的物理引擎中，有几种施加力的方式，分别描述出来</h3><p>rigidbody.AddForce/AddForceAtPosition，都在rigidbody系列函数中。大家可以自己去查看一下rigidbody的API</p>
<h3 id="二十：什么叫做链条关节？"><a href="#二十：什么叫做链条关节？" class="headerlink" title="二十：什么叫做链条关节？"></a>二十：什么叫做链条关节？</h3><p>Hinge Joint，可以模拟两个物体间用一根链条连接在一起的情况，能保持两个物体在一个固定距离内部相互移动而不产生作用力，但是达到固定距离后就会产生拉力。</p>
<h3 id="二十一：物体自身旋转使用的函数？"><a href="#二十一：物体自身旋转使用的函数？" class="headerlink" title="二十一：物体自身旋转使用的函数？"></a>二十一：物体自身旋转使用的函数？</h3><p>Transform.Rotate()</p>
<h3 id="二十二：Unity3d提供了一个用于保存和读取数据的类-PlayerPrefs-，请列出保存和读取整形数据的函数"><a href="#二十二：Unity3d提供了一个用于保存和读取数据的类-PlayerPrefs-，请列出保存和读取整形数据的函数" class="headerlink" title="二十二：Unity3d提供了一个用于保存和读取数据的类(PlayerPrefs)，请列出保存和读取整形数据的函数"></a>二十二：Unity3d提供了一个用于保存和读取数据的类(PlayerPrefs)，请列出保存和读取整形数据的函数</h3><p>PlayerPrefs.SetInt() PlayerPrefs.GetInt()</p>
<h3 id="二十三：Unity3d脚本从唤醒到销毁有着一套比较完整的生命周期，请列出系统自带的几个重要的方法。"><a href="#二十三：Unity3d脚本从唤醒到销毁有着一套比较完整的生命周期，请列出系统自带的几个重要的方法。" class="headerlink" title="二十三：Unity3d脚本从唤醒到销毁有着一套比较完整的生命周期，请列出系统自带的几个重要的方法。"></a>二十三：Unity3d脚本从唤醒到销毁有着一套比较完整的生命周期，请列出系统自带的几个重要的方法。</h3><p>Awake——&gt;OnEnable–&gt;Start——&gt;Update——&gt;FixedUpdate——&gt;LateUpdate——&gt;OnGUI——&gt;OnDisable——&gt;OnDestroy</p>
<h3 id="二十四：物理更新一般放在哪个系统函数里？"><a href="#二十四：物理更新一般放在哪个系统函数里？" class="headerlink" title="二十四：物理更新一般放在哪个系统函数里？"></a>二十四：物理更新一般放在哪个系统函数里？</h3><p>FixedUpdate，每固定帧绘制时执行一次，和Update不同的是FixedUpdate是渲染帧执行，如果你的渲染效率低下的时候FixedUpdate调用次数就会跟着下降。FixedUpdate比较适用于物理引擎的计算，因为是跟每帧渲染有关。Update就比较适合做控制。</p>
<h3 id="二十五：在场景中放置多个Camera并同时处于活动状态会发生什么？"><a href="#二十五：在场景中放置多个Camera并同时处于活动状态会发生什么？" class="headerlink" title="二十五：在场景中放置多个Camera并同时处于活动状态会发生什么？"></a>二十五：在场景中放置多个Camera并同时处于活动状态会发生什么？</h3><p>游戏界面可以看到很多摄像机的混合。</p>
<h3 id="二十六：如何销毁一个UnityEngine-Object及其子类？"><a href="#二十六：如何销毁一个UnityEngine-Object及其子类？" class="headerlink" title="二十六：如何销毁一个UnityEngine.Object及其子类？"></a>二十六：如何销毁一个UnityEngine.Object及其子类？</h3><p>使用Destroy()方法;</p>
<h3 id="二十七：请描述为什么Unity3d中会发生在组件上出现数据丢失的情况"><a href="#二十七：请描述为什么Unity3d中会发生在组件上出现数据丢失的情况" class="headerlink" title="二十七：请描述为什么Unity3d中会发生在组件上出现数据丢失的情况"></a>二十七：请描述为什么Unity3d中会发生在组件上出现数据丢失的情况</h3><p>一般是组件上绑定的物体对象被删除了</p>
<h3 id="二十八：LOD是什么，优缺点是什么？"><a href="#二十八：LOD是什么，优缺点是什么？" class="headerlink" title="二十八：LOD是什么，优缺点是什么？"></a>二十八：LOD是什么，优缺点是什么？</h3><p>LOD(Level of detail)多层次细节，是最常用的游戏优化技术。它按照模型的位置和重要程度决定物体渲染的资源分配，降低非重要物体的面数和细节度，从而获得高效率的渲染运算。缺点是增加了内存。</p>
<h3 id="二十九：MipMap是什么，作用？"><a href="#二十九：MipMap是什么，作用？" class="headerlink" title="二十九：MipMap是什么，作用？"></a>二十九：MipMap是什么，作用？</h3><p>MipMapping：在三维计算机图形的贴图渲染中有常用的技术，为加快渲染进度和减少图像锯齿，贴图被处理成由一系列被预先计算和优化过的图片组成的文件，这样的贴图被称为MipMap。</p>
<h3 id="三十：请描述Interface与抽象类之间的不同"><a href="#三十：请描述Interface与抽象类之间的不同" class="headerlink" title="三十：请描述Interface与抽象类之间的不同"></a>三十：请描述Interface与抽象类之间的不同</h3><p>抽象类表示该类中可能已经有一些方法的具体定义，但接口就是公公只能定义各个方法的界面 ，不能具体的实现代码在成员方法中。类是子类用来继承的，当父类已经有实际功能的方法时该方法在子类中可以不必实现，直接引用父类的方法，子类也可以重写该父类的方法。实现接口的时候必须要实现接口中所有的方法，不能遗漏任何一个。</p>
<h3 id="三十一：-Net与Mono的关系？"><a href="#三十一：-Net与Mono的关系？" class="headerlink" title="三十一：.Net与Mono的关系？"></a>三十一：.Net与Mono的关系？</h3><p>mono是.net的一个开源跨平台工具，就类似java虚拟机，java本身不是跨平台语言，但运行在虚拟机上就能够实现了跨平台。.net只能在windows下运行，mono可以实现跨平台跑，可以运行于linux，Unix，Mac OS等。</p>
<h3 id="三十二：简述Unity3D支持的作为脚本的语言的名称"><a href="#三十二：简述Unity3D支持的作为脚本的语言的名称" class="headerlink" title="三十二：简述Unity3D支持的作为脚本的语言的名称"></a>三十二：简述Unity3D支持的作为脚本的语言的名称</h3><p>Unity的脚本语言基于Mono的.Net平台上运行，可以使用.NET库，这也为XML、数据库、正则表达式等问题提供了很好的解决方案。Unity里的脚本都会经过编译，他们的运行速度也很快。这三种语言实际上的功能和运行速度是一样的，区别主要体现在语言特性上。JavaScript、 C#、Boo</p>
<h3 id="三十三：U3D中用于记录节点空间几何信息的组件名称，及其父类名称"><a href="#三十三：U3D中用于记录节点空间几何信息的组件名称，及其父类名称" class="headerlink" title="三十三：U3D中用于记录节点空间几何信息的组件名称，及其父类名称"></a>三十三：U3D中用于记录节点空间几何信息的组件名称，及其父类名称</h3><p>Transform 父类是 Component</p>
<h3 id="三十四：向量的点乘、叉乘以及归一化的意义？"><a href="#三十四：向量的点乘、叉乘以及归一化的意义？" class="headerlink" title="三十四：向量的点乘、叉乘以及归一化的意义？"></a>三十四：向量的点乘、叉乘以及归一化的意义？</h3><ul>
<li>1.点乘描述了两个向量的相似程度，结果越大两向量越相似，还可表示投影</li>
<li>2.叉乘得到的向量垂直于原来的两个向量</li>
<li>3.标准化向量：用在只关系方向，不关心大小的时候<h3 id="三十五：为何大家都在移动设备上寻求U3D原生GUI的替代方案"><a href="#三十五：为何大家都在移动设备上寻求U3D原生GUI的替代方案" class="headerlink" title="三十五：为何大家都在移动设备上寻求U3D原生GUI的替代方案"></a>三十五：为何大家都在移动设备上寻求U3D原生GUI的替代方案</h3>不美观，OnGUI很耗费时间，效率不高，使用不方便</li>
</ul>
<h3 id="三十六：请简述如何在不同分辨率下保持UI的一致性"><a href="#三十六：请简述如何在不同分辨率下保持UI的一致性" class="headerlink" title="三十六：请简述如何在不同分辨率下保持UI的一致性"></a>三十六：请简述如何在不同分辨率下保持UI的一致性</h3><p>NGUI很好的解决了这一点，屏幕分辨率的自适应性，原理就是计算出屏幕的宽高比跟原来的预设的屏幕分辨率求出一个对比值，然后修改摄像机的size。UGUI通过锚点和中心点和分辨率也解决这个问题</p>
<h3 id="三十七：什么是LightMap？"><a href="#三十七：什么是LightMap？" class="headerlink" title="三十七：什么是LightMap？"></a>三十七：什么是LightMap？</h3><p>LightMap:就是指在三维软件里实现打好光，然后渲染把场景各表面的光照输出到贴图上，最后又通过引擎贴到场景上，这样就使物体有了光照的感觉。</p>
<h3 id="三十八：Unity和cocos2d的区别"><a href="#三十八：Unity和cocos2d的区别" class="headerlink" title="三十八：Unity和cocos2d的区别"></a>三十八：Unity和cocos2d的区别</h3><ul>
<li><ol>
<li>Unity3D支持C#、javascript等，cocos2d-x 支持c++、Html5、Lua等。</li>
</ol>
</li>
<li><ol start="2">
<li>cocos2d 开源 并且免费</li>
</ol>
</li>
<li><ol start="3">
<li>Unity3D支持iOS、Android、Flash、Windows、Mac、Wii等平台的游戏开发，cocos2d-x支持iOS、Android、WP等。</li>
</ol>
</li>
</ul>
<h3 id="三十九：C-和C-的区别？"><a href="#三十九：C-和C-的区别？" class="headerlink" title="三十九：C#和C++的区别？"></a>三十九：C#和C++的区别？</h3><p>简单的说：C### 与C++ 比较的话，最重要的特性就是C### 是一种完全面向对象的语言，而C++ 不是，另外C### 是基于IL 中间语言和.NET Framework CLR 的，在可移植性，可维护性和强壮性都比C++ 有很大的改进。C### 的设计目标是用来开发快速稳定可扩展的应用程序，当然也可以通过Interop 和Pinvoke 完成一些底层操作。更详细的区别大家可以参考这里</p>
<h3 id="四十：结构体和类有何区别？"><a href="#四十：结构体和类有何区别？" class="headerlink" title="四十：结构体和类有何区别？"></a>四十：结构体和类有何区别？</h3><p>结构体是一种值类型，而类是引用类型。（值类型、引用类型是根据数据存储的角度来分的）就是值类型用于存储数据的值，引用类型用于存储对实际数据的引用。那么结构体就是当成值来使用的，类则通过引用来对实际数据操作</p>
<h3 id="四十一：ref参数和out参数是什么？有什么区别？"><a href="#四十一：ref参数和out参数是什么？有什么区别？" class="headerlink" title="四十一：ref参数和out参数是什么？有什么区别？"></a>四十一：ref参数和out参数是什么？有什么区别？</h3><p>ref和out参数的效果一样，都是通过关键字找到定义在主函数里面的变量的内存地址，并通过方法体内的语法改变它的大小。不同点就是输出参数必须对参数进行初始化。ref必须初始化，out 参数必须在函数里赋值。ref参数是引用，out参数为输出参数。</p>
<h3 id="四十二：C-的委托是什么？有何用处？"><a href="#四十二：C-的委托是什么？有何用处？" class="headerlink" title="四十二：C#的委托是什么？有何用处？"></a>四十二：C#的委托是什么？有何用处？</h3><p>委托类似于一种安全的指针引用，在使用它时是当做类来看待而不是一个方法，相当于对一组方法的列表的引用。用处：使用委托使程序员可以将方法引用封装在委托对象内。然后可以将该委托对象传递给可调用所引用方法的代码，而不必在编译时知道将调用哪个方法。与C或C++中的函数指针不同，委托是面向对象，而且是类型安全的。</p>
<h3 id="四十三：C-中的排序方式有哪些？"><a href="#四十三：C-中的排序方式有哪些？" class="headerlink" title="四十三：C#中的排序方式有哪些？"></a>四十三：C#中的排序方式有哪些？</h3><p>选择排序，冒泡排序，快速排序，插入排序，希尔排序，归并排序</p>
<h3 id="四十四：射线检测碰撞物的原理是？"><a href="#四十四：射线检测碰撞物的原理是？" class="headerlink" title="四十四：射线检测碰撞物的原理是？"></a>四十四：射线检测碰撞物的原理是？</h3><p>射线是3D世界中一个点向一个方向发射的一条无终点的线，在发射轨迹中与其他物体发生碰撞时，它将停止发射 。</p>
<h3 id="四十五：Unity中，照相机的Clipping-Planes的作用是什么？调整Near、Fare两个值时，应该注意什么？"><a href="#四十五：Unity中，照相机的Clipping-Planes的作用是什么？调整Near、Fare两个值时，应该注意什么？" class="headerlink" title="四十五：Unity中，照相机的Clipping Planes的作用是什么？调整Near、Fare两个值时，应该注意什么？"></a>四十五：Unity中，照相机的Clipping Planes的作用是什么？调整Near、Fare两个值时，应该注意什么？</h3><p>剪裁平面 。从相机到开始渲染和停止渲染之间的距离。</p>
<h3 id="四十六：如何让已经存在的GameObject在LoadLevel后不被卸载掉？"><a href="#四十六：如何让已经存在的GameObject在LoadLevel后不被卸载掉？" class="headerlink" title="四十六：如何让已经存在的GameObject在LoadLevel后不被卸载掉？"></a>四十六：如何让已经存在的GameObject在LoadLevel后不被卸载掉？</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Awake</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DontDestroyOnLoad(transform.gameObject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="四十七：请简述GC（垃圾回收）产生的原因，并描述如何避免？"><a href="#四十七：请简述GC（垃圾回收）产生的原因，并描述如何避免？" class="headerlink" title="四十七：请简述GC（垃圾回收）产生的原因，并描述如何避免？"></a>四十七：请简述GC（垃圾回收）产生的原因，并描述如何避免？</h3><p>GC回收堆上的内存<br>避免：</p>
<ul>
<li>1.减少new产生对象的次数</li>
<li>2.使用公用的对象（静态成员）</li>
<li>3.将String换为StringBuilder</li>
</ul>
<h3 id="四十八：反射的实现原理？"><a href="#四十八：反射的实现原理？" class="headerlink" title="四十八：反射的实现原理？"></a>四十八：反射的实现原理？</h3><p>审查元数据并收集关于它的类型信息的能力。实现原理：在运行时根据程序集及其中的类型得到元数据。下面是实现步骤：</p>
<ol>
<li>导入using System.Reflection;</li>
<li>Assembly.Load(“程序集”)加载程序集,返回类型是一个Assembly</li>
<li>得到程序集中所有类的名称</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (Type<span class="built_in"> type </span><span class="keyword">in</span> assembly.GetTypes())</span><br><span class="line">&#123;</span><br><span class="line">    string t = type.Name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Type type = assembly.GetType(“程序集.类名”);获取当前类的类型</li>
<li>Activator.CreateInstance(type); 创建此类型实例</li>
<li>MethodInfo mInfo = type.GetMethod(“方法名”);获取当前方法</li>
<li>m.Info.Invoke(null,方法参数);</li>
</ol>
<h3 id="四十九：简述四元数的作用，四元数对欧拉角的优点？"><a href="#四十九：简述四元数的作用，四元数对欧拉角的优点？" class="headerlink" title="四十九：简述四元数的作用，四元数对欧拉角的优点？"></a>四十九：简述四元数的作用，四元数对欧拉角的优点？</h3><p>四元数用于表示旋转<br>相对欧拉角的优点：<br>1.能进行增量旋转<br>2.避免万向锁<br>3.给定方位的表达方式有两种，互为负（欧拉角有无数种表达方式）</p>
<h3 id="五十：移动相机动作在哪个函数里，为什么在这个函数里？"><a href="#五十：移动相机动作在哪个函数里，为什么在这个函数里？" class="headerlink" title="五十：移动相机动作在哪个函数里，为什么在这个函数里？"></a>五十：移动相机动作在哪个函数里，为什么在这个函数里？</h3><p>LateUpdate，是在所有的update结束后才调用，比较适合用于命令脚本的执行。官网上例子是摄像机的跟随，都是所有的update操作完才进行摄像机的跟进，不然就有可能出现摄像机已经推进了，但是视角里还未有角色的空帧出现。</p>
<h3 id="五十一：GPU的工作原理"><a href="#五十一：GPU的工作原理" class="headerlink" title="五十一：GPU的工作原理"></a>五十一：GPU的工作原理</h3><p>简而言之，GPU的图形（处理）流水线完成如下的工作：（并不一定是按照如下顺序） </p>
<ul>
<li>顶点处理：这阶段GPU读取描述3D图形外观的顶点数据并根据顶点数据确定3D图形的形状及位置关系，建立起3D图形的骨架。在支持DX8和DX9规格的GPU中，这些工作由硬件实现的Vertex Shader（定点着色器）完成。 </li>
<li>光栅化计算：显示器实际显示的图像是由像素组成的，我们需要将上面生成的图形上的点和线通过一定的算法转换到相应的像素点。把一个矢量图形转换为一系列像素点的过程就称为光栅化。例如，一条数学表示的斜线段，最终被转化成阶梯状的连续像素点。 </li>
<li>纹理帖图：顶点单元生成的多边形只构成了3D物体的轮廓，而纹理映射（texture mapping）工作完成对多变形表面的帖图，通俗的说，就是将多边形的表面贴上相应的图片，从而生成“真实”的图形。TMU（Texture mapping unit）即是用来完成此项工作。 </li>
<li>像素处理：这阶段（在对每个像素进行光栅化处理期间）GPU完成对像素的计算和处理，从而确定每个像素的最终属性。在支持DX8和DX9规格的GPU中，这些工作由硬件实现的Pixel Shader（像素着色器）完成。 </li>
<li>最终输出：由ROP（光栅化引擎）最终完成像素的输出，1帧渲染完毕后，被送到显存帧缓冲区。</li>
<li>总结：GPU的工作通俗的来说就是完成3D图形的生成，将图形映射到相应的像素点上，对每个像素进行计算确定最终颜色并完成输出。</li>
</ul>
<h3 id="五十二：什么是渲染管道？"><a href="#五十二：什么是渲染管道？" class="headerlink" title="五十二：什么是渲染管道？"></a>五十二：什么是渲染管道？</h3><p>是指在显示器上为了显示出图像而经过的一系列必要操作。 渲染管道中的很多步骤，都要将几何物体从一个坐标系中变换到另一个坐标系中去。主要步骤有：<br>本地坐标-&gt;视图坐标-&gt;背面裁剪-&gt;光照-&gt;裁剪-&gt;投影-&gt;视图变换-&gt;光栅化</p>
<h3 id="五十三：如何优化内存？"><a href="#五十三：如何优化内存？" class="headerlink" title="五十三：如何优化内存？"></a>五十三：如何优化内存？</h3><p>有很多种方式，例如</p>
<ul>
<li>1.压缩自带类库；</li>
<li>2.将暂时不用的以后还需要使用的物体隐藏起来而不是直接Destroy掉；</li>
<li>3.释放AssetBundle占用的资源；</li>
<li>4.降低模型的片面数，降低模型的骨骼数量，降低贴图的大小；</li>
<li>5.使用光照贴图，使用多层次细节(LOD)，使用着色器(Shader)，使用预设(Prefab)。</li>
<li>6.代码中少产生临时变量</li>
</ul>
<h3 id="五十四：动态加载资源的方式？他们之间的区别"><a href="#五十四：动态加载资源的方式？他们之间的区别" class="headerlink" title="五十四：动态加载资源的方式？他们之间的区别"></a>五十四：动态加载资源的方式？他们之间的区别</h3><ul>
<li>1.Resources.Load();</li>
<li>2.AssetBundle<br>区别参考</li>
</ul>
<h3 id="五十五：请描述游戏动画有哪几种，以及其原理？"><a href="#五十五：请描述游戏动画有哪几种，以及其原理？" class="headerlink" title="五十五：请描述游戏动画有哪几种，以及其原理？"></a>五十五：请描述游戏动画有哪几种，以及其原理？</h3><p>主要有关节动画、骨骼动画、单一网格模型动画(关键帧动画)。<br>关节动画：把角色分成若干独立部分，一个部分对应一个网格模型，部分的动画连接成一个整体的动画，角色比较灵活，Quake2中使用这种动画；<br>骨骼动画，广泛应用的动画方式，集成了以上两个方式的优点，骨骼按角色特点组成一定的层次结构，有关节相连，可做相对运动，皮肤作为单一网格蒙在骨骼之外，决定角色的外观；<br>单一网格模型动画由一个完整的网格模型构成，在动画序列的关键帧里记录各个顶点的原位置及其改变量，然后插值运算实现动画效果，角色动画较真实。</p>
<h3 id="五十六：alpha-blend工作原理"><a href="#五十六：alpha-blend工作原理" class="headerlink" title="五十六：alpha blend工作原理"></a>五十六：alpha blend工作原理</h3><p>Alpha Blend 实现透明效果，不过只能针对某块区域进行alpha操作，透明度可设。</p>
<h3 id="五十七：写出光照计算中的diffuse的计算公式"><a href="#五十七：写出光照计算中的diffuse的计算公式" class="headerlink" title="五十七：写出光照计算中的diffuse的计算公式"></a>五十七：写出光照计算中的diffuse的计算公式</h3><figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">diffuse = Kd x colorLight x <span class="built_in">max</span>(<span class="built_in">N</span>*L,<span class="number">0</span>)；</span><br><span class="line">Kd 漫反射系数、colorLight 光的颜色、</span><br><span class="line"><span class="built_in">N</span> 单位法线向量、</span><br><span class="line">L 由点指向光源的单位向量、</span><br><span class="line">其中<span class="built_in">N</span>与L点乘，如果结果小于等于<span class="number">0</span>，则漫反射为<span class="number">0</span>。</span><br></pre></td></tr></table></figure>
<h3 id="五十八：两种阴影判断的方法、工作原理。"><a href="#五十八：两种阴影判断的方法、工作原理。" class="headerlink" title="五十八：两种阴影判断的方法、工作原理。"></a>五十八：两种阴影判断的方法、工作原理。</h3><ul>
<li>本影和半影：参考本影和半影</li>
<li>本影：景物表面上那些没有被光源直接照射的区域（全黑的轮廓分明的区域）。</li>
<li>半影：景物表面上那些被某些特定光源直接照射但并非被所有特定光源直接照射的区域（半明半暗区域）</li>
<li>工作原理：从光源处向物体的所有可见面投射光线，将这些面投影到场景中得到投影面，再将这些投影面与场景中的其他平面求交得出阴影多边形，保存这些阴影多边形信息，然后再按视点位置对场景进行相应处理得到所要求的视图（利用空间换时间，每次只需依据视点位置进行一次阴影计算即可，省去了一次消隐过程）</li>
</ul>
<h3 id="五十九：Vertex-Shader是什么，怎么计算？"><a href="#五十九：Vertex-Shader是什么，怎么计算？" class="headerlink" title="五十九：Vertex Shader是什么，怎么计算？"></a>五十九：Vertex Shader是什么，怎么计算？</h3><p>顶点着色器是一段执行在GPU上的程序，用来取代fixed pipeline中的transformation和lighting，Vertex Shader主要操作顶点。<br>Vertex Shader对输入顶点完成了从local space到homogeneous space（齐次空间）的变换过程，homogeneous space即projection space的下一个space。在这其间共有world transformation, view transformation和projection transformation及lighting几个过程。</p>
<h3 id="六十：下列代码在运行中会产生几个临时对象？"><a href="#六十：下列代码在运行中会产生几个临时对象？" class="headerlink" title="六十：下列代码在运行中会产生几个临时对象？"></a>六十：下列代码在运行中会产生几个临时对象？</h3><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">string</span> a = <span class="keyword">new</span> <span class="keyword">string</span>(<span class="string">"abc"</span>);</span><br><span class="line">a = (a.ToUpper() + <span class="string">"123"</span>).Substring(<span class="number">0</span>, <span class="number">2</span>); </span><br><span class="line">在C<span class="meta">#中第一行是会报错的（Java中倒是可行）。</span></span><br><span class="line">应该这样初始化：</span><br><span class="line"><span class="keyword">string</span> b = <span class="keyword">new</span> <span class="keyword">string</span>(<span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>&#125;);</span><br></pre></td></tr></table></figure>
<p>答案为：5个临时对象</p>
<h3 id="六十一：下列代码在运行中会发生什么问题？如何避免？"><a href="#六十一：下列代码在运行中会发生什么问题？如何避免？" class="headerlink" title="六十一：下列代码在运行中会发生什么问题？如何避免？"></a>六十一：下列代码在运行中会发生什么问题？如何避免？</h3><figure class="highlight zephir"><table><tr><td class="code"><pre><span class="line"><span class="keyword">List</span>&lt;<span class="keyword">int</span>&gt; ls = <span class="keyword">new</span> <span class="keyword">List</span>&lt;<span class="keyword">int</span>&gt;(<span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">int</span> item in ls)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item * item);</span><br><span class="line">    ls.Remove(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>产生运行时错误，在 ls.Remove(item)这行，因为foreach是只读的。不能一边遍历一边修改。</p>
<h3 id="六十二：Unity3D是否支持写成多线程程序？如果支持的话需要注意什么？"><a href="#六十二：Unity3D是否支持写成多线程程序？如果支持的话需要注意什么？" class="headerlink" title="六十二：Unity3D是否支持写成多线程程序？如果支持的话需要注意什么？"></a>六十二：Unity3D是否支持写成多线程程序？如果支持的话需要注意什么？</h3><p>仅能从主线程中访问Unity3D的组件，对象和Unity3D系统调用<br>支持：如果同时你要处理很多事情或者与Unity的对象互动小可以用thread,否则使用coroutine。<br>注意：C#中有lock这个关键字,以确保只有一个线程可以在特定时间内访问特定的对象</p>
<h3 id="六十三：Unity3D的协程和C-线程之间的区别是什么？"><a href="#六十三：Unity3D的协程和C-线程之间的区别是什么？" class="headerlink" title="六十三：Unity3D的协程和C#线程之间的区别是什么？"></a>六十三：Unity3D的协程和C#线程之间的区别是什么？</h3><p>多线程程序同时运行多个线程 ，而在任一指定时刻只有一个协程在运行，并且这个正在运行的协同程序只在必要时才被挂起。除主线程之外的线程无法访问Unity3D的对象、组件、方法。<br>Unity3d没有多线程的概念，不过unity也给我们提供了StartCoroutine（协同程序）和LoadLevelAsync（异步加载关卡）后台加载场景的方法。 StartCoroutine为什么叫协同程序呢，所谓协同，就是当你在StartCoroutine的函数体里处理一段代码时，利用yield语句等待执行结果，这期间不影响主程序的继续执行，可以协同工作。</p>
<h3 id="六十四：矩阵相乘的意义及注意点"><a href="#六十四：矩阵相乘的意义及注意点" class="headerlink" title="六十四：矩阵相乘的意义及注意点"></a>六十四：矩阵相乘的意义及注意点</h3><p>用于表示线性变换：旋转、缩放、投影、平移、仿射<br>注意矩阵的蠕变：误差的积累</p>
<h3 id="六十五：为什么dynamic-font在unicode环境下优于static-font"><a href="#六十五：为什么dynamic-font在unicode环境下优于static-font" class="headerlink" title="六十五：为什么dynamic font在unicode环境下优于static font"></a>六十五：为什么dynamic font在unicode环境下优于static font</h3><p>Unicode是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案。<br>使用动态字体时，Unity将不会预先生成一个与所有字体的字符纹理。当需要支持亚洲语言或者较大的字体的时候，若使用正常纹理，则字体的纹理将非常大。</p>
<h3 id="六十六：当一个细小的高速物体撞向另一个较大的物体时，会出现什么情况？如何避免？"><a href="#六十六：当一个细小的高速物体撞向另一个较大的物体时，会出现什么情况？如何避免？" class="headerlink" title="六十六：当一个细小的高速物体撞向另一个较大的物体时，会出现什么情况？如何避免？"></a>六十六：当一个细小的高速物体撞向另一个较大的物体时，会出现什么情况？如何避免？</h3><p>穿透（碰撞检测失败）</p>
<h3 id="六十七：请简述OnBecameVisible及OnBecameInvisible的发生时机，以及这一对回调函数的意义？"><a href="#六十七：请简述OnBecameVisible及OnBecameInvisible的发生时机，以及这一对回调函数的意义？" class="headerlink" title="六十七：请简述OnBecameVisible及OnBecameInvisible的发生时机，以及这一对回调函数的意义？"></a>六十七：请简述OnBecameVisible及OnBecameInvisible的发生时机，以及这一对回调函数的意义？</h3><p>当物体是否可见切换之时。可以用于只需要在物体可见时才进行的计算。</p>
<h3 id="六十八：什么叫动态合批？跟静态合批有什么区别？"><a href="#六十八：什么叫动态合批？跟静态合批有什么区别？" class="headerlink" title="六十八：什么叫动态合批？跟静态合批有什么区别？"></a>六十八：什么叫动态合批？跟静态合批有什么区别？</h3><p>如果动态物体共用着相同的材质，那么Unity会自动对这些物体进行批处理。动态批处理操作是自动完成的，并不需要你进行额外的操作。<br>区别：动态批处理一切都是自动的，不需要做任何操作，而且物体是可以移动的，但是限制很多。静态批处理：自由度很高，限制很少，缺点可能会占用更多的内存，而且经过静态批处理后的所有物体都不可以再移动了。<br>参考</p>
<h3 id="六十九：简述StringBuilder和String的区别？"><a href="#六十九：简述StringBuilder和String的区别？" class="headerlink" title="六十九：简述StringBuilder和String的区别？"></a>六十九：简述StringBuilder和String的区别？</h3><ul>
<li>String是字符串常量。</li>
<li>StringBuffer是字符串变量 ，线程安全。</li>
<li>StringBuilder是字符串变量，线程不安全。</li>
<li>String类型是个不可变的对象，当每次对String进行改变时都需要生成一个新的String对象，然后将指针指向一个新的对象，如果在一个循环里面，不断的改变一个对象，就要不断的生成新的对象，所以效率很低，建议在不断更改String对象的地方不要使用String类型。</li>
<li>StringBuilder对象在做字符串连接操作时是在原来的字符串上进行修改，改善了性能。这一点我们平时使用中也许都知道，连接操作频繁的时候，使用StringBuilder对象。</li>
</ul>
<h3 id="七十：Unity3D-Shader分哪几种，有什么区别？"><a href="#七十：Unity3D-Shader分哪几种，有什么区别？" class="headerlink" title="七十：Unity3D Shader分哪几种，有什么区别？"></a>七十：Unity3D Shader分哪几种，有什么区别？</h3><p>表面着色器的抽象层次比较高，它可以轻松地以简洁方式实现复杂着色。表面着色器可同时在前向渲染及延迟渲染模式下正常工作。<br>顶点片段着色器可以非常灵活地实现需要的效果，但是需要编写更多的代码，并且很难与Unity的渲染管线完美集成。<br>固定功能管线着色器可以作为前两种着色器的备用选择，当硬件无法运行那些酷炫Shader的时，还可以通过固定功能管线着色器来绘制出一些基本的内容。</p>
<h3 id="七十一：已知strcpy函数的原型是：char-strcpy-char-strDest-const-char-strSrc-1-不调用库函数，实现strcpy函数。2-解释为什么要返回char"><a href="#七十一：已知strcpy函数的原型是：char-strcpy-char-strDest-const-char-strSrc-1-不调用库函数，实现strcpy函数。2-解释为什么要返回char" class="headerlink" title="七十一：已知strcpy函数的原型是：char  strcpy(char  strDest,const char  strSrc); 1.不调用库函数，实现strcpy函数。2.解释为什么要返回char "></a>七十一：已知strcpy函数的原型是：char <em> strcpy(char </em> strDest,const char <em> strSrc); 1.不调用库函数，实现strcpy函数。2.解释为什么要返回char </em></h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> * <span class="title">strcpy</span><span class="params">(<span class="keyword">char</span> * strDest,<span class="keyword">const</span> <span class="keyword">char</span> * strSrc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((strDest==<span class="literal">NULL</span>)||(strSrc==<span class="literal">NULL</span>))</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">"Invalid argument(s)"</span>;</span><br><span class="line">    <span class="keyword">char</span> * strDestCopy=strDest;</span><br><span class="line">    <span class="keyword">while</span> ((*strDest++=*strSrc++)!=<span class="string">'\0'</span>);</span><br><span class="line">    <span class="keyword">return</span> strDestCopy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="七十二：C-中四种访问修饰符是哪些？各有什么区别？"><a href="#七十二：C-中四种访问修饰符是哪些？各有什么区别？" class="headerlink" title="七十二：C#中四种访问修饰符是哪些？各有什么区别？"></a>七十二：C#中四种访问修饰符是哪些？各有什么区别？</h3><p>1.属性修饰符 2.存取修饰符 3.类修饰符 4.成员修饰符。<br>属性修饰符：</p>
<ul>
<li>Serializable：按值将对象封送到远程服务器。</li>
<li>STATread：是单线程套间的意思，是一种线程模型。</li>
<li>MATAThread：是多线程套间的意思，也是一种线程模型。<br>存取修饰符：</li>
<li>public：存取不受限制。</li>
<li>private：只有包含该成员的类可以存取。</li>
<li>internal：只有当前工程可以存取。</li>
<li>protected：只有包含该成员的类以及派生类可以存取。<br>类修饰符：</li>
<li>abstract：抽象类。指示一个类只能作为其它类的基类。</li>
<li>sealed：密封类。指示一个类不能被继承。理所当然，密封类不能同时又是抽象类，因为抽象总是希望被继承的。<br>成员修饰符：</li>
<li>abstract：指示该方法或属性没有实现。</li>
<li>sealed：密封方法。可以防止在派生类中对该方法的override（重载）。不是类的每个成员方法都可以作为密封方法密封方法，必须对基类的虚方法进行重载，提供具体的实现方法。所以，在方法的声明中，sealed修饰符总是和override修饰符同时使用。</li>
<li>delegate：委托。用来定义一个函数指针。C#中的事件驱动是基于delegate + event的。</li>
<li>const：指定该成员的值只读不允许修改。</li>
<li>event：声明一个事件。</li>
<li>extern：指示方法在外部实现。</li>
<li>override：重写。对由基类继承成员的新实现。</li>
<li>readonly：指示一个域只能在声明时以及相同类的内部被赋值。</li>
<li>static：指示一个成员属于类型本身，而不是属于特定的对象。即在定义后可不经实例化，就可使用。</li>
<li>virtual：指示一个方法或存取器的实现可以在继承类中被覆盖。<br>new：在派生类中隐藏指定的基类成员，从而实现重写的功能。 若要隐藏继承类的成员，请使用相同名称在派生类中声明该成员，并用 new 修饰符修饰它。</li>
</ul>
<h3 id="七十三：Heap与Stack有何区别？"><a href="#七十三：Heap与Stack有何区别？" class="headerlink" title="七十三：Heap与Stack有何区别？"></a>七十三：Heap与Stack有何区别？</h3><ul>
<li>1.heap是堆，stack是栈。</li>
<li>2.stack的空间由操作系统自动分配和释放，heap的空间是手动申请和释放的，heap常用new关键字来分配。</li>
<li>3.stack空间有限，heap的空间是很大的自由区。</li>
</ul>
<h3 id="七十四：值类型和引用类型有何区别？"><a href="#七十四：值类型和引用类型有何区别？" class="headerlink" title="七十四：值类型和引用类型有何区别？"></a>七十四：值类型和引用类型有何区别？</h3><p>1.值类型的数据存储在内存的栈中；引用类型的数据存储在内存的堆中，而内存单元中只存放堆中对象的地址。<br>2.值类型存取速度快，引用类型存取速度慢。<br>3.值类型表示实际数据，引用类型表示指向存储在内存堆中的数据的指针或引用<br>4.值类型继承自System.ValueType，引用类型继承自System.Object<br>5.栈的内存分配是自动释放；而堆在.NET中会有GC来释放<br>6.值类型的变量直接存放实际的数据，而引用类型的变量存放的则是数据的地址，即对象的引用。</p>
<h3 id="七十五：协同程序的执行代码是什么？有何用处，有何缺点？"><a href="#七十五：协同程序的执行代码是什么？有何用处，有何缺点？" class="headerlink" title="七十五：协同程序的执行代码是什么？有何用处，有何缺点？"></a>七十五：协同程序的执行代码是什么？有何用处，有何缺点？</h3><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Start</span><span class="params">()</span></span> &#123; </span><br><span class="line">    // 协同程序WaitAndPrint在Start函数内执行,可以视同于它与Start函数同步执行.</span><br><span class="line">    StartCoroutine(WaitAndPrint(<span class="number">2.0</span>)); </span><br><span class="line">    <span class="built_in">print</span> (<span class="string">"Before WaitAndPrint Finishes "</span> + Time.<span class="built_in">time</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WaitAndPrint</span> <span class="params">(waitTime : float)</span></span> &#123;</span><br><span class="line">    // 暂停执行waitTime秒</span><br><span class="line">    <span class="built_in">yield</span> WaitForSeconds (waitTime);</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">"WaitAndPrint "</span>+ Time.<span class="built_in">time</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>作用：一个协同程序在执行过程中,可以在任意位置使用yield语句。yield的返回值控制何时恢复协同程序向下执行。协同程序在对象自有帧执行过程中堪称优秀。协同程序在性能上没有更多的开销。<br>缺点：协同程序并非真线程，可能会发生堵塞。</p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> game </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[经历了几场面试后的全球同服架构思考]]></title>
      <url>https://blog.xiaomo.info/2019/worldServerGame/</url>
      <content type="html"><![CDATA[<p>从自己的游戏从业经验来看，一直做的是滚服机制的游戏，当然也是因为我游戏从业经历不多。中国的网络游戏喜欢开小服，制造玩家矛盾，引起战斗，进而让用户心甘情愿充钱的氪金模式。日本的大部分游戏是做内容，所以基本上都是同服机制，但是因为知识水平受限面试表现并不尽如意，之后专门查资料研究了一番。<br><a id="more"></a><br>首先，游戏服务器是IO密集型服务器，它的主要瓶颈在网络IO，而不是CPU，这点要记住了。所以经常服务器问题都会出现在网络IO，带宽，数据库磁盘读写上面，而非CPU上面。</p>
<p>其实全球同服也就是大量在线，只是你看起来同服，而不是他本身就在同一个服务器上，或者同一个进程上，这是完全不现实的。一个好的服务器进程，能同时承载10k的游戏玩家(还依赖于游戏逻辑复杂度)已经不错了。其实要全球同服，就是堆服务器进程嘛。</p>
<ul>
<li>1.Gate: 首先要有一个(多个)Gate(网关)服务器，负责客户端连接及消息转发到GameServer(游戏服)（选服逻辑）,保持客户端到服务端的连接。没有任何逻辑，只做消息加密和解密，以及客户端和服务器消息的转发(相当于两者之间的桥梁).</li>
<li>2.GameServer: GameServer是主要的游戏进程,提供游戏逻辑功能(采用单进程(或者单线程)模型,游戏服务器的瓶颈从来不在CPU,所以只做逻辑功能的话单线程足够了,在这里没必要用多线程或多进程)。</li>
<li>3.DBManager: 实现数据库的读写，方便Game服务器异步读写数据库的数据(有些把数据库读写放在游戏服，没有单独的服务器，那恐怕游戏服单进程就不够用了)。</li>
<li>4.GameManager: 负责管理所有的GameServer，GameServer之间消息转发，提供广播到所有Game的功能。</li>
</ul>
<p>客户端连Gate，Gate连GameServer，GameServer连DBManager，GameManager管理所有的GameServer并通知所有的Gate。</p>
<p>除了GameManager只有一个，理论上Gate，GameServer，DBManager都可以扩展到多个实例，你要实现全球唯一服，理论上就是扩展GameServer，那么怎么让他们看起来在一个服呢？其实很简单，COC大多数都是单服玩法，只有交互玩法的时候你才能感受到它是同一个服。</p>
<p>主要讲讲GameServer，这是主要的处理服务器逻辑的地方，一般单进程就可以了，一个epoll_wait hold住全场，然后做分发，理论上cpu都能承载的住，而epoll能处理的上限，一般跟机器的内存有关，远大于1024，正常的也达到100k，当然考虑到逻辑的复杂度，一个实例一般处理的连接接近10k就可以了。<br>那怎么处理100k，1000k甚至更多了，那就多个实例，那这样还是唯一服吗？是的，至少可以看起来是，游戏自然有单人玩法和多人玩法，单人玩法自然自己在自己的服就可以了，谁也不知道是不是跟别人一个服。<br>当然有全服的排行榜，好友系统之类的怎么办呢，其实很简单，我们不是有GameManager吗，它就是负责做这事的，每当你发个好友请求，GameManager广播一条消息，然后如果有某个GameServer存在这个玩家，那就回应你，你们就可以相互通信了，更简单的想办法获取玩家的服务器ID号，直接通过GameManager转发给那个服务器，自然就可以通信了，就像在同一个服务器一样。<br>排行榜呢，最简单的，指定一个服务器，或者单独开辟一个服务器做排行榜，所有数据变动都通知这个服务器，然后服务器自然就能排行了，然后再广播。<br>双人战斗或者多人副本呢？<br>像COC这样的，掠夺战，我们当时的做法就是，直接搜到敌方，然后把自己的玩家，士兵军队等需要的数据序列化之后，传到对面的服务器去，反序列化，然后直接开打，打完再把数据传回来。<br>更多人的呢，那就方便点，再开辟一类服务器，叫BattleServer，专门负责多人玩法，副本玩法之类的，多人的时候，把所有的多人数据迁移到BattleServer，然后多人（副本玩法）结束的时候，再通过GameManager把数据迁移回原来的服务器。</p>
<p>这样看，其实全球唯一服也就没有那么高大上了。</p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> game </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[日语汉字速查表]]></title>
      <url>https://blog.xiaomo.info/2019/japanKannjiIndex/</url>
      <content type="html"><![CDATA[<p>音读，训读，特殊读，平假名，片假名，王小明…..<br><a id="more"></a></p>
<ul>
<li>亜(あ)</li>
<li>哀(あい)</li>
<li>爱(あい)</li>
<li>悪(あく)</li>
<li>握(あく)</li>
<li>圧(あつ)</li>
<li>扱(あつかい)</li>
<li>安(あん)</li>
<li>暗(あん)</li>
<li>案(あん)</li>
<li>以(い)</li>
<li>位(くらい)</li>
<li>依(やすし)</li>
<li>伟(いさむ)</li>
<li>囲(かこい)</li>
<li>委(い)</li>
<li>威(い)</li>
<li>尉(い)</li>
<li>意(い)</li>
<li>慰(いさむ)</li>
<li>易(えき)</li>
<li>为(ため)</li>
<li>异(い)</li>
<li>移(うつり)</li>
<li>维(ゆい)</li>
<li>纬(い)</li>
<li>胃(い)</li>
<li>衣(ころも)</li>
<li>违(ちがい)</li>
<li>遗(い)</li>
<li>医(い)</li>
<li>井(せい)</li>
<li>域(いき)</li>
<li>育(いく)</li>
<li>一(いち)</li>
<li>壱(いち)</li>
<li>逸(すぐる)</li>
<li>稲(いね)</li>
<li>芋(いも)</li>
<li>印(いん)</li>
<li>员(いん)</li>
<li>因(いん)</li>
<li>姻(いん)</li>
<li>引(いん)</li>
<li>饮(いん)</li>
<li>院(いん)</li>
<li>阴(かげ)</li>
<li>隠(いん)</li>
<li>韵(いん)</li>
<li>右(みぎ)</li>
<li>宇(たか)</li>
<li>羽(はね)</li>
<li>雨(あめ)</li>
<li>涡(うず)</li>
<li>浦(うら)</li>
<li>运(うん)</li>
<li>云(くも)</li>
<li>営(えい)</li>
<li>影(かげ)</li>
<li>映(うつる)</li>
<li>栄(えい)</li>
<li>永(なが)</li>
<li>泳(およ)</li>
<li>英(えい)</li>
<li>卫(まもる)</li>
<li>咏(えい)</li>
<li>锐(はやし)</li>
<li>液(えき)</li>
<li>疫(えき)</li>
<li>益(えき)</li>
<li>駅(えき)</li>
<li>悦(えつ)</li>
<li>谒(えつ)</li>
<li>越(こし)</li>
<li>阅(えつ)</li>
<li>円(えん)</li>
<li>园(えん)</li>
<li>宴(えん)</li>
<li>延(えん)</li>
<li>援(えん)</li>
<li>沿(えん)</li>
<li>演(えん)</li>
<li>炎(ほのお)</li>
<li>烟(けむり)</li>
<li>猿(さる)</li>
<li>縁(えん)</li>
<li>远(えん)</li>
<li>铅(なまり)</li>
<li>塩(しお)</li>
<li>汚(きたな)</li>
<li>凹(ぼこ)</li>
<li>央(ひさし)</li>
<li>奥(おく)</li>
<li>往(おう)</li>
<li>応(おう)</li>
<li>押(おし)</li>
<li>横(よこ)</li>
<li>欧(おう)</li>
<li>殴(なぐ)</li>
<li>王(おう)</li>
<li>翁(おきな)</li>
<li>黄(き)</li>
<li>冲(おき)</li>
<li>亿(おく)</li>
<li>屋(や)</li>
<li>忆(おく)</li>
<li>乙(おつ)</li>
<li>卸(おろし)</li>
<li>恩(おん)</li>
<li>温(あつし)</li>
<li>穏(おん)</li>
<li>音(おん)</li>
<li>下(した)</li>
<li>化(か)</li>
<li>仮(かり)</li>
<li>何(なに)</li>
<li>価(あたい)</li>
<li>佳(よろし)</li>
<li>加(か)</li>
<li>可(か)</li>
<li>夏(なつ)</li>
<li>嫁(よめ)</li>
<li>家(いえ)</li>
<li>寡(やもめ)</li>
<li>科(か)</li>
<li>暇(ひま)</li>
<li>果(はたし)</li>
<li>架(か)</li>
<li>歌(うた)</li>
<li>河(かわ)</li>
<li>火(ひ)</li>
<li>祸(わざわい)</li>
<li>稼(かせぎ)</li>
<li>个(か)</li>
<li>花(はな)</li>
<li>荷(に)</li>
<li>华(はな)</li>
<li>菓(か)</li>
<li>课(か)</li>
<li>货(か)</li>
<li>过(か)</li>
<li>蚊(か)</li>
<li>我(われ)</li>
<li>画(が)</li>
<li>芽(め)</li>
<li>贺(が)</li>
<li>雅(が)</li>
<li>饿(が)</li>
<li>介(すけ)</li>
<li>会(かい)</li>
<li>解(かい)</li>
<li>回(かい)</li>
<li>块(かたまり)</li>
<li>壊(こわ)</li>
<li>快(かい)</li>
<li>怪(かい)</li>
<li>悔(くや)</li>
<li>懐(ふところ)</li>
<li>戒(かい)</li>
<li>拐(かい)</li>
<li>改(あらた)</li>
<li>械(かい)</li>
<li>海(うみ)</li>
<li>灰(はい)</li>
<li>界(かい)</li>
<li>皆(みな)</li>
<li>絵(え)</li>
<li>开(かい)</li>
<li>阶(かい)</li>
<li>贝(かい)</li>
<li>劾(がい)</li>
<li>外(がい)</li>
<li>害(がい)</li>
<li>慨(がい)</li>
<li>概(おおむね)</li>
<li>涯(がい)</li>
<li>街(まち)</li>
<li>该(がい)</li>
<li>垣(かき)</li>
<li>吓(かく)</li>
<li>各(かく)</li>
<li>拡(ひろむ)</li>
<li>格(かく)</li>
<li>核(かく)</li>
<li>壳(から)</li>
<li>获(え)</li>
<li>确(あきら)</li>
<li>获(ゆたか)</li>
<li>覚(さとる)</li>
<li>角(かど)</li>
<li>较(くら)</li>
<li>郭(くるわ)</li>
<li>阁(かく)</li>
<li>隔(へだ)</li>
<li>革(かわ)</li>
<li>学(がく)</li>
<li>岳(たけ)</li>
<li>楽(らく)</li>
<li>额(がく)</li>
<li>挂(かかり)</li>
<li>潟(かた)</li>
<li>割(わり)</li>
<li>喝(かつ)</li>
<li>括(くく)</li>
<li>活(かつ)</li>
<li>渇(かつ)</li>
<li>滑(なめら)</li>
<li>褐(かつ)</li>
<li>辖(かつ)</li>
<li>且(かつ)</li>
<li>株(かぶ)</li>
<li>刈(かり)</li>
<li>乾(いぬい)</li>
<li>冠(かん)</li>
<li>寒(かん)</li>
<li>刊(かん)</li>
<li>勘(かん)</li>
<li>勧(すすむ)</li>
<li>巻(かん)</li>
<li>唤(かん)</li>
<li>堪(かん)</li>
<li>完(かん)</li>
<li>官(かん)</li>
<li>寛(ひろし)</li>
<li>干(かん)</li>
<li>干(みき)</li>
<li>患(わずら)</li>
<li>感(かん)</li>
<li>惯(な)</li>
<li>憾(かん)</li>
<li>换(かん)</li>
<li>敢(かん)</li>
<li>棺(ひつぎ)</li>
<li>款(かん)</li>
<li>歓(かん)</li>
<li>汗(あせ)</li>
<li>汉(かん)</li>
<li>环(わ)</li>
<li>甘(かん)</li>
<li>监(らん)</li>
<li>看(み)</li>
<li>管(かん)</li>
<li>简(かん)</li>
<li>缓(ゆる)</li>
<li>缶(かん)</li>
<li>肝(きも)</li>
<li>舰(かん)</li>
<li>観(かん)</li>
<li>贯(ぬき)</li>
<li>还(かん)</li>
<li>鉴(かがみ)</li>
<li>间(あいだ)</li>
<li>闲(ひま)</li>
<li>関(せき)</li>
<li>陥(おちい)</li>
<li>馆(かん)</li>
<li>丸(まる)</li>
<li>含(ふくみ)</li>
<li>岸(きし)</li>
<li>眼(め)</li>
<li>岩(いわ)</li>
<li>顽(がん)</li>
<li>颜(かお)</li>
<li>愿(ねがい)</li>
<li>企(くわだ)</li>
<li>危(あぶ)</li>
<li>喜(よし)</li>
<li>器(うつわ)</li>
<li>基(もと)</li>
<li>奇(き)</li>
<li>寄(やどりき)</li>
<li>岐(ちまた)</li>
<li>希(まれ)</li>
<li>几(いく)</li>
<li>忌(いみ)</li>
<li>挥(き)</li>
<li>机(つくえ)</li>
<li>旗(はた)</li>
<li>既(き)</li>
<li>期(き)</li>
<li>棋(ぎ)</li>
<li>弃(す)</li>
<li>机(き)</li>
<li>帰(き)</li>
<li>気(き)</li>
<li>汽(き)</li>
<li>祈(いのり)</li>
<li>季(き)</li>
<li>纪(おさむ)</li>
<li>规(き)</li>
<li>记(き)</li>
<li>贵(き)</li>
<li>起(おこし)</li>
<li>轨(き)</li>
<li>辉(てる)</li>
<li>饥(う)</li>
<li>骑(き)</li>
<li>鬼(おに)</li>
<li>伪(ぎ)</li>
<li>仪(ぎ)</li>
<li>宜(ぎ)</li>
<li>戯(ぎ)</li>
<li>技(わざ)</li>
<li>拟(ぎ)</li>
<li>欺(ぎ)</li>
<li>犠(ぎ)</li>
<li>疑(うたが)</li>
<li>义(ぎ)</li>
<li>议(ぎ)</li>
<li>菊(きく)</li>
<li>吉(きち)</li>
<li>吃(いさむ)</li>
<li>诘(つめ)</li>
<li>却(きゃく)</li>
<li>客(きゃく)</li>
<li>脚(あし)</li>
<li>虐(ぎゃく)</li>
<li>逆(ぎゃく)</li>
<li>丘(おか)</li>
<li>久(ひさし)</li>
<li>休(きゅう)</li>
<li>及(およぶ)</li>
<li>吸(きゅう)</li>
<li>宫(みや)</li>
<li>弓(ゆみ)</li>
<li>急(きゅう)</li>
<li>救(すくい)</li>
<li>朽(きゅう)</li>
<li>求(もとむ)</li>
<li>泣(な)</li>
<li>球(たま)</li>
<li>究(きわむ)</li>
<li>穷(きゅう)</li>
<li>级(きゅう)</li>
<li>纠(ただす)</li>
<li>给(きゅう)</li>
<li>旧(きゅう)</li>
<li>牛(うし)</li>
<li>去(きょ)</li>
<li>居(きょ)</li>
<li>巨(きょ)</li>
<li>拒(こば)</li>
<li>拠(きょ)</li>
<li>挙(きょ)</li>
<li>虚(きょ)</li>
<li>许(もと)</li>
<li>距(きょ)</li>
<li>渔(りょう)</li>
<li>鱼(さかな)</li>
<li>享(すすむ)</li>
<li>京(きょう)</li>
<li>供(とも)</li>
<li>竞(せり)</li>
<li>共(とも)</li>
<li>凶(きょう)</li>
<li>协(きょう)</li>
<li>叫(きょう)</li>
<li>境(さかい)</li>
<li>峡(きょう)</li>
<li>强(つよし)</li>
<li>恐(おそ)</li>
<li>恭(やすし)</li>
<li>挟(はさ)</li>
<li>教(きょう)</li>
<li>桥(はし)</li>
<li>况(きょう)</li>
<li>狂(きょう)</li>
<li>狭(せま)</li>
<li>矫(きょう)</li>
<li>胸(むね)</li>
<li>胁(おびや)</li>
<li>兴(きょう)</li>
<li>郷(ごう)</li>
<li>镜(かがみ)</li>
<li>响(ひびき)</li>
<li>惊(おどろき)</li>
<li>仰(あおぎ)</li>
<li>凝(ぎょう)</li>
<li>暁(あかつき)</li>
<li>业(ぎょう)</li>
<li>局(きょく)</li>
<li>曲(きょく)</li>
<li>极(きょく)</li>
<li>玉(たま)</li>
<li>勤(つとむ)</li>
<li>均(たもつ)</li>
<li>斤(きん)</li>
<li>琴(こと)</li>
<li>禁(きん)</li>
<li>筋(すじ)</li>
<li>紧(みしと)</li>
<li>菌(きん)</li>
<li>襟(えり)</li>
<li>谨(すすむ)</li>
<li>近(こん)</li>
<li>金(きん)</li>
<li>吟(ぎん)</li>
<li>银(ぎん)</li>
<li>九(きゅう)</li>
<li>句(く)</li>
<li>区(く)</li>
<li>苦(く)</li>
<li>駆(く)</li>
<li>具(ぐ)</li>
<li>愚(ぐ)</li>
<li>虞(おそれ)</li>
<li>空(そら)</li>
<li>偶(ぐう)</li>
<li>遇(ぐう)</li>
<li>隅(すみ)</li>
<li>屈(くつ)</li>
<li>掘(ほり)</li>
<li>靴(くつ)</li>
<li>缲(くり)</li>
<li>桑(くわ)</li>
<li>勲(いさお)</li>
<li>君(きみ)</li>
<li>薫(かおる)</li>
<li>训(くん)</li>
<li>群(ぐん)</li>
<li>军(ぐん)</li>
<li>郡(ぐん)</li>
<li>系(かかり)</li>
<li>倾(なだれ)</li>
<li>刑(けい)</li>
<li>兄(あに)</li>
<li>启(けい)</li>
<li>型(かた)</li>
<li>契(ちぎり)</li>
<li>形(けい)</li>
<li>径(けい)</li>
<li>恵(めぐみ)</li>
<li>庆(けい)</li>
<li>憩(いこい)</li>
<li>掲(けい)</li>
<li>携(たずさ)</li>
<li>敬(けい)</li>
<li>景(かげ)</li>
<li>渓(けい)</li>
<li>系(けい)</li>
<li>経(きょう)</li>
<li>継(つぎ)</li>
<li>茎(くき)</li>
<li>蛍(ほたる)</li>
<li>计(けい)</li>
<li>警(けい)</li>
<li>軽(けい)</li>
<li>鶏(にわとり)</li>
<li>芸(げい)</li>
<li>迎(むかい)</li>
<li>鲸(くじら)</li>
<li>剧(げき)</li>
<li>撃(げき)</li>
<li>激(げき)</li>
<li>杰(すぐる)</li>
<li>欠(けつ)</li>
<li>决(けつ)</li>
<li>洁(きよし)</li>
<li>穴(あな)</li>
<li>结(むすぶ)</li>
<li>血(ち)</li>
<li>月(つき)</li>
<li>件(けん)</li>
<li>倹(けん)</li>
<li>健(けん)</li>
<li>兼(けん)</li>
<li>券(けん)</li>
<li>剣(けん)</li>
<li>圏(けん)</li>
<li>坚(けん)</li>
<li>嫌(いや)</li>
<li>建(けん)</li>
<li>宪(けん)</li>
<li>悬(かけ)</li>
<li>検(けん)</li>
<li>権(けん)</li>
<li>犬(いぬ)</li>
<li>献(けん)</li>
<li>研(けん)</li>
<li>绢(きぬ)</li>
<li>県(けん)</li>
<li>肩(かた)</li>
<li>见(み)</li>
<li>谦(けん)</li>
<li>贤(けん)</li>
<li>轩(のき)</li>
<li>遣(つか)</li>
<li>険(けん)</li>
<li>顕(けん)</li>
<li>験(しるし)</li>
<li>元(もと)</li>
<li>原(はら)</li>
<li>厳(げん)</li>
<li>幻(まぼろし)</li>
<li>弦(つる)</li>
<li>减(げん)</li>
<li>源(みなもと)</li>
<li>玄(げん)</li>
<li>现(うつつ)</li>
<li>言(げん)</li>
<li>限(きり)</li>
<li>个(こ)</li>
<li>古(いにしえ)</li>
<li>呼(こ)</li>
<li>固(かたむ)</li>
<li>孤(こ)</li>
<li>己(おのれ)</li>
<li>库(こ)</li>
<li>弧(こ)</li>
<li>戸(と)</li>
<li>故(ゆえ)</li>
<li>枯(かれ)</li>
<li>湖(みずうみ)</li>
<li>夸(ほこ)</li>
<li>雇(やとい)</li>
<li>顾(かえりみ)</li>
<li>鼓(つづみ)</li>
<li>五(ご)</li>
<li>互(たがい)</li>
<li>午(うま)</li>
<li>呉(くれ)</li>
<li>娯(ご)</li>
<li>后(ご)</li>
<li>御(お)</li>
<li>悟(さとる)</li>
<li>碁(ご)</li>
<li>语(ご)</li>
<li>误(ご)</li>
<li>护(ゆずる)</li>
<li>交(こう)</li>
<li>侯(こう)</li>
<li>候(こう)</li>
<li>光(ひかり)</li>
<li>公(こう)</li>
<li>功(こう)</li>
<li>効(こう)</li>
<li>厚(あつし)</li>
<li>口(くち)</li>
<li>向(むかい)</li>
<li>后(きさき)</li>
<li>坑(こう)</li>
<li>好(よしみ)</li>
<li>孔(あな)</li>
<li>孝(たかし)</li>
<li>工(こう)</li>
<li>巧(こう)</li>
<li>幸(さいわい)</li>
<li>広(ひろ)</li>
<li>康(やすし)</li>
<li>恒(つね)</li>
<li>慌(あわ)</li>
<li>抗(こう)</li>
<li>拘(かか)</li>
<li>控(ひかえ)</li>
<li>攻(こう)</li>
<li>更(さら)</li>
<li>校(こう)</li>
<li>构(かまえ)</li>
<li>江(え)</li>
<li>洪(こう)</li>
<li>港(みなと)</li>
<li>沟(みぞ)</li>
<li>甲(こう)</li>
<li>皇(すべらぎ)</li>
<li>硬(こう)</li>
<li>稿(こう)</li>
<li>红(べに)</li>
<li>绞(しぼり)</li>
<li>纲(つな)</li>
<li>耕(こう)</li>
<li>考(こう)</li>
<li>肯(こう)</li>
<li>航(こう)</li>
<li>荒(あら)</li>
<li>行(ぎょう)</li>
<li>衡(たいら)</li>
<li>讲(こう)</li>
<li>贡(みつぐ)</li>
<li>购(こう)</li>
<li>郊(こう)</li>
<li>酵(こう)</li>
<li>鉱(こう)</li>
<li>钢(こう)</li>
<li>降(たかし)</li>
<li>项(こう)</li>
<li>香(かおり)</li>
<li>高(たか)</li>
<li>刚(ごう)</li>
<li>号(ごう)</li>
<li>合(ごう)</li>
<li>拷(ごう)</li>
<li>豪(ごう)</li>
<li>克(かつみ)</li>
<li>刻(こく)</li>
<li>告(こく)</li>
<li>国(こく)</li>
<li>谷(こく)</li>
<li>酷(こく)</li>
<li>黒(くろ)</li>
<li>狱(ごく)</li>
<li>腰(こし)</li>
<li>骨(ほね)</li>
<li>込(こみ)</li>
<li>今(いま)</li>
<li>困(こま)</li>
<li>垦(ひらく)</li>
<li>婚(こん)</li>
<li>恨(うら)</li>
<li>恳(こん)</li>
<li>昆(こん)</li>
<li>根(ね)</li>
<li>混(こん)</li>
<li>绀(こん)</li>
<li>魂(たましい)</li>
<li>佐(さ)</li>
<li>唆(さ)</li>
<li>左(ひだり)</li>
<li>差(さ)</li>
<li>査(さ)</li>
<li>砂(すな)</li>
<li>诈(さ)</li>
<li>锁(くさり)</li>
<li>座(ざ)</li>
<li>债(さい)</li>
<li>催(もよお)</li>
<li>再(さい)</li>
<li>最(さい)</li>
<li>妻(つま)</li>
<li>宰(つかさ)</li>
<li>彩(いろどり)</li>
<li>才(さい)</li>
<li>采(さい)</li>
<li>栽(さい)</li>
<li>歳(とし)</li>
<li>済(すみ)</li>
<li>灾(わざわ)</li>
<li>砕(くだ)</li>
<li>祭(さい)</li>
<li>斎(いわい)</li>
<li>细(ほそ)</li>
<li>菜(な)</li>
<li>裁(さい)</li>
<li>载(みつる)</li>
<li>际(さい)</li>
<li>剤(ざい)</li>
<li>在(ざい)</li>
<li>材(ざい)</li>
<li>罪(つみ)</li>
<li>财(ざい)</li>
<li>坂(さか)</li>
<li>咲(さき)</li>
<li>崎(ざき)</li>
<li>作(さく)</li>
<li>削(けず)</li>
<li>榨(しぼ)</li>
<li>昨(さく)</li>
<li>策(さく)</li>
<li>索(さく)</li>
<li>错(さく)</li>
<li>桜(さくら)</li>
<li>册(さつ)</li>
<li>刷(さつ)</li>
<li>察(さつ)</li>
<li>撮(さつ)</li>
<li>擦(さつ)</li>
<li>札(さつ)</li>
<li>杀(ころ)</li>
<li>雑(ざつ)</li>
<li>皿(さら)</li>
<li>三(さん)</li>
<li>伞(かさ)</li>
<li>参(さん)</li>
<li>山(やま)</li>
<li>惨(さん)</li>
<li>散(さん)</li>
<li>桟(さん)</li>
<li>产(さん)</li>
<li>算(ざん)</li>
<li>蚕(かいこ)</li>
<li>賛(さん)</li>
<li>酸(さん)</li>
<li>暂(ざん)</li>
<li>残(ざん)</li>
<li>仕(つこう)</li>
<li>伺(うかがい)</li>
<li>使(つか)</li>
<li>刺(とげ)</li>
<li>司(つかさ)</li>
<li>史(し)</li>
<li>嗣(つぐ)</li>
<li>四(よん)</li>
<li>士(し)</li>
<li>始(はじめ)</li>
<li>姉(あね)</li>
<li>姿(すがた)</li>
<li>子(こ)</li>
<li>市(し)</li>
<li>师(し)</li>
<li>志(こころざし)</li>
<li>思(おもう)</li>
<li>指(ゆび)</li>
<li>支(ささ)</li>
<li>施(し)</li>
<li>旨(むね)</li>
<li>枝(えだ)</li>
<li>止(どめ)</li>
<li>死(し)</li>
<li>氏(し)</li>
<li>祉(し)</li>
<li>私(わたし)</li>
<li>糸(いと)</li>
<li>纸(かみ)</li>
<li>紫(むらさき)</li>
<li>肢(あし)</li>
<li>脂(あぶら)</li>
<li>至(いたる)</li>
<li>视(し)</li>
<li>词(し)</li>
<li>诗(し)</li>
<li>试(ためし)</li>
<li>志(し)</li>
<li>谘(とう)</li>
<li>资(し)</li>
<li>赐(たまもの)</li>
<li>雌(めす)</li>
<li>饲(か)</li>
<li>歯(は)</li>
<li>事(こと)</li>
<li>似(に)</li>
<li>侍(さむらい)</li>
<li>児(じ)</li>
<li>字(じ)</li>
<li>寺(てら)</li>
<li>慈(めぐむ)</li>
<li>持(もち)</li>
<li>时(とき)</li>
<li>次(つぎ)</li>
<li>滋(しげる)</li>
<li>治(おさむ)</li>
<li>玺(じ)</li>
<li>磁(じ)</li>
<li>示(しめす)</li>
<li>耳(みみ)</li>
<li>自(じ)</li>
<li>辞(じ)</li>
<li>式(しき)</li>
<li>识(さとし)</li>
<li>轴(じく)</li>
<li>七(しち)</li>
<li>执(もり)</li>
<li>失(しつ)</li>
<li>室(しつ)</li>
<li>湿(しつ)</li>
<li>漆(うるし)</li>
<li>疾(しつ)</li>
<li>质(しつ)</li>
<li>実(じつ)</li>
<li>芝(しば)</li>
<li>舎(しゃ)</li>
<li>写(しゃ)</li>
<li>射(い)</li>
<li>舍(しゃ)</li>
<li>赦(しゃ)</li>
<li>斜(しゃ)</li>
<li>煮(に)</li>
<li>社(しゃ)</li>
<li>者(しゃ)</li>
<li>谢(しゃ)</li>
<li>车(くるま)</li>
<li>遮(さえぎ)</li>
<li>蛇(へび)</li>
<li>邪(よこしま)</li>
<li>借(しゃく)</li>
<li>勺(しゃく)</li>
<li>尺(しゃく)</li>
<li>爵(たか)</li>
<li>酌(しゃく)</li>
<li>釈(せき)</li>
<li>若(わか)</li>
<li>寂(じゃく)</li>
<li>弱(じゃく)</li>
<li>主(しゅ)</li>
<li>取(とり)</li>
<li>守(かみ)</li>
<li>手(て)</li>
<li>朱(しゅ)</li>
<li>殊(こと)</li>
<li>狩(かり)</li>
<li>珠(たま)</li>
<li>种(たね)</li>
<li>趣(おもむき)</li>
<li>酒(さけ)</li>
<li>首(くび)</li>
<li>儒(じゅ)</li>
<li>受(うけ)</li>
<li>寿(ことぶき)</li>
<li>授(じゅ)</li>
<li>树(き)</li>
<li>需(もとめ)</li>
<li>囚(しゅう)</li>
<li>収(おさむ)</li>
<li>周(しゅう)</li>
<li>宗(しゅう)</li>
<li>就(しゅう)</li>
<li>州(しゅう)</li>
<li>修(おさむ)</li>
<li>愁(しゅう)</li>
<li>拾(おさむ)</li>
<li>秀(ひで)</li>
<li>秋(あき)</li>
<li>终(しゅう)</li>
<li>习(ならい)</li>
<li>臭(しゅう)</li>
<li>舟(ふね)</li>
<li>众(しゅう)</li>
<li>袭(おそい)</li>
<li>周(しゅう)</li>
<li>酬(しゅう)</li>
<li>集(しゅう)</li>
<li>丑(しゅう)</li>
<li>住(じゅう)</li>
<li>充(みつる)</li>
<li>十(じゅう)</li>
<li>従(じゅう)</li>
<li>柔(じゅう)</li>
<li>汁(しる)</li>
<li>渋(しぶ)</li>
<li>獣(けもの)</li>
<li>縦(たて)</li>
<li>重(しげる)</li>
<li>铳(じゅう)</li>
<li>叔(すえ)</li>
<li>宿(やど)</li>
<li>淑(よし)</li>
<li>祝(しゅく)</li>
<li>缩(ちぢみ)</li>
<li>粛(しゅく)</li>
<li>塾(じゅく)</li>
<li>熟(じゅく)</li>
<li>出(で)</li>
<li>术(じゅつ)</li>
<li>述(のべる)</li>
<li>俊(しゅん)</li>
<li>春(はる)</li>
<li>瞬(しゅん)</li>
<li>准(じゅん)</li>
<li>循(めぐる)</li>
<li>旬(しゅん)</li>
<li>殉(じゅん)</li>
<li>准(じゅん)</li>
<li>润(じゅん)</li>
<li>盾(たて)</li>
<li>纯(じゅん)</li>
<li>巡(じゅん)</li>
<li>遵(じゅん)</li>
<li>顺(じゅん)</li>
<li>処(ところ)</li>
<li>初(しょ)</li>
<li>所(しょ)</li>
<li>暑(しょ)</li>
<li>庶(ちかし)</li>
<li>绪(ちょ)</li>
<li>署(しょ)</li>
<li>书(しょ)</li>
<li>诸(もろ)</li>
<li>助(すけ)</li>
<li>叙(じょ)</li>
<li>女(おんな)</li>
<li>序(じょ)</li>
<li>徐(じょ)</li>
<li>除(じょ)</li>
<li>伤(きず)</li>
<li>偿(しょう)</li>
<li>胜(かつ)</li>
<li>匠(たくみ)</li>
<li>升(ます)</li>
<li>召(しょう)</li>
<li>商(しょう)</li>
<li>唱(うた)</li>
<li>奨(すすむ)</li>
<li>宵(よい)</li>
<li>将(しょう)</li>
<li>小(しょう)</li>
<li>少(しょう)</li>
<li>尚(なお)</li>
<li>床(ゆか)</li>
<li>彰(あきら)</li>
<li>承(うけたまわ)</li>
<li>抄(しょう)</li>
<li>招(しょう)</li>
<li>掌(てのひら)</li>
<li>升(のぼる)</li>
<li>昭(あきら)</li>
<li>晶(あきら)</li>
<li>松(まつ)</li>
<li>沼(ぬま)</li>
<li>消(け)</li>
<li>渉(わたる)</li>
<li>焼(やき)</li>
<li>焦(あせ)</li>
<li>照(てる)</li>
<li>症(しょう)</li>
<li>省(しょう)</li>
<li>硝(しょう)</li>
<li>礁(しょう)</li>
<li>祥(しょ)</li>
<li>称(しょう)</li>
<li>章(しょう)</li>
<li>笑(わらい)</li>
<li>妆(しょう)</li>
<li>绍(たすく)</li>
<li>肖(あやか)</li>
<li>冲(しょう)</li>
<li>讼(しょう)</li>
<li>证(あかし)</li>
<li>诏(みことのり)</li>
<li>详(しょう)</li>
<li>象(ぞう)</li>
<li>赏(しょう)</li>
<li>钟(かね)</li>
<li>障(さわ)</li>
<li>上(じょう)</li>
<li>丈(たけ)</li>
<li>乗(じょう)</li>
<li>冗(じょう)</li>
<li>剰(じょう)</li>
<li>城(しろ)</li>
<li>场(ば)</li>
<li>壌(ゆずる)</li>
<li>嬢(じょう)</li>
<li>常(つね)</li>
<li>情(じょう)</li>
<li>条(じょう)</li>
<li>浄(じょう)</li>
<li>状(じょう)</li>
<li>畳(たたみ)</li>
<li>蒸(むし)</li>
<li>譲(ゆずる)</li>
<li>醸(じょう)</li>
<li>锭(じょう)</li>
<li>嘱(しょく)</li>
<li>饰(かざり)</li>
<li>植(うえ)</li>
<li>殖(しょく)</li>
<li>织(おり)</li>
<li>职(しょく)</li>
<li>色(いろ)</li>
<li>触(しょく)</li>
<li>食(しょく)</li>
<li>辱(はじ)</li>
<li>伸(しん)</li>
<li>信(しん)</li>
<li>侵(おか)</li>
<li>唇(くちびる)</li>
<li>娠(しん)</li>
<li>寝(ね)</li>
<li>审(しん)</li>
<li>心(こころ)</li>
<li>慎(まき)</li>
<li>振(おさむ)</li>
<li>新(しん)</li>
<li>森(もり)</li>
<li>浸(ひた)</li>
<li>深(しん)</li>
<li>申(さる)</li>
<li>真(まこと)</li>
<li>神(かみ)</li>
<li>绅(しん)</li>
<li>臣(しん)</li>
<li>薪(たきぎ)</li>
<li>亲(おや)</li>
<li>诊(み)</li>
<li>身(み)</li>
<li>辛(しん)</li>
<li>进(すすむ)</li>
<li>针(はり)</li>
<li>震(しん)</li>
<li>人(じん)</li>
<li>仁(じん)</li>
<li>刃(は)</li>
<li>寻(ひろ)</li>
<li>甚(じん)</li>
<li>尽(じん)</li>
<li>迅(じん)</li>
<li>阵(じん)</li>
<li>酢(す)</li>
<li>図(ず)</li>
<li>吹(すい)</li>
<li>垂(たれ)</li>
<li>帅(そち)</li>
<li>推(すい)</li>
<li>水(みず)</li>
<li>炊(すい)</li>
<li>睡(すい)</li>
<li>粋(いき)</li>
<li>衰(おとろ)</li>
<li>遂(やすし)</li>
<li>酔(すい)</li>
<li>锤(おもり)</li>
<li>随(ずい)</li>
<li>髄(ずい)</li>
<li>崇(たかし)</li>
<li>数(かず)</li>
<li>枢(かなめ)</li>
<li>据(きょ)</li>
<li>杉(すぎ)</li>
<li>澄(きよむ)</li>
<li>寸(すん)</li>
<li>世(よ)</li>
<li>瀬(せ)</li>
<li>亩(うね)</li>
<li>是(これ)</li>
<li>制(せい)</li>
<li>势(ぜい)</li>
<li>姓(せい)</li>
<li>征(ただし)</li>
<li>性(せい)</li>
<li>成(しげる)</li>
<li>政(せい)</li>
<li>整(ただし)</li>
<li>星(ほし)</li>
<li>晴(はれ)</li>
<li>正(せい)</li>
<li>清(せい)</li>
<li>牲(せい)</li>
<li>生(しょう)</li>
<li>盛(もり)</li>
<li>精(せい)</li>
<li>圣(ひじり)</li>
<li>声(こえ)</li>
<li>制(せい)</li>
<li>西(にし)</li>
<li>诚(まこと)</li>
<li>誓(ちかい)</li>
<li>请(しょう)</li>
<li>逝(ゆ)</li>
<li>青(あお)</li>
<li>静(せい)</li>
<li>斉(さい)</li>
<li>税(ぜい)</li>
<li>只(せき)</li>
<li>席(せき)</li>
<li>惜(せき)</li>
<li>斥(せき)</li>
<li>昔(むかし)</li>
<li>析(せき)</li>
<li>石(いし)</li>
<li>积(せき)</li>
<li>籍(せき)</li>
<li>绩(つむぎ)</li>
<li>责(せき)</li>
<li>赤(あか)</li>
<li>迹(あと)</li>
<li>切(きり)</li>
<li>拙(せつ)</li>
<li>接(せつ)</li>
<li>摂(せつ)</li>
<li>折(おり)</li>
<li>设(せつ)</li>
<li>窃(せつ)</li>
<li>节(せつ)</li>
<li>说(せつ)</li>
<li>雪(ゆき)</li>
<li>绝(ぜつ)</li>
<li>舌(した)</li>
<li>仙(せん)</li>
<li>先(さき)</li>
<li>千(せん)</li>
<li>占(うらない)</li>
<li>宣(よろし)</li>
<li>専(あつむ)</li>
<li>川(かわ)</li>
<li>戦(いくさ)</li>
<li>扇(おうぎ)</li>
<li>栓(せん)</li>
<li>泉(いずみ)</li>
<li>浅(あさ)</li>
<li>洗(すすぐ)</li>
<li>染(そめ)</li>
<li>潜(ひそか)</li>
<li>旋(めぐる)</li>
<li>线(せん)</li>
<li>繊(せん)</li>
<li>船(せん)</li>
<li>荐(すすむ)</li>
<li>践(せん)</li>
<li>选(せん)</li>
<li>迁(せん)</li>
<li>銭(ぜに)</li>
<li>铣(せん)</li>
<li>鲜(あらた)</li>
<li>前(まえ)</li>
<li>善(ぜん)</li>
<li>渐(すすむ)</li>
<li>然(ぜん)</li>
<li>全(ぜん)</li>
<li>禅(ぜん)</li>
<li>缮(つくろ)</li>
<li>塑(そ)</li>
<li>措(そ)</li>
<li>疎(そ)</li>
<li>础(いしずえ)</li>
<li>祖(そ)</li>
<li>租(そ)</li>
<li>粗(ほぼ)</li>
<li>素(す)</li>
<li>组(くみ)</li>
<li>诉(うった)</li>
<li>阻(はば)</li>
<li>僧(そう)</li>
<li>创(きず)</li>
<li>双(そう)</li>
<li>仓(くら)</li>
<li>丧(も)</li>
<li>壮(そう)</li>
<li>奏(そう)</li>
<li>层(そう)</li>
<li>想(そう)</li>
<li>捜(さが)</li>
<li>扫(は)</li>
<li>挿(ざし)</li>
<li>操(みさお)</li>
<li>早(はや)</li>
<li>曹(そう)</li>
<li>巣(す)</li>
<li>槽(そう)</li>
<li>燥(そう)</li>
<li>争(あらそ)</li>
<li>相(そう)</li>
<li>窓(まど)</li>
<li>総(ふさ)</li>
<li>草(くさ)</li>
<li>荘(しょう)</li>
<li>葬(そう)</li>
<li>藻(も)</li>
<li>装(そう)</li>
<li>走(そう)</li>
<li>送(そう)</li>
<li>遭(あ)</li>
<li>霜(しも)</li>
<li>騒(さわ)</li>
<li>像(ぞう)</li>
<li>増(ぞう)</li>
<li>憎(ぞう)</li>
<li>臓(ぞう)</li>
<li>蔵(くら)</li>
<li>赠(おく)</li>
<li>造(づくり)</li>
<li>促(うなが)</li>
<li>侧(がわ)</li>
<li>则(のり)</li>
<li>即(そく)</li>
<li>息(いき)</li>
<li>束(たば)</li>
<li>测(はかり)</li>
<li>足(あし)</li>
<li>速(はやし)</li>
<li>俗(ぞく)</li>
<li>属(ぞく)</li>
<li>贼(ぞく)</li>
<li>族(ぞく)</li>
<li>続(ぞく)</li>
<li>卒(そつ)</li>
<li>存(ぞん)</li>
<li>孙(まご)</li>
<li>尊(みこと)</li>
<li>损(そん)</li>
<li>村(むら)</li>
<li>他(ほか)</li>
<li>多(た)</li>
<li>太(ふとし)</li>
<li>堕(だ)</li>
<li>妥(ゆずる)</li>
<li>惰(だ)</li>
<li>打(だ)</li>
<li>駄(だ)</li>
<li>体(からだ)</li>
<li>対(たい)</li>
<li>耐(しのぶ)</li>
<li>帯(おび)</li>
<li>待(まつ)</li>
<li>怠(おこた)</li>
<li>态(たい)</li>
<li>替(たい)</li>
<li>泰(はた)</li>
<li>滞(たい)</li>
<li>胎(はら)</li>
<li>袋(ふくろ)</li>
<li>贷(かし)</li>
<li>退(たい)</li>
<li>逮(たい)</li>
<li>队(たい)</li>
<li>代(だい)</li>
<li>台(だい)</li>
<li>大(だい)</li>
<li>第(だい)</li>
<li>题(だい)</li>
<li>滝(たき)</li>
<li>卓(たく)</li>
<li>宅(たく)</li>
<li>択(たく)</li>
<li>拓(つぶせ)</li>
<li>沢(さわ)</li>
<li>濯(たく)</li>
<li>托(ことづけ)</li>
<li>浊(だく)</li>
<li>诺(だく)</li>
<li>但(ただし)</li>
<li>达(たち)</li>
<li>夺(だっ)</li>
<li>脱(だつ)</li>
<li>棚(だな)</li>
<li>谷(たに)</li>
<li>丹(に)</li>
<li>単(たん)</li>
<li>叹(たん)</li>
<li>担(たん)</li>
<li>探(さぐ)</li>
<li>淡(たん)</li>
<li>炭(すみ)</li>
<li>短(たん)</li>
<li>端(はし)</li>
<li>胆(きも)</li>
<li>诞(たん)</li>
<li>锻(きたえ)</li>
<li>団(だん)</li>
<li>坛(だん)</li>
<li>弾(たま)</li>
<li>断(だん)</li>
<li>暖(だん)</li>
<li>段(だん)</li>
<li>男(おとこ)</li>
<li>谈(だん)</li>
<li>値(あたい)</li>
<li>知(ち)</li>
<li>地(ち)</li>
<li>耻(はじ)</li>
<li>池(いけ)</li>
<li>痴(ち)</li>
<li>稚(おさない)</li>
<li>置(おき)</li>
<li>致(いたす)</li>
<li>遅(ち)</li>
<li>筑(ちく)</li>
<li>畜(ちく)</li>
<li>竹(たけ)</li>
<li>蓄(ちく)</li>
<li>逐(ちく)</li>
<li>秩(さとし)</li>
<li>窒(ちつ)</li>
<li>茶(ちゃ)</li>
<li>嫡(ちゃく)</li>
<li>着(き)</li>
<li>中(なか)</li>
<li>仲(なか)</li>
<li>宙(ちゅう)</li>
<li>忠(ちゅう)</li>
<li>抽(ちゅう)</li>
<li>昼(ひる)</li>
<li>柱(はしら)</li>
<li>注(ちゅう)</li>
<li>虫(むし)</li>
<li>衷(まこと)</li>
<li>鋳(い)</li>
<li>驻(ちゅう)</li>
<li>著(ちょ)</li>
<li>贮(ちょ)</li>
<li>丁(ちょう)</li>
<li>兆(ちょう)</li>
<li>帐(とばり)</li>
<li>庁(ちょう)</li>
<li>吊(とむら)</li>
<li>张(はり)</li>
<li>雕(ほり)</li>
<li>徴(しるし)</li>
<li>惩(ちょう)</li>
<li>挑(いど)</li>
<li>朝(あさ)</li>
<li>潮(しお)</li>
<li>町(まち)</li>
<li>眺(なが)</li>
<li>聴(ちょう)</li>
<li>胀(ちょう)</li>
<li>肠(ちょう)</li>
<li>调(ちょう)</li>
<li>超(ちょう)</li>
<li>跳(は)</li>
<li>长(ちょう)</li>
<li>顶(いただき)</li>
<li>鸟(とり)</li>
<li>勅(ちょく)</li>
<li>直(ちょく)</li>
<li>朕(ちん)</li>
<li>沈(ちん)</li>
<li>珍(ちん)</li>
<li>赁(ちん)</li>
<li>镇(しん)</li>
<li>陈(ちん)</li>
<li>津(つ)</li>
<li>坠(つい)</li>
<li>追(つい)</li>
<li>痛(つう)</li>
<li>通(つう)</li>
<li>冢(つか)</li>
<li>渍(づけ)</li>
<li>坪(つぼ)</li>
<li>钓(つり)</li>
<li>亭(てい)</li>
<li>低(てい)</li>
<li>停(てい)</li>
<li>侦(てい)</li>
<li>贞(さだ)</li>
<li>呈(てい)</li>
<li>堤(つつみ)</li>
<li>定(さだむ)</li>
<li>帝(てい)</li>
<li>底(そこ)</li>
<li>庭(にわ)</li>
<li>廷(てい)</li>
<li>弟(おとうと)</li>
<li>抵(てい)</li>
<li>提(つつみ)</li>
<li>程(ほど)</li>
<li>缔(しめ)</li>
<li>艇(てい)</li>
<li>订(てい)</li>
<li>逓(てい)</li>
<li>邸(やしき)</li>
<li>泥(どろ)</li>
<li>摘(てき)</li>
<li>敌(てき)</li>
<li>滴(しずく)</li>
<li>的(まと)</li>
<li>笛(ふえ)</li>
<li>适(てき)</li>
<li>哲(てつ)</li>
<li>彻(とおる)</li>
<li>撤(てつ)</li>
<li>迭(てつ)</li>
<li>鉄(てつ)</li>
<li>典(てん)</li>
<li>天(てん)</li>
<li>展(てん)</li>
<li>店(てん)</li>
<li>添(そう)</li>
<li>転(てん)</li>
<li>点(てん)</li>
<li>伝(でん)</li>
<li>殿(どの)</li>
<li>田(た)</li>
<li>电(でん)</li>
<li>吐(は)</li>
<li>涂(ぬり)</li>
<li>徒(と)</li>
<li>斗(はかる)</li>
<li>渡(わたり)</li>
<li>登(のぼる)</li>
<li>途(と)</li>
<li>都(みやこ)</li>
<li>努(つとむ)</li>
<li>度(ど)</li>
<li>土(つち)</li>
<li>奴(やつ)</li>
<li>怒(いかり)</li>
<li>倒(だおれ)</li>
<li>党(とう)</li>
<li>冬(ふゆ)</li>
<li>冻(こお)</li>
<li>刀(かたな)</li>
<li>唐(とう)</li>
<li>塔(とう)</li>
<li>岛(しま)</li>
<li>悼(いたむ)</li>
<li>投(とう)</li>
<li>搭(とう)</li>
<li>东(ひがし)</li>
<li>桃(もも)</li>
<li>栋(むね)</li>
<li>盗(ぬす)</li>
<li>汤(ゆ)</li>
<li>灯(ひ)</li>
<li>当(とう)</li>
<li>痘(とう)</li>
<li>等(とう)</li>
<li>答(こたえ)</li>
<li>筒(つつ)</li>
<li>糖(とう)</li>
<li>统(おさむ)</li>
<li>到(いたる)</li>
<li>讨(う)</li>
<li>誊(とう)</li>
<li>豆(まめ)</li>
<li>踏(とう)</li>
<li>逃(のが)</li>
<li>透(とおる)</li>
<li>陶(すえ)</li>
<li>头(あたま)</li>
<li>腾(とう)</li>
<li>闘(たたか)</li>
<li>働(はたらき)</li>
<li>动(どう)</li>
<li>同(どう)</li>
<li>堂(どう)</li>
<li>导(しるべ)</li>
<li>洞(ほら)</li>
<li>童(わらべ)</li>
<li>胴(どう)</li>
<li>道(みち)</li>
<li>铜(どう)</li>
<li>峠(とうげ)</li>
<li>匿(とく)</li>
<li>得(とく)</li>
<li>徳(とく)</li>
<li>特(とく)</li>
<li>督(よし)</li>
<li>笃(あつし)</li>
<li>毒(どく)</li>
<li>独(どく)</li>
<li>読(どく)</li>
<li>凸(でこ)</li>
<li>突(とつ)</li>
<li>届(とどけ)</li>
<li>屯(たむろ)</li>
<li>豚(ぶた)</li>
<li>昙(くもり)</li>
<li>钝(どん)</li>
<li>内(ない)</li>
<li>縄(なわ)</li>
<li>南(みなみ)</li>
<li>软(やわ)</li>
<li>难(なん)</li>
<li>二(に)</li>
<li>尼(あま)</li>
<li>弐(に)</li>
<li>肉(にく)</li>
<li>日(ひ)</li>
<li>乳(ちち)</li>
<li>入(いり)</li>
<li>如(ぎん)</li>
<li>尿(にょう)</li>
<li>任(にん)</li>
<li>妊(にん)</li>
<li>忍(にん)</li>
<li>认(しのぶ)</li>
<li>宁(やすし)</li>
<li>猫(ねこ)</li>
<li>热(ねつ)</li>
<li>年(とし)</li>
<li>念(ねん)</li>
<li>燃(ねん)</li>
<li>粘(ねん)</li>
<li>悩(なや)</li>
<li>浓(のう)</li>
<li>纳(おさむ)</li>
<li>能(のう)</li>
<li>脳(のう)</li>
<li>农(のう)</li>
<li>把(たば)</li>
<li>覇(は)</li>
<li>波(なみ)</li>
<li>派(は)</li>
<li>破(やぶ)</li>
<li>婆(ばばあ)</li>
<li>马(うま)</li>
<li>俳(はい)</li>
<li>廃(はい)</li>
<li>拝(おが)</li>
<li>排(はい)</li>
<li>败(はい)</li>
<li>杯(さかずき)</li>
<li>背(せ)</li>
<li>肺(はい)</li>
<li>辈(やから)</li>
<li>配(くば)</li>
<li>倍(ばい)</li>
<li>培(つちかう)</li>
<li>媒(ばい)</li>
<li>梅(うめ)</li>
<li>买(ばい)</li>
<li>売(ばい)</li>
<li>赔(ばい)</li>
<li>陪(ばい)</li>
<li>伯(はく)</li>
<li>博(ひろし)</li>
<li>拍(はく)</li>
<li>泊(はく)</li>
<li>白(しろ)</li>
<li>舶(はく)</li>
<li>薄(すすき)</li>
<li>迫(はさま)</li>
<li>漠(ばく)</li>
<li>爆(ばく)</li>
<li>缚(ばく)</li>
<li>麦(むぎ)</li>
<li>箱(はこ)</li>
<li>肌(はだ)</li>
<li>畑(はたけ)</li>
<li>八(はち)</li>
<li>钵(はち)</li>
<li>発(はつ)</li>
<li>髪(かみ)</li>
<li>伐(ばつ)</li>
<li>罚(ばち)</li>
<li>抜(ぬ)</li>
<li>阀(ばつ)</li>
<li>伴(とも)</li>
<li>判(はん)</li>
<li>半(はん)</li>
<li>反(はん)</li>
<li>帆(ほ)</li>
<li>搬(はん)</li>
<li>板(いた)</li>
<li>版(はん)</li>
<li>犯(はん)</li>
<li>班(はん)</li>
<li>畔(あぜ)</li>
<li>繁(しげる)</li>
<li>般(ぱん)</li>
<li>藩(はん)</li>
<li>贩(はん)</li>
<li>范(はん)</li>
<li>烦(はん)</li>
<li>颁(はん)</li>
<li>饭(めし)</li>
<li>晩(ばん)</li>
<li>番(ばん)</li>
<li>盘(ばん)</li>
<li>蛮(ばん)</li>
<li>卑(いや)</li>
<li>否(いな)</li>
<li>妃(きさき)</li>
<li>彼(かれ)</li>
<li>悲(かな)</li>
<li>扉(とびら)</li>
<li>批(ひ)</li>
<li>披(ひ)</li>
<li>比(ひ)</li>
<li>泌(ひつ)</li>
<li>疲(つか)</li>
<li>皮(かわ)</li>
<li>碑(ひ)</li>
<li>秘(ひ)</li>
<li>罢(ひ)</li>
<li>肥(こえ)</li>
<li>被(ひ)</li>
<li>费(ひ)</li>
<li>避(さ)</li>
<li>非(ひ)</li>
<li>飞(とび)</li>
<li>备(そなえ)</li>
<li>尾(お)</li>
<li>微(び)</li>
<li>美(び)</li>
<li>鼻(はな)</li>
<li>匹(ぴき)</li>
<li>必(ひつ)</li>
<li>笔(ふで)</li>
<li>姫(ひめ)</li>
<li>百(ひゃく)</li>
<li>表(たわら)</li>
<li>标(ひょう)</li>
<li>氷(こおり)</li>
<li>漂(ただよ)</li>
<li>票(ひょう)</li>
<li>表(おもて)</li>
<li>评(ひょう)</li>
<li>描(びょう)</li>
<li>病(びょう)</li>
<li>秒(びょう)</li>
<li>苗(なえ)</li>
<li>品(ひん)</li>
<li>浜(はま)</li>
<li>贫(ひん)</li>
<li>宾(ひん)</li>
<li>频(ひん)</li>
<li>敏(びん)</li>
<li>瓶(びん)</li>
<li>不(ふ)</li>
<li>付(づけ)</li>
<li>夫(おっと)</li>
<li>妇(ふ)</li>
<li>富(とみ)</li>
<li>布(ぬの)</li>
<li>府(ふ)</li>
<li>怖(こわ)</li>
<li>扶(たもつ)</li>
<li>敷(しき)</li>
<li>普(すすむ)</li>
<li>浮(うき)</li>
<li>父(ちち)</li>
<li>符(ふ)</li>
<li>腐(くさ)</li>
<li>肤(はだ)</li>
<li>谱(ふ)</li>
<li>负(ふ)</li>
<li>赋(みつぐ)</li>
<li>赴(おもむ)</li>
<li>附(ふ)</li>
<li>侮(ぶ)</li>
<li>武(ぶ)</li>
<li>舞(まい)</li>
<li>部(ぶ)</li>
<li>封(ふう)</li>
<li>风(ふう)</li>
<li>伏(ふし)</li>
<li>副(ふく)</li>
<li>复(また)</li>
<li>幅(はば)</li>
<li>服(ふく)</li>
<li>福(ふく)</li>
<li>腹(はら)</li>
<li>复(ふく)</li>
<li>覆(くつがえ)</li>
<li>払(ばらい)</li>
<li>沸(ふつ)</li>
<li>仏(ふつ)</li>
<li>物(ぶつ)</li>
<li>分(ぶん)</li>
<li>喷(ふん)</li>
<li>坟(ふん)</li>
<li>愤(いきどお)</li>
<li>奋(いさむ)</li>
<li>粉(こな)</li>
<li>纷(まぎ)</li>
<li>雰(ふん)</li>
<li>文(ぶん)</li>
<li>闻(ぶん)</li>
<li>丙(へい)</li>
<li>并(へい)</li>
<li>兵(へい)</li>
<li>塀(へい)</li>
<li>币(へい)</li>
<li>平(ひら)</li>
<li>弊(へい)</li>
<li>柄(え)</li>
<li>并(なみ)</li>
<li>闭(へい)</li>
<li>陛(のぼる)</li>
<li>米(べい)</li>
<li>壁(かべ)</li>
<li>癖(くせ)</li>
<li>别(べつ)</li>
<li>偏(へん)</li>
<li>変(へん)</li>
<li>片(かた)</li>
<li>编(へん)</li>
<li>辺(へん)</li>
<li>返(へん)</li>
<li>遍(へん)</li>
<li>便(びん)</li>
<li>勉(つとむ)</li>
<li>弁(べん)</li>
<li>保(ほ)</li>
<li>舗(ほ)</li>
<li>捕(つか)</li>
<li>歩(ほ)</li>
<li>补(たすく)</li>
<li>穂(ほ)</li>
<li>募(つのる)</li>
<li>墓(はか)</li>
<li>慕(した)</li>
<li>暮(くれ)</li>
<li>母(はは)</li>
<li>簿(ぼ)</li>
<li>仿(ほう)</li>
<li>俸(ほう)</li>
<li>包(つつみ)</li>
<li>报(ほう)</li>
<li>奉(みつぐ)</li>
<li>宝(たから)</li>
<li>峰(みね)</li>
<li>崩(くずれ)</li>
<li>抱(かかえ)</li>
<li>放(ほう)</li>
<li>方(かた)</li>
<li>法(ほう)</li>
<li>泡(あわ)</li>
<li>炮(ほう)</li>
<li>缝(ぬい)</li>
<li>胞(ほう)</li>
<li>芳(よし)</li>
<li>褒(ほ)</li>
<li>访(おとず)</li>
<li>豊(とよ)</li>
<li>邦(ほう)</li>
<li>饱(あ)</li>
<li>乏(ぼう)</li>
<li>亡(ぼう)</li>
<li>傍(そば)</li>
<li>剖(ぼう)</li>
<li>坊(ぼう)</li>
<li>妨(さまた)</li>
<li>帽(ぼう)</li>
<li>忘(わす)</li>
<li>忙(いそが)</li>
<li>房(ふさ)</li>
<li>暴(あば)</li>
<li>望(ぼう)</li>
<li>某(ぼう)</li>
<li>棒(ぼう)</li>
<li>冒(ぼう)</li>
<li>纺(ぼう)</li>
<li>肪(ぼう)</li>
<li>膨(ふく)</li>
<li>谋(はかりごと)</li>
<li>贸(ぼう)</li>
<li>防(ぼう)</li>
<li>北(きた)</li>
<li>仆(ぼく)</li>
<li>墨(すみ)</li>
<li>扑(ぼく)</li>
<li>朴(ぼく)</li>
<li>牧(まき)</li>
<li>没(ぼつ)</li>
<li>堀(ほり)</li>
<li>奔(ほん)</li>
<li>本(ほん)</li>
<li>翻(ほん)</li>
<li>凡(ぼん)</li>
<li>盆(ぼん)</li>
<li>摩(ま)</li>
<li>磨(おさむ)</li>
<li>魔(ま)</li>
<li>麻(あさ)</li>
<li>埋(まい)</li>
<li>妹(いもうと)</li>
<li>枚(まい)</li>
<li>毎(ごと)</li>
<li>幕(まく)</li>
<li>膜(まく)</li>
<li>又(また)</li>
<li>抹(まつ)</li>
<li>末(すえ)</li>
<li>茧(まゆ)</li>
<li>万(よろず)</li>
<li>慢(まん)</li>
<li>満(まん)</li>
<li>漫(まん)</li>
<li>味(あじ)</li>
<li>未(み)</li>
<li>魅(み)</li>
<li>岬(みさき)</li>
<li>密(みつ)</li>
<li>脉(みゃく)</li>
<li>妙(みょう)</li>
<li>民(みん)</li>
<li>眠(みん)</li>
<li>务(つとむ)</li>
<li>梦(ゆめ)</li>
<li>无(む)</li>
<li>矛(ほこ)</li>
<li>雾(きり)</li>
<li>婿(むこ)</li>
<li>娘(むすめ)</li>
<li>名(めい)</li>
<li>命(いのち)</li>
<li>明(めい)</li>
<li>盟(めい)</li>
<li>迷(めい)</li>
<li>铭(めい)</li>
<li>鸣(なる)</li>
<li>灭(めつ)</li>
<li>免(めん)</li>
<li>绵(わた)</li>
<li>面(めん)</li>
<li>模(ぼ)</li>
<li>茂(しげる)</li>
<li>妄(もう)</li>
<li>毛(け)</li>
<li>猛(たける)</li>
<li>盲(もう)</li>
<li>网(もう)</li>
<li>耗(もう)</li>
<li>木(き)</li>
<li>黙(もく)</li>
<li>目(め)</li>
<li>戻(もどり)</li>
<li>问(とい)</li>
<li>纹(もん)</li>
<li>门(もん)</li>
<li>匁(もんめ)</li>
<li>夜(よる)</li>
<li>野(の)</li>
<li>矢(や)</li>
<li>厄(やく)</li>
<li>役(えき)</li>
<li>约(やく)</li>
<li>薬(くすり)</li>
<li>訳(やく)</li>
<li>跃(おど)</li>
<li>柳(やなぎ)</li>
<li>愉(さとる)</li>
<li>油(あぶら)</li>
<li>愈(ゆ)</li>
<li>谕(さとし)</li>
<li>输(ゆ)</li>
<li>唯(ただ)</li>
<li>优(ゆう)</li>
<li>勇(ゆう)</li>
<li>友(とも)</li>
<li>幽(ゆう)</li>
<li>悠(ゆう)</li>
<li>忧(うれ)</li>
<li>有(ゆう)</li>
<li>犹(なお)</li>
<li>由(よし)</li>
<li>裕(ゆう)</li>
<li>诱(ゆう)</li>
<li>游(ゆう)</li>
<li>邮(ゆう)</li>
<li>雄(おす)</li>
<li>融(ゆう)</li>
<li>夕(ゆう)</li>
<li>予(よ)</li>
<li>余(よ)</li>
<li>与(あたえ)</li>
<li>誉(ほまれ)</li>
<li>预(あずかり)</li>
<li>幼(よう)</li>
<li>容(かたち)</li>
<li>庸(よう)</li>
<li>扬(よう)</li>
<li>揺(ゆ)</li>
<li>拥(まもる)</li>
<li>曜(ひかり)</li>
<li>様(さま)</li>
<li>洋(よう)</li>
<li>溶(よう)</li>
<li>用(よう)</li>
<li>窑(かま)</li>
<li>羊(ひつじ)</li>
<li>叶(は)</li>
<li>要(よう)</li>
<li>谣(うたい)</li>
<li>踊(おどり)</li>
<li>阳(よう)</li>
<li>养(おさむ)</li>
<li>抑(おおき)</li>
<li>欲(よく)</li>
<li>浴(よく)</li>
<li>翌(よく)</li>
<li>翼(つばさ)</li>
<li>罗(ら)</li>
<li>裸(はだか)</li>
<li>来(らい)</li>
<li>頼(より)</li>
<li>雷(かみなり)</li>
<li>络(らく)</li>
<li>落(おち)</li>
<li>酪(らく)</li>
<li>乱(らん)</li>
<li>卵(たまご)</li>
<li>栏(らん)</li>
<li>滥(らん)</li>
<li>覧(らん)</li>
<li>利(り)</li>
<li>吏(つかさ)</li>
<li>履(くつ)</li>
<li>理(り)</li>
<li>痢(り)</li>
<li>裏(うら)</li>
<li>里(さと)</li>
<li>离(はなれ)</li>
<li>陆(りく)</li>
<li>律(りつ)</li>
<li>率(りつ)</li>
<li>立(りつ)</li>
<li>略(りゃく)</li>
<li>流(りゅう)</li>
<li>留(どめ)</li>
<li>硫(りゅう)</li>
<li>粒(つぶ)</li>
<li>隆(たかし)</li>
<li>竜(りゅう)</li>
<li>虑(りょ)</li>
<li>旅(たび)</li>
<li>虏(とりこ)</li>
<li>了(りょう)</li>
<li>僚(しかさ)</li>
<li>両(りょう)</li>
<li>寮(りょう)</li>
<li>料(りょう)</li>
<li>凉(りょう)</li>
<li>猟(りょう)</li>
<li>疗(りょう)</li>
<li>粮(かて)</li>
<li>良(りょう)</li>
<li>量(りょう)</li>
<li>陵(みささぎ)</li>
<li>领(りょう)</li>
<li>力(ちから)</li>
<li>绿(みどり)</li>
<li>伦(たぐい)</li>
<li>厘(りん)</li>
<li>林(はやし)</li>
<li>临(のぞむ)</li>
<li>轮(わ)</li>
<li>隣(となり)</li>
<li>塁(るい)</li>
<li>涙(なみだ)</li>
<li>累(るい)</li>
<li>类(たぐい)</li>
<li>令(れい)</li>
<li>例(れい)</li>
<li>冷(ひや)</li>
<li>励(つとむ)</li>
<li>礼(れい)</li>
<li>铃(すず)</li>
<li>隷(れい)</li>
<li>零(ぜろ)</li>
<li>霊(れい)</li>
<li>丽(うるわ)</li>
<li>齢(よわい)</li>
<li>暦(こよみ)</li>
<li>歴(れき)</li>
<li>列(れつ)</li>
<li>劣(れつ)</li>
<li>烈(れつ)</li>
<li>裂(れつ)</li>
<li>廉(かど)</li>
<li>恋(こい)</li>
<li>练(ねり)</li>
<li>连(れん)</li>
<li>錬(きたう)</li>
<li>炉(ろ)</li>
<li>路(ろ)</li>
<li>露(つゆ)</li>
<li>労(ろう)</li>
<li>廊(ろう)</li>
<li>朗(あきら)</li>
<li>楼(ろう)</li>
<li>浪(なみ)</li>
<li>漏(ろう)</li>
<li>老(ろう)</li>
<li>郎(ろう)</li>
<li>六(ろく)</li>
<li>录(ろく)</li>
<li>论(ろん)</li>
<li>和(わ)</li>
<li>话(はなし)</li>
<li>贿(まかない)</li>
<li>惑(まど)</li>
<li>枠(わく)</li>
<li>湾(わん)</li>
<li>腕(うで)</li>
</ul>
]]></content>
      
        <categories>
            
            <category> japan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[签证总结大全（工作签、在留卡加汉字、工作签证更新、家族签证等）]]></title>
      <url>https://blog.xiaomo.info/2019/aboutAllVisa/</url>
      <content type="html"><![CDATA[<p>今天办理了家族签证和工作签更新，突然发现自己接触的签证相关的也有4种类型了，所以差不多可以做个总结性blog了。今天办签证遇到的坑很多，感觉真是难以言说。先是公司资料没有寄到，自己去公司拿了一趟。之后告知需要去区役所开非课税证明，而去了之后说是未满一年开不了。各种种的坑，觉得需要记录下来，给需要的朋友少走弯路。<br><a id="more"></a></p>
<h1 id="东京入管局概述"><a href="#东京入管局概述" class="headerlink" title="东京入管局概述"></a>东京入管局概述</h1><p>东京入管局一共有5个区，分别是A（红色）留学类、更新再交付 B（橘黄色）签证更新、C（蓝色）就劳相谈、D（绿色）永驻/再交付/再入国、E（1楼）家族签证。ABCD在二楼，E在1楼。</p>
<h1 id="首次工作签"><a href="#首次工作签" class="headerlink" title="首次工作签"></a>首次工作签</h1><p>理论上来说大专以上的学历都是可以到日本工作的，只要在日本的公司给offer就可以。所以首先是在招聘App上更新简历，我是通过猎聘app上拿到的offer。日本IT相关工作非常缺人，一般来说单纯在上面更新一下简历不需要投递就会有一大波猎头主动过去找你。然后就是精挑细选，挑出觉得比较合适的公司和猎头沟通进行面试安排。一般来说首次来日工作的话都是进的华人外派公司作为跳板，待1-2年之后有合适的机会再换。所以远程面试可能会用wechat视频等不是很正规的方式。等offer确定后就可以和公司沟通办理签证相关事项了，工作签证需要3个月左右。给大家一个提醒，还没给你发工资就要找你要钱的果断拉黑，都9102了相信也不会有人会被这种骗术骗到了吧。</p>
<h2 id="需要的资料"><a href="#需要的资料" class="headerlink" title="需要的资料"></a>需要的资料</h2><ol>
<li>毕业证</li>
<li>学位证（专科不需要）</li>
<li>护照</li>
</ol>
<p>将1-3资料国际快递给公司，之后剩下的时间就是等待了。如果这期间日语不是很好，而经济又不是很紧张的话可以报个班学习一下，这点投入是很值得的。</p>
<h2 id="去日本需要准备的东西"><a href="#去日本需要准备的东西" class="headerlink" title="去日本需要准备的东西"></a>去日本需要准备的东西</h2><p>这些内容一般来说公司会交代，但是不一定会很详细，在此列举一下。</p>
<ol>
<li>印章（12mm左右），日本社会对印章信任度大过签字</li>
<li>一张visa或jcb的信用卡，银联不可。因为不支持绑定手机卡消费</li>
<li>西瓜卡（可以在淘宝上买，也可以下飞机了再买，不过提前准备我觉得更好，坐车吃饭都可以用）</li>
<li>现金若干，不用太多，刷卡一样的，主要用来应急用。</li>
<li>手机卡（或者在支付宝买一个国际流量包）</li>
<li>家族关系公正书（公正处可以办），主要用来年底申请抚养时退税用，如果不在乎这点钱就直接忽略吧</li>
<li>一些小东西，比如指甲钳、挖耳勺之类的刚到日本可能都不知道在哪买，自备一个挺方便。（推荐一个日本的百元连锁店Daiso，生活用品又全又便宜）</li>
</ol>
<p>以上是1年前来日本时准备的东西的回忆版，可能有所遗漏，想到再补充吧。</p>
<h1 id="在留卡加汉字"><a href="#在留卡加汉字" class="headerlink" title="在留卡加汉字"></a>在留卡加汉字</h1><p>初次工作签到日本的话，拿着在留资格认定书在入关换在留卡的时候给的卡是只有拼音名字。如果觉得不方便的话可以之后去入管局申请加一下汉字，当天就能拿到。</p>
<h2 id="需要的资料-1"><a href="#需要的资料-1" class="headerlink" title="需要的资料"></a>需要的资料</h2><ol>
<li>护照</li>
<li>在留卡</li>
<li>申请表（可以到入管了再拿申请表填）</li>
<li>照片*1</li>
<li>1500日币</li>
</ol>
<p>去拿新的在留卡的时候他们会把你原来的在留卡挖个洞再还给你。老的在留卡虽然不知道还有没有用，但是最好不要丢，拿回去放着，也不会吃你家大米不是？</p>
<h1 id="工作签到期更新"><a href="#工作签到期更新" class="headerlink" title="工作签到期更新"></a>工作签到期更新</h1><p>在签证快到期时就在留意去入管更新了，一般在到期前3个月都可以去。要跑两趟的，第一趟去申请更新，会拿到回执。之后会寄通知单过来，再去一趟拿新的在留卡，需要4000日币的更新费用。拿到新的在留卡之后记得把填的老的在留卡的信息的地方全部更新一下，然后拍一张电子照留存。</p>
<p>办理更新是在B区，也是人最多的一个区，拿号都得排队。B1-B4是资料提交区，B5-B6是回执交付区。也就是说在B1-B4递送资料，然后在B5-B6等着。B7是排队拿号的地方，也是噩梦的开始。在等候区有个日本老头找我们聊天说以后如果来入管尽量避开周一和周四，说这2天人超级多。感觉日本的老头老太太都好優しい啊，来日本没多久已经被很多老头老太太关照，暖心的不得了。</p>
<p>这是从公司拿到的资料<br><img src="/img/blog/visa_update_from_company.jpg" width="30%" height="30%"></p>
<p>2019年11月25追记：<br>时隔整整一个月，入管终于把通知去拿在留卡的明信片送过来了，然后带上必要的资料去换卡就好了。我早上7点左右出发，11点拿到在留卡（2楼A1区），天还下着雨。但是拿到3年的签证还是很开心的，同事更新后还是一年，虽然不知道有什么讲究。</p>
<ul>
<li>护照</li>
<li>在留卡</li>
<li>回执</li>
<li>通知卡</li>
<li>4000円（到入管后的全家便利店买4000的邮票）</li>
</ul>
<h2 id="需要的资料-2"><a href="#需要的资料-2" class="headerlink" title="需要的资料"></a>需要的资料</h2><ol>
<li>在留期间申请更新表</li>
<li>照片 4*3 白底 无帽 正面（3个月内，如果不在3个月内也不要用和上一个在留卡一样的照片，这不是明明白白的告诉他们你的照片是1年前的么）</li>
<li>在留卡</li>
<li>护照</li>
<li>住民税证明（不满1年不需要，因为也开不出来。日本不会出现踢皮球式的刁难，一边不给开另一边非得要） </li>
</ol>
<h1 id="以下资料公司准备"><a href="#以下资料公司准备" class="headerlink" title="以下资料公司准备"></a>以下资料公司准备</h1><ol start="6">
<li>雇用契约书 （公司准备）</li>
<li>登记薄滕本（公司准备）</li>
<li>决算报告书（公司准备）</li>
<li>法定调书合计表（公司准备）</li>
<li>在留期间更新许可申请书（公司准备）</li>
</ol>
<p>这个是拿到的回执单，一把辛酸泪。<br><img src="/img/blog/visa_update_result.jpg" width="30%" height="30%"></p>
<h1 id="家族签证"><a href="#家族签证" class="headerlink" title="家族签证"></a>家族签证</h1><p>这次的家族签证是给老婆孩子办的，家族签证可以在日本生活但没有就劳资格。申请所需要时间在1-3个月之间。据说提交的资料越全下签越快，通过率越高，所以我也是尽可能的多准备些资料。换到在留卡之后可以去区役所申请补助，一个月1万5000日元，一直补贴到16岁。1岁半之后就可以免费送去保育园上学，3岁后可以免费上幼儿园。如果抚养者交了社保或者国民健康保险的话老婆孩子都可以享受福利。一家3口，孩子全免，大人负担30%，一个月上限8万日元。以下是所需的资料：</p>
<h2 id="申请书"><a href="#申请书" class="headerlink" title="申请书"></a>申请书</h2><ol>
<li>家族签证申请书（有几个人就需要填几份）</li>
</ol>
<h2 id="复印件"><a href="#复印件" class="headerlink" title="复印件"></a>复印件</h2><ol>
<li>护照复印件</li>
<li>在留卡复印件</li>
<li>结婚证复印件</li>
<li>出生证明复印件（没有孩子就不需要）</li>
</ol>
<h2 id="公正书"><a href="#公正书" class="headerlink" title="公正书"></a>公正书</h2><ol>
<li>家族关系公正书</li>
<li>结婚证公正书</li>
<li>出生证明公正书（没有孩子就不需要）</li>
</ol>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ol>
<li>夫妻交往照片*10</li>
<li>证件照*1（小孩的也需要，我在官网查的资料写16岁以下不要，去了又说要可急坏了我，最后拍了一张护照上的照片应急搞定了） </li>
<li>在职证明</li>
<li>未来半年的收入证明</li>
<li>去1楼的全家花417买简易书留的信封</li>
</ol>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ol>
<li>剪刀（打照片剪照片用）</li>
<li>固体胶（贴照片用）</li>
<li>笔和本子</li>
<li>订书机（固定资料）</li>
<li>在留卡（申请者身份证明）</li>
<li>护照（提前都复印好了可以不用带）</li>
</ol>
<p>这是个自己做的一些记录<br><img src="/img/blog/visa_update.jpg" width="30%" height="30%"></p>
<p>这个是家族签证的回执单<br><img src="/img/blog/family_result.jpg" width="30%" height="30%"></p>
<h1 id="高级人才签证"><a href="#高级人才签证" class="headerlink" title="高级人才签证"></a>高级人才签证</h1><p>目前暂未涉及，留坑以后补充</p>
<h1 id="永住者签证"><a href="#永住者签证" class="headerlink" title="永住者签证"></a>永住者签证</h1><p>目前暂未涉及，留坑以后补充</p>
]]></content>
      
        <categories>
            
            <category> japan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-Java到底是值传递还是引用传递？]]></title>
      <url>https://blog.xiaomo.info/2019/javaPassByValueAndReference/</url>
      <content type="html"><![CDATA[<p>首先，不要纠结于 Pass By Value 和 Pass By Reference 的字面上的意义，否则很容易陷入所谓的“一切传引用其实本质上是传值”这种并不能解决问题无意义论战中。更何况，要想知道Java到底是传值还是传引用，起码你要先知道传值和传引用的准确含义吧？可是如果你已经知道了这两个名字的准确含义，那么你自己就能判断Java到底是传值还是传引用。这就好像用大学的名词来解释高中的题目，对于初学者根本没有任何意义。<br><a id="more"></a></p>
<h1 id="一、搞清楚-基本类型-和-引用类型的不同之处"><a href="#一、搞清楚-基本类型-和-引用类型的不同之处" class="headerlink" title="一、搞清楚 基本类型 和 引用类型的不同之处"></a>一、搞清楚 基本类型 和 引用类型的不同之处</h1><figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">int num</span> = 10;</span><br><span class="line"><span class="attribute">String str</span> = <span class="string">"hello"</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic3.zhimg.com/80/166032bc90958c21604110441ad03f45_hd.jpg" alt></p>
<p>如图所示，num是基本类型，值就直接保存在变量中。而str是引用类型，变量中保存的只是实际对象的地址。一般称这种变量为”引用”，引用指向实际对象，实际对象中保存着内容。</p>
<h1 id="二、搞清楚赋值运算符（-）的作用"><a href="#二、搞清楚赋值运算符（-）的作用" class="headerlink" title="二、搞清楚赋值运算符（=）的作用"></a>二、搞清楚赋值运算符（=）的作用</h1><figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">int num</span> = 10;</span><br><span class="line"><span class="attribute">String str</span> = <span class="string">"hello"</span>;</span><br><span class="line"><span class="attribute">num</span> = 20;</span><br><span class="line"><span class="attribute">str</span> = <span class="string">"java"</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic4.zhimg.com/80/287c0efbb179638cf4cf27cbfdf3e746_hd.jpg" alt></p>
<p>对于基本类型 num ，赋值运算符会直接改变变量的值，原来的值被覆盖掉。对于引用类型 str，赋值运算符会改变引用中所保存的地址，原来的地址被覆盖掉。<code>但是原来的对象不会被改变（重要）。</code> 如上图所示，”hello” 字符串对象没有被改变。（没有被任何引用所指向的对象是垃圾，会被垃圾回收器回收）</p>
<h1 id="三、调用方法时发生了什么？参数传递基本上就是赋值操作。"><a href="#三、调用方法时发生了什么？参数传递基本上就是赋值操作。" class="headerlink" title="三、调用方法时发生了什么？参数传递基本上就是赋值操作。"></a>三、调用方法时发生了什么？参数传递基本上就是赋值操作。</h1><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">第一个例子：基本类型</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">value</span> = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line">foo(num); <span class="comment">// num 没有被改变</span></span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">第二个例子：没有提供改变自身方法的引用类型</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">String</span> <span class="built_in">text</span>)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">text</span> = <span class="string">"windows"</span>;</span><br><span class="line">&#125;</span><br><span class="line">foo(str); <span class="comment">// str 也没有被改变</span></span><br></pre></td></tr></table></figure>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">第三个例子：提供了改变自身方法的引用类型</span><br><span class="line"><span class="keyword">StringBuilder </span><span class="built_in">sb</span> = new <span class="keyword">StringBuilder("iphone");</span></span><br><span class="line"><span class="keyword">void </span>foo(<span class="keyword">StringBuilder </span><span class="keyword">builder) </span>&#123;</span><br><span class="line">    <span class="keyword">builder.append("4");</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br><span class="line"><span class="keyword">foo(sb); </span>// <span class="built_in">sb</span> 被改变了，变成了<span class="string">"iphone4"</span>。</span><br></pre></td></tr></table></figure>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">第四个例子：提供了改变自身方法的引用类型，但是不使用，而是使用赋值运算符。</span><br><span class="line"><span class="keyword">StringBuilder </span><span class="built_in">sb</span> = new <span class="keyword">StringBuilder("iphone");</span></span><br><span class="line"><span class="keyword">void </span>foo(<span class="keyword">StringBuilder </span><span class="keyword">builder) </span>&#123;</span><br><span class="line">    <span class="keyword">builder </span>= new <span class="keyword">StringBuilder("ipad");</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br><span class="line"><span class="keyword">foo(sb); </span>// <span class="built_in">sb</span> 没有被改变，还是 <span class="string">"iphone"</span>。</span><br></pre></td></tr></table></figure>
<p>重点理解为什么，第三个例子和第四个例子结果不同？</p>
<p>下面是第三个例子的图解：<br><img src="https://pic2.zhimg.com/80/d8b82e07ea21375ca6b300f9162aa95f_hd.jpg" alt><br><code>builder.append(&quot;4&quot;)之后</code><br><img src="https://pic2.zhimg.com/80/ff2ede9c6c55568d42425561f25a0fd7_hd.jpg" alt></p>
<p>下面是第四个例子的图解：<br><img src="https://pic2.zhimg.com/80/d8b82e07ea21375ca6b300f9162aa95f_hd.jpg" alt><br><code>builder = new StringBuilder(&quot;ipad&quot;);</code> 之后<br><img src="https://pic4.zhimg.com/80/46fa5f10cc135a3ca087dae35a5211bd_hd.jpg" alt></p>
<h1 id="从局部变量-方法参数开始讲起"><a href="#从局部变量-方法参数开始讲起" class="headerlink" title="从局部变量/方法参数开始讲起"></a>从局部变量/方法参数开始讲起</h1><p>局部变量和方法参数在jvm中的储存方法是相同的，都是在栈上开辟空间来储存的，随着进入方法开辟，退出方法回收。以32位JVM为例，boolean/byte/short/char/int/float以及引用都是分配4字节空间，long/double分配8字节空间。对于每个方法来说，最多占用多少空间是一定的，这在编译时就可以计算好。</p>
<p>我们都知道JVM内存模型中有，stack和heap的存在，但是更准确的说，是每个线程都分配一个独享的stack，所有线程共享一个heap。对于每个方法的局部变量来说，是绝对无法被其他方法，甚至其他线程的同一方法所访问到的，更遑论修改。当我们在方法中声明一个 int i = 0，或者 Object obj = null 时，仅仅涉及stack，不影响到heap，当我们 new Object() 时，会在heap中开辟一段内存并初始化Object对象。</p>
<p>当我们将这个对象赋予obj变量时，仅仅是stack中代表obj的那4个字节变更为这个对象的地址。</p>
<h1 id="数组类型引用和对象："><a href="#数组类型引用和对象：" class="headerlink" title="数组类型引用和对象："></a>数组类型引用和对象：</h1><p>当我们声明一个数组时，如int[] arr = new int[10]，因为数组也是对象，arr实际上是引用，stack上仅仅占用4字节空间，new int[10]会在heap中开辟一个数组对象，然后arr指向它。</p>
<p>当我们声明一个二维数组时，如 int[][] arr2 = new int[2][4]，arr2同样仅在stack中占用4个字节，会在内存中开辟一个长度为2的，类型为int[]的数组，然后arr2指向这个数组。这个数组内部有两个引用（大小为4字节），分别指向两个长度为4的类型为int的数组。</p>
<p><img src="https://pic4.zhimg.com/80/v2-6590cb935ae8bf3b7241cb309fe041d7_hd.jpg" alt></p>
<p>所以当我们传递一个数组引用给一个方法时，数组的元素是可以被改变的，但是无法让数组引用指向新的数组。</p>
<p>你还可以这样声明：int[][] arr3 = new int[3][]，这时内存情况如下图</p>
<p><img src="https://pic2.zhimg.com/80/v2-fdc86227021d56a02b559d6485983c71_hd.jpg" alt></p>
<p>你还可以这样 arr3[0] = new int [5]; arr3[1] = arr2[0];</p>
<p><img src="https://pic1.zhimg.com/80/v2-fdc5e737a95d625a47d66ab61e4a2f55_hd.jpg" alt></p>
<h1 id="关于String"><a href="#关于String" class="headerlink" title="关于String"></a>关于String</h1><p>String对象内部仅需要维护三个变量，char[] chars, int startIndex, int length。而chars在某些情况下是可以共用的。但是因为String被设计成为了不可变类型，所以你思考时把String对象简化考虑也是可以的。String str = new String(“hello”)</p>
<p><img src="https://pic4.zhimg.com/80/v2-a143d0a3594d06f54c6853c46c429e08_hd.jpg" alt></p>
<p>当然某些JVM实现会把”hello”字面量生成的String对象放到常量池中，而常量池中的对象可以实际分配在heap中，有些实现也许会分配在方法区，当然这对我们理解影响不大。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[restful最佳实践]]></title>
      <url>https://blog.xiaomo.info/2019/restfulBestUse/</url>
      <content type="html"><![CDATA[<p>restful 是目前最流行的 API 设计规范，用于 Web 数据接口的设计。它的大原则容易把握，但是细节不容易做对。<br><a id="more"></a></p>
<h4 id="不要纠结于无意义的规范"><a href="#不要纠结于无意义的规范" class="headerlink" title="不要纠结于无意义的规范"></a>不要纠结于无意义的规范</h4><p>  在开始本文之前，我想先说这么一句：RESTful 真的很好，但它只是一种软件架构风格，过度纠结如何遵守规范只是徒增烦恼，也违背了使用它的初衷。</p>
<p>  就像 Elasticsearch 的 API 会在 GET 请求中直接传 JSON，但这是它的业务需要，因为普通的 Query Param 根本无法构造如此复杂的查询 DSL。Github 的 V3 API 中也有很多不符合标准的地方，这也并不会妨碍它成为业界 RESTful API 的参考标准。</p>
<p>  我接下来要介绍的一些东西也会跟标准不符，但这是我在实际开发中遇到过、困扰过、思考过所得出的结论，所以才是<q>我所认为的</q>RESTful API 最佳实践。</p>
<h1 id="为什么要用-RESTful"><a href="#为什么要用-RESTful" class="headerlink" title="为什么要用 RESTful"></a>为什么要用 RESTful</h1><p> RESTful 给我的最大感觉就是规范、易懂和优雅，一个结构清晰、易于理解的 API 完全可以省去许多无意义的沟通和文档。并且 RESTful 现在越来越流行，也有越来越多优秀的周边工具（例如文档工具 Swagger）。</p>
<h1 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h1><p>  如果能全站 HTTPS 当然是最好的，不能的话也请尽量将登录、注册等涉及密码的接口使用 HTTPS。</p>
<h1 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h1><p> API 的版本号和客户端 APP 的版本号是毫无关系的，不要让 APP 将它们用于提交应用市场的版本号传递到服务器，而是提供类似于<code>v1</code>、<code>v2</code>之类的 API 版本号。版本号只允许枚举，不允许判断区间。</p>
<p>  版本号拼接在 URL 中或是放在 Header 中都可以。例如：</p>
 <figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">api.xxx.com</span>/<span class="built_in">v1</span>/users</span><br></pre></td></tr></table></figure>
<p>  或：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">api.xxx.com/users</span><br><span class="line"> <span class="attribute">version</span>=v1</span><br></pre></td></tr></table></figure>
<h1 id="URL-设计"><a href="#URL-设计" class="headerlink" title="URL 设计"></a>URL 设计</h1><h3 id="动词-宾语"><a href="#动词-宾语" class="headerlink" title="动词+宾语"></a>动词+宾语</h3><p>RESTful 的核心思想就是，客户端发出的数据操作指令都是”动词 + 宾语”的结构。比如，GET /articles这个命令，GET是动词，/articles是宾语。<br>动词通常就是五种 HTTP 方法，对应 CRUD 操作。</p>
<h3 id="动词的覆盖"><a href="#动词的覆盖" class="headerlink" title="动词的覆盖"></a>动词的覆盖</h3><p>有些客户端只能使用GET和POST这两种方法。服务器必须接受POST模拟其他三个方法（PUT、PATCH、DELETE）。<br>这时，客户端发出的 HTTP 请求，要加上X-HTTP-Method-Override属性，告诉服务器应该使用哪一个动词，覆盖POST方法。</p>
<h3 id="宾语必须是名词"><a href="#宾语必须是名词" class="headerlink" title="宾语必须是名词"></a>宾语必须是名词</h3><p>宾语就是 API 的 URL，是 HTTP 动词作用的对象。它应该是名词，不能是动词。比如，/articles这个 URL 就是正确的，而下面的 URL 不是名词，所以都是错误的。</p>
<h3 id="复数-URL"><a href="#复数-URL" class="headerlink" title="复数 URL"></a>复数 URL</h3><p>既然 URL 是名词，那么应该使用复数，还是单数？<br>这没有统一的规定，但是常见的操作是读取一个集合，比如GET /articles（读取所有文章），这里明显应该是复数。<br>为了统一起见，建议都使用复数 URL，比如GET /articles/2要好于GET /article/2。</p>
<h3 id="避免多级-URL"><a href="#避免多级-URL" class="headerlink" title="避免多级 URL"></a>避免多级 URL</h3><p>常见的情况是，资源需要多级分类，因此很容易写出多级的 URL，比如获取某个作者的某一类文章。</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">GET <span class="regexp">/authors/</span><span class="number">12</span><span class="regexp">/categories/</span><span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>这种 URL 不利于扩展，语义也不明确，往往要想一会，才能明白含义。<br>更好的做法是，除了第一级，其他级别都用查询字符串表达。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">GET</span> /authors/12?<span class="attribute">categories</span>=2</span><br></pre></td></tr></table></figure>
<h1 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h1><p>一般来说 API 的外在形式无非就是增删改查（当然具体的业务逻辑肯定要复杂得多），而查询又分为详情和列表两种，在 RESTful 中这就相当于通用的模板。例如针对文章（Article）设计 API，那么最基础的 URL 就是这几种：</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">GET <span class="meta-keyword">/articles/</span>list： 文章列表</span><br><span class="line">GET <span class="meta-keyword">/articles/</span>detail<span class="class">/&#123;id&#125;：文章详情</span></span><br><span class="line"><span class="class">POST <span class="meta-keyword">/articles/</span>create/： 创建文章</span></span><br><span class="line"><span class="class">PUT <span class="meta-keyword">/articles/</span>update/&#123;id&#125;：修改文章</span></span><br><span class="line"><span class="class">DELETE <span class="meta-keyword">/articles/</span>delete/&#123;id&#125;：删除文章</span></span><br></pre></td></tr></table></figure>
<p> RESTful 中使用 GET、POST、PUT 和 DELETE 来表示资源的查询、创建、更改、删除，并且除了 POST 其他三种请求都具备幂等性（多次请求的效果相同）。需要注意的是 POST 和 PUT 最大的区别就是幂等性，所以 PUT 也可以用于创建操作，只要在创建前就可以确定资源的 id。</p>
<p>  将 id 放在 URL 中而不是 Query Param 的其中一个好处是可以表示资源之间的层级关系，例如文章下面会有评论（Comment）和点赞（Like），这两项资源必然会属于一篇文章，所以它们的 URL 应该是这样的：</p>
<p>评论：<br><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">GET <span class="string">/articles/</span>&#123;aid&#125;<span class="string">/comments</span>： 某篇文章的评论列表</span><br><span class="line">GET <span class="string">/comments/</span>&#123;cid&#125;<span class="string">/get</span>： 获取</span><br><span class="line">POST <span class="string">/articles/</span>&#123;aid&#125;<span class="string">/comments/create</span>： 在某篇文章中创建评论</span><br><span class="line">PUT <span class="string">/comments/</span>&#123;cid&#125;<span class="string">/update</span>： 修改评论</span><br><span class="line">DELETE <span class="string">/comments/</span>&#123;cid&#125;<span class="string">/delete</span>： 删除评论</span><br></pre></td></tr></table></figure></p>
<p>  这里有一点比较特殊，永远去使用可以指向资源的的最短 URL 路径，也就是说既然<code>/comments/{cid}</code>已经可以指向一条评论了，就不需要再用<code>/articles/{aid}/comments/{cid}</code>特意的指出所属文章了。</p>
<p>点赞：<br><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">GET <span class="string">/articles/</span>&#123;id&#125;<span class="string">/like</span>：查看文章是否被点赞</span><br><span class="line">PUT <span class="string">/articles/</span>&#123;id&#125;<span class="string">/like</span>：点赞文章</span><br><span class="line">DELETE <span class="string">/articles/</span>&#123;id&#125;<span class="string">/like</span>：取消点赞</span><br></pre></td></tr></table></figure></p>
<p>由于大部分的关系查询都与当前的登录用户有关，所以也可以直接在关系所属的资源中返回关系状态。例如点赞状态就可以直接在获取文章详情时返回。注意这里我选择了 PUT 而不是 POST，因为我觉得点赞这种行为应该是幂等的，多次操作的结果应该相同。</p>
<h1 id="Token-和-Sign"><a href="#Token-和-Sign" class="headerlink" title="Token 和 Sign"></a>Token 和 Sign</h1><p>API 需要设计成无状态，所以客户端在每次请求时都需要提供有效的 Token 和 Sign，在我看来它们的用途分别是：</p>
<ul>
<li>Token 用于证明请求所属的用户，一般都是服务端在登录后随机生成一段字符串（UUID）和登录用户进行绑定，再将其返回给客户端。Token 的状态保持一般有两种方式实现：一种是在用户每次操作都会延长或重置 TOKEN 的生存时间（类似于缓存的机制），另一种是 Token 的生存时间固定不变，但是同时返回一个刷新用的 Token，当 Token 过期时可以将其刷新而不是重新登录。</li>
<li>Sign 用于证明该次请求合理，所以一般客户端会把请求参数拼接后并加密作为 Sign 传给服务端，这样即使被抓包了，对方只修改参数而无法生成对应的 Sign 也会被服务端识破。当然也可以将时间戳、请求地址和 Token 也混入 Sign，这样 Sign 也拥有了所属人、时效性和目的地。</li>
</ul>
<h1 id="统计性参数"><a href="#统计性参数" class="headerlink" title="统计性参数"></a>统计性参数</h1><p>  我不太清楚这类参数具体该被称为什么，总之就是用户的各种隐私【误。类似于经纬度、手机系统、型号、IMEI、网络状态、客户端版本、渠道等，这些参数会经常收集然后用作运营、统计等平台，但是在大部分情况下他们是与业务无关的。这类参数变化不频繁的可以在登录时提交，变化比较频繁的可以用轮训或是在其他请求中附加提交。</p>
<h1 id="业务参数"><a href="#业务参数" class="headerlink" title="业务参数"></a>业务参数</h1><p>  在 RESTful 的标准中，PUT 和 PATCH 都可以用于修改操作，它们的区别是 PUT 需要提交整个对象，而 PATCH 只需要提交修改的信息。但是在我看来实际应用中不需要这么麻烦，所以我一律使用 PUT，并且只提交修改的信息。<br>  另一个问题是在 POST 创建对象时，究竟该用表单提交更好些还是用 JSON 提交更好些。其实两者都可以，在我看来它们唯一的区别是 JSON 可以比较方便的表示更为复杂的结构（有嵌套对象）。另外无论使用哪种，请保持统一，不要两者混用。<br>  还有一个建议是最好将过滤、分页和排序的相关信息全权交给客户端，包括过滤条件、页数或是游标、每页的数量、排序方式、升降序等，这样可以使 API 更加灵活。但是对于过滤条件、排序方式等，不需要支持所有方式，只需要支持目前用得上的和以后可能会用上的方式即可，并通过字符串枚举解析，这样可见性要更好些。例如：<br>  搜索，客户端只提供关键词，具体搜索的字段，和搜索方式（前缀、全文、精确）由服务端决定：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/users/?<span class="attribute">query</span>=ScienJus</span><br></pre></td></tr></table></figure>
<p>  过滤，只需要对已有的情况进行支持：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/users/?<span class="attribute">gender</span>=1</span><br></pre></td></tr></table></figure>
<p>  对于某些特定且复杂的业务逻辑，不要试图让客户端用复杂的查询参数表示，而是在 URL 使用别名：</p>
 <figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/users/</span>recommend</span><br></pre></td></tr></table></figure>
<p>  分页：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/users/?<span class="attribute">offset</span>=10&amp;limit=10</span><br><span class="line"> /articles/?<span class="attribute">cursor</span>=2015-01-01 15:20:30&amp;<span class="attribute">limit</span>=10</span><br><span class="line"> /users/?<span class="attribute">page</span>=2&amp;pre_page=20</span><br></pre></td></tr></table></figure>
<p>  排序，只需要对已有的情况进行支持：</p>
 <figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/articles/</span><span class="keyword">sort</span>=-create_date</span><br></pre></td></tr></table></figure>
<p> PS：我很喜欢这种在字段名前面加<code>-</code>表示降序排列的方式。</p>
<h1 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h1><p>HTTP 状态码就是一个三位数，分成五个类别。</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>xx：相关信息</span><br><span class="line"><span class="number">2</span>xx：操作成功</span><br><span class="line"><span class="number">3</span>xx：重定向</span><br><span class="line"><span class="number">4</span>xx：客户端错误</span><br><span class="line"><span class="number">5</span>xx：服务器错误</span><br></pre></td></tr></table></figure>
<p>这五大类总共包含100多种状态码，覆盖了绝大部分可能遇到的情况。每一种状态码都有标准的（或者约定的）解释，客户端只需查看状态码，就可以判断出发生了什么情况，所以服务器应该返回尽可能精确的状态码。<br>API 不需要1xx状态码，下面介绍其他四类状态码的精确含义。</p>
<h3 id="2xx-状态码"><a href="#2xx-状态码" class="headerlink" title="2xx 状态码"></a>2xx 状态码</h3><p>200状态码表示操作成功，但是不同的方法可以返回更精确的状态码。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">GET:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">POST:</span> <span class="number">201</span> <span class="string">Created</span></span><br><span class="line"><span class="attr">PUT:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">PATCH:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">DELETE:</span> <span class="number">204</span> <span class="literal">No</span> <span class="string">Content</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，POST返回201状态码，表示生成了新的资源；DELETE返回204状态码，表示资源已经不存在。<br>此外，202 Accepted状态码表示服务器已经收到请求，但还未进行处理，会在未来再处理，通常用于异步操作。下面是一个例子</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">202</span> Accepted</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "task": &#123;</span><br><span class="line">    "href": "/api/company/job-management/jobs/2130040",</span><br><span class="line">    "id": "2130040"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3xx-状态码"><a href="#3xx-状态码" class="headerlink" title="3xx 状态码"></a>3xx 状态码</h3><p>API 用不到301状态码（永久重定向）和302状态码（暂时重定向，307也是这个含义），因为它们可以由应用级别返回，浏览器会直接跳转，API 级别可以不考虑这两种情况。<br>API 用到的3xx状态码，主要是303 See Other，表示参考另一个 URL。它与302和307的含义一样，也是”暂时重定向”，区别在于302和307用于GET请求，而303用于POST、PUT和DELETE请求。收到303以后，浏览器不会自动跳转，而会让用户</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">303</span> See Other</span><br><span class="line"><span class="attribute">Location</span>: /api/orders/12345</span><br></pre></td></tr></table></figure>
<h3 id="4xx-状态码"><a href="#4xx-状态码" class="headerlink" title="4xx 状态码"></a>4xx 状态码</h3><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span>xx状态码表示客户端错误，主要有下面几种。</span><br><span class="line"><span class="symbol">400 </span>Bad Request：服务器不理解客户端的请求，未做任何处理。</span><br><span class="line"><span class="symbol">401 </span>Unauthorized：用户未提供身份验证凭据，或者没有通过身份验证。</span><br><span class="line"><span class="symbol">403 </span>Forbidden：用户通过了身份验证，但是不具有访问资源所需的权限。</span><br><span class="line"><span class="symbol">404 </span><span class="keyword">Not</span> Found：所请求的资源不存在，或不可用。</span><br><span class="line"><span class="symbol">405 </span>Method <span class="keyword">Not</span> Allowed：用户已经通过身份验证，但是所用的 HTTP 方法不在他的权限之内。</span><br><span class="line"><span class="symbol">410 </span>Gone：所请求的资源已从这个地址转移，不再可用。</span><br><span class="line"><span class="symbol">415 </span>Unsupported Media Type：客户端要求的返回格式不支持。比如，API 只能返回 JSON 格式，但是客户端要求返回 XML 格式。</span><br><span class="line"><span class="symbol">422 </span>Unprocessable Entity ：客户端上传的附件无法处理，导致请求失败。</span><br><span class="line"><span class="symbol">429 </span>Too Many Requests：客户端的请求次数超过限额。</span><br></pre></td></tr></table></figure>
<h3 id="5xx-状态码"><a href="#5xx-状态码" class="headerlink" title="5xx 状态码"></a>5xx 状态码</h3><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">5</span>xx状态码表示服务端错误。一般来说，API 不会向用户透露服务器的详细信息，所以只要两个状态码就够了。</span><br><span class="line"><span class="symbol">500 </span>Internal Server <span class="keyword">Error</span>：客户端请求有效，服务器处理时发生了意外。</span><br><span class="line"><span class="symbol">503 </span>Service Unavailable：服务器无法处理请求，一般用于网站维护状态。</span><br></pre></td></tr></table></figure>
<p>  但是有些时候仅仅使用 HTTP 状态码没有办法明确的表达错误信息，所以我倾向于在里面再包一层自定义的返回码，例如：</p>
<p>  成功时：</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"code"</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">"msg"</span>: <span class="string">"成功"</span>,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  失败时：</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"code"</span>: <span class="number">-1000</span>,</span><br><span class="line">    <span class="attr">"msg"</span>: <span class="string">"用户名或密码错误"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <code>data</code>是真正需要返回的数据，并且只会在请求成功时才存在，<code>msg</code>只用在开发环境，并且只为了开发人员识别。客户端逻辑只允许识别<code>code</code>，并且不允许直接将<code>msg</code>的内容展示给用户。如果这个错误很复杂，无法使用一段话描述清楚，也可以在添加一个<code>doc</code>字段，包含指向该错误的文档的链接。</p>
<h1 id="返回数据"><a href="#返回数据" class="headerlink" title="返回数据"></a>返回数据</h1><h3 id="不要返回纯本文"><a href="#不要返回纯本文" class="headerlink" title="不要返回纯本文"></a>不要返回纯本文</h3><p>API 返回的数据格式，不应该是纯文本，而应该是一个 JSON 对象，因为这样才能返回标准的结构化数据。所以，服务器回应的 HTTP 头的Content-Type属性要设为application/json。<br>客户端请求时，也要明确告诉服务器，可以接受 JSON 格式，即请求的 HTTP 头的ACCEPT属性也要设成application/json。下面是一个例子。</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">GET <span class="meta-keyword">/orders/</span><span class="number">2</span> HTTP/<span class="number">1.1</span> </span><br><span class="line"><span class="symbol">Accept:</span> application/json</span><br></pre></td></tr></table></figure>
<h3 id="发生错误时，不要返回-200-状态码"><a href="#发生错误时，不要返回-200-状态码" class="headerlink" title="发生错误时，不要返回 200 状态码"></a>发生错误时，不要返回 200 状态码</h3><p>有一种不恰当的做法是，即使发生错误，也返回200状态码，把错误信息放在数据体里面，就像下面这样。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "status": "failure",</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "error": "Expected at least two items in list."</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码中，解析数据体以后，才能得知操作失败。<br>这张做法实际上取消了状态码，这是完全不可取的。正确的做法是，状态码反映发生的错误，具体的错误信息放在数据体里面返回。下面是一个例子。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">HTTP/1.1 <span class="number">400</span> Bad Request</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "error": "Invalid payoad.",</span><br><span class="line">  "detail": &#123;</span><br><span class="line">     "surname": "This field is required."</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="提供链接"><a href="#提供链接" class="headerlink" title="提供链接"></a>提供链接</h3><p>API 的使用者未必知道，URL 是怎么设计的。一个解决方法就是，在回应中，给出相关链接，便于下一步操作。这样的话，用户只要记住一个 URL，就可以发现其他的 URL。这种方法叫做 HATEOAS。<br>举例来说，GitHub 的 API 都在 api.github.com 这个域名。访问它，就可以得到其他 URL。</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">...</span></span><br><span class="line">  <span class="string">"feeds_url"</span>: <span class="string">"https://api.github.com/feeds"</span>,</span><br><span class="line">  <span class="string">"followers_url"</span>: <span class="string">"https://api.github.com/user/followers"</span>,</span><br><span class="line">  <span class="string">"following_url"</span>: <span class="string">"https://api.github.com/user/following&#123;/target&#125;"</span>,</span><br><span class="line">  <span class="string">"gists_url"</span>: <span class="string">"https://api.github.com/gists&#123;/gist_id&#125;"</span>,</span><br><span class="line">  <span class="string">"hub_url"</span>: <span class="string">"https://api.github.com/hub"</span>,</span><br><span class="line">  <span class="string">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的回应中，挑一个 URL 访问，又可以得到别的 URL。对于用户来说，不需要记住 URL 设计，只要从 api.github.com 一步步查找就可以了。</p>
<p>HATEOAS 的格式没有统一规定，上面例子中，GitHub 将它们与其他属性放在一起。更好的做法应该是，将相关链接与其他属性分开。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "status": "In progress",</span><br><span class="line">   "links": &#123;[</span><br><span class="line">    &#123; "rel":"cancel", "method": "delete", "href":"/api/status/12345" &#125; ,</span><br><span class="line">    &#123; "rel":"edit", "method": "put", "href":"/api/status/12345" &#125;</span><br><span class="line">  ]&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JSON 比 XML 可视化更好，也更加节约流量，所以尽量不要使用 XML。<br>创建和修改操作成功后，需要返回该资源的全部信息。<br>返回数据不要和客户端界面强耦合，不要在设计 API 时就考虑少查询一张关联表或是少查询 / 返回几个字段能带来多大的性能提升。并且一定要以资源为单位，即使客户端一个页面需要展示多个资源，也不要在一个接口中全部返回，而是让客户端分别请求多个接口。<br>最好将返回数据进行加密和压缩，尤其是压缩在移动应用中还是比较重要的。</p>
<h1 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h1><p>  在 <a href="http://www.scienjus.com/app-server-paging/" target="_blank" rel="noopener">APP 后端分页设计</a> 中提到过，分页布局一般分为两种，一种是在 Web 端比较常见的有底部分页栏的电梯式分页，另一种是在 APP 中比较常见的上拉加载更多的流式分页。这两种分页的 API 到底该如何设计呢？</p>
<p>  电梯式分页需要提供<code>page</code>（页数）和<code>pre_page</code>（每页的数量）。例如：</p>
 <figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="meta-keyword">/users/</span>?page=<span class="number">2</span><span class="variable">&amp;pre_page</span>=<span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>  而服务端则需要额外返回<code>total_count</code>（总记录数），以及可选的当前页数、每页的数量（这两个与客户端提交的相同）、总页数、是否有下一页、是否有上一页（这三个都可以通过总记录数计算出）。例如：</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"pagination"</span>: &#123;</span><br><span class="line">       <span class="attr">"previous"</span>: <span class="number">1</span>,</span><br><span class="line">       <span class="attr">"next"</span>: <span class="number">3</span>,</span><br><span class="line">       <span class="attr">"current"</span>: <span class="number">2</span>,</span><br><span class="line">       <span class="attr">"per_page"</span>: <span class="number">20</span>,</span><br><span class="line">       <span class="attr">"total"</span>: <span class="number">200</span>,</span><br><span class="line">       <span class="attr">"pages"</span>: <span class="number">10</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  流式布局也完全可以使用这种方式，并且不需要查询总记录数（好处是减少一次数据库操作，坏处时客户端需要多请求一次才能判断是否到最后一页）。但是会出现数据重复和缺失的情况，所以更推荐使用游标分页。</p>
<p>  游标分页需要提供<code>cursor</code>(下一页的起点游标) 和<code>limit</code>(数量) 参数。例如：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/articles/?<span class="attribute">cursor</span>=2015-01-01 15:20:30&amp;<span class="attribute">limit</span>=10</span><br></pre></td></tr></table></figure>
<p>  如果文章列表默认是以创建时间为倒序排列的，那么<code>cursor</code>就是当前列表最后一条的创建时间（第一页为当前时间）。</p>
<p>  服务端需要返回的数据也很简单，只需要以此游标为起点的总记录数和下一个起点游标就可以了。例如：</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"pagination"</span>: &#123;</span><br><span class="line">       <span class="attr">"next"</span>: <span class="string">"2015-01-01 12:20:30"</span>,</span><br><span class="line">       <span class="attr">"limit"</span>: <span class="number">10</span>,</span><br><span class="line">       <span class="attr">"total"</span>: <span class="number">100</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  如果<code>total</code>小于<code>limit</code>，就说明已经没有数据了。</p>
<p>  流式布局的分页 API 还有一种情况很常见，就是下拉刷新的增量更新。它的业务逻辑正好和游标分页相反，但是参数基本一样：</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/articles/?<span class="attribute">cursor</span>=2015-01-01 15:20:30&amp;<span class="attribute">limit</span>=20</span><br></pre></td></tr></table></figure>
<p>  返回数据有两种可能，一种是增量更新的数据小于指定的数量，就直接将全部数据返回（这个数量可以设置的相对大一些），客户端会将这些增量更新的数据添加在已有列表的顶部。但是如果增量更新的数据要大于指定的数量，就会只返回最新的 n 条数据作为第一页，这时候客户端需要清空之前的列表。例如：</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"pagination"</span>: &#123;</span><br><span class="line">       <span class="attr">"limit"</span>: <span class="number">20</span>,</span><br><span class="line">       <span class="attr">"total"</span>: <span class="number">100</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  如果<code>total</code>大于<code>limit</code>，说明增量的数据太多所以只返回了第一页，需要清空旧的列表。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-Thread.sleep(0)和Thread.sleep(1)的区别]]></title>
      <url>https://blog.xiaomo.info/2019/jdkSourceCodeReadThreadSleep/</url>
      <content type="html"><![CDATA[<p>某人的代码中用了一句看似莫明其妙的话：Thread.Sleep(0) 。既然是 Sleep 0 毫秒，那么他跟去掉这句代码相比，有啥区别么？Thread.Sleep(0) 表示挂起0毫秒，你可能觉得没作用，你要写Thread.Sleep(1000) 就有感觉了。<br><a id="more"></a></p>
<p>Thread.Sleep(0) 并非是真的要线程挂起0毫秒，意义在于这次调用Thread.Sleep(0)的当前线程确实的被冻结了一下，让其他线程有机会优先执行。Thread.Sleep(0) 是你的线程暂时放弃cpu，也就是释放一些未用的时间片给其他线程或进程使用，就相当于一个让位动作。<br>在线程中，调用sleep（0）可以释放cpu时间，让线程马上重新回到就绪队列而非等待队列，sleep(0)释放当前线程所剩余的时间片（如果有剩余的话），这样可以让操作系统切换其他线程来执行，提升效率。<br>我们可能经常会用到 Thread.Sleep 函数来使线程挂起一段时间。那么你有没有正确的理解这个函数的用法呢？</p>
<h1 id="回顾一下操作系统原理"><a href="#回顾一下操作系统原理" class="headerlink" title="回顾一下操作系统原理"></a>回顾一下操作系统原理</h1><p>操作系统中，CPU竞争有很多种策略。Unix系统使用的是时间片算法，而Windows则属于抢占式的。<br>在时间片算法中，所有的进程排成一个队列。操作系统按照他们的顺序，给每个进程分配一段时间，即该进程允许运行的时间。如果在 时间片结束时进程还在运行，则CPU将被剥夺并分配给另一个进程。如果进程在时间片结束前阻塞或结束，则CPU当即进行切换。调度程 序所要做的就是维护一张就绪进程列表，，当进程用完它的时间片后，它被移到队列的末尾。</p>
<p>所谓抢占式操作系统，就是说如果一个进程得到了 CPU 时间，除非它自己放弃使用 CPU ，否则将完全霸占 CPU 。因此可以看出，在抢 占式操作系统中，操作系统假设所有的进程都是“人品很好”的，会主动退出 CPU 。在抢占式操作系统中，假设有若干进程，操作系统会根据他们的优先级、饥饿时间（已经多长时间没有使用过 CPU 了），给他们算出一 个总的优先级来。操作系统就会把 CPU 交给总优先级最高的这个进程。当进程执行完毕或者自己主动挂起后，操作系统就会重新计算一 次所有进程的总优先级，然后再挑一个优先级最高的把 CPU 控制权交给他。</p>
<p>我们用分蛋糕的场景来描述这两种算法。假设有源源不断的蛋糕（源源不断的时间），一副刀叉（一个CPU），10个等待吃蛋糕的人（10 个进程）。<br>如果是 Unix操作系统来负责分蛋糕，那么他会这样定规矩：每个人上来吃 1 分钟，时间到了换下一个。最后一个人吃完了就再从头开始。于是，不管这10个人是不是优先级不同、饥饿程度不同、饭量不同，每个人上来的时候都可以吃 1 分钟。当然，如果有人本来不太饿，或者饭量小，吃了30秒钟之后就吃饱了，那么他可以跟操作系统说：我已经吃饱了（挂起）。于是操作系统就会让下一个人接着来。<br>如果是 Windows 操作系统来负责分蛋糕的，那么场面就很有意思了。他会这样定规矩：我会根据你们的优先级、饥饿程度去给你们每个人计算一个优先级。优先级最高的那个人，可以上来吃蛋糕——吃到你不想吃为止。等这个人吃完了，我再重新根据优先级、饥饿程度来计算每个人的优先级，然后再分给优先级最高的那个人。<br>这样看来，这个场面就有意思了——可能有些人是PPMM，因此具有高优先级，于是她就可以经常来吃蛋糕。可能另外一个人是个丑男，而去很ws，所以优先级特别低，于是好半天了才轮到他一次（因为随着时间的推移，他会越来越饥饿，因此算出来的总优先级就会越来越高，因此总有一天会轮到他的）。而且，如果一不小心让一个大胖子得到了刀叉，因为他饭量大，可能他会霸占着蛋糕连续吃很久很久，导致旁边的人在那里咽口水。。。</p>
<p>而且，还可能会有这种情况出现：操作系统现在计算出来的结果，5号PPMM总优先级最高，而且高出别人一大截。因此就叫5号来吃蛋糕。5号吃了一小会儿，觉得没那么饿了，于是说“我不吃了”（挂起）。因此操作系统就会重新计算所有人的优先级。因为5号刚刚吃过，因此她的饥饿程度变小了，于是总优先级变小了；而其他人因为多等了一会儿，饥饿程度都变大了，所以总优先级也变大了。不过这时候仍然有可能5号的优先级比别的都高，只不过现在只比其他的高一点点——但她仍然是总优先级最高的啊。因此操作系统就会说：5号mm上来吃蛋糕……（5号mm心里郁闷，这不刚吃过嘛……人家要减肥……谁叫你长那么漂亮，获得了那么高的优先级）。</p>
<p>那么，Thread.Sleep 函数是干吗的呢？还用刚才的分蛋糕的场景来描述。上面的场景里面，5号MM在吃了一次蛋糕之后，觉得已经有8分饱了，她觉得在未来的半个小时之内都不想再来吃蛋糕了，那么她就会跟操作系统说：在未来的半个小时之内不要再叫我上来吃蛋糕了。这样，操作系统在随后的半个小时里面重新计算所有人总优先级的时候，就会忽略5号mm。Sleep函数就是干这事的，他告诉操作系统“在未来的多少毫秒内我不参与CPU竞争”。</p>
<p>看完了 Thread.Sleep 的作用，我们再来想想文章开头的两个问题。<br>对于第一个问题，答案是：不一定。因为你只是告诉操作系统：在未来的1000毫秒内我不想再参与到CPU竞争。那么1000毫秒过去之后，这时候也许另外一个线程正在使用CPU，那么这时候操作系统是不会重新分配CPU的，直到那个线程挂起或结束；况且，即使这个时候恰巧轮到操作系统进行CPU 分配，那么当前线程也不一定就是总优先级最高的那个，CPU还是可能被其他线程抢占去。与此相似的，Thread有个Resume函数，是用来唤醒挂起的线程的。好像上面所说的一样，这个函数只是“告诉操作系统我从现在起开始参与CPU竞争了”，这个函数的调用并不能马上使得这个线程获得CPU控制权。</p>
<p>对于第二个问题，答案是：有，而且区别很明显。假设我们刚才的分蛋糕场景里面，有另外一个PPMM 7号，她的优先级也非常非常高（因为非常非常漂亮），所以操作系统总是会叫道她来吃蛋糕。而且，7号也非常喜欢吃蛋糕，而且饭量也很大。不过，7号人品很好，她很善良，她没吃几口就会想：如果现在有别人比我更需要吃蛋糕，那么我就让给他。因此，她可以每吃几口就跟操作系统说：我们来重新计算一下所有人的总优先级吧。不过，操作系统不接受这个建议——因为操作系统不提供这个接口。于是7号mm就换了个说法：“在未来的0毫秒之内不要再叫我上来吃蛋糕了”。这个指令操作系统是接受的，于是此时操作系统就会重新计算大家的总优先级——注意这个时候是连7号一起计算的，因为“0毫秒已经过去了”嘛。因此如果没有比7号更需要吃蛋糕的人出现，那么下一次7号还是会被叫上来吃蛋糕。<br>因此，Thread.Sleep(0)的作用，就是“触发操作系统立刻重新进行一次CPU竞争”。竞争的结果也许是当前线程仍然获得CPU控制权，也许会换成别的线程获得CPU控制权。这也是我们在大循环里面经常会写一句Thread.Sleep(0) ，因为这样就给了其他线程比如Paint线程获得CPU控制权的权力，这样界面就不会假死在那里。</p>
<p>末了说明一下，虽然上面提到说“除非它自己放弃使用 CPU ，否则将完全霸占 CPU”，但这个行为仍然是受到制约的——操作系统会监控你霸占CPU的情况，如果发现某个线程长时间霸占CPU，会强制使这个线程挂起，因此在实际上不会出现“一个线程一直霸占着 CPU 不放”的情况。至于我们的大循环造成程序假死，并不是因为这个线程一直在霸占着CPU。实际上在这段时间操作系统已经进行过多次CPU竞争了，只不过其他线程在获得CPU控制权之后很短时间内马上就退出了，于是就又轮到了这个线程继续执行循环，于是就又用了很久才被操作系统强制挂起。。。因此反应到界面上，看起来就好像这个线程一直在霸占着CPU一样。<br>末了再说明一下，文中线程、进程有点混乱，其实在Windows原理层面，CPU竞争都是线程级的，本文中把这里的进程、线程看成同一个东西就好了。</p>
<h1 id="问题：主动的放弃运行让系统调度的意义是什么呢？"><a href="#问题：主动的放弃运行让系统调度的意义是什么呢？" class="headerlink" title="问题：主动的放弃运行让系统调度的意义是什么呢？"></a>问题：主动的放弃运行让系统调度的意义是什么呢？</h1><p>为了等待资源、事件，那么你需要进入等待队列。如果你已经拥有运行所需资源，却让系统调度，这是资源的浪费，并且调度也是要浪费资源的</p>
<p>解释：对的，你要等待资源，你确实需要排队，假如AB两个线程为合作关系，A线程处理一些原始数据，数据处理到一定程度，交给B线程处理，在A处理原始数据的时候，B也要做一些准备工作，所以，AB是并发的，但是B做好准备之后，需要等待A处理好那些数据，接过A的数据，继续处理，因此，这个等待，如果A不使用信号或者等待条件来通知B的话，那么B必须一直轮询，查看A是否已完成，B线程所做的这个轮询是否会一直占用CPU来做无用的循环查看呢？因此B这个时候占用的cpu时间片做的是无用功，因此，这里sleep(0)就有作用，当B查看A没处理完数据的时候，B马上sleep(0)交出B的时间片，让操作系统调度A来运行(假设只有AB两个线程），那么这个时候，A就会得到充分的时间来处理它的数据，这个不是一个应用了吗？我猜测pthread_conn_wait()内部阻塞就是使用这个机制</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">thread_fun</span>()</span><br><span class="line">&#123;</span><br><span class="line">    prepare_word.....</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (A is finish)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">sleep</span>(<span class="number">0</span>); <span class="comment">//这里会交出B的时间片，下一次调度B的时候，接着执行这个循环</span></span><br><span class="line">    &#125;</span><br><span class="line">    process A's data</span><br></pre></td></tr></table></figure>
<p>没有sleep(0)版：<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">thread_fun</span>()</span><br><span class="line">&#123;</span><br><span class="line">    prepare_word.....</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)  <span class="comment">//这里会一直浪费CPU时间做死循环的轮询，无用功</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (A is finish)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    process A's data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果说是轮询，那它就是一种高效、节约、谦虚的轮询，如果没有sleep(0)，那么B线程可能会执行上万次的while循环，直至它的时间片消耗完，做这些都是无用功，而是用了sleep(0)后，B线程每一次执行就只做一次while循环就把剩余的时间片让出给A，能让A得到更多的执行次数,利用率更高</p>
<h1 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h1><p>在线程没退出之前，线程有三个状态，就绪态，运行态，等待态。sleep(n)之所以在n秒内不会参与CPU竞争，是因为，当线程调用sleep(n)的时候，线程是由运行态转入等待态，线程被放入等待队列中，等待定时器n秒后的中断事件，当到达n秒计时后，线程才重新由等待态转入就绪态，被放入就绪队列中，等待队列中的线程是不参与cpu竞争的，只有就绪队列中的线程才会参与cpu竞争，所谓的cpu调度，就是根据一定的算法（优先级，FIFO等。。。），从就绪队列中选择一个线程来分配cpu时间。</p>
<p>而sleep(0)之所以马上回去参与cpu竞争，是因为调用sleep(0)后，因为0的原因，线程直接回到就绪队列，而非进入等待队列，只要进入就绪队列，那么它就参与cpu竞争。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[小莫的日本换驾照攻略]]></title>
      <url>https://blog.xiaomo.info/2019/nihonnmennkyo/</url>
      <content type="html"><![CDATA[<p>虽然没有100%确定要在日本定居，但是也不能像咸鱼一样度日。而且日本的驾照可以作为身份证明使用（有些日企在填资料时有一项是填：是否有驾照），所以便有准备考驾照，当然以后自驾游啥的也是很方便。在准备考试的过程中经过多方了解和调查获取了许多相关知识，所以准备以blog的形式记录下来。一是把内容整理出来方便自己更好的通过考试，也可以方便在日本想要换驾照的朋友提供个参照。（本篇文章历时2周，花费时间5个小时左右）<br><a id="more"></a></p>
<h1 id="换驾照和住所有关"><a href="#换驾照和住所有关" class="headerlink" title="换驾照和住所有关"></a>换驾照和住所有关</h1><p>因为我住在琦玉，所以换驾照是去<code>埼玉県鴻巣市鴻巣405番地</code>警察署，具体移步<a href="https://www.police.pref.saitama.lg.jp/f0130/menkyo/gaikoku.html" target="_blank" rel="noopener">琦玉警察署</a>，还有一种不需要和住所绑定，也就是报一个华人驾校，费用在3-4万左右。由于我准备硬刚，所以没有做这种方式的相关攻略，我同事选的这个方式目前己拿到驾照。如果万一对自己没有信心的话可以找个技能学习中心学几节课，费用在2万左右。不管怎么说换驾照都比直接考要便宜，我有个朋友10连休去学的驾照花了20多万，12天拿到驾照。</p>
<h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol>
<li>资料审核时间是工作日的早上9:30-10:30,和下午的1:30-2:00，各半小时（政府单位就是这么任性）。如果要当天考视力和笔试必须得上午去，下午1点钟考。</li>
<li>在国内拿到驾照之后需要待满3个月以上才能过来换。</li>
<li>如果日语不好需要有人陪同，会问一些简单的情况。</li>
<li>如果戴眼镜的话会被做标记限制只能戴眼镜开车，很在意这个测视力的时候可以戴隐形假装自己不近视。（看的别人的攻略，个人觉得没必要这样弄虚作假）</li>
<li>考试内容的话概括是视力测试;10道题的理论测试，7道以上合格;类似国内科二跑一圈。扣分制，70分以下考官会叫停。</li>
<li>日本是右舵，跟国内相反。不过看到这个攻略的人应该都知道这个情况。</li>
<li>台湾护照可以不经过考试直接换日本驾照。</li>
</ol>
<h1 id="费用"><a href="#费用" class="headerlink" title="费用"></a>费用</h1><ol>
<li>报名费 2550　（意味着挂几次就要出几次2550）</li>
<li>领取驾照 2050 （工本费，考过后出一次）</li>
</ol>
<h1 id="需要的资料"><a href="#需要的资料" class="headerlink" title="需要的资料"></a>需要的资料</h1><ol>
<li>在留卡原件</li>
<li>护照。用来确认在居留期限及出入国境的记录。</li>
<li>1寸照片（3X2.4），两张或以上。日本的车站里的写真机器或者便利店里的打印机都可以弄。</li>
<li>登录所有信息的住民票</li>
<li>中国驾驶证。（原件。JAF及各县交通局会拿去复印。需要在取证之后的3个月内没有出中国的记录。）</li>
<li>JAF（Japan Automobile Federation日本汽车联盟）翻译件，可以去JAF窗口也可以邮寄。费用 3500，具体请移步<a href="http://www.jaf.or.jp/inter/translation/" target="_blank" rel="noopener">JAF</a></li>
<li>国内的成绩单和个人信息表，不需要翻译件</li>
</ol>
<h1 id="中文PDF说明文件"><a href="#中文PDF说明文件" class="headerlink" title="中文PDF说明文件"></a>中文PDF说明文件</h1><p><a href="https://www.keishicho.metro.tokyo.jp/multilingual/chinese/traffic_safety/drivers_licenses/index.files/convert_license_chinese.pdf" target="_blank" rel="noopener">外国驾照更换日本驾照</a></p>
<h1 id="考试经过"><a href="#考试经过" class="headerlink" title="考试经过"></a>考试经过</h1><ol>
<li>坐电梯上2楼右转再右转，到<code>外国人免许相谈室</code>门口排队，等待资料审核。会问一些国内考驾照的细节，需要有一定的日语基础。（不会日语需要自带翻译）</li>
<li>下午1点前到1楼大厅左侧3-4号排队检查视力，然后考10道理论题，7道以上合格。（正常人都能通过）</li>
<li>通过之后就会被带到场地上车考试，场地有很多小牌子，考官会提前发出指令。对牌子的位置不熟的话很快就会挂掉！！！<a href="https://blog.xiaomo.info/2019/nihonnmennkyo/#最后配一张琦玉考试的平面路线图">参考</a></li>
<li>我在考到一半的时候被叫停挂掉，最大原因就是对场地不熟悉（毕竟没练过），开车的时候不停的在找牌子就这样挂掉了，预约在半个月后（6/24）再次考试。</li>
<li>参考考试结果觉得不练一下还是比较难考过，果断找了一家驾校准备去练几节课。</li>
</ol>
<h1 id="练车心得"><a href="#练车心得" class="headerlink" title="练车心得"></a>练车心得</h1><p>2019/6/10去驾校练车，由于平日练车的人不多所以直接一次性练了3节课（<code>3280*3</code>），练车后觉得还是挺有帮助的。</p>
<ol>
<li>上车前：从副驾侧绕到车头中间后退3步蹲下看车底和轮胎，然后从副驾侧绕道车尾后退3步蹲下看车底和轮胎 检查有没有小动物，儿童，或障碍物，有没有漏油，变形，车轮是否回正等。确认无误后，从后面绕到车右侧开门上车。。（不能从车头直接绕到驾驶室）</li>
<li>上车时：先看后方，无人时把车门开一个缝，然后再扭头观察后方。无车情况下打开车门进入驾驶室。坐下后关车门：关车门分两段，先虚掩一下车门，确认不会夹到东西，再用力关上，关上后顺便锁车门！不锁车门会扣分。然后向考官问好：こんにちは，留个好印象。</li>
<li>打火前准备：调节座椅位置，调节车内后视镜（就算合适也要调整，要有这个动作），系上安全带，并告诉考官 シートベルト(seat belt)お願いいたします。如果车轮没有回正的话，把车轮回正。依次摸一下档位和手刹，确认手刹已经拉上，档位在P档，雨刮，灯光拨杆位置都正确。确认的时候可以用手指一个一个点过去做确认状。然后踩着刹车，发动引擎，启动后确认车况和指示灯无异常。</li>
<li>打火后准备：调节左右2个后视镜，如果下雨情况下要打开雨刷。（没打火调不了左右后视镜）准备完之后告诉考官 準備終わりました。</li>
<li>当考官告诉你 出発，回答　はい。然后挂D档，松手刹，打右转灯。依次扭头确认后方，左后视镜，车内后视镜，右后视镜，右侧，扭头看右向方（记住一定要回头！不然会扣分！扣分！分！），没车的情况下松开刹车起步。</li>
<li>进入主道前要停车，依次观察车内后视镜，右方后视镜，右后方，无车情况下方可进入。</li>
<li>过弯道后进入直道要加速至35-40码，进入弯道前减速。</li>
</ol>
<hr>
<ol start="8">
<li>此时考官会说 <code>3</code>番：右，到<code>33</code>号附近（提前30米）打右转灯。确认车内后视镜，右方后视镜，右后方。无车开始向右并线，到<code>3号</code>再次3点确认后右转到左道上，然后此直道上要加速到35-40码。</li>
<li>此时考官会说 <code>35</code>番：右，打右转灯，右方3点确认。可在上一步的基础上贴近右侧线，到<code>35号</code>前再次右方3次确认进入<code>直接弯</code>。</li>
<li>此时考官会说 <code>38</code>番：右，打右转灯，在路口停车以此确认左后视镜，车内后视镜，右后视镜，右方，然后看着左方没车的时候拐入左侧道路。</li>
<li>此时考官会说 <code>2</code>番：左，此时离2号还隔着一个<code>红绿灯</code>，不要急着打灯。正常通过红绿灯后，打左转灯。然后依次左方3点确认后开始向左并线。在2号时停车看右方，右后视镜，车内后视镜，左边后视镜，左前方，然后看下右方没车转向左道。</li>
<li>此时考官会说 <code>1</code>番：左，打左转打。左方3点确认，没车的话往左并线。到了<code>1号</code>后停车左方3点确认没车的话进入左道，前方直接要加速到35-40码。前方十字路口<code>有树（見通し悪い場所）</code>，要降速至10码以下到达路口时要前倾以右左右的顺序确认缓慢通过。</li>
<li>此时考官会说 <code>50</code>番：左，打左转灯，左方3点确认，向左并线。到达50号时再次左方3点确认，没车时开始进入<code>S弯</code>。</li>
<li>此时考官会说 <code>49</code>番：右，在路口时要停车看右前方，车内后视镜，左前方，没车时右转到左道。</li>
<li>此时考官会说 <code>16</code>番：左，打左转灯，左方3点确认，并线至左边。然后到达<code>16</code>号时<code>停车3秒(止まれ)</code>,不停会挂掉。看右前，车内后视镜，左侧后视镜，扭头看后方。然后看下右方没车的话开始左转。前方有一个路口，减速通过。然后有一个人行道，减速通过。</li>
<li>此时考官会说 <code>14</code>番：左，打左转灯。左方3点确认，开始向左并线。到达<code>14</code>号再次3点确认，没车时开始左转。前人有一个红绿灯，注意看灯。通过后加速到35-40码。</li>
<li>此时考官会说 <code>4</code>番：右，打右转打，右方3点确认，并线到右边。到达4号后再次右方3点确认，看下左边没车的话开始进入左道。</li>
<li>此时考官会说 <code>8</code>番：右，打右转打，右方3点确认，向右侧并线。同样也要反复左右偏头确认后再进入左侧道路。前方<code>有树（見通し悪い場所）</code>，要路口前要减速到10码以下，以右左右的顺序确认缓慢通过。</li>
<li>此时考官会说 <code>10</code>番：右，打右转灯，右方3点确认，然后向右侧并线。到达10号再次右方3点确认，并进入左道。此时加速至40-50， 前方有<code>障碍物</code>，还有50米左右时打右转灯，然后右方3点确认，打30度方向盘加速进入右道，车子摆正后打左转灯，到达障碍物时左方3点确认，没车时打30度方向盘并入左侧。前方过弯道后打左转灯，左方3点确认。没车时进入左道。</li>
<li>此时考官会说 <code>左</code> 终点停車,减速，打左灯，回头看，贴边，在指定的位置慢慢停住。（左侧30CM以内，左前方铁栏杆50CM以内）。</li>
</ol>
<hr>
<ol start="22">
<li>先拉手刹（不用按），然后挂P档。如果雨刷打开着的话要向前推关掉雨刷，熄火。把座椅推到最后，然后解掉安全带。把车门打开一个缝，观察后方安全推开车门，一只脚踏出去后告诉考官 終わりました。</li>
<li>从车的后方绕到考官的左侧车窗，听候发落。。</li>
<li>车开到终点，考官会根据你的表现告诉你及不及格，合格的话归还号码牌，不合格的话会还你申请资料。有时候考官会问你两句，比如说你之前练了多久的车，在哪个驾校练的，这是第几次考试了之类的，有时候结果介于及格和不及格之间的话，回答没怎么练过，或者驾校的名声比较臭的话容易给不及格。不及格的话一般考官会告诉你扣分点在哪里，你是怎么错的，不过一般也就说一两个地方，如果错的比较多的话考官不会全部都告诉你，但是如果教官完全没说的话你可以开口问，考官是有义务告知你的，问的话不会不说。等说完之后就按照指示去约下一次的考试。及格的话，去换证窗口办手续，按照指示等两三个小时，就可以领到驾照了。最后祝换证的朋友们都能一切顺利！</li>
</ol>
<h1 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h1><ol>
<li>打方向盘不要太急，不稳会扣分。</li>
<li>打方向盘一次不要太多，回盘一次扣5分。</li>
<li>止まれ 不停车会被直接踩停挂掉考试;红灯不停会被踩停挂掉考试;逆行会被踩停挂掉考试。</li>
<li>考试前拿着路线图实地进场走一走，再熟悉一遍(11:45~12:45)。</li>
<li>要先打灯后确认，到达目的地点后再次确认方可动盘。</li>
<li>确认的时候要保持方向盘水平且不能动盘。</li>
<li>有树的地方（見通し悪い場所）一定要减速并左右观察确定。</li>
<li>路线一定要熟记，在哪往哪转提前心里要有谱。</li>
</ol>
<h1 id="友情提示"><a href="#友情提示" class="headerlink" title="友情提示"></a>友情提示</h1><ol>
<li>日本驾照的扣分是：每个月有3分。各种违章，按轻重扣分不同。比如15号，你的3分扣完了，那么你这个月就不能再开车了。但下个月自动还是有3分的。</li>
<li>开车的时候，一定不要喝酒，一口都不行，因为你考回来的驾照会被吊销！另外，安全带，上车后必须系上！必须！包括副驾驶的！如果副驾驶没有系安全带，警察看到后，司机的驾照仍旧会被扣分。</li>
<li>普通道路的时候，可以稍微超速，80km/h的限速，开到120km/h的也大有人在，只是有被扣分罚钱的危险。</li>
</ol>
<h1 id="最后配一张琦玉考试的平面路线图"><a href="#最后配一张琦玉考试的平面路线图" class="headerlink" title="最后配一张琦玉考试的平面路线图"></a>最后配一张琦玉考试的平面路线图</h1><p><img src="/img/blog/saitama.png" alt></p>
<h1 id="更加真实一点的地图"><a href="#更加真实一点的地图" class="headerlink" title="更加真实一点的地图"></a>更加真实一点的地图</h1><p><img src="/img/blog/course.jpg" alt></p>
<h1 id="2019-08-20-更新"><a href="#2019-08-20-更新" class="headerlink" title="2019/08/20 更新"></a>2019/08/20 更新</h1><p>在昨天，终于拿到了驾照，不负这段付出的时光，希望每个努力的人都有一个好结果。<br><img src="/img/blog/menkyo.jpg" alt></p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="http://www.infukuoka.info/life/5168.html" target="_blank" rel="noopener">中国驾照转日本驾照超详细攻略！</a></li>
<li><a href="https://blog.xiangzhuyuan.com/tranfer-chinese-driver-license-to-japanese/" target="_blank" rel="noopener">东京换驾照记</a></li>
<li><a href="https://baijiahao.baidu.com/s?id=1595714456461270665&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">日本留学 ｜ 如何在日本换驾照</a></li>
<li><a href="http://mini.eastday.com/bdmip/180404112201086.html#" target="_blank" rel="noopener">YMG教你中国驾照如何换日本驾照</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> japan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2018年终总结（日本的生活日常）]]></title>
      <url>https://blog.xiaomo.info/2018/nihonnkita2kagetsu/</url>
      <content type="html"><![CDATA[<p>来日本也差不多有2个月啦，这2个月时间也一直没有更新博客,本来是在元旦就应该开始写的，但是一直拖到了现在。主要是因为换了新环境很多事情需要做，很多地方需要适应，所以没时间也没法静下心来写写博客记录一下生活。现在终于有时间坐下来记录一下在日本的生活日常。<br><a id="more"></a></p>
<h1 id="我为什么要来日本"><a href="#我为什么要来日本" class="headerlink" title="我为什么要来日本"></a>我为什么要来日本</h1><p>大学的时候一直对动漫特别感觉趣，毕业后在杭州偶然接触到对日的软件开发，开始萌发了学日语的想法。后来看动漫的量越来越多，听力也慢慢好起来，开始有了到日本看一看的念头，但是因为能力受限一直没有到日本，但是在2015年~2018年期间有断断续续的背日语单词。17年国庆节的时候和老婆一起来日本自由行12天，亲眼见证了日本的自然和人文，便把到日本工作作为自己的下一个计划。大家应该都知道2018年是互联网很不好的一年，裁员风暴一波又一波，但是我的前公司并没有因此裁员反而吸收了大量被裁员的人。我15年进那家公司的时候不到60人，我18年离职的时候己经快1000人了，我亲眼见证了这家公司的飞速成长。但是为我什么离职呢，我在这家公司3年了也想换换新的环境，但是国内的环境不好自己带的那个项目表现不是很好又经常通宵加班所以趁此机会开始找日本的工作机会。从6月份开始通过猎头远程面试到7月份确定工作，然后就是各种证件EMS给公司办在留资格证。</p>
<h1 id="我来日本多久了"><a href="#我来日本多久了" class="headerlink" title="我来日本多久了"></a>我来日本多久了</h1><p>2018年8月份开始申请在留，2019年11月拿到手，但是很快到日本的新年了。所以我在农历的腊月中旬（2019.1.16）来到日本东京，2019年在日本度过了的第一个中国新年，正好今年东京塔在春节当晚亮起了中国红，刷爆了朋友圈,突然也有了一点恋家的感觉。我老家在非常偏僻的农村，后来了为读书我们搬到了镇上。考上了县城高中然后在县城买了房子。到后来读大学，去了武汉。毕业后和朋友一起到杭州谋生。现在都各自成家立业，朋友正在注册着属于自己的公司，而我飘扬过海来到日本工作。我一直不信星座，但是作为射手座的我，星座解释说射手座向往自由和远方，这一点我倒是深信不疑,从一个小村庄到出国，是射手座给我的勇气。截至到目前为止，我在日本待了大概有2个月，可能还会待很多个两个月。今年天皇退位,所以黄金周放10天假可以回杭州休息一段时间了。</p>
<h1 id="在日本住的房子是什么样的"><a href="#在日本住的房子是什么样的" class="headerlink" title="在日本住的房子是什么样的"></a>在日本住的房子是什么样的</h1><p>公司提供了3种方案：1、住公司宿舍——价格最便宜，也最省心，但是环境不是很好，地方也比较小。 2、在公司合租的中介那边自租房间——个人感觉价格比较贵，而且有朋友在日本工作，问我愿不愿意合租。 3、自理——我选择了自己搞定，在日本和朋友合租了UR团地，9万一个月，总面积54平，3DK。在房子上没有走很多才来日本的朋友的坑，这一点比较省心。但是由于住的地方比较远，所以上班时间得花1个多小时。不过和北上广比较来，也差不了太多。既然选择在大城市，就得有这个觉悟。</p>
<h1 id="在日本做什么样的工作"><a href="#在日本做什么样的工作" class="headerlink" title="在日本做什么样的工作"></a>在日本做什么样的工作</h1><p>我是2019年1月17号到达日本，来了之后公司催着去上班（我还以为是2.1号开始）。所以在17号当天急急忙忙办了各种手续。包括住民登记、办手机卡、办银行卡、去公司签协议等等。于是，在2019年2月18号，我正式开始了在日本的第一天社畜生活。我是在 在日华人在日本开的公司，属于派遣形式。第一个现场是在浦田，公司名字是日立制作所，我对日立印象最深的就是中国很多电梯都是三菱和日立的品牌。做的工作内容并没有什么技术性，短暂的做了一些测试的工作，在这期间我开始疯狂的记单词，没有工作任务的时候就记。好在这个现场的工作时间不长，2019年2月底就结束了，所以我开始面试新的项目，从3.1号开始到下个现场上班。说实话，因为自己日语口语太差，加上基本上没有对日开发经验，所以一度非常受挫。第一个面试的项目是在SoftBank，第二个是日本NSD,第三个是ricoh(理光)。第三个面上了，我特意去了解了一下是个世界500强的公司，还算是不错。工作内容是使用Angular6做网站开发，因为我经常不务正业研究一些乱七八糟的技术，包括但不限于Angular,React之类。在面试的时候虽然口语表达的不好，但是把自己Angular会的部分展示出来成功的获得了工作机会。还有最后2天就要开始做这个项目了，希望会是一个开心的过程。</p>
<h1 id="在日本的通讯方式"><a href="#在日本的通讯方式" class="headerlink" title="在日本的通讯方式"></a>在日本的通讯方式</h1><p>来日本的第一天匆匆忙忙办了一张Y！Mobile的手机卡，一个月2000日元，3GB流量。由于考虑手机用的比较久，电池不耐用，32G内存也不够用等等花了8万日元入手了一台256G的iphoneXR，办了一个SoftBank的卡，因为室友也用的SoftBank的卡，所以每个月还可以额外优惠1000日元。</p>
<h1 id="在日本吃什么"><a href="#在日本吃什么" class="headerlink" title="在日本吃什么"></a>在日本吃什么</h1><p>首先，我出生在内陆，很少吃海鲜，偶尔吃虾和鱼。来了日本之后看到鱼特别便宜但是却没有想吃的欲望觉得还是挺浪费的。正所谓入乡随俗，所以我也开始尝试一些日本料理，但是吃了一次生鱼片我确实还没法习惯。再加上店里吃饭比较贵，我一般都是自己做饭吃，带便当去现场中午吃。住的地方超市、便利店、物产店都很方便，想吃什么基本上都能买到。</p>
<h1 id="打算在日本待多久"><a href="#打算在日本待多久" class="headerlink" title="打算在日本待多久"></a>打算在日本待多久</h1><p>目前来说还没有确定，只能说走一步看一步。刚来日本各种东西不熟悉、语言不通、环境不适应等等各种因素我也打过退堂鼓，但是觉得自己努力了这么久才来了不到2个月，还得需要更多的时间去适应。</p>
<h1 id="日本的工作加班吗"><a href="#日本的工作加班吗" class="headerlink" title="日本的工作加班吗"></a>日本的工作加班吗</h1><p>做IT行业我说不加班你会信吗？ 你肯定会说：我信你鬼哟，你个糟老头子坏的很！ 确实，IT行业不需要和人打交道，有内容一直都可以做。但是日本确定很少加班，日本和中国不一样，日本是按照出勤时间算。比如说一天上班8小时，一个月上20天。所以日本普遍月出勤时间在150-160之间。到了下班时间还在公司墨迹领导会催着回去，而且有些公司规定周三、周五强制6点离场。在现在这个现场我偶尔也有加班，但是最晚是到8点钟，这样的话我出勤时间就有10个小时。我之后如果有事情要办，可以调休去办自己的事情，只要总工时达到了规定时间就能发全工资，所以我觉得这一点还是比较人性化。</p>
<h1 id="日本的社保"><a href="#日本的社保" class="headerlink" title="日本的社保"></a>日本的社保</h1><p>日本有社保和厚生年金，年金和国内的一金非常类似，自己的公司各负担一半。社保可以不交，但是国民健康保险最好交一下，我现在每个月是2700日元。日本纳税是按照上一年度纳税，我第一年来日本所以比较低，明年的话可能一个月要交8000左右的保险金。这个国民健康保险看病自己只用负担30%，家人也可以用，小孩子是全免费的。有些不分大人小孩可吃的药医生出会多开一些剂量，不用出钱大人也可以用，比如说日本人春天物别容易犯的花粉症的抗过敏药。我到现在为止拿到了国民健康保险卡，这个月也刚交了2700的保险金，但是没有到医院去过，所以具体什么样子得等以后再实践。</p>
<h1 id="日本IT行业的那些规矩"><a href="#日本IT行业的那些规矩" class="headerlink" title="日本IT行业的那些规矩"></a>日本IT行业的那些规矩</h1><p>在日本做IT没有灵活可言，要用什么工具，什么版本基本上都是定好的，给什么用什么。有问题一定要及时和上级沟通，上级会很认真的帮忙解决，自己想当然做到最后出问题会很严重，一直出错最终会失去领导的信任。在工位上可以玩手机，可以充电啥的，但是绝对不要把USB插到电脑上，也不要在办公室拍照。日本人上班工作喝水基本上都是在自动贩卖机上买各种饮料或矿泉水，目前只有我一个人会抱着个大大的保温杯去接开水喝，而且日本人食量很小，我每天中午都吃的是我们领导的2倍多，才开始还觉得有点羞耻，后来脸厚了也就无畏无惧了。我现在工作的地方允许在工位上吃饭，可能有些地方会不让。</p>
<h1 id="在日本的中国人可信吗"><a href="#在日本的中国人可信吗" class="headerlink" title="在日本的中国人可信吗"></a>在日本的中国人可信吗</h1><p>来日本之前看过很多文章说中国人坑中国人，首先我觉得比较丢脸，因为我也是中国人，但是我觉得事实上并没有说的那么严重。至少我来日本遇到的中国人都还是挺好的，包括我现在公司的社长、公司营业、办手机卡的中国营业员、项目组的中国人，感觉都还挺好的。目前没有出现被坑的情况，也希望以后不要遇到，不要让我也觉得国人坑国人是那么普遍。</p>
<h1 id="日本的卫生间"><a href="#日本的卫生间" class="headerlink" title="日本的卫生间"></a>日本的卫生间</h1><p>可能有朋友有觉得我把这个单独提出来是不是有点变态，其实我觉得是有些可以拿出来说的。首先，日本的卫生间干净的让人觉得十分舒服，完全没有味道。每个水龙头都有热水，旁边摆的洗手液永远都不会成空瓶子。有风干机，有镜子，每个马桶边上的纸从来不会空。总之，这些小细节真的是让人非常喜欢。</p>
<h1 id="办公室工作结构"><a href="#办公室工作结构" class="headerlink" title="办公室工作结构"></a>办公室工作结构</h1><p>我目前所在的项目是6个人，4个中国人和2个日本人。为了练日语，我会经常厚脸皮的和其中一个日本人发消息聊天，在没有工作内容的时候经常会一聊 聊半天时间。从开始打字都不知道打什么，到现在能长篇大论，从吃的谈到用的，从家庭谈到工作。我觉得我进步还是挺大的，但是目标最弱的还是口语，所以在接下来的时候我会努力的去读去练发声。</p>
<h1 id="非工作时间我一般在做什么"><a href="#非工作时间我一般在做什么" class="headerlink" title="非工作时间我一般在做什么"></a>非工作时间我一般在做什么</h1><p>来日本一个多月了，除了上班我感觉别的事情我真的什么都没做，但是总觉得时间一晃就非常晚了。一般来说，花1个多小时回家，再花1个小时做饭吃饭，再玩玩电脑玩玩手机不知不觉都己经过了12点。从高中开始一直对钢琴比较有兴趣，所以买了雅马哈的电钢琴但是也没什么时间练，但是它也是我以后其中计划的一环，总有一天我会流利的弹出我喜欢的钢琴曲。周六固定在日本政府办的免费日语教室上课，然后和朋友一起吃个晚饭。周末做家里蹲一睡一整天，其实我觉得这样很不好，这个我会尽量改掉。我一直计划想去海边去玩，但是因为温度比较低一直没有去，等天气暖和一点了去海边玩。在国内的时候玩着来日本了一有时间我就要出去各种浪，但是真正来了日本快2个月了一直没有出去玩过真是汗颜。</p>
<h1 id="日本的电车"><a href="#日本的电车" class="headerlink" title="日本的电车"></a>日本的电车</h1><p>日本的电车非常准时，我仔细注意过，我只要早上固定在某个时间点从家里出来，一定是在某个时间点到达公司。只有一次电车延迟了半个多小时，原因好像是我坐的这条线正好遇到了人身事故。日本的电车非常安静，日本人在电车上很喜欢看书。电车上明文规定手机保持震动，不要在车上打电话，所以车上非常安静。能听到别人说的悄悄话和翻书的声音。电车上有2个固定的显示屏，一个放广告一个放实时站点信息。不想看广告的话完全不会被打扰，屏幕上会有当天的天气预报。每个电车基本上都设置有3节女性车厢，早晚高峰最好不要坐，不然有可能会被白眼，其实这倒没什么，万一遇到蛮不讲理的女性非要说是痴汉会很伤脑筋。东京早晚高峰电车非常拥挤，这也是为什么男性要尽量避免女性专用车厢。但是平时的话很容易遇到座位，因为有很多日本人都不坐。据说是他们觉得会有比自己更需要座位的人，所以不是特别累就会站着，反正我是奉行有位置不坐是王八的バカ。</p>
<h1 id="日本的电梯文化"><a href="#日本的电梯文化" class="headerlink" title="日本的电梯文化"></a>日本的电梯文化</h1><p>我工作的现场有8个电梯，在两边都排着整齐的队伍。有电梯下来依次乘坐，坐不下的会退回来等下一部电梯。站的太满的时候靠近门的那部分人会先出来等别人都出来了再上去，电梯按钮边上的人也会帮忙一直把开的按钮一直按着，不会像国内站在里面想出来只能使劲挤出来。在坐电梯的时候如果门快关了有快速跑过来按开电梯，进来之前会先鞠躬道歉再过来。在按钮边上站着的人会按着开的按钮等所有人都出来了他们再出来，因为我没有这个习惯所以一到目的地楼层我就会先出来，所以心里会有点抱歉。</p>
<h1 id="来日本2个月的感觉"><a href="#来日本2个月的感觉" class="headerlink" title="来日本2个月的感觉"></a>来日本2个月的感觉</h1><p>首先从去市役所做住所登录来说，政府人员真的是非常非常有耐心。我听不懂他们说什么的时候，会用非常慢的语速再重复，如果再听不懂会用笔写下来。还是不懂的话我会打电话给日语好的朋友让我朋友帮我说，不管花多长时间他们不会显示出不耐烦。据日本的朋友说，我们作为纳税人养活着他们，他们态度好不是理所当然的么。我觉得非常震惊，但是仔细想过又觉得他说的非常有道理。但是日本非常不方便的是办事情只能工作日，周六周日从来不上班。但是工作现场可以调休这一点也正好弥补了这一点不方便。还有非常不方便的地方就是日本的快递不能邮寄到公司，只能邮到家里。但是提前不能指定时间，他们送到之后。人不在家拿不了时，会给一张不在联络票放在邮箱，拿到不在联络票再指定时间。我觉得这真是一个神奇而又变态的设定。在日本总体来说有着非常好的服务态度，不用担心食品安全问题，每天都能看到蓝天，很多细节感人泪人，也不用在意各种墙，写代码因为网络原因出现各种奇怪而又难解决的问题。但是毕竟这不是自己的家乡，会觉得不适应。也会想家人，想老婆，想孩子，也想我家那只蓝猫。</p>
<h1 id="我接下来的计划"><a href="#我接下来的计划" class="headerlink" title="我接下来的计划"></a>我接下来的计划</h1><p>在日本工作生活，时间越长越觉得日语不好是多么的不方便。听着别人说一口流利的日语，真的是不要太羡慕。所以接下来首要的任务就是加油学日语，然后报今年7月份的N2。如果N2能考，12月份接着考N1,万一考不过继续考N2。反正不考到N1不罢休。然后就是好好学学技术，技术是自己的饭碗所以这个当然不能丢。计划做一个独立小游戏上线推广。朋友注册了公司，帮忙做一些公司建设方面的内容。N1到手之后开始把时间转移到学英语和钢琴上，然后考一些日本政府认可的技术证书等等（高级人才签证的准备工作）。我一直觉得人活着，过一天就要有新的收获，所以每一天都在不停的学习。达到一个目标后，继续开始新的目标。比如说初中时各个假期学五笔、学PS、学装系统、电脑维修等等，这些都为我以后的工作生活带来了极大的方便 。有的时候和我朋友讲我的经历，他们总会觉得我的经历充满了传奇，非常的羡慕。但是我想说的是，每个人都是一个精彩的传奇，我被别人羡慕着同样也羡慕着别人。我也有特别多让人烦心的事情，也是一个普通的不能再普通的普通人。</p>
<h1 id="不会日语可以来日本工作吗"><a href="#不会日语可以来日本工作吗" class="headerlink" title="不会日语可以来日本工作吗"></a>不会日语可以来日本工作吗</h1><p>完全可以，因为众所周知，日本是一个少子化相当严重的国家，而IT行业缺人尤为严重。只要会一点点技术，基本上都不会找不到工作。不过工资不会太高，一般会在25万左右。但是想在日本长期生活，建议尽最大努力提长自己的日语能力。哪怕来了日语才开始记50音图都没关系，但是一直要快点把日语学好，因为这关系到自己的待遇和生活质量。谁都不想出去了只买自己知道的东西，找不到东西不知道怎么给店员说。有人可能会反驳，很多店都有中国店员，甚至有很多日本人也在在学中文。但是在日本这个国家生活，只想靠中文生活是不是有点说不过去。</p>
<h1 id="以上"><a href="#以上" class="headerlink" title="以上"></a>以上</h1><p>断断续续天马行空的写了些乱七八糟的东西。想看的朋友将就着看，如果有什么问题想了解我没有提到的欢迎留言，我会适当补充内容。</p>
]]></content>
      
        <categories>
            
            <category> japan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fps游戏常用功能]]></title>
      <url>https://blog.xiaomo.info/2018/unityFpsCommonMethod/</url>
      <content type="html"><![CDATA[<p>镜头拉远拉近，类似狙的镜头缩放；枪口特效；角色的移动和镜头旋转<br><a id="more"></a></p>
<h1 id="镜头拉远拉近"><a href="#镜头拉远拉近" class="headerlink" title="镜头拉远拉近"></a>镜头拉远拉近</h1><ol>
<li>在main camera中添加一个脚本 <code>CameraZoom</code></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CameraZoom</span> :</span> MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Camera mainCamera;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] zoomLevel = &#123;<span class="number">60</span>, <span class="number">40</span>, <span class="number">20</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> currentLevel;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mainCamera = GetComponent&lt;Camera&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetMouseButtonDown(<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            currentLevel += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (currentLevel &gt;= zoomLevel.Length)</span><br><span class="line">            &#123;</span><br><span class="line">                currentLevel = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> currentFieldOfView = zoomLevel[currentLevel];</span><br><span class="line"></span><br><span class="line">        mainCamera.fieldOfView = Mathf.Lerp(mainCamera.fieldOfView, currentFieldOfView, <span class="number">0.1f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>此脚本的功能是可以在编辑器中自定义缩放等级，不设置的话默认是60,40,20共3个等级。当按下鼠标左键的时候缩放等级+1,到了最大缩放等级回到0</li>
</ol>
<h1 id="fps角色组成部分"><a href="#fps角色组成部分" class="headerlink" title="fps角色组成部分"></a>fps角色组成部分</h1><p><img src="https://image.xiaomo.info/unity3d/fps/player.png" alt></p>
<ul>
<li>player是个空物体，是放角色模型的容器</li>
<li>player/main camera是player的子物体，我们控制player移动时camera跟着一起移动</li>
<li>player/guns 是枪的容器,放所有的枪</li>
<li>player/guns/HandGun是手枪的容器，里面放手枪的模型，枪口</li>
<li>player/guns/handGun/firePoint/fireEffect 是枪口开火特效，默认隐藏，开火时显示</li>
</ul>
<ol>
<li>新建一个脚本<code>FireEffectController</code>挂在<code>firePoint</code>空物体上,当点击鼠标左键时开火显示特效，使用<code>Invoke</code>方法延迟0.3秒隐藏</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GunFireEffect</span> :</span> MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> GameObject fireEffect;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        fireEffect = transform.Find(<span class="string">"Effect"</span>).gameObject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetMouseButtonDown(<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            fireEffect.SetActive(<span class="literal">true</span>);</span><br><span class="line">            Invoke(<span class="string">"HideEffect"</span>, <span class="number">0.3f</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HideEffect</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        fireEffect.SetActive(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="角色控制"><a href="#角色控制" class="headerlink" title="角色控制"></a>角色控制</h1><ol>
<li>移动,这个方法因为乘了<code>Time.deltaTime</code>，所以它是在<code>Update</code>方法中调用的，h或者v要有其一大于0</li>
</ol>
<figure class="highlight plain"><figcaption><span><summary></summary></span></figcaption><table><tr><td class="code"><pre><span class="line">/// 在update中调用</span><br><span class="line">/// &lt;/summary&gt;</span><br><span class="line">/// &lt;param name=&quot;h&quot;&gt;&lt;/param&gt;</span><br><span class="line">/// &lt;param name=&quot;v&quot;&gt;&lt;/param&gt;</span><br><span class="line">public void Move(float h, float v)</span><br><span class="line">&#123;</span><br><span class="line">    Vector3 dir = new Vector3(h * speed * Time.deltaTime, 0, v * speed * Time.deltaTime);</span><br><span class="line">    player.Translate(dir);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>旋转视野，这个方法只能在<code>FixedUpdate中调用</code>，如果要放在<code>Update</code>中,x、y要乘于<code>Time.deltaTime</code></li>
</ol>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 在fixUpdate中调用</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="x"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="y"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RotateView</span>(<span class="params"><span class="keyword">float</span> x, <span class="keyword">float</span> y</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x *= rotateSpeed;</span><br><span class="line">    y *= rotateSpeed;</span><br><span class="line">    <span class="comment">// 左右沿自身旋转</span></span><br><span class="line">    transform.Rotate(-y, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 上下旋转沿世界坐标</span></span><br><span class="line">    transform.Rotate(<span class="number">0</span>, x, <span class="number">0</span>, Space.World);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>角色控制器脚本<code>FpsPlayerController</code>方法</li>
</ol>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FpsPlayerController</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Range(2, 4)</span>] <span class="keyword">public</span> <span class="keyword">int</span> speed = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Transform player;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> rotateSpeed = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        player = GameObject.Find(<span class="string">"Player"</span>).transform;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// 键盘</span></span><br><span class="line">        <span class="keyword">float</span> h = Input.GetAxisRaw(<span class="string">"Horizontal"</span>);</span><br><span class="line">        <span class="keyword">float</span> v = Input.GetAxisRaw(<span class="string">"Vertical"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (h &gt;= <span class="number">0.1f</span> || v &gt;= <span class="number">0.1f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Move(h, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FixedUpdate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// 鼠标</span></span><br><span class="line">        <span class="keyword">float</span> x = Input.GetAxisRaw(<span class="string">"Mouse X"</span>);</span><br><span class="line">        <span class="keyword">float</span> y = Input.GetAxisRaw(<span class="string">"Mouse Y"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">0.1f</span> || y &gt; <span class="number">0.1f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            RotateView(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p><img src="https://image.xiaomo.info/unity3d/camera/fps.gif" alt></p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> function </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[镜头拉远拉近]]></title>
      <url>https://blog.xiaomo.info/2018/unitySceneFarAndNear/</url>
      <content type="html"><![CDATA[<p>镜头拉远拉近，类似狙的镜头缩放<br><a id="more"></a></p>
<ol>
<li>在场景中创建一个cube,默认fieldOfView为60</li>
<li>在main camera中添加一个脚本 <code>CameraZoom</code></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CameraZoom</span> :</span> MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Camera mainCamera;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] zoomLevel = &#123;<span class="number">60</span>, <span class="number">40</span>, <span class="number">20</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> currentLevel;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mainCamera = GetComponent&lt;Camera&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetMouseButtonDown(<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            currentLevel += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (currentLevel &gt;= zoomLevel.Length)</span><br><span class="line">            &#123;</span><br><span class="line">                currentLevel = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> currentFieldOfView = zoomLevel[currentLevel];</span><br><span class="line"></span><br><span class="line">        mainCamera.fieldOfView = Mathf.Lerp(mainCamera.fieldOfView, currentFieldOfView, <span class="number">0.1f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>此脚本的功能是可以在编辑器中自定义缩放等级，不设置的话默认是60,40,20共3个等级。当按下鼠标左键的时候缩放等级+1,到了最大缩放等级回到0</li>
<li>效果如下<br><img src="https://image.xiaomo.info/unity3d/camera/cameraFieldOfView.gif" alt></li>
</ol>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> function </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[unity3d小地图]]></title>
      <url>https://blog.xiaomo.info/2018/unity3dMiniMap/</url>
      <content type="html"><![CDATA[<p>小地图基本是每个RPG游戏都必备的功能，如果连这个都不会做就太不应该了。<br><a id="more"></a></p>
<ol>
<li>新建一个相机，<code>projection</code>设置为正交模式（2d）<code>orthographic</code>,size大概为30左右（视地图而定）,把它放在角色的容器中,让它可以和角色一起移动。Rotation绕x旋转90度，放到天上调整到合适位置和距离<br><img src="https://image.xiaomo.info/unity3d/miniMap/miniMapCamera.png" alt></li>
<li>新建一个renderTexture,把它给小地图相机</li>
<li>下载<a href="https://image.xiaomo.info/unity3d3d/ugui/minimap/Minimap.unity3dpackage" target="_blank" rel="noopener">miniMap包</a>导入，新建材质球。shade设置为custom，第一个指定为renderTexture,第二个指定为mask<br><img src="https://image.xiaomo.info/unity3d/miniMap/miniMapPackage.png" alt><br><img src="https://image.xiaomo.info/unity3d/miniMap/mat_miniMap.png" alt></li>
<li>新建一个RawImage,把renderTexture和材质球给它<br><img src="https://image.xiaomo.info/unity3d/miniMap/miniMapImage.png" alt></li>
<li>在角色容器中添加一个plane，把miniMap包中的icon给它。然后把layer设置为miniMap层。</li>
<li>把角色模型本体设置为Player层，把主相机的culling mask 取消miniMap,小地图摄像机的culling mask取消player层<br><img src="https://image.xiaomo.info/unity3d/miniMap/mainCamera.png" alt><br><img src="https://image.xiaomo.info/unity3d/miniMap/miniMapCameraCullingMask.png" alt></li>
<li>完成品如下，如果有外框可以给地图加个外框会漂亮一点<br><img src="https://image.xiaomo.info/unity3d/miniMap/CompleteMiniMap.png" alt></li>
</ol>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ugui </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用UGUI中的层级问题——以背包为例]]></title>
      <url>https://blog.xiaomo.info/2018/UGUISorting/</url>
      <content type="html"><![CDATA[<p>UGUI的canvas默认层级是UI，Sorting order 是0，由于unity渲染物体时是从上到下直接渲染的，这就导致了渲染出来的效果和我们预期的不一致，因此必须设置层级，指定渲染的先后顺序（层级低的先渲染）才行。<br><a id="more"></a></p>
<p>想要实现的效果是有一个背包，背包里有道具，鼠标移上去之后出现一个框显示物品的详细信息，移开就消失。但是默认UI层级会把挡住<br><img src="https://image.xiaomo.info/unity3d/ugui/bag/mask.png" alt></p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><ol>
<li>在被挡住的UI上添加组件<code>canvas</code>,增大它的<code>sorting order</code>，但是坑爹的是：设置完后，层级的问题解决了，但是UI的所有事件被拦截（包括按钮的点击、UI拖拽等等）</li>
<li>给UI再设置一个组件Graphic RayCaster，完美解决，既可以显示特效，还不会遮挡UI。<br><img src="https://image.xiaomo.info/unity3d/ugui/bag/correct.png" alt></li>
<li>至此有个问题，如果界面很多都需要设置上述的canvas，那就需要自己实现一个管理类，给每个ui设置它的order，不过canvas会影响合并批次，所以不能有太多，自己权衡。</li>
<li>给Item上挂一个脚本，实现<code>IPointerEnter</code>和<code>IPointerExit</code>接口，分别对应设置Active属性</li>
</ol>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">UI</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BagItem</span> : <span class="title">MonoBehaviour</span>, <span class="title">IPointerEnterHandler</span>, <span class="title">IPointerExitHandler</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> GameObject desc;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            desc = transform.Find(<span class="string">"Desc"</span>).gameObject;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerEnter</span>(<span class="params">PointerEventData eventData</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            desc.SetActive(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerExit</span>(<span class="params">PointerEventData eventData</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            desc.SetActive(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h1><p><img src="https://image.xiaomo.info/unity3d/ugui/bag/bag.gif" alt></p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ugui </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用UGUI制作滚动列表-选服列表]]></title>
      <url>https://blog.xiaomo.info/2018/UGUIServerList/</url>
      <content type="html"><![CDATA[<p>UGUI必将千秋万代，一统江湖！（麻烦给UGUI加一下动画系统，谢谢）<br><a id="more"></a></p>
<p>想要实现的效果..ummmm，大概是以下这个样子，这是最终做好的样子，记录一下<br><img src="https://image.xiaomo.info/unity3d/ugui/serverList/serverList.gif" alt></p>
<ol>
<li>假设我现在的目录结构是这样子的，canvas下有一个Bg,bg下有一个RegionFrom用来放服务器列表。<br><img src="https://image.xiaomo.info/unity3d/ugui/serverList/fileTree1.png" alt></li>
<li>在Region下新建一个Image控件ServerList用来做内容呈现的容器，给它添加<code>mask组件</code>和<code>scroll rect组件</code>,把<code>mask</code>的 <code>show mask graphic</code>的勾去掉。<br><img src="https://image.xiaomo.info/unity3d/ugui/serverList/fileTree3.png" alt></li>
<li>在ServerList下新建一个空物体Content做来做滑动的区域，这个区域的宽度和ServerList一样大，高度设置大一点,添加上GridLayoutGoup组件自动布局，设置好大小和间距。<br><img src="https://image.xiaomo.info/unity3d/ugui/serverList/fileTree2.png" alt></li>
<li>在Content下添加服务器项目，项目会被自动布局。运行后即可获得gif效果所示。</li>
</ol>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ugui </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[docker应用]]></title>
      <url>https://blog.xiaomo.info/2018/aboutDockerUse/</url>
      <content type="html"><![CDATA[<p>docker是一个简化部署的容器,使用docker不仅能够降低性能消耗，而且方便部署工作，在互联网企业中使用十分普遍。<br><a id="more"></a></p>
<h1 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h1><ol>
<li>解决了运行环境不一致的问题。</li>
<li>docker隔离了运行环境，对同一台服务器上运行的其他应用不会产生任何影响。</li>
<li>docker可伸缩的部署服务减少了资源的浪费和运维的人工成本。</li>
</ol>
<h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://www.docker.com/get-docker" target="_blank" rel="noopener">https://www.docker.com/get-docker</a></p>
<h1 id="网易镜像"><a href="#网易镜像" class="headerlink" title="网易镜像"></a>网易镜像</h1><p><a href="https://c.163yun.com/hub#/m/home/" target="_blank" rel="noopener">https://c.163yun.com/hub#/m/home/</a></p>
<h1 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h1><h2 id="center-os"><a href="#center-os" class="headerlink" title="center os"></a>center os</h2><p>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker 。通过 uname -r 命令查看你当前的内核版本<br><code>uname -r</code></p>
<h3 id="yum安装docker"><a href="#yum安装docker" class="headerlink" title="yum安装docker"></a>yum安装docker</h3><p><code>yum -y install docker-io</code><br>运行docker<br><code>systemctl start docker</code><br>测试<br><code>docker run hello-world</code></p>
<h3 id="脚本安装docker"><a href="#脚本安装docker" class="headerlink" title="脚本安装docker"></a>脚本安装docker</h3><p>更新系统组件<br><code>sudo yum update</code><br>执行 Docker 安装脚本<br><code>curl -fsSL https://get.docker.com/ | sh</code><br>启动docker<br><code>sudo service docker start</code><br>验证 docker 是否安装成功并在容器中执行一个测试的镜像。<br><code>sudo docker run hello-world</code><br><code>docker ps</code></p>
<h3 id="docker镜像加速"><a href="#docker镜像加速" class="headerlink" title="docker镜像加速"></a>docker镜像加速</h3><p>鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决，我使用的是网易的镜像地址：<a href="http://hub-mirror.c.163.com。新版的" target="_blank" rel="noopener">http://hub-mirror.c.163.com。新版的</a> Docker 使用 /etc/docker/daemon.json（Linux） 或者 %programdata%\docker\config\daemon.json（Windows） 来配置 Daemon。<br>请在该配置文件中加入（没有该文件的话，请先建一个）：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"registry-mirrors"</span>: [<span class="string">"http://hub-mirror.c.163.com"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mac-os"><a href="#mac-os" class="headerlink" title="mac os"></a>mac os</h2><p>一个命令搞定<br><code>brew cask install docker</code></p>
<h3 id="镜像加速"><a href="#镜像加速" class="headerlink" title="镜像加速"></a>镜像加速</h3><p>鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决，我使用的是网易的镜像地址：<a href="http://hub-mirror.c.163.com。" target="_blank" rel="noopener">http://hub-mirror.c.163.com。</a><br>在任务栏点击 Docker for mac 应用图标 -&gt; Preferences… -&gt; Daemon -&gt; Registry mirrors。在列表中填写加速器地址即可。修改完成之后，点击 Apply &amp; Restart 按钮，Docker 就会重启并应用配置的镜像地址了。</p>
<h1 id="docker常用命令"><a href="#docker常用命令" class="headerlink" title="docker常用命令"></a>docker常用命令</h1><ol>
<li>查看应用容器 <code>docker ps</code></li>
<li>启动一个容器 <code>docker run -d -p 5000:5000 training/webapp python app.py</code></li>
<li>查看应用日志 <code>docker logs -f 7a38a1ad55c6</code></li>
<li>查看应用程序容器的进程 <code>docker top 镜像名</code></li>
<li>检查应用程序 <code>docker inspect 镜像名</code></li>
<li>停止应用容器 <code>docker stop 镜像名</code></li>
<li>移除应用容器 <code>docker rm 镜像名</code></li>
<li>查看镜像列表 <code>docker image</code></li>
<li>获取一个新镜像 <code>docker pull image:tag</code></li>
<li>查找镜像 <code>docker search httpd</code></li>
<li>构建镜像 <code>docker build -t image:tag .</code></li>
<li>设置镜像tag <code>docker tag 860c279d2fec image:tag</code></li>
</ol>
<h1 id="docker学习资源"><a href="#docker学习资源" class="headerlink" title="docker学习资源"></a>docker学习资源</h1><p><a href="http://www.runoob.com/docker/docker-command-manual.html" target="_blank" rel="noopener">http://www.runoob.com/docker/docker-command-manual.html</a></p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 容器 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-Java中ArrayList、LinkedList和Vector的联系与区别]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadArrayListAndLinkedArrayList/</url>
      <content type="html"><![CDATA[<p>毫无疑问，List是一种非常基础的数据结构，翻译过来就是列表。正如它的名字所示，List表示的是一个有序(插入顺序)的元素序列。在Java的集合框架中，List是作为顶级接口Collection的直接子类接口存在，因此，List分支是集合框架中最简单、最常用的分支。<br><a id="more"></a></p>
<h1 id="List概述"><a href="#List概述" class="headerlink" title="List概述"></a>List概述</h1><p>List分支作为集合框架中最简单、最常用的分支，其在集合框架中的位置可以直接参看下图：<br><img src="https://image.xiaomo.info/blog/linkedArraylist.jpg" alt></p>
<p>仔细观察和分析此图，你会发现JDK中对于List接口的实现由三种类型：ArrayList、Vector 和 LinkedList。当我们谈论List的时候，我们可以用它与Set来做比较，集合框架中的Set代表一群无序和唯一的元素集合。<br>仔细观察上图可知，集合框架中的List接口具有多达三个实现类。由继承机制可知，它们在很多方面都是非常相似的，比如有序、用法等。它们之间最大的区别是它们的内部实现方式和细节，不同的实现方式和细节造就了它们之间巨大的性能差异和用法差异。</p>
<ol>
<li>ArrayList 是Java语言对于动态数组的一个实现。当不断地添加新的元素到ArrayList集合中时，该集合的底层数组的长度就会动态的增长，以便能容纳新添加的元素。至于ArrayList的底层数组长度的动态增长策略，在不同的JDK实现和版本中是不同的，最常见的策略是新增 %50，具体请参看源码。正因为ArrayList的底层实现是数组，其带来的一个特性是：它的元素可以通过 getter(index) 和 setter(index) 方法直接访问，而且性能特别好。</li>
<li>LinkedList 的底层实现是基于 双向队列(double linked list)。熟悉数据结构的读者应该可以猜到：LinkedList 对于新增和删除元素的操作在性能上远远优于 ArrayList。但是，它的缺点在于：其 getter(index) 方法和 setter(index) 方法的性能很差，时间复杂度是 O(n)。</li>
<li>Vector 与 ArrayList 唯一的区别是：它是同步的(synchronized)，线程安全。</li>
</ol>
<h1 id="性能对比"><a href="#性能对比" class="headerlink" title="性能对比"></a>性能对比</h1><ol>
<li>对于ArrayList，add/remove的时间复杂度是 O(n)；但在尾部操作是 O(1) 。</li>
<li>对于LinkedList，add/remove的时间复杂度是 O(n)；但在尾部和头部操作的是 O(1) 。</li>
</ol>
<h1 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h1><p>为了实际测验三种List的add、get和remove的性能，我们可以使用如下的代码片段：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">ArrayList arrayList = <span class="keyword">new</span> ArrayList();</span><br><span class="line"><span class="keyword">long</span> startTime = System.nanoTime();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">arrayList.<span class="keyword">add</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> endTime = System.nanoTime();</span><br><span class="line"><span class="keyword">long</span> duration = endTime - startTime;</span><br><span class="line">System.<span class="keyword">out</span>.println(<span class="string">"duration : "</span> + duration);</span><br></pre></td></tr></table></figure>
<p>此处只给出测验ArrayList的add操作的代码，但是测验LinkedList和其他操作的代码是类似，读者可自行修改代码进行测验。测验的结果表明：<br>在add和remove操作时，LinkedList的性能远优于ArrayList。在get操作时，ArrayList的性能优于LinkedList。经过性能对比和性能的测试，我们可以总结出如何在它们之间做出选择。通常使用ArrayList，但是LinkedList在如下场景时更合适：</p>
<ol>
<li>随机访问集合元素的次数不是很频繁。</li>
<li>对集合有大量的add/remove操作需求。</li>
</ol>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>对比Vector和ArrayList，如果程序本身就是线程安全的，为了更好的性能，应该选择ArrayList。当添加新的元素到集合时，Vector和ArrayList都需要更多的空间来存储新元素，但是它们的增长策略是不一样的：Vector的增长幅度是 100%；ArrayList的增长幅度是 50%。对于LinkdedList而言，其不仅实现了List接口，还实现了Queue接口，这个Queue接口给LinkdedList带来了更多的访问和操作元素的方法，比如 offer(), peek(), poll() 等。<br>对于ArrayList而言，如果使用不含参数的构造函数新建一个ArrayList对象，该对象的起始大小是比较小的，只有10。我们都知道对象的动态增长导致的底层数组重写分配和复制是一个非常耗时的操作。所以，对于可以预估ArrayList大小的应用场景，应该指定ArrayList对象的初始大小，从而提供性能。</p>
<h1 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h1><p><a href="http://www.tiantianbianma.com/java-arraylist-linkedlist-vector.html/" target="_blank" rel="noopener">Java中ArrayList、LinkedList和Vector的联系与区别</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-String,StringBuffer,StringBuilder]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadStringDifferent/</url>
      <content type="html"><![CDATA[<p>String,StringBuilder以及StringBuffer这三个类之间有什么区别?<br><a id="more"></a></p>
<p>这三个类之间的区别主要是在两个方面，即运行速度和线程安全这两方面。</p>
<p>首先说运行速度，或者说是执行速度，在这方面运行速度快慢为：StringBuilder &gt; StringBuffer &gt; String<br>String最慢的原因：<br>String为字符串常量，而StringBuilder和StringBuffer均为字符串变量，即String对象一旦创建之后该对象是不可更改的，但后两者的对象是变量，是可以更改的。以下面一段代码为例：</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">String</span> <span class="built_in">str</span>=<span class="string">"abc"</span>;</span><br><span class="line">System.out.<span class="built_in">println</span>(<span class="built_in">str</span>);</span><br><span class="line"><span class="built_in">str</span>=<span class="built_in">str</span>+<span class="string">"de"</span>;</span><br><span class="line">System.out.<span class="built_in">println</span>(<span class="built_in">str</span>);</span><br></pre></td></tr></table></figure>
<p>　如果运行这段代码会发现先输出“abc”，然后又输出“abcde”，好像是str这个对象被更改了，其实，这只是一种假象罢了，JVM对于这几行代码是这样处理的，首先创建一个String对象str，并把“abc”赋值给str，然后在第三行中，其实JVM又创建了一个新的对象也名为str，然后再把原来的str的值和“de”加起来再赋值给新的str，而原来的str就会被JVM的垃圾回收机制（GC）给回收掉了，所以，str实际上并没有被更改，也就是前面说的String对象一旦创建之后就不可更改了。所以，Java中对String对象进行的操作实际上是一个不断创建新的对象并且将旧的对象回收的一个过程，所以执行速度很慢。而StringBuilder和StringBuffer的对象是变量，对变量进行操作就是直接对该对象进行更改，而不进行创建和回收的操作，所以速度要比String快很多。另外，有时候我们会这样对字符串进行赋值</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">String</span> <span class="built_in">str</span>=<span class="string">"abc"</span>+<span class="string">"de"</span>;</span><br><span class="line">StringBuilder stringBuilder=<span class="keyword">new</span> StringBuilder().<span class="built_in">append</span>(<span class="string">"abc"</span>).<span class="built_in">append</span>(<span class="string">"de"</span>);</span><br><span class="line">System.out.<span class="built_in">println</span>(<span class="built_in">str</span>);</span><br><span class="line">System.out.<span class="built_in">println</span>(stringBuilder.toString());</span><br></pre></td></tr></table></figure>
<p>这样输出结果也是“abcde”和“abcde”，但是String的速度却比StringBuilder的反应速度要快很多，这是因为第1行中的操作和<code>String str=&quot;abcde&quot;;</code>是完全一样的，所以会很快，而如果写成下面这种形式</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">String <span class="attribute">str1</span>=<span class="string">"abc"</span>;</span><br><span class="line">String <span class="attribute">str2</span>=<span class="string">"de"</span>;</span><br><span class="line">String <span class="attribute">str</span>=str1+str2;</span><br></pre></td></tr></table></figure>
<p>那么JVM就会像上面说的那样，不断的创建、回收对象来进行这个操作了。速度就会很慢。</p>
<ol start="2">
<li><p>再来说线程安全<br>在线程安全上，StringBuilder是线程不安全的，而StringBuffer是线程安全的<br>如果一个StringBuffer对象在字符串缓冲区被多个线程使用时，StringBuffer中很多方法可以带有synchronized关键字，所以可以保证线程是安全的，但StringBuilder的方法则没有该关键字，所以不能保证线程安全，有可能会出现一些错误的操作。所以如果要进行的操作是多线程的，那么就要使用StringBuffer，但是在单线程的情况下，还是建议使用速度比较快的StringBuilder。</p>
</li>
<li><p>总结一下<br>String：适用于少量的字符串操作的情况<br>StringBuilder：适用于单线程下在字符缓冲区进行大量操作的情况<br>StringBuffer：适用多线程下在字符缓冲区进行大量操作的情况</p>
</li>
</ol>
<h1 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h1><p><a href="https://www.cnblogs.com/su-feng/p/6659064.html" target="_blank" rel="noopener">Java中的String，StringBuilder，StringBuffer三者的区别</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-类的初始化顺序]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadClassInitOrder/</url>
      <content type="html"><![CDATA[<p>大家在去参加面试的时候，经常会遇到这样的考题：给你两个类的代码，它们之间是继承的关系，每个类里只有构造器方法和一些变量，构造器里可能还有一段代码对变量值进行了某种运算，另外还有一些将变量值输出到控制台的代码，然后让我们判断输出的结果。这实际上是在考查我们对于继承情况下类的初始化顺序的了解<br><a id="more"></a><br>我们大家都知道，对于静态变量、静态初始化块、变量、初始化块、构造器，它们的初始化顺序依次是（静态变量、静态初始化块）&gt;（变量、初始化块）&gt;构造器。我们也可以通过下面的测试代码来验证这一点：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InitialOrderTest</span> </span>&#123;</span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String staticField = <span class="string">"静态变量"</span>;</span><br><span class="line"><span class="comment">// 变量</span></span><br><span class="line"><span class="keyword">public</span> String field = <span class="string">"变量"</span>;</span><br><span class="line"><span class="comment">// 静态初始化块</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.out.println(staticField);</span><br><span class="line">    System.out.println(<span class="string">"静态初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 初始化块</span></span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(field);</span><br><span class="line">    System.out.println(<span class="string">"初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 构造器</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InitialOrderTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"构造器"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> InitialOrderTest();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行以上代码，我们会得到如下的输出结果：</p>
<ol>
<li>静态变量</li>
<li>静态初始化块</li>
<li>变量</li>
<li>初始化块</li>
<li>构造器</li>
</ol>
<p>这与上文中说的完全符合。那么对于继承情况下又会怎样呢？我们仍然以一段测试代码来获取最终结果:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String p_StaticField = <span class="string">"父类--静态变量"</span>;</span><br><span class="line"><span class="comment">// 变量</span></span><br><span class="line"><span class="keyword">public</span> String p_Field = <span class="string">"父类--变量"</span>;</span><br><span class="line"><span class="comment">// 静态初始化块</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.out.println(p_StaticField);</span><br><span class="line">    System.out.println(<span class="string">"父类--静态初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 初始化块</span></span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(p_Field);</span><br><span class="line">    System.out.println(<span class="string">"父类--初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 构造器</span></span><br><span class="line">    &#123;</span><br><span class="line">    System.out.println(<span class="string">"父类--构造器"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubClass</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String s_StaticField = <span class="string">"子类--静态变量"</span>;</span><br><span class="line"><span class="comment">// 变量</span></span><br><span class="line"><span class="keyword">public</span> String s_Field = <span class="string">"子类--变量"</span>;</span><br><span class="line"><span class="comment">// 静态初始化块</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.out.println(s_StaticField);</span><br><span class="line">    System.out.println(<span class="string">"子类--静态初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 初始化块</span></span><br><span class="line">&#123;</span><br><span class="line">System.out.println(s_Field);</span><br><span class="line">    System.out.println(<span class="string">"子类--初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 构造器</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SubClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"子类--构造器"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 程序入口</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> SubClass();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行一下上面的代码，结果马上呈现在我们的眼前：</p>
<ol>
<li>父类–静态变量</li>
<li>父类–静态初始化块</li>
<li>子类–静态变量</li>
<li>子类–静态初始化块</li>
<li>父类–变量</li>
<li>父类–初始化块</li>
<li>父类–构造器</li>
<li>子类–变量</li>
<li>子类–初始化块</li>
<li>子类–构造器</li>
</ol>
<p>现在，结果已经不言自明了。大家可能会注意到一点，那就是，并不是父类完全初始化完毕后才进行子类的初始化，实际上子类的静态变量和静态初始化块的初始化是在父类的变量、初始化块和构造器初始化之前就完成了。<br>那么对于静态变量和静态初始化块之间、变量和初始化块之间的先后顺序又是怎样呢？是否静态变量总是先于静态初始化块，变量总是先于初始化块就被初始化了呢？实际上这取决于它们在类中出现的先后顺序。我们以静态变量和静态初始化块为例来进行说明。</p>
<p>同样，我们还是写一个类来进行测试：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestOrder</span> </span>&#123;</span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TestA a = <span class="keyword">new</span> TestA();</span><br><span class="line"><span class="comment">// 静态初始化块</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">"静态初始化块"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TestB b = <span class="keyword">new</span> TestB();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> TestOrder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Test--A"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestB</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Test--B"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行上面的代码，会得到如下的结果：</p>
<ol>
<li>Test–A</li>
<li>静态初始化块</li>
<li>Test–B</li>
</ol>
<p>大家可以随意改变变量a、变量b以及静态初始化块的前后位置，就会发现输出结果随着它们在类中出现的前后顺序而改变，这就说明静态变量和静态初始化块是依照他们在类中的定义顺序进行初始化的。同样，变量和初始化块也遵循这个规律。了解了继承情况下类的初始化顺序之后，如何判断最终输出结果就迎刃而解了</p>
<h1 id="注"><a href="#注" class="headerlink" title="注"></a>注</h1><p>转载自 臧圩人 <a href="http://zangweiren.javaeye.com" target="_blank" rel="noopener">http://zangweiren.javaeye.com</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-创建对象]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadCreateObject/</url>
      <content type="html"><![CDATA[<p><code>String str=new String(&quot;abc&quot;);</code>到底创建了几个对象？相信大家对这此并不陌生，答案也是众所周知的，2个。接下来我们就从这道题展开，一起回顾一下与创建String对象相关的一些JAVA知识。<br><a id="more"></a></p>
<h1 id="String-str-new-String-quot-abc-quot"><a href="#String-str-new-String-quot-abc-quot" class="headerlink" title="String str=new String(&quot;abc&quot;);"></a><code>String str=new String(&quot;abc&quot;);</code></h1><p>我们可以把上面这行代码分成String str、=、”abc”和new String()四部分来看待。String str只是定义了一个名为str的String类型的变量，因此它并没有创建对象；=是对变量str进行初始化，将某个对象的引用（或者叫句柄）赋值给它，显然也没有创建对象；现在只剩下new String(“abc”)了。那么，new String(“abc”)为什么又能被看成”abc”和new String()呢？我们来看一下被我们调用了的String的构造器：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">String</span><span class="params">(String original)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//other code ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>大家都知道，我们常用的创建一个类的实例（对象）的方法有以下两种：</p>
<ol>
<li>使用new创建对象。</li>
<li>调用Class类的newInstance方法，利用反射机制创建对象。<br>我们正是使用new调用了String类的上面那个构造器方法创建了一个对象，并将它的引用赋值给了str变量。同时我们注意到，被调用的构造器方法接受的参数也是一个String对象，这个对象正是”abc”。由此我们又要引入另外一种创建String对象的方式的讨论——引号内包含文本。这种方式是String特有的，并且它与new的方式存在很大区别</li>
</ol>
<h1 id="String-str-quot-abc-quot"><a href="#String-str-quot-abc-quot" class="headerlink" title="String str=&quot;abc&quot;;"></a><code>String str=&quot;abc&quot;;</code></h1><p>毫无疑问，这行代码创建了一个String对象。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    String a=<span class="string">"abc"</span>;</span><br><span class="line">    String b=<span class="string">"abc"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那这里呢？答案还是一个。</p>
<p><code>String a=&quot;ab&quot;+&quot;cd&quot;;</code><br>再看看这里呢？答案仍是一个。有点奇怪吗？说到这里，我们就需要引入对字符串池相关知识的回顾了。</p>
<p>在JAVA虚拟机（JVM）中存在着一个字符串池，其中保存着很多String对象，并且可以被共享使用，因此它提高了效率。由于String类是final的，它的值一经创建就不可改变，因此我们不用担心String对象共享而带来程序的混乱。字符串池由String类维护，我们可以调用intern()方法来访问字符串池。我们再回头看看String a=”abc”;，这行代码被执行的时候，JAVA虚拟机首先在字符串池中查找是否已经存在了值为”abc”的这么一个对象，它的判断依据是String类equals(Object obj)方法的返回值。如果有，则不再创建新的对象，直接返回已存在对象的引用；如果没有，则先创建这个对象，然后把它加入到字符串池中，再将它的引用返回。因此，我们不难理解前面三个例子中头两个例子为什么是这个答案了。<br>对于第三个例子：<br>String a=”ab”+”cd”;<br>由于常量的值在编译的时候就被确定了。在这里，”ab”和”cd”都是常量，因此变量a的值在编译时就可以确定。</p>
<p>这行代码编译后的效果等同于：<br>String a=”abcd”;<br>因此这里只创建了一个对象”abcd”，并且它被保存在字符串池里了。现在问题又来了，是不是所有经过“+”连接后得到的字符串都会被添加到字符串池中呢？我们都知道“==”</p>
<p>可以用来比较两个变量，它有以下两种情况：</p>
<ol>
<li>如果比较的是两个基本类型（char，byte，short，int，long，float，double，boolean），则是判断它们的值是否相等。</li>
<li>如果表较的是两个对象变量，则是判断它们的引用是否指向同一个对象。</li>
</ol>
<p>下面我们就用“==”来做几个测试。为了便于说明，我们把指向字符串池中已经存在的对象也视为该对象被加入了字符串池：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">String a = <span class="string">"ab"</span>;<span class="comment">// 创建了一个对象，并加入字符串池中</span></span><br><span class="line">System.out.println(<span class="string">"String a = \"ab\";"</span>);</span><br><span class="line">String b = <span class="string">"cd"</span>;<span class="comment">// 创建了一个对象，并加入字符串池中</span></span><br><span class="line">System.out.println(<span class="string">"String b = \"cd\";"</span>);</span><br><span class="line">String c = <span class="string">"abcd"</span>;<span class="comment">// 创建了一个对象，并加入字符串池中</span></span><br><span class="line">String d = <span class="string">"ab"</span> + <span class="string">"cd"</span>;</span><br><span class="line"><span class="comment">// 如果d和c指向了同一个对象，则说明d也被加入了字符串池</span></span><br><span class="line"><span class="keyword">if</span> (d == c) &#123;</span><br><span class="line">    System.out.println(<span class="string">"\"ab\"+\"cd\" 创建的对象 \"加入了\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果d和c没有指向了同一个对象，则说明d没有被加入字符串池</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">"\"ab\"+\"cd\" 创建的对象 \"没加入\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line">String e = a + <span class="string">"cd"</span>;</span><br><span class="line"><span class="comment">// 如果e和c指向了同一个对象，则说明e也被加入了字符串池</span></span><br><span class="line"><span class="keyword">if</span> (e == c) &#123;</span><br><span class="line">    System.out.println(<span class="string">" a +\"cd\" 创建的对象 \"加入了\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果e和c没有指向了同一个对象，则说明e没有被加入字符串池</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">" a +\"cd\" 创建的对象 \"没加入\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line">String f = <span class="string">"ab"</span> + b;</span><br><span class="line"><span class="comment">// 如果f和c指向了同一个对象，则说明f也被加入了字符串池</span></span><br><span class="line"><span class="keyword">if</span> (f == c) &#123;</span><br><span class="line">    System.out.println(<span class="string">"\"ab\"+ b 创建的对象 \"加入了\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果f和c没有指向了同一个对象，则说明f没有被加入字符串池</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">"\"ab\"+ b 创建的对象 \"没加入\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line">String g = a + b;</span><br><span class="line"><span class="comment">// 如果g和c指向了同一个对象，则说明g也被加入了字符串池</span></span><br><span class="line"><span class="keyword">if</span> (g == c) &#123;</span><br><span class="line">    System.out.println(<span class="string">" a + b 创建的对象 \"加入了\" 字符串池中"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果g和c没有指向了同一个对象，则说明g没有被加入字符串池</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">" a + b 创建的对象 \"没加入\" 字符串池中"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<ol>
<li>String a = “ab”;</li>
<li>String b = “cd”;</li>
<li>“ab”+”cd” 创建的对象 “加入了” 字符串池中</li>
<li>a +”cd” 创建的对象 “没加入” 字符串池中</li>
<li>“ab”+ b 创建的对象 “没加入” 字符串池中</li>
<li>a + b 创建的对象 “没加入” 字符串池中</li>
</ol>
<p>从上面的结果中我们不难看出，只有使用引号包含文本的方式创建的String对象之间使用“+”连接产生的新对象才会被加入字符串池中。对于所有包含new方式新建对象（包括null）的“+”连接表达式，它所产生的新对象都不会被加入字符串池中，对此我们不再赘述</p>
<p>但是有一种情况需要引起我们的注意。请看下面的代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringStaticTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 常量A</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String A = <span class="string">"ab"</span>;</span><br><span class="line">    <span class="comment">// 常量B</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String B = <span class="string">"cd"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 将两个常量用+连接对s进行初始化</span></span><br><span class="line">    String s = A + B;</span><br><span class="line">    String t = <span class="string">"abcd"</span>;</span><br><span class="line">    <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">        System.out.println(<span class="string">"s等于t，它们是同一个对象"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"s不等于t，它们不是同一个对象"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码的运行结果如下：</p>
<ul>
<li>s等于t，它们是同一个对象</li>
</ul>
<p>这又是为什么呢？原因是这样的，对于常量来讲，它的值是固定的，因此在编译期就能被确定了，而变量的值只有到运行时才能被确定，因为这个变量可以被不同的方法调用，从而可能引起值的改变。在上面的例子中，A和B都是常量，值是固定的，因此s的值也是固定的，它在类被编译时就已经确定了。也就是说：</p>
<p><code>String s=A+B;</code> 等同于<code>String s=&quot;ab&quot;+&quot;cd&quot;;</code></p>
<p>我对上面的例子稍加改变看看会出现什么情况：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringStaticTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 常量A</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String A;</span><br><span class="line">    <span class="comment">// 常量B</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String B;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">    A = <span class="string">"ab"</span>;</span><br><span class="line">    B = <span class="string">"cd"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 将两个常量用+连接对s进行初始化</span></span><br><span class="line">    String s = A + B;</span><br><span class="line">    String t = <span class="string">"abcd"</span>;</span><br><span class="line">    <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">        System.out.println(<span class="string">"s等于t，它们是同一个对象"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"s不等于t，它们不是同一个对象"</span>);</span><br><span class="line">     &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它的运行结果是这样：</p>
<ul>
<li>s不等于t，它们不是同一个对象<br>只是做了一点改动，结果就和刚刚的例子恰好相反。我们再来分析一下。A和B虽然被定义为常量（只能被赋值一次），但是它们都没有马上被赋值。在运算出s的值之前，他们何时被赋值，以及被赋予什么样的值，都是个变数。因此A和B在被赋值之前，性质类似于一个变量。那么s就不能在编译期被确定，而只能在运行时被创建了。由于字符串池中对象的共享能够带来效率的提高，因此我们提倡大家用引号包含文本的方式来创建String对象，实际上这也是我们在编程中常采用的。<br>接下来我们再来看看intern()方法，它的定义如下：<br><code>public native String intern();</code></li>
</ul>
<p>这是一个本地方法。在调用这个方法时，JAVA虚拟机首先检查字符串池中是否已经存在与该对象值相等对象存在，如果有则返回字符串池中对象的引用；如果没有，则先在字符串池中创建一个相同值的String对象，然后再将它的引用返回。</p>
<p>我们来看这段代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringInternTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 使用char数组来初始化a，避免在a被创建之前字符串池中已经存在了值为"abcd"的对象</span></span><br><span class="line">    String a = <span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span> &#125;);</span><br><span class="line">    String b = a.intern();</span><br><span class="line">    <span class="keyword">if</span> (b == a) &#123;</span><br><span class="line">        System.out.println(<span class="string">"b被加入了字符串池中，没有新建对象"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"b没被加入字符串池中，新建了对象"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：<br>b没被加入字符串池中，新建了对象。如果String类的intern()方法在没有找到相同值的对象时，是把当前对象加入字符串池中，然后返回它的引用的话，那么b和a指向的就是同一个对象；否则b指向的对象就是JAVA虚拟机在字符串池中新建的，只是它的值与a相同罢了。上面这段代码的运行结果恰恰印证了这一点。最后我们再来说说String对象在JAVA虚拟机（JVM）中的存储，以及字符串池与堆（heap）和栈（stack）的关系。我们首先回顾一下堆和栈的区别：</p>
<p>• 栈（stack）：主要保存基本类型（或者叫内置类型）（char、byte、short、int、long、float、double、boolean）和对象的引用，数据可以共享，速度仅次于寄存器（register），快于堆。<br>• 堆（heap）：用于存储对象。</p>
<p>我们查看String类的源码就会发现，它有一个value属性，保存着String对象的值，类型是char[]，这也正说明了字符串就是字符的序列。当执行String a=”abc”;时，JAVA虚拟机会在栈中创建三个char型的值’a’、’b’和’c’，然后在堆中创建一个String对象，它的值（value）是刚才在栈中创建的三个char型值组成的数组{‘a’,’b’,’c’}，最后这个新创建的String对象会被添加到字符串池中。如果我们接着执行String b=new String(“abc”);代码，由于”abc”已经被创建并保存于字符串池中，因此JAVA虚拟机只会在堆中新创建一个String对象，但是它的值（value）是共享前一行代码执行时在栈中创建的三个char型值值’a’、’b’和’c’。说到这里，我们对于篇首提出的String str=new String(“abc”)为什么是创建了两个对象这个问题就已经相当明了了</p>
<h1 id="注"><a href="#注" class="headerlink" title="注"></a>注</h1><p>转载自 臧圩人 <a href="http://zangweiren.javaeye.com" target="_blank" rel="noopener">http://zangweiren.javaeye.com</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-线程池]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadThreadPool/</url>
      <content type="html"><![CDATA[<p>Executors 是 Executor、ExecutorService、ThreadFactory、Callable 类的工厂和工具方法。<br><a id="more"></a></p>
<h1 id="创建一个固定大小的线程池"><a href="#创建一个固定大小的线程池" class="headerlink" title="创建一个固定大小的线程池"></a>创建一个固定大小的线程池</h1><p>通过重用共享无界队列里的线程来减少线程创建的开销。当所有的线程都在执行任务，新增的任务将会在队列中等待，直到一个线程空闲。由于在执行前失败导致的线程中断，如果需要继续执行接下去的任务，新的线程会取代它执行。线程池中的线程会一直存在，除非明确地 shutdown 掉。</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="keyword">new</span><span class="type">FixedThreadPool</span>(int nThreads) &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">ThreadPoolExecutor</span>(nThreads, nThreads, <span class="number">0</span>L, TimeUnit.MILLISECONDS, <span class="keyword">new</span> <span class="type">LinkedBlockingQueue</span>&lt;Runnable&gt;());  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>返回的是 ThreadPoolExecutor 类的对象，这个构造方法使用传入的参数和默认的线程工厂与拒绝执行的处理。<br>corePoolSize：线程池中的线程数量，除非设置了 allowCoreThreadTimeOut， 否则就算线程空闲还是在保存在线程池中<br>maximumPoolSize：线程池中允许存放最大的线程数量<br>keepAliveTime：当线程数大于 corePoolSize，如果 keepAliveTime 内空闲的线程未执行，线程将被终结<br>unit：keepAliveTime 的时间单位<br>workQueue：保存 execute() 提交的任务 </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> maximumPoolSize,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">long</span> keepAliveTime,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          TimeUnit unit,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">this</span>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,  </span><br><span class="line">         Executors.defaultThreadFactory(), defaultHandler);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到固定大小线程池，corePoolSize 和 maximumPoolSize 传入的参数是一样的</p>
<h1 id="创建一个单个线程的线程池"><a href="#创建一个单个线程的线程池" class="headerlink" title="创建一个单个线程的线程池"></a>创建一个单个线程的线程池</h1><p>任务会被保证顺序执行，因为只有一个工作线程。不像 newFixedThreadPool(1)，这个不保证任务顺序执行。corePoolSize 和 maximumPoolSize 都是 1。</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="keyword">new</span><span class="type">SingleThreadExecutor</span>() &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">FinalizableDelegatedExecutorService</span>  </span><br><span class="line">        (<span class="keyword">new</span> <span class="type">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">1</span>,<span class="number">0</span>L, TimeUnit.MILLISECONDS,<span class="keyword">new</span> <span class="type">LinkedBlockingQueue</span>&lt;Runnable&gt;()));  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="创建一个可按需自动扩容的线程池-但是会优先重用线程池中空闲可用的线程"><a href="#创建一个可按需自动扩容的线程池-但是会优先重用线程池中空闲可用的线程" class="headerlink" title="创建一个可按需自动扩容的线程池,但是会优先重用线程池中空闲可用的线程"></a>创建一个可按需自动扩容的线程池,但是会优先重用线程池中空闲可用的线程</h1><p>这个类型的线程池将会大大提升执行许多短暂的异步任务的程序。如果线程池中线程都在使用，又有新任务到来，则新增一个线程到线程池。如果线程 60 秒内空闲，则将被终止移除线程池。corePoolSize 为 0，可知一旦线程 60s 空闲就会被移出线程池</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="keyword">new</span><span class="type">CachedThreadPool</span>() &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">ThreadPoolExecutor</span>(<span class="number">0</span>, Integer.MAX_VALUE,<span class="number">60</span>L, TimeUnit.SECONDS, <span class="keyword">new</span> <span class="type">SynchronousQueue</span>&lt;Runnable&gt;());  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="创建一个在一定延迟时间后调度命令的线程池，或者周期性执行的线程池。"><a href="#创建一个在一定延迟时间后调度命令的线程池，或者周期性执行的线程池。" class="headerlink" title="创建一个在一定延迟时间后调度命令的线程池，或者周期性执行的线程池。"></a>创建一个在一定延迟时间后调度命令的线程池，或者周期性执行的线程池。</h1><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ScheduledExecutorService <span class="keyword">new</span><span class="type">ScheduledThreadPool</span>(int corePoolSize) &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">ScheduledThreadPoolExecutor</span>(corePoolSize);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="创建完线程池，然后就该执行任务了"><a href="#创建完线程池，然后就该执行任务了" class="headerlink" title="创建完线程池，然后就该执行任务了"></a>创建完线程池，然后就该执行任务了</h1><p>看下内部类 DelegatedExecutorService 里的 execute 方法：可以看到任务执行策略（单线程串行、多线程并行）和任务的具体执行分离，是一个典型的命令模式。</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegatedExecutorService</span> <span class="keyword">extends</span> <span class="title">AbstractExecutorService</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ExecutorService e;  </span><br><span class="line">    DelegatedExecutorService(ExecutorService executor) &#123; e = executor; &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span> </span>&#123; e.execute(command); &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> </span>&#123; e.shutdown(); &#125;  </span><br><span class="line">    <span class="keyword">public</span> List&lt;Runnable&gt; shutdownNow() &#123; <span class="function"><span class="keyword">return</span> e.<span class="title">shutdownNow</span><span class="params">()</span></span>; &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isShutdown</span><span class="params">()</span> </span>&#123; <span class="function"><span class="keyword">return</span> e.<span class="title">isShutdown</span><span class="params">()</span></span>; &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isTerminated</span><span class="params">()</span> </span>&#123; <span class="function"><span class="keyword">return</span> e.<span class="title">isTerminated</span><span class="params">()</span></span>; &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> awaitTermination(<span class="keyword">long</span> timeout, TimeUnit unit)  </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">awaitTermination</span><span class="params">(timeout, unit)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> Future&lt;?&gt; submit(Runnable task) &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">submit</span><span class="params">(task)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task) &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">submit</span><span class="params">(task)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result) &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">submit</span><span class="params">(task, result)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? <span class="keyword">extends</span> Callable&lt;T&gt;&gt; tasks)  </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">invokeAll</span><span class="params">(tasks)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? <span class="keyword">extends</span> Callable&lt;T&gt;&gt; tasks,  </span><br><span class="line">                                         <span class="keyword">long</span> timeout, TimeUnit unit)  </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">invokeAll</span><span class="params">(tasks, timeout, unit)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T invokeAny(Collection&lt;? <span class="keyword">extends</span> Callable&lt;T&gt;&gt; tasks)  </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">invokeAny</span><span class="params">(tasks)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T invokeAny(Collection&lt;? <span class="keyword">extends</span> Callable&lt;T&gt;&gt; tasks,  </span><br><span class="line">                           <span class="keyword">long</span> timeout, TimeUnit unit)  </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException &#123;  </span><br><span class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">invokeAny</span><span class="params">(tasks, timeout, unit)</span></span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建线程池的时候，已经实例化了 ThreadPoolExecutor，所以上面 execute() 方法实际是调用 ThreadPoolExecutor 的 execute：给定的任务可能在未来的某个时刻执行。可能是新建一个线程执行，也可能是线程中原有的线程执行。如果任务不能执行，可能是这个 executor 已经被 shutdown 了，也可能是到达了线程池的执行阈值，任务被拒绝执行处理器处理中。</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span>(<span class="params">Runnable command</span>)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> (command == <span class="literal">null</span>)  </span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();  </span><br><span class="line">    <span class="keyword">int</span> c = ctl.<span class="keyword">get</span>();  </span><br><span class="line">    <span class="keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;  </span><br><span class="line">        <span class="keyword">if</span> (addWorker(command, <span class="literal">true</span>))  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        c = ctl.<span class="keyword">get</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;  </span><br><span class="line">        <span class="keyword">int</span> recheck = ctl.<span class="keyword">get</span>();  </span><br><span class="line">        <span class="keyword">if</span> (! isRunning(recheck) &amp;&amp; <span class="keyword">remove</span>(command))  </span><br><span class="line">            reject(command);  </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (workerCountOf(recheck) == <span class="number">0</span>)  </span><br><span class="line">            addWorker(<span class="literal">null</span>, <span class="literal">false</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!addWorker(command, <span class="literal">false</span>))  </span><br><span class="line">        reject(command);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看到这，其实发现线程池的核心实现就是在 ThreadPoolExecutor 里面，所以先介绍下 ThreadPoolExecutor 类的作用： </p>
<p><img src="https://image.xiaomo.info/blog/executor.png" alt></p>
<p>上图可以看出 ThreadPoolExecutor 类的层次结构中的位置，是对抽象方法和接口的完整实现，即核心代码在这个类里。</p>
<p>一个 ExecutorService 执行每个任务可能用到线程池中的一个或多个线程，线程池由 Executors 工厂创建。<br>线程池解决了两个不同的问题：</p>
<ol>
<li>执行大量异步的任务时，线程池减少线程的创建来减少开销，提升性能</li>
<li>提供了对资源的管理，包括当执行一系列任务时，线程的消耗。每个 ThreadPoolExecutor 也存储有些基本数据，诸如完成的任务数量</li>
</ol>
<p>想要在更广阔的背景下使用的话，这个类提供了许多可调整的参数和扩展的 hook。不管怎么样，还是推荐使用 Executors 来创建线程池比较方便。</p>
<p>这个主要的线程池控制状态 ctl，使用 AtomicInteger 存储两个概念上的字段 workerCount(线程池有效的线程数) 和 runState(线程池是 running、shuting down 等等状态) </p>
<p><code>private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));</code></p>
<p>上述 execute() 方法有三个处理步骤：</p>
<ol>
<li>如果正在 running 的线程 (即 worker 线程) 小于 corePoolSize ( workerCountOf(c) &lt; corePoolSize )，尝试创建一个新线程并把传入的 command(任务) 作为它的第一个任务。调用 addWorker(command, true) 自动检查 runState 和 workCount，以便在不能增加线程的时候返回 false。添加成功直接 return，不能添加就要看下面的步骤</li>
<li>如果被成功放进队列（if (isRunning(c) &amp;&amp; workQueue.offer(command))  workQueue 是一个任务排队的阻塞队列），然后还需要二次检查线程池是否 shut down（上次检查后到这次检查前死亡）。所以我们重新检查状态，如果线程池停止的话，回滚进队操作，或者如果没有工作的线程开启一个新线程（addWorker(null, false);）</li>
<li>如果不能让任务进入阻塞队列，然后尝试新增一个线程。如果新增线程失败，可能是线程池 shut down 或者线程池饱和（达到 maxPoolSize），所以接下来抛弃这个任务。</li>
</ol>
<p>任务（Task）被包装在一个叫做 Worker 的内部类，Worker 继承 AQS 来实现任务增加/删除的同步控制，使用 HashSet 来保存 Worker 线程。如果 worker 线程大于 corePoolSize，则不创建 worker 线程，而是放入一个 BlockingQueue 排队。如果有界队列的 BlockingQueue 满了，则尝试增加线程到线程池，但是线程总数要小于 maxPollSize。</p>
<p>addWorker() 方法：检查线程池当前状态和线程数量的边界条件看是否可以增加 worker 线程。如果可以，工作线程计数响应调整，并且，如果可能的话，新的 worker 线程被创建，启动，跑它的第一个 task。如果线程池 stop 或者要被 shut down，此方法返回 false。如果线程工厂（thread factory）创建线程失败，此方法也会返回 false。如果线程创建失败，不管是 thread factory 返回 null，或者 exception（通常是 OOM），都会被回滚。</p>
<p>参数<br>firstTask： 新线程应该运行的第一个任务。如果 worker 线程小于 corePoolSize，worker 和初始化的第一次任务一起创建绕过排队这一过程，或者队列已满。初始化空闲线程通常是通过 prestartCoreThread 或者替换已经死亡的 worker 线程。<br>core：如果 true，则使用 corePoolSize 作为边界，否则使用 maximumPoolSize 作为边界。（这里使用 Boolean 而不是传入实际值，是因为传入值可能会在传入过程被改变，在方法中直接读取值更精确）。  </p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">boolean</span> addWorker(Runnable firstTask, <span class="built_in">boolean</span> core) &#123;  </span><br><span class="line">    retry:  </span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;  </span><br><span class="line">        <span class="built_in">int</span> c = ctl.<span class="built_in">get</span>();  </span><br><span class="line">        <span class="built_in">int</span> rs = runStateOf(c);  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">// Check if queue empty only if necessary.  </span></span><br><span class="line">        <span class="keyword">if</span> (rs &gt;= SHUTDOWN &amp;&amp;  </span><br><span class="line">            ! (rs == SHUTDOWN &amp;&amp;  </span><br><span class="line">               firstTask == <span class="keyword">null</span> &amp;&amp;  </span><br><span class="line">               ! workQueue.isEmpty()))  </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;  </span><br><span class="line">            <span class="built_in">int</span> wc = workerCountOf(c);  </span><br><span class="line">            <span class="keyword">if</span> (wc &gt;= CAPACITY ||  </span><br><span class="line">                wc &gt;= (core ? corePoolSize : maximumPoolSize))  </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;  </span><br><span class="line">            <span class="keyword">if</span> (compareAndIncrementWorkerCount(c))  </span><br><span class="line">                <span class="keyword">break</span> retry;  </span><br><span class="line">            c = ctl.<span class="built_in">get</span>();  <span class="comment">// Re-read ctl  </span></span><br><span class="line">            <span class="keyword">if</span> (runStateOf(c) != rs)  </span><br><span class="line">                <span class="keyword">continue</span> retry;  </span><br><span class="line">            <span class="comment">// else CAS failed due to workerCount change; retry inner loop  </span></span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="built_in">boolean</span> workerStarted = <span class="keyword">false</span>;  </span><br><span class="line">    <span class="built_in">boolean</span> workerAdded = <span class="keyword">false</span>;  </span><br><span class="line">    Worker w = <span class="keyword">null</span>;  </span><br><span class="line">    <span class="keyword">try</span> &#123;  </span><br><span class="line">        <span class="keyword">final</span> ReentrantLock mainLock = <span class="keyword">this</span>.mainLock;  </span><br><span class="line">        w = <span class="keyword">new</span> Worker(firstTask);  </span><br><span class="line">        <span class="keyword">final</span> Thread t = w.thread;  </span><br><span class="line">        <span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;  </span><br><span class="line">            mainLock.lock();  </span><br><span class="line">            <span class="keyword">try</span> &#123;  </span><br><span class="line">                <span class="comment">// Recheck while holding lock.  </span></span><br><span class="line">                <span class="comment">// Back out on ThreadFactory failure or if  </span></span><br><span class="line">                <span class="comment">// shut down before lock acquired.  </span></span><br><span class="line">                <span class="built_in">int</span> c = ctl.<span class="built_in">get</span>();  </span><br><span class="line">                <span class="built_in">int</span> rs = runStateOf(c);  </span><br><span class="line">  </span><br><span class="line">                <span class="keyword">if</span> (rs &lt; SHUTDOWN ||  </span><br><span class="line">                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class="keyword">null</span>)) &#123;  </span><br><span class="line">                    <span class="keyword">if</span> (t.isAlive()) <span class="comment">// precheck that t is startable  </span></span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();  </span><br><span class="line">                    workers.<span class="built_in">add</span>(w);  </span><br><span class="line">                    <span class="built_in">int</span> s = workers.<span class="built_in">size</span>();  </span><br><span class="line">                    <span class="keyword">if</span> (s &gt; largestPoolSize)  </span><br><span class="line">                        largestPoolSize = s;  </span><br><span class="line">                    workerAdded = <span class="keyword">true</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">                mainLock.unlock();  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">if</span> (workerAdded) &#123;  </span><br><span class="line">                t.start();  </span><br><span class="line">                workerStarted = <span class="keyword">true</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> (! workerStarted)  </span><br><span class="line">            addWorkerFailed(w);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> workerStarted;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-ThreadLocal]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadThreadLocal/</url>
      <content type="html"><![CDATA[<p>这个类提供本地线程变量。不同于一般的变量，这些变量在他们各自的线程里通过 get、set 访问一个它自己的变量，这是一个独立初始化的变量副本。在一个类中，ThreadLocal 实例一般是 private static 的，期望和一个线程关联状态（如 userId，transactionId 等）。简单地说，就是此类提供了线程的本地变量，线程修改本地变量不互相影响。<br><a id="more"></a></p>
<p>举个例子，下面的类给每个线程生成一个唯一的标识。一个线程 id 在第一次调用 ThreadId.get() 被赋值，并且在后续的调用上保持不变。</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadId</span> </span>&#123;  </span><br><span class="line">       <span class="comment">// Atomic integer containing the next thread ID to be assigned  </span></span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> AtomicInteger nextId = <span class="keyword">new</span> AtomicInteger(<span class="number">0</span>);  </span><br><span class="line">  </span><br><span class="line">       <span class="comment">// Thread local 变量保存着每个线程的ID  </span></span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Integer&gt; threadId =  </span><br><span class="line">           <span class="keyword">new</span> ThreadLocal&lt;Integer&gt;() &#123;  </span><br><span class="line">               <span class="meta">@Override</span> <span class="keyword">protected</span> <span class="function">Integer <span class="title">initialValue</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">                   <span class="function"><span class="keyword">return</span> nextId.<span class="title">getAndIncrement</span><span class="params">()</span></span>;  </span><br><span class="line">           &#125;  </span><br><span class="line">       &#125;;  </span><br><span class="line">  </span><br><span class="line">       <span class="comment">// 返回当前线程的唯一ID，如果没有值的话先赋值  </span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">           <span class="function"><span class="keyword">return</span> threadId.<span class="title">get</span><span class="params">()</span></span>;  </span><br><span class="line">       &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>只要线程还存活并且 ThreadLocal 实例可访问，那么每个线程持有一个确定的引用指向本地的变量副本，当线程消失，它的本地变量副本将会被GC（除非还被其他对象引用）。</p>
<h1 id="使用案例"><a href="#使用案例" class="headerlink" title="使用案例"></a>使用案例</h1><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="markdown">/** </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>执行结果： </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-0,5,main]---------count=0 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-0,5,main]---------count=1 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-0,5,main]---------count=2 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-0,5,main]---------count=3 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-0,5,main]---------count=4 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-2,5,main]---------count=0 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-2,5,main]---------count=1 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-2,5,main]---------count=2 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-1,5,main]---------count=0 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-2,5,main]---------count=3 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-2,5,main]---------count=4 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-1,5,main]---------count=1 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-1,5,main]---------count=2 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-1,5,main]---------count=3 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Thread[Thread-1,5,main]---------count=4 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>可以看出线程的变量更新没有相互影响 </span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>Created by hzzhuyibin on 2017/3/14. </span></span></span><br><span class="line"><span class="comment"><span class="markdown"> */</span></span>  </span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalTest</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    private <span class="keyword">static</span> ThreadLocal&lt;Integer&gt; count = <span class="keyword">new</span> ThreadLocal&lt;Integer&gt;() &#123;  </span><br><span class="line">        public Integer initialValue() &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;;  </span><br><span class="line">  </span><br><span class="line">    public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;  </span><br><span class="line">  </span><br><span class="line">        NewThread thread1 = <span class="keyword">new</span> NewThread(count);  </span><br><span class="line">        NewThread thread2 = <span class="keyword">new</span> NewThread(count);  </span><br><span class="line">        NewThread thread3 = <span class="keyword">new</span> NewThread(count);  </span><br><span class="line">  </span><br><span class="line">        thread1.start();  </span><br><span class="line">        thread3.start();  </span><br><span class="line">        thread2.start();  </span><br><span class="line">  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    public <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">NewThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;  </span><br><span class="line">        ThreadLocal&lt;Integer&gt; threadLocal = <span class="keyword">null</span>;  </span><br><span class="line">  </span><br><span class="line">        public NewThread(ThreadLocal&lt;Integer&gt; threadLocal) &#123;  </span><br><span class="line">            <span class="keyword">this</span>.threadLocal = threadLocal;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        public <span class="keyword">void</span> run() &#123;  </span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;  </span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">"---------count="</span> + threadLocal.<span class="keyword">get</span>());  </span><br><span class="line">                threadLocal.<span class="keyword">set</span>(threadLocal.<span class="keyword">get</span>() + <span class="number">1</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h1><p>ThreadLocal 的数据结构：实线表示强引用，虚线表示弱引用<br>每个 Thread 维护一个ThreadLocalMap 映射 table，映射 table 的 key 是 ThreadLocal 实例，value 就是线程存独立的变量副本的地方。<br>为什么这么设计，而不是由 ThreadLocal 来维护一个以 Thread 为 key 的映射呢？原因如下：</p>
<ol>
<li>减小 Entry 数组大小：ThreadLocal 数量多，还是 Thread 的数量多，显而易见，使用 ThreadLocal 来当 key 可以减少 Entry 数量</li>
<li>减小内存占用：当 Thread 消亡，对 Thread 实例不在引用，则 GC 后就会清除相关数据</li>
</ol>
<p><img src="https://image.xiaomo.info/blog/threadLocal.png" alt></p>
<ol>
<li>先看字段含义</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** ThreadLocals 依赖每个线程的线性嗅探哈希映射到每个线程(Thread.threadLocals and inheritableThreadLocals)。 </span></span><br><span class="line"><span class="comment"> * ThreadLocal 对象作为 key，通过 threadLocalHashCode 来搜索。这是一个定制化的减少冲突的哈希码（只在 ThreadLocalMaps 有用）， </span></span><br><span class="line"><span class="comment"> * 其中连续构造的ThreadLocals由相同的线程使用，在较不常见的情况下保持良好行为。 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> threadLocalHashCode = nextHashCode();  </span><br><span class="line">  </span><br><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 生成下一个 Hash Code。原子更新。从零开始。 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> AtomicInteger nextHashCode =  </span><br><span class="line">        <span class="keyword">new</span> AtomicInteger();  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">     *连续生成的散列码之间的差异 - 将隐式顺序线程本地ID转换为二次幂表的近似最优扩展的乘法散列值。 </span></span><br><span class="line"><span class="comment">     *简单来说就是偏移量，offetset </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HASH_INCREMENT = <span class="number">0x61c88647</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 返回下一个 Hash 值 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">nextHashCode</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> nextHashCode.getAndAdd(HASH_INCREMENT);  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>主要方法：</li>
</ol>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**   返回当前线程的线程本地变量值。这个方法将会在线程第一次通过 get() 访问变量的时候调用， </span></span><br><span class="line"><span class="comment">     * 除非这个线程之前调用过 set() 那么 initialValue() 才不会被调用。通常，这个方法只会被调用一次, </span></span><br><span class="line"><span class="comment">     * 但是它在 get() 后调用 remove()，能被再次调用。 </span></span><br><span class="line"><span class="comment">     * 这里实现是简单返回 null，如果想赋其他值需要重写这个方法。 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> T <span class="title">initialValue</span>(<span class="params"></span>)</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>核心方法 get() 相关内容：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">* 返回当前线程的本地变量副本值。如果这个变量没有值，则返回 initialValue() 初始化的值 </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"><span class="keyword">public</span> T <span class="keyword">get</span>() &#123;  </span><br><span class="line">    Thread t = Thread.currentThread();  </span><br><span class="line">    <span class="comment">// ThreadLocalMap 是一个为了保存线程本地变量定制化的 hash map。  </span></span><br><span class="line">    ThreadLocalMap map = getMap(t);  </span><br><span class="line">    <span class="keyword">if</span> (map != <span class="literal">null</span>) &#123;  </span><br><span class="line">        ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);  </span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;  </span><br><span class="line">            <span class="meta">@SuppressWarnings(<span class="meta-string">"unchecked"</span>)</span>  </span><br><span class="line">            T result = (T)e.value;  </span><br><span class="line">            <span class="keyword">return</span> result;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> setInitialValue();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的 getMap(Thread t)：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**   获取和ThreadLocal相关的 map。在 InheritableThreadLocal中重写 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="function">ThreadLocalMap <span class="title">getMap</span><span class="params">(Thread t)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> t.threadLocals;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Thread 类中的代码：这里可以看到是 Thread 持有 ThreadLocal.ThreadLocalMap 引用</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 与此线程有关的ThreadLocal值。 此 map 由ThreadLocal类维护。 */</span>  </span><br><span class="line">dLocal.ThreadLocalMap <span class="attr">threadLocals</span> = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<p>其中的 map.getEntry(this)：</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 获取和key关联的Entry。 此方法本身仅处理快速路径：直接命中现有键。 </span></span><br><span class="line"><span class="comment"> *  这是为了最大限度地提高直接命中的性能，部分通过使这种方法很容易嵌入。 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> Entry getEntry(ThreadLocal&lt;?&gt; <span class="built_in">key</span>) &#123;  </span><br><span class="line">    <span class="built_in">int</span> i = <span class="built_in">key</span>.threadLocalHashCode &amp; (table.length - <span class="number">1</span>);  </span><br><span class="line">    Entry e = table[i];  </span><br><span class="line">    <span class="comment">// 命中 hash slot  </span></span><br><span class="line">    <span class="keyword">if</span> (e != <span class="keyword">null</span> &amp;&amp; e.<span class="built_in">get</span>() == <span class="built_in">key</span>)  </span><br><span class="line">        <span class="keyword">return</span> e;  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="comment">// 如果在 hash slot 里面没有直接查到就进入这个方法  </span></span><br><span class="line">        <span class="keyword">return</span> getEntryAfterMiss(<span class="built_in">key</span>, i, e);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 如果在 hash slot 里面没有直接查到就进入这个方法 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> Entry getEntryAfterMiss(ThreadLocal&lt;?&gt; <span class="built_in">key</span>, <span class="built_in">int</span> i, Entry e) &#123;  </span><br><span class="line">    Entry[] tab = table;  </span><br><span class="line">    <span class="built_in">int</span> len = tab.length;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">while</span> (e != <span class="keyword">null</span>) &#123;  </span><br><span class="line">        ThreadLocal&lt;?&gt; k = e.<span class="built_in">get</span>();  </span><br><span class="line">        <span class="keyword">if</span> (k == <span class="built_in">key</span>)  </span><br><span class="line">            <span class="keyword">return</span> e;  </span><br><span class="line">        <span class="keyword">if</span> (k == <span class="keyword">null</span>) <span class="comment">// 清理无用 entry  </span></span><br><span class="line">            expungeStaleEntry(i);  </span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// 可以看出这里使用开放定址法来解决哈希冲突  </span></span><br><span class="line">            i = nextIndex(i, len);  </span><br><span class="line">        e = tab[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 核心方法 set() 相关内容：</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 设置 key 的 value </span></span><br><span class="line"><span class="comment"> * 这里不使用 get() 方法中的快速路径，因为新建和更新的比例差不多， </span></span><br><span class="line"><span class="comment"> * 使用快速路径查找失败率很高 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="built_in">set</span>(ThreadLocal&lt;?&gt; <span class="built_in">key</span>, <span class="keyword">Object</span> value) &#123;  </span><br><span class="line">  </span><br><span class="line">    Entry[] tab = table;  </span><br><span class="line">    <span class="built_in">int</span> len = tab.length;  </span><br><span class="line">    <span class="built_in">int</span> i = <span class="built_in">key</span>.threadLocalHashCode &amp; (len<span class="number">-1</span>);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 开发地址法，遍历查找  </span></span><br><span class="line">    <span class="keyword">for</span> (Entry e = tab[i];  </span><br><span class="line">         e != <span class="keyword">null</span>;  </span><br><span class="line">         e = tab[i = nextIndex(i, len)]) &#123;  </span><br><span class="line">        ThreadLocal&lt;?&gt; k = e.<span class="built_in">get</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span> (k == <span class="built_in">key</span>) &#123;  </span><br><span class="line">            e.value = value;  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">            <span class="comment">// key 为 null，说明 ThreadLocal 实例已被回收，  </span></span><br><span class="line">            <span class="comment">// 所以这里的 value 可以被覆盖。减少内存泄露的可能  </span></span><br><span class="line">        <span class="keyword">if</span> (k == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            replaceStaleEntry(<span class="built_in">key</span>, value, i);  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 没有找到 Entry 则新建一个  </span></span><br><span class="line">    tab[i] = <span class="keyword">new</span> Entry(<span class="built_in">key</span>, value);  </span><br><span class="line">    <span class="built_in">int</span> sz = ++<span class="built_in">size</span>;  </span><br><span class="line">    <span class="keyword">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)  </span><br><span class="line">        rehash();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-内存模型]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadMemoryActor/</url>
      <content type="html"><![CDATA[<p>为了让程序员忽略掉各种硬件和操作系统的内存访问差异， 也既无需关心不同架构上内存模型的差异， Java 在代码和硬件内存模型间又提供了一个 Java 内存模型。<br><a id="more"></a></p>
<h1 id="并发模型的分类"><a href="#并发模型的分类" class="headerlink" title="并发模型的分类"></a>并发模型的分类</h1><p>在并发编程中，需要处理两个关键问题：线程之间如何通信（线程之间以何种机制来交换信息， 有两种方式：共享内存和消息传递）及线程之间如何同步。</p>
<p>在共享内存的并发模型里（如 Java），线程之间共享程序的公共状态，线程之间通过写-读内存中的公共状态（主存）来隐式（对程序员透明）进行通信。在消息传递的并发模型里，线程之间没有公共状态，线程之间必须通过明确的发送消息来显式进行通信。</p>
<p>同步是指程序用于控制不同线程之间操作发生相对顺序的机制。在共享内存并发模型里，同步是显式进行的。程序员必须显式指定某个方法或某段代码需要在线程之间互斥执行。在消息传递的并发模型里，由于消息的发送必须在消息的接收之前，因此同步是隐式进行的。</p>
<p>虽然 Java 是共享内存并发模型， 对程序员透明， 但是不理解 Java 内存模型， 就会对内存可见性， 有序性等问题出现时找不到解决方法。</p>
<h1 id="Java-虚拟机运行时数据区"><a href="#Java-虚拟机运行时数据区" class="headerlink" title="Java 虚拟机运行时数据区"></a>Java 虚拟机运行时数据区</h1><p><img src="https://img-blog.csdn.net/20150927230534604" alt></p>
<p>虚拟机栈描述的是 Java 执行的内存模型： 每个方法在执行的同时都会创建一个栈帧（Stack Frame）用于存储局部变量表、  操作数栈、 动态链接、 方法出口等信息。</p>
<p>Java 内存模型的主要目标是定义程序中各个变量的访问规则， 既在虚拟机中对变量的读写操作， 监视器的加锁和释放操作， 以及线程的启动和合并操作。</p>
<h1 id="原子性、-可见性和有序性"><a href="#原子性、-可见性和有序性" class="headerlink" title="原子性、 可见性和有序性"></a>原子性、 可见性和有序性</h1><p>Java 内存模型是围绕着在并发过程中如何处理原子性、 可见性和有序性来建立的。 </p>
<p> 原子性： 操作不可再分。 如在 Java 代码中使用 synchronized 和 ReentrantLock 来保障。<br> 可见性： A 线程操作， 对 B 线程可见， 既 A 变量赋值 1， B 线程能看见变量已经变为 1。 synchronized 、final、 volatile 和 ReentrantLock 都能提供。<br> 有序性： 在本线程内观察， 所有操作都是有序的（线程内表现为串行语义）； 如果在另一个线程中观察另一个线程， 所有操作都是无序的（指令重排序与工作内存与主内存同步延迟）。synchronized 、 volatile 和 ReentrantLock 都能提供有序性保证。</p>
<p> 从上述可以得出 synchronized 和 ReentrantLock 是万能的， 但是效率却有巨大的差别， ReentrantLock 会比 synchronized 好很多， ConcurrentHashMap 的源码实现中就利用了 ReentrantLock 分段锁来提升并发安全和效率。</p>
<h1 id="Happens-Before-规则"><a href="#Happens-Before-规则" class="headerlink" title="Happens-Before 规则"></a>Happens-Before 规则</h1><p>要保证 A 线程看到 B线程的操作结果（无论 A 和 B 是否在同一线程中执行）， 那么 A 和 B 之间必须满足 Happens-Before 关系。<br>Happens-Before 规则如下：</p>
<ol>
<li>序次序规则（Program Order Rule）：程序中 操作 A 在操作 B 之前， 那么在线程中 A 操作将在 B 操作之前进行。</li>
<li>管程锁定规则（Monitor Lock Rule）：一个 unlock 操作 happen—before 后面（时间上的先后顺序，下同）对同一个锁的 lock 操作。</li>
<li>volatile 变量规则：对一个 volatile 变量的写操作 happen—before 后面对该变量的读操作。</li>
<li>线程启动规则：Thread 对象的 start() 方法 happen—before 此线程的每一个动作。</li>
<li>线程终止规则：线程的所有操作都 happen—before 对此线程的终止检测，可以通过 Thread.join() 方法结束、Thread.isAlive() 的返回值等手段检测到线程已经终止执行。</li>
<li>线程中断规则：对线程 interrupt() 方法的调用 happen—before 发生于被中断线程的代码检测到中断时事件的发生。</li>
<li>终结器规则（Finalizer Rule）：一个对象的初始化完成（构造函数执行结束）happen—before 它的 finalize() 方法的开始。</li>
<li>传递性：如果操作A happen—before 操作 B，操作 B happen—before 操作 C，那么可以得出 A happen—before 操作 C。</li>
<li>如果两个操作间缺乏 Happens-Before 关系， 那么 JVM 可以对它们进行任意排序。</li>
</ol>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a><br><a href="https://www.jianshu.com/p/2fdee831ed03" target="_blank" rel="noopener">Java内存溢出(OOM)异常完全指南</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-Integer]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadInteger/</url>
      <content type="html"><![CDATA[<p>对于 Integer 这个 Java 程序员几乎天天使用的类,使用上却可以看出普通程序员和优秀程序员区别。<br><a id="more"></a></p>
<h1 id="深入代码"><a href="#深入代码" class="headerlink" title="深入代码"></a>深入代码</h1><p>在创建数字 1 的对象时， 大多数人会使用 new Integer(1)， 而使用 Integer.valueOf(1) 可以使用系统缓存，既减少可能的内存占用，也省去了频繁创建对象的开销。<br>系统默认只缓存 -128～127 之间的整数。下面我们看一下 Integer.valueOf(int) 方法的代码： </p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function">Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;  </span><br><span class="line">    <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)  </span><br><span class="line">        <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到核心 <code>IntegerCache.cache[i + (-IntegerCache.low)]</code>， 观察<code>IntegerCache</code>类的源码实现：<br>为 －128 ～ 127 数值提供自动装箱的缓存服务。 </p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerCache</span> &#123;</span>  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = <span class="number">-128</span>;  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> &#123;  </span><br><span class="line">        <span class="comment">// high value may be configured by property  </span></span><br><span class="line">        <span class="keyword">int</span> h = <span class="number">127</span>;  </span><br><span class="line">        <span class="keyword">String</span> integerCacheHighPropValue =  </span><br><span class="line">            sun.misc.VM.getSavedProperty(<span class="string">"java.lang.Integer.IntegerCache.high"</span>);  </span><br><span class="line">        <span class="keyword">if</span> (integerCacheHighPropValue != null) &#123;  </span><br><span class="line">            <span class="keyword">int</span> i = <span class="built_in">parseInt</span>(integerCacheHighPropValue);  </span><br><span class="line">            i = Math.<span class="built_in">max</span>(i, <span class="number">127</span>);  </span><br><span class="line">            <span class="comment">// Maximum array size is Integer.MAX_VALUE  </span></span><br><span class="line">            h = Math.<span class="built_in">min</span>(i, Integer.MAX_VALUE - (-low) <span class="number">-1</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">        high = h;  </span><br><span class="line">  </span><br><span class="line">        cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];  </span><br><span class="line">        <span class="keyword">int</span> j = low;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cache.length; k++)  </span><br><span class="line">            cache[k] = <span class="keyword">new</span> Integer(j++);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">IntegerCache</span><span class="params">()</span> </span>&#123;&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>static 静态代码块可知缓存的初始化是在第一次使用的时候。 通过 VM 参数-XX:AutoBoxCacheMax=<size> 可以配置缓存的最大值。 在 VM 初始化期间， 缓存最大值 high， 可能被保存在 sun.misc.VM class 的私有系统属性里。   </size></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>  除非是 JDK 1.5 以前的环境， 如果系统不需要新对象， 则推荐使用 Long， Integer， Short， Character， Byte 的 valueOf() 方法提升性能。 </p>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-ConcurrentHashMap]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadConcurrentHashMap/</url>
      <content type="html"><![CDATA[<p>ConcurrentHashMap 是将锁的范围细化来实现高效并发的。 基本策略是将数据结构分为一个一个 Segment（每一个都是一个并发可读的 hash table， 即分段锁）作为一个并发单元。 为了减少开销， 除了一处 Segment 是在构造器初始化的， 其他都延迟初始化（详见 ensureSegment）。 并使用 volatile 关键字来保证 Segment 延迟初始化的可见性问题。 </p>
<p>HashMap 不是线程安全的， 故多线程情况下会出现 infinit loop。 HashTable 是线程安全的， 但是是用全局锁来保障， 效率很低。 所以 Doug Lea 并发专家研发了高效并发的 ConcurrentHashMap 来应对并发情况下的情景。 阅读本文前最好先看： <a href="https://blog.xiaomo.info/2018/jdkSourceCodeReadMemoryActor/">Java内存模型</a> 和 <a href="https://blog.xiaomo.info/2018/jdkSourceCodeReadAtomicInteger/">AtomicInteger 分析</a>。<br><a id="more"></a></p>
<h1 id="术语定义"><a href="#术语定义" class="headerlink" title="术语定义"></a>术语定义</h1><ol>
<li><p>哈希算法<br>是一种将任意内容的输入转换成相同长度输出的加密方式，其输出被称为哈希值。</p>
</li>
<li><p>哈希表<br>根据设定的哈希函数H(key)和处理冲突方法将一组关键字映象到一个有限的地址区间上，并以关键字在地址区间中的象作为记录在表中的存储位置，这种表称为哈希表或散列，所得存储位置称为哈希地址或散列地址。</p>
</li>
</ol>
<h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><p><img src="https://image.xiaomo.info/blog/c1.png" alt></p>
<p>抽象结构图<br><img src="https://image.xiaomo.info/blog/c2.png" alt></p>
<p>从上述类图和抽象结构图可以看出 ConcurrentHashMap 是由 Segment 数组结构和 HashEntry 数组结构组成。Segment 继承(Generalization)了可重入锁ReentrantLock，HashEntry 用于存储键值对数据。一个 ConcurrentHashMap 里 contains-a (Composition) 一个 Segment []，Segment 的结构和 HashMap 类似，是一种数组和链表结构， 一个 Segment 里 has-a (Aggregation)一个 HashEntry 数组，每个 HashEntry 是一个链表结构的元素， 每个 Segment 锁定一个 HashEntry 数组里的元素, 当对 HashEntry 数组的数据进行 put 等修改操作时，必须先获得它对应的 Segment 锁。</p>
<h1 id="源码解析"><a href="#源码解析" class="headerlink" title="源码解析"></a>源码解析</h1><p>内部类 Segment 类：<br>Segment 维护着条目列表状态一致性， 所以可以实现无锁读。 在表超出 threshold 进行 resize 的时候， 复制节点， 所以在做 resize 修改操作的时候， 还可以进行读操作（在旧 list 读）。 本类里只有变化操作的方法才需要加锁， 变化的方法利用一系列忙等控制来处理资源争用， 例如 scanAndLock 和 scanAndLockForPut 。 那些遍历去查找节点的 tryLocks() 方法， 主要是用来吸收 cached 不命中(在 hash tables 经常出现)， 这样后续获取锁的遍历操作效率将会有不小提升。 我们可能不是真的需要使用找到的数据， 因为重新获得数据还需要加锁来保证更新操作的一致性， 但他们会更快地进行重定位。 此外，  scanAndLockForPut 特地创建新数据用于没有数据被找到的 put 方法。</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在准备锁住 segment 操作前最大的 tryLock() 次数。 多核情况下， 在定位 nodes 时使用 64 次最大值维持缓存  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_SCAN_RETRIES =  </span><br><span class="line">    <span class="keyword">Runtime</span>.getRuntime().availableProcessors() &gt; <span class="number">1</span> ? <span class="number">64</span> : <span class="number">1</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * The per-segment table. 数据访问通过 </span></span><br><span class="line"><span class="comment"> * entryAt/setEntryAt 提供的 volatile 语义来保证可见性. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">volatile</span> HashEntry&lt;K,V&gt;[] table;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * sengment 内 hash entry 元素个数 , 之所以在每个 Segment 对象中包含一个计数器，而不是在 ConcurrentHashMap 中使用全局的计数器，是为了避免出现“热点域”而影响 ConcurrentHashMap 的并发性。 </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> <span class="keyword">count</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 在 segment 中可变操作总数, 即更新次数 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> modCount;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 当超过threshold 时候，  table 再哈希 </span></span><br><span class="line"><span class="comment"> * (The value of this field is always &lt;tt&gt;(int)(capacity * </span></span><br><span class="line"><span class="comment"> * loadFactor)&lt;/tt&gt;.) </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> threshold;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> *  hash table 负载因子.  Even though this value </span></span><br><span class="line"><span class="comment"> * is same for all segments, it is replicated to avoid needing </span></span><br><span class="line"><span class="comment"> * links to outer object. </span></span><br><span class="line"><span class="comment"> * @serial </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br></pre></td></tr></table></figure>
<p><code>put</code> 方法：<br>插入A， B， C后 Segment 示意图：</p>
<p><img src="https://image.xiaomo.info/blog/c3.png" alt></p>
<figure class="highlight q"><table><tr><td class="code"><pre><span class="line">final V put(K <span class="built_in">key</span>, <span class="type">int</span> hash, V <span class="built_in">value</span>, boolean onlyIfAbsent) &#123;  </span><br><span class="line"> <span class="comment">// tryLock 一般缓存作用  </span></span><br><span class="line">HashEntry&lt;K,V&gt; node = tryLock() ? <span class="built_in">null</span> :  </span><br><span class="line">        scanAndLockForPut(<span class="built_in">key</span>, hash, <span class="built_in">value</span>);  </span><br><span class="line">    V oldValue;  </span><br><span class="line">    try &#123;  </span><br><span class="line">        HashEntry&lt;K,V&gt;[] tab = table;  </span><br><span class="line">        <span class="type">int</span> index = (tab.length - <span class="number">1</span>) &amp; hash;  </span><br><span class="line">        <span class="comment">// 找到 bucket 位置  </span></span><br><span class="line">        HashEntry&lt;K,V&gt; <span class="built_in">first</span> = entryAt(tab, index);  </span><br><span class="line">        for (HashEntry&lt;K,V&gt; e = <span class="built_in">first</span>;;) &#123;  </span><br><span class="line">            if (e != <span class="built_in">null</span>) &#123;  </span><br><span class="line">                K k;  </span><br><span class="line">                if ((k = e.<span class="built_in">key</span>) == <span class="built_in">key</span> ||  </span><br><span class="line">                    (e.hash == hash &amp;&amp; <span class="built_in">key</span>.equals(k))) &#123;  </span><br><span class="line">                    <span class="comment">// 保存旧值， 这样 get 操作就可以无锁访问正在写操作的节点  </span></span><br><span class="line">                    oldValue = e.<span class="built_in">value</span>;  </span><br><span class="line">                    if (!onlyIfAbsent) &#123;  </span><br><span class="line">                        <span class="comment">// 覆盖原来的值  </span></span><br><span class="line">                        e.<span class="built_in">value</span> = <span class="built_in">value</span>;  </span><br><span class="line">                        <span class="comment">// 修改计数  </span></span><br><span class="line">                        ++modCount;  </span><br><span class="line">                    &#125;  </span><br><span class="line">                    break;  </span><br><span class="line">                &#125;  </span><br><span class="line">                <span class="comment">// 每次从头部插入  </span></span><br><span class="line">                e = e.<span class="built_in">next</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            else &#123;  </span><br><span class="line">                if (node != <span class="built_in">null</span>)  </span><br><span class="line">                    node.setNext(<span class="built_in">first</span>);  </span><br><span class="line">                else  </span><br><span class="line">                    node = new HashEntry&lt;K,V&gt;(hash, <span class="built_in">key</span>, <span class="built_in">value</span>, <span class="built_in">first</span>);  </span><br><span class="line">                <span class="type">int</span> c = <span class="built_in">count</span> + <span class="number">1</span>;  </span><br><span class="line">                <span class="comment">// 超过 threshold 则， rehash()  </span></span><br><span class="line">                if (c &gt; threshold &amp;&amp; tab.length &lt; MAXIMUM_CAPACITY)  </span><br><span class="line">                    rehash(node);  </span><br><span class="line">                else  </span><br><span class="line">                    setEntryAt(tab, index, node);  </span><br><span class="line">                ++modCount;  </span><br><span class="line">                <span class="built_in">count</span> = c;  </span><br><span class="line">                oldValue = <span class="built_in">null</span>;  </span><br><span class="line">                break;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125; finally &#123;  </span><br><span class="line">        <span class="comment">// 典型的 ReentrantLock 释放锁  </span></span><br><span class="line">        unlock();  </span><br><span class="line">    &#125;  </span><br><span class="line">    return oldValue;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ConcurrentHashMap的size操作<br>如果我们要统计整个ConcurrentHashMap里元素的大小，就必须统计所有Segment里元素的大小后求和。Segment里的全局变量count是一个volatile变量，那么在多线程场景下，我们是不是直接把所有Segment的count相加就可以得到整个ConcurrentHashMap大小了呢？不是的，虽然相加时可以获取每个Segment的count的最新值，但是拿到之后可能累加前使用的count发生了变化，那么统计结果就不准了。所以最安全的做法，是在统计size的时候把所有Segment的put，remove和clean方法全部锁住，但是这种做法显然非常低效。 因为在累加count操作过程中，之前累加过的count发生变化的几率非常小，所以ConcurrentHashMap的做法是先尝试2次通过不锁住Segment的方式来统计各个Segment大小，如果统计的过程中，容器的count发生了变化，则再采用加锁的方式来统计所有Segment的大小。</p>
<p>那么ConcurrentHashMap是如何判断在统计的时候容器是否发生了变化呢？使用modCount变量，在put , remove和clean方法里操作元素前都会将变量modCount进行加1，那么在统计size前后比较modCount是否发生变化，从而得知容器的大小是否发生变化。</p>
<p><code>rehash()</code> 方法:  在新 table 中重新分类节点。 因为使用了 2 的幂指数扩展方式， bucket/bin 中的数据还是在原位， 即旧数据的索引位置不变或者偏移了 2 的幂指数距离。 可以重用旧节点减少不必要的节点生成。 </p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * table 大小 *2， 重新放置 HashEntry， 加入新节点 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line">@SuppressWarnings(<span class="string">"unchecked"</span>)  </span><br><span class="line"><span class="keyword">private</span> void rehash(HashEntry&lt;K,V&gt; node) &#123;  </span><br><span class="line">    <span class="comment">// 保存旧值以便 get 操作遍历  </span></span><br><span class="line">    HashEntry&lt;K,V&gt;[] oldTable = table;  </span><br><span class="line">    int oldCapacity = oldTable.length;  </span><br><span class="line">    int <span class="keyword">new</span><span class="type">Capacity</span> = oldCapacity &lt;&lt; <span class="number">1</span>;  </span><br><span class="line">    threshold = (int)(<span class="keyword">new</span><span class="type">Capacity</span> * loadFactor);  </span><br><span class="line">    HashEntry&lt;K,V&gt;[] <span class="keyword">new</span><span class="type">Table</span> =  </span><br><span class="line">        (HashEntry&lt;K,V&gt;[]) <span class="keyword">new</span> <span class="type">HashEntry</span>[<span class="keyword">new</span><span class="type">Capacity</span>];  </span><br><span class="line">    int sizeMask = <span class="keyword">new</span><span class="type">Capacity</span> - <span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; oldCapacity ; i++) &#123;  </span><br><span class="line">        HashEntry&lt;K,V&gt; e = oldTable[i];  </span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;  </span><br><span class="line">            HashEntry&lt;K,V&gt; next = e.next;  </span><br><span class="line">            int idx = e.hash &amp; sizeMask;  </span><br><span class="line">            <span class="keyword">if</span> (next == <span class="literal">null</span>)   <span class="comment">//  单节点链表  </span></span><br><span class="line">                <span class="keyword">new</span><span class="type">Table</span>[idx] = e;  </span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="comment">// 重用在同一个 slot 的连续序列  </span></span><br><span class="line">                HashEntry&lt;K,V&gt; lastRun = e;  </span><br><span class="line">                int lastIdx = idx;  </span><br><span class="line">                <span class="keyword">for</span> (HashEntry&lt;K,V&gt; last = next;  </span><br><span class="line">                     last != <span class="literal">null</span>;  </span><br><span class="line">                     last = last.next) &#123;  </span><br><span class="line">                    int k = last.hash &amp; sizeMask;  </span><br><span class="line">                    <span class="keyword">if</span> (k != lastIdx) &#123;  </span><br><span class="line">                        lastIdx = k;  </span><br><span class="line">                        lastRun = last;  </span><br><span class="line">                    &#125;  </span><br><span class="line">                &#125;  </span><br><span class="line">                <span class="keyword">new</span><span class="type">Table</span>[lastIdx] = lastRun;  </span><br><span class="line">                <span class="comment">// Clone remaining nodes  </span></span><br><span class="line">                <span class="keyword">for</span> (HashEntry&lt;K,V&gt; p = e; p != lastRun; p = p.next) &#123;  </span><br><span class="line">                    V v = p.value;  </span><br><span class="line">                    int h = p.hash;  </span><br><span class="line">                    int k = h &amp; sizeMask;  </span><br><span class="line">                    HashEntry&lt;K,V&gt; n = <span class="keyword">new</span><span class="type">Table</span>[k];  </span><br><span class="line">                    <span class="keyword">new</span><span class="type">Table</span>[k] = <span class="keyword">new</span> <span class="type">HashEntry</span>&lt;K,V&gt;(h, p.key, v, n);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    int nodeIndex = node.hash &amp; sizeMask; <span class="comment">// add the new node  </span></span><br><span class="line">    node.setNext(<span class="keyword">new</span><span class="type">Table</span>[nodeIndex]);  </span><br><span class="line">    <span class="keyword">new</span><span class="type">Table</span>[nodeIndex] = node;  </span><br><span class="line">    table = <span class="keyword">new</span><span class="type">Table</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>内部类 <code>HashEntry</code>：链表结构</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> HashEntry&lt;K,V&gt; &#123;  </span><br><span class="line">    <span class="comment">// final 保证不变性， 即为线程安全的字段  </span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;  </span><br><span class="line">    <span class="keyword">final</span> K key;  </span><br><span class="line">    <span class="comment">// 根据 volatile 写永远先于读操作的 happens-before 原则来保证获取到都是最新值  </span></span><br><span class="line">    <span class="keyword">volatile</span> V value;  </span><br><span class="line">    <span class="keyword">volatile</span> HashEntry&lt;K,V&gt; <span class="keyword">next</span>;  </span><br><span class="line">  </span><br><span class="line">    HashEntry(<span class="keyword">int</span> hash, K key, V value, HashEntry&lt;K,V&gt; <span class="keyword">next</span>) &#123;  </span><br><span class="line">        <span class="keyword">this</span>.hash = hash;  </span><br><span class="line">        <span class="keyword">this</span>.key = key;  </span><br><span class="line">        <span class="keyword">this</span>.value = value;  </span><br><span class="line">        <span class="keyword">this</span>.<span class="keyword">next</span> = <span class="keyword">next</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 使用 volatile 写语义设置 next </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">void</span> setNext(HashEntry&lt;K,V&gt; n) &#123;  </span><br><span class="line">        UNSAFE.putOrderedObject(<span class="keyword">this</span>, nextOffset, n);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Unsafe mechanics  </span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> sun.misc.Unsafe UNSAFE;  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> nextOffset;  </span><br><span class="line">    <span class="keyword">static</span> &#123;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            UNSAFE = sun.misc.Unsafe.getUnsafe();  </span><br><span class="line">            <span class="keyword">Class</span> k = HashEntry.<span class="keyword">class</span>;  </span><br><span class="line">            nextOffset = UNSAFE.objectFieldOffset  </span><br><span class="line">                (k.getDeclaredField(<span class="string">"next"</span>));  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Error(e);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ConcurrentHashMap 类：</code></p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* ---------------- Constants -------------- */</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * The default initial capacity for this table, </span></span><br><span class="line"><span class="comment"> * used when not otherwise specified in a constructor. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">16</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 本值是 HashEntry 个数与 table 数组长度的比值 </span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75</span>f;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 当前并发线程的使用数 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CONCURRENCY_LEVEL = <span class="number">16</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * The maximum capacity, used if a higher value is implicitly </span></span><br><span class="line"><span class="comment"> * specified by either of the constructors with arguments.  MUST </span></span><br><span class="line"><span class="comment"> * be a power of two &lt;= 1&lt;&lt;30 to ensure that entries are indexable </span></span><br><span class="line"><span class="comment"> * using ints. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * The minimum capacity for per-segment tables.  Must be a power </span></span><br><span class="line"><span class="comment"> * of two, at least two to avoid immediate resizing on next use </span></span><br><span class="line"><span class="comment"> * after lazy construction. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_SEGMENT_TABLE_CAPACITY = <span class="number">2</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * The maximum number of segments to allow; used to bound </span></span><br><span class="line"><span class="comment"> * constructor arguments. Must be power of two less than 1 &lt;&lt; 24. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_SEGMENTS = <span class="number">1</span> &lt;&lt; <span class="number">16</span>; <span class="comment">// slightly conservative  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * Number of unsynchronized retries in size and containsValue </span></span><br><span class="line"><span class="comment"> * methods before resorting to locking. This is used to avoid </span></span><br><span class="line"><span class="comment"> * unbounded retries if tables undergo continuous modification </span></span><br><span class="line"><span class="comment"> * which would make it impossible to obtain an accurate result. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RETRIES_BEFORE_LOCK = <span class="number">2</span>;  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 索引 segments 时使用： 使用高比特位的 hash 值去选择 segment </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> segmentMask;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * Shift value for indexing within segments. </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> segmentShift;</span><br></pre></td></tr></table></figure>
<p>初始化 ConcurrentHashMap:<br>ConcurrentHashMap 结构图</p>
<p><img src="https://image.xiaomo.info/blog/c4.png" alt></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ConcurrentHashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity,  </span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">float</span> loadFactor, <span class="keyword">int</span> concurrencyLevel)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (!(loadFactor &gt; <span class="number">0</span>) || initialCapacity &lt; <span class="number">0</span> || concurrencyLevel &lt;= <span class="number">0</span>)  </span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();  </span><br><span class="line">    <span class="keyword">if</span> (concurrencyLevel &gt; MAX_SEGMENTS)  </span><br><span class="line">        concurrencyLevel = MAX_SEGMENTS;  </span><br><span class="line">    <span class="comment">// Find power-of-two sizes best matching arguments  </span></span><br><span class="line">    <span class="keyword">int</span> sshift = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">int</span> ssize = <span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">while</span> (ssize &lt; concurrencyLevel) &#123;  </span><br><span class="line">        ++sshift;  </span><br><span class="line">        ssize &lt;&lt;= <span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">this</span>.segmentShift = <span class="number">32</span> - sshift;  </span><br><span class="line">    <span class="keyword">this</span>.segmentMask = ssize - <span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)  </span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;  </span><br><span class="line">    <span class="keyword">int</span> c = initialCapacity / ssize;  </span><br><span class="line">    <span class="keyword">if</span> (c * ssize &lt; initialCapacity)  </span><br><span class="line">        ++c;  </span><br><span class="line">    <span class="keyword">int</span> cap = MIN_SEGMENT_TABLE_CAPACITY;  </span><br><span class="line">    <span class="keyword">while</span> (cap &lt; c)  </span><br><span class="line">        cap &lt;&lt;= <span class="number">1</span>;  </span><br><span class="line">    <span class="comment">// create segments and segments[0]  </span></span><br><span class="line">    Segment&lt;K,V&gt; s0 =  </span><br><span class="line">        <span class="keyword">new</span> Segment&lt;K,V&gt;(loadFactor, (<span class="keyword">int</span>)(cap * loadFactor),  </span><br><span class="line">                         (HashEntry&lt;K,V&gt;[])<span class="keyword">new</span> HashEntry[cap]);  </span><br><span class="line">    Segment&lt;K,V&gt;[] ss = (Segment&lt;K,V&gt;[])<span class="keyword">new</span> Segment[ssize];  </span><br><span class="line">    UNSAFE.putOrderedObject(ss, SBASE, s0); <span class="comment">// ordered write of segments[0]  </span></span><br><span class="line">    <span class="keyword">this</span>.segments = ss;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由上面的代码可知segments数组的长度size通过concurrencyLevel计算得出。为了能通过按位与的哈希算法来定位segments数组的索引，必须保证segments数组的长度是2的N次方（power-of-two size），所以必须计算出一个是大于或等于concurrencyLevel的最小的2的N次方值来作为segments数组的长度。假如concurrencyLevel等于14，15或16，ssize都会等于16，即容器里锁的个数也是16。注意concurrencyLevel的最大大小是65535，意味着segments数组的长度最大为65536，对应的二进制是16位。</p>
<p>初始化segmentShift和segmentMask。这两个全局变量在定位segment时的哈希算法里需要使用，sshift等于ssize从1向左移位的次数，在默认情况下concurrencyLevel等于16，1需要向左移位移动4次，所以sshift等于4。segmentShift用于定位参与hash运算的位数，segmentShift等于32减sshift，所以等于28，这里之所以用32是因为ConcurrentHashMap里的hash()方法输出的最大数是32位的，后面的测试中我们可以看到这点。segmentMask是哈希运算的掩码，等于ssize减1，即15，掩码的二进制各个位的值都是1。因为ssize的最大长度是65536，所以segmentShift最大值是16，segmentMask最大值是65535，对应的二进制是16位，每个位都是1。</p>
<p>变量cap就是segment里HashEntry数组的长度，它等于initialCapacity除以ssize的倍数c，如果c大于1，就会取大于等于c的2的N次方值，所以cap不是1，就是2的N次方。segment的容量threshold＝(int)cap*loadFactor，默认情况下initialCapacity等于16，load factor等于0.75，通过运算cap等于1，threshold等于零。</p>
<h1 id="在jdk1-8中主要做了2方面的改进"><a href="#在jdk1-8中主要做了2方面的改进" class="headerlink" title="在jdk1.8中主要做了2方面的改进"></a>在jdk1.8中主要做了2方面的改进</h1><p>数据结构<br>1.8中放弃了Segment臃肿的设计，取而代之的是采用Node + CAS + Synchronized来保证并发安全进行实现，结构如下：<br><img src="https://image.xiaomo.info/blog/nodeArray.png" alt></p>
<p>只有在执行第一次put方法时才会调用initTable()初始化Node数组，实现如下：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">private final Node&lt;K,V&gt;[] initTable() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] <span class="keyword">tab</span>; int <span class="keyword">sc</span>;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="keyword">tab</span> = <span class="keyword">table</span>) == null || <span class="keyword">tab</span>.length == 0) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">sc</span> = sizeCtl) &lt; 0)</span><br><span class="line">            Thread.yield(); <span class="comment">// lost initialization race; just spin</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">U</span>.compareAndSwapInt(this, SIZECTL, <span class="keyword">sc</span>, -1)) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="keyword">tab</span> = <span class="keyword">table</span>) == null || <span class="keyword">tab</span>.length == 0) &#123;</span><br><span class="line">                    int <span class="keyword">n</span> = (<span class="keyword">sc</span> &gt; 0) ? <span class="keyword">sc</span> : DEFAULT_CAPACITY;</span><br><span class="line">                    @SuppressWarnings(<span class="string">"unchecked"</span>)</span><br><span class="line">                    Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[<span class="keyword">n</span>];</span><br><span class="line">                    <span class="keyword">table</span> = <span class="keyword">tab</span> = nt;</span><br><span class="line">                    <span class="keyword">sc</span> = <span class="keyword">n</span> - (<span class="keyword">n</span> &gt;&gt;&gt; 2);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                sizeCtl = <span class="keyword">sc</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">tab</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>put实现<br>当执行put方法插入数据时，根据key的hash值，在Node数组中找到相应的位置，实现如下：</p>
<p>1、如果相应位置的Node还未初始化，则通过CAS插入相应的数据；</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ((f = <span class="built_in">tabAt</span>(<span class="built_in">tab</span>, i = (n - <span class="number">1</span>) &amp; hash)) == <span class="built_in">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">casTabAt</span>(<span class="built_in">tab</span>, i, <span class="built_in">null</span>, new Node&lt;K,V&gt;(hash, <span class="built_in">key</span>, value, <span class="built_in">null</span>)))</span><br><span class="line">        <span class="keyword">break</span>;                   <span class="comment">// no lock when adding to empty bin</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、如果相应位置的Node不为空，且当前该节点不处于移动状态，则对该节点加synchronized锁，如果该节点的hash不小于0，则遍历链表更新节点或插入新节点；</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">if (fh &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    binCount = <span class="number">1</span>;</span><br><span class="line">    for (<span class="keyword">Node</span><span class="title">&lt;K</span>,V&gt; e = f;; ++binCount) &#123;</span><br><span class="line">        K ek;</span><br><span class="line">        if (e.hash == hash &amp;&amp;</span><br><span class="line">            ((ek = e.key) == key ||</span><br><span class="line">             (ek != null &amp;&amp; key.equals(ek)))) &#123;</span><br><span class="line">            oldVal = e.val;</span><br><span class="line">            if (!onlyIfAbsent)</span><br><span class="line">                e.val = value;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">Node</span><span class="title">&lt;K</span>,V&gt; pred = e;</span><br><span class="line">        if ((e = e.next) == null) &#123;</span><br><span class="line">            pred.next = new <span class="keyword">Node</span><span class="title">&lt;K</span>,V&gt;(hash, key, value, null);</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、如果该节点是TreeBin类型的节点，说明是红黑树结构，则通过putTreeVal方法往红黑树中插入节点；</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (f instanceof TreeBin) &#123;</span><br><span class="line">    Node&lt;K,V&gt; p;</span><br><span class="line">    binCount = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> ((p = ((TreeBin&lt;K,V&gt;)f).<span class="built_in">putTreeVal</span>(hash, <span class="built_in">key</span>, value)) != <span class="built_in">null</span>) &#123;</span><br><span class="line">        oldVal = p.val;</span><br><span class="line">        <span class="keyword">if</span> (!onlyIfAbsent)</span><br><span class="line">            p.val = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、如果binCount不为0，说明put操作对数据产生了影响，如果当前链表的个数达到8个，则通过treeifyBin方法转化为红黑树，如果oldVal不为空，说明是一次更新操作，没有对元素个数产生影响，则直接返回旧值；</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (binCount != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD)</span><br><span class="line">        <span class="built_in">treeifyBin</span>(<span class="built_in">tab</span>, i);</span><br><span class="line">    <span class="keyword">if</span> (oldVal != <span class="built_in">null</span>)</span><br><span class="line">        <span class="keyword">return</span> oldVal;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、如果插入的是一个新节点，则执行addCount()方法尝试更新元素个数baseCount；</p>
<p>size实现<br>1.8中使用一个volatile类型的变量baseCount记录元素的个数，当插入新数据或则删除数据时，会通过addCount()方法更新baseCount，实现如下：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ((<span class="keyword">as</span> = counterCells) != <span class="literal">null</span> ||</span><br><span class="line">    !U.compareAndSwapLong(<span class="keyword">this</span>, BASECOUNT, b = baseCount, s = b + x)) &#123;</span><br><span class="line">    CounterCell a; <span class="keyword">long</span> v; <span class="keyword">int</span> m;</span><br><span class="line">    boolean uncontended = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">as</span> == <span class="literal">null</span> || (m = <span class="keyword">as</span>.length - <span class="number">1</span>) &lt; <span class="number">0</span> ||</span><br><span class="line">        (a = <span class="keyword">as</span>[ThreadLocalRandom.getProbe() &amp; m]) == <span class="literal">null</span> ||</span><br><span class="line">        !(uncontended =</span><br><span class="line">          U.compareAndSwapLong(a, CELLVALUE, v = a.<span class="keyword">value</span>, v + x))) &#123;</span><br><span class="line">        fullAddCount(x, uncontended);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (check &lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    s = sumCount();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1、初始化时counterCells为空，在并发量很高时，如果存在两个线程同时执行CAS修改baseCount值，则失败的线程会继续执行方法体中的逻辑，使用CounterCell记录元素个数的变化；</p>
<p>2、如果CounterCell数组counterCells为空，调用fullAddCount()方法进行初始化，并插入对应的记录数，通过CAS设置cellsBusy字段，只有设置成功的线程才能初始化CounterCell数组，实现如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (cellsBusy == <span class="number">0</span> &amp;&amp; counterCells == <span class="keyword">as</span> &amp;&amp;</span><br><span class="line">         U.compareAndSwapInt(<span class="keyword">this</span>, CELLSBUSY, <span class="number">0</span>, <span class="number">1</span>)) &#123;</span><br><span class="line">    boolean <span class="keyword">init</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;                           <span class="comment">// Initialize table</span></span><br><span class="line">        <span class="keyword">if</span> (counterCells == <span class="keyword">as</span>) &#123;</span><br><span class="line">            CounterCell[] rs = new CounterCell[<span class="number">2</span>];</span><br><span class="line">            rs[h &amp; <span class="number">1</span>] = new CounterCell(x);</span><br><span class="line">            counterCells = rs;</span><br><span class="line">            <span class="keyword">init</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        cellsBusy = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">init</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、如果通过CAS设置cellsBusy字段失败的话，则继续尝试通过CAS修改baseCount字段，如果修改baseCount字段成功的话，就退出循环，否则继续循环插入CounterCell对象；</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (U.compareAndSwapLong(<span class="keyword">this</span>, BASECOUNT, v = baseCount, v + x))</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>
<p>所以在1.8中的size实现比1.7简单多，因为元素个数保存baseCount中，部分元素的变化个数保存在CounterCell数组中，实现如下：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">long</span> n = sumCount();</span><br><span class="line">    <span class="keyword">return</span> ((n &lt; <span class="number">0L</span>) ? <span class="number">0</span> :</span><br><span class="line">            (n &gt; (<span class="keyword">long</span>)Integer.MAX_VALUE) ? Integer.MAX_VALUE :</span><br><span class="line">            (<span class="keyword">int</span>)n);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function">final <span class="keyword">long</span> <span class="title">sumCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    CounterCell[] <span class="keyword">as</span> = counterCells; CounterCell a;</span><br><span class="line">    <span class="keyword">long</span> sum = baseCount;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">as</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">as</span>.length; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((a = <span class="keyword">as</span>[i]) != <span class="literal">null</span>)</span><br><span class="line">                sum += a.<span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过累加baseCount和CounterCell数组中的数量，即可得到元素的总个数；</p>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-AtomicInteger]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadAtomicInteger/</url>
      <content type="html"><![CDATA[<p>JDK 里面提供的以 Atomic* 开头的类基本原理都是一致的， 都是借助了底层硬件级别的 Lock 来实现原子操作的。 本文以 AtomicInteger 为例进行讲述， 其他的类似。阅读本文前建议先阅读基础篇：<a href="https://blog.xiaomo.info/2018/jdkSourceCodeReadMemoryActor/">Java内存模型</a><br><a id="more"></a></p>
<h1 id="处理器原子操作：-3种加锁方式"><a href="#处理器原子操作：-3种加锁方式" class="headerlink" title="处理器原子操作： 3种加锁方式"></a>处理器原子操作： 3种加锁方式</h1><p>关于 CPU 的锁有如下 3 种：</p>
<ol>
<li><p>处理器自动保证基本内存操作的原子性<br>首先处理器会自动保证基本的内存操作的原子性。 处理器保证从系统内存当中读取或者写入一个字节是原子的， 意思是当一个处理器读取一个字节时， 其他处理器不能访问这个字节的内存地址。 奔腾 6 和最新的处理器能自动保证单处理器对同一个缓存行里进行 16/32/64 位的操作是原子的， 但是复杂的内存操作处理器不能自动保证其原子性， 比如跨总线宽度， 跨多个缓存行， 跨页表的访问。 但是处理器提供总线锁定和缓存锁定两个机制来保证复杂内存操作的原子性。 </p>
</li>
<li><p>使用总线锁保证原子性（开销大）<br>如果多个处理器同时对共享变量进行读改写（i++ 就是经典的读改写操作）操作， 那么共享变量就会被多个处理器同时进行操作， 这样读改写操作就不是原子的， 操作完之后共享变量的值会和期望的不一致， 举个例子：如果 i=1,我们进行两次 i++ 操作，我们期望的结果是 3，但是有可能结果是 2 。如下图<br>原因是有可能多个处理器同时从各自的缓存中读取变量i， 分别进行加一操作， 然后分别写入系统内存当中。 那么想要保证读改写共享变量的操作是原子的， 就必须保证 CPU1 读改写共享变量的时候，CPU2 不能操作缓存了该共享变量内存地址的缓存。<br>处理器使用总线锁就是来解决这个问题的。 所谓总线锁就是使用处理器提供的一个 LOCK＃ 信号，当一个处理器在总线上输出此信号时， 其他处理器的请求将被阻塞住, 那么该处理器可以独占使用共享内存。<br><img src="https://img-blog.csdn.net/20150929000908894" alt></p>
</li>
<li>用缓存锁保证原子性<br>频繁使用的内存会缓存在处理器的 L1，L2 和 L3 高速缓存里， 那么原子操作就可以直接在处理器内部缓存中进行， 并不需要声明总线锁， 在奔腾 6 和最近的处理器中可以使用“缓存锁定”的方式来实现复杂的原子性。所谓“缓存锁定”就是如果缓存在处理器缓存行中内存区域在 LOCK 操作期间被锁定，当它执行锁操作回写内存时，处理器不在总线上声言 LOCK＃ 信号，而是修改内部的内存地址，并允许它的缓存一致性机制来保证操作的原子性，因为缓存一致性机制会阻止同时修改被两个以上处理器缓存的内存区域数据，当其他处理器回写已被锁定的缓存行的数据时会起缓存行无效，在上图中，当 CPU1 修改缓存行中的 i 时使用缓存锁定，那么 CPU2 就不能同时修改缓存了 i 的缓存行， 在 CPU1 更新后， CPU2 去主存拿最新值， 从而保证了数据的一致性。</li>
</ol>
<p>但是有两种情况下处理器不会使用缓存锁定。第一种情况是：当操作的数据不能被缓存在处理器内部，或操作的数据跨多个缓存行（cache line），则处理器会调用总线锁定。第二种情况是：有些处理器不支持缓存锁定。对于 Inter486 和奔腾处理器,就算锁定的内存区域在处理器的缓存行中也会调用总线锁定。</p>
<p>以上两个机制我们可以通过 Inter 处理器提供了很多 LOCK 前缀的指令来实现。比如位测试和修改指令BTS，BTR，BTC，交换指令 XADD，CMPXCHG 和其他一些操作数和逻辑指令，比如 ADD（加），OR（或）等，被这些指令操作的内存区域就会加锁，导致其他处理器不能同时访问它。</p>
<h1 id="AtomicInteger-源码如何实现原子性"><a href="#AtomicInteger-源码如何实现原子性" class="headerlink" title="AtomicInteger 源码如何实现原子性"></a>AtomicInteger 源码如何实现原子性</h1><p>类声明：<br><code>public class AtomicInteger extends Number implements java.io.Serializable</code></p>
<p>继承了 Number， 这主要是提供方法将数值转化为 byte, double 等方便 Java 开发者使用；<br>实现了 Serializable， 为了网络传输等的序列化用， 编码时最好手动生成序列化 ID， 让 javac 编译器生成开销大， 而且可能造成意想不到的状况。</p>
<p>变量声明：<br><code>private volatile int value;</code></p>
<p>原始类型变量声明为 private 的， 这样不会发生外部修改问题（逃逸）， 如果是引用的话， 再把引用用 public 方法暴露出去那么还是会造成逃逸现象， 不过这里是原始类型， 不会出现这种情况；<br>volatile 关键字修饰， 使 value 变量的改变具有可见性， 底层实现是内存栅栏，保证每次取到的是最新值。</p>
<p>get 方法： </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> value;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>final 类型方法， 不可继承， 进一步保证线程安全。</p>
<p>自减操作： </p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getAndDecrement</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;  </span><br><span class="line">        <span class="keyword">int</span> current = <span class="built_in">get</span>();  </span><br><span class="line">        <span class="keyword">int</span> next = current - <span class="number">1</span>;  </span><br><span class="line">        <span class="keyword">if</span> (compareAndSet(current, next))  </span><br><span class="line">            <span class="keyword">return</span> current;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到 for 是一个死循环， 是采用忙等（也叫自旋）的方式不断地尝试（乐观锁）－1 操作， 直到成功才退出。<br>这里的核心是调用了 compareAndSet() 方法， 传入当前值和新值。  </p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="function"><span class="keyword">boolean</span> <span class="title">compareAndSet</span><span class="params">(<span class="keyword">int</span> expect, <span class="keyword">int</span> update)</span> </span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">return</span> unsafe.<span class="title">compareAndSwapInt</span><span class="params">(<span class="keyword">this</span>, valueOffset, expect, update)</span></span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>利用 JNI 调用底层其他语言实现的方法， 利用操作系统提供的 CAS（只要当前值和原来不一致就重新取值直到成功） 来保证原子性。</p>
<h1 id="CAS-的缺点"><a href="#CAS-的缺点" class="headerlink" title="CAS 的缺点"></a>CAS 的缺点</h1><p>基本上 Java 的 concurrent 包都是建立在 CAS 的基础上的， 甚至还包括业界一个很出名的应用于高频交易的框架 Disruptor 也是利用 CAS 来保证原子性。 但是 CAS 还是有它的缺点：</p>
<ol>
<li>ABA问题。因为 CAS 需要在操作值的时候检查下值有没有发生变化，如果没有发生变化则更新，但是如果一个值原来是A，变成了B，又变成了A，那么使用CAS进行检查时会发现它的值没有发生变化，但是实际上却变化了。ABA问题的解决思路就是使用版本号。在变量前面追加上版本号，每次变量更新的时候把版本号加一，那么A－B－A 就会变成1A-2B－3A。<br>从Java1.5开始JDK的atomic包里提供了一个类 AtomicStampedReference 来解决 ABA 问题。这个类的compareAndSet 方法作用是首先检查当前引用是否等于预期引用，并且当前标志是否等于预期标志，如果全部相等，则以原子方式将该引用和该标志的值设置为给定的更新值。</li>
<li>循环时间长开销大。自旋 CAS 如果长时间不成功，会给 CPU 带来非常大的执行开销。如果JVM能支持处理器提供的 pause 指令那么效率会有一定的提升，pause 指令有两个作用，第一它可以延迟流水线执行指令（de-pipeline）,使 CPU 不会消耗过多的执行资源，延迟的时间取决于具体实现的版本，在一些处理器上延迟时间是零。第二它可以避免在退出循环的时候因内存顺序冲突（memory order violation：内存顺序冲突一般是由伪/假共享引起，假共享是指多个 CPU 同时修改同一个缓存行的不同部分而引起其中一个CPU的操作无效，当出现这个内存顺序冲突时，CPU必须清空流水线）而引起 CPU 流水线被清空（CPU pipeline flush），从而提高 CPU 的执行效率。</li>
<li>只能保证一个共享变量的原子操作。当对一个共享变量执行操作时，我们可以使用循环CAS的方式来保证原子操作，但是对多个共享变量操作时，循环CAS就无法保证操作的原子性，这个时候就可以用锁，或者有一个取巧的办法，就是把多个共享变量合并成一个共享变量来操作。比如有两个共享变量i＝2,j=a，合并一下ij=2a，然后用CAS来操作ij。从Java1.5开始JDK提供了AtomicReference类来保证引用对象之间的原子性，你可以把多个变量放在一个对象里来进行CAS操作。</li>
</ol>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-深入了解IO的工作机制]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadIO/</url>
      <content type="html"><![CDATA[<p>I/O 问题是任何编程语言都无法回避的问题，可以说 I/O 问题是整个人机交互的核心问题，因为 I/O 是机器获取和交换信息的主要渠道。在当今这个数据大爆炸时代，I/O 问题尤其突出，很容易成为一个性能瓶颈。正因如此，所以 Java 在 I/O 上也一直在做持续的优化，如从 1.4 开始引入了 NIO，提升了 I/O 的性能。<br><a id="more"></a></p>
<h1 id="Java-的-I-O-类库的基本架构"><a href="#Java-的-I-O-类库的基本架构" class="headerlink" title="Java 的 I/O 类库的基本架构"></a>Java 的 I/O 类库的基本架构</h1><p>Java 的 I/O 操作类在包 java.io 下，大概有将近 80 个类，但是这些类大概可以分成四组，分别是：</p>
<ol>
<li>基于字节操作的 I/O 接口：InputStream 和 OutputStream</li>
<li>基于字符操作的 I/O 接口：Writer 和 Reader</li>
<li>基于磁盘操作的 I/O 接口：File</li>
<li>基于网络操作的 I/O 接口：Socket</li>
</ol>
<p>前两组主要是根据传输数据的数据格式，后两组主要是根据传输数据的方式，虽然 Socket 类并不在 java.io 包下，但是我仍然把它们划分在一起，因为我个人认为 I/O 的核心问题要么是数据格式影响 I/O 操作，要么是传输方式影响 I/O 操作，也就是将什么样的数据写到什么地方的问题，I/O 只是人与机器或者机器与机器交互的手段，除了在它们能够完成这个交互功能外，我们关注的就是如何提高它的运行效率了，而数据格式和传输方式是影响效率最关键的因素了。我们后面的分析也是基于这两个因素来展开的。</p>
<h1 id="基于字节的-I-O-操作接口"><a href="#基于字节的-I-O-操作接口" class="headerlink" title="基于字节的 I/O 操作接口"></a>基于字节的 I/O 操作接口</h1><p>基于字节的 I/O 操作接口输入和输出分别是：InputStream 和 OutputStream，InputStream 输入流的类继承层次如下图所示：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image002.png" alt></p>
<p>输入流根据数据类型和操作方式又被划分成若干个子类，每个子类分别处理不同操作类型，OutputStream 输出流的类层次结构也是类似，如下图所示：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image004.png" alt><br>这里就不详细解释每个子类如何使用了，如果不清楚的话可以参考一下 JDK 的 API 说明文档，这里只想说明两点，一个是操作数据的方式是可以组合使用的，如这样组合使用<br><code>OutputStream out = new BufferedOutputStream(new ObjectOutputStream(new FileOutputStream(&quot;fileName&quot;))；</code><br>还有一点是流最终写到什么地方必须要指定，要么是写到磁盘要么是写到网络中，其实从上面的类图中我们发现，写网络实际上也是写文件，只不过写网络还有一步需要处理就是底层操作系统再将数据传送到其它地方而不是本地磁盘。关于网络 I/O 和磁盘 I/O 我们将在后面详细介绍。</p>
<h1 id="基于字符的-I-O-操作接口"><a href="#基于字符的-I-O-操作接口" class="headerlink" title="基于字符的 I/O 操作接口"></a>基于字符的 I/O 操作接口</h1><p>不管是磁盘还是网络传输，最小的存储单元都是字节，而不是字符，所以 I/O 操作的都是字节而不是字符，但是为啥有操作字符的 I/O 接口呢？这是因为我们的程序中通常操作的数据都是以字符形式，为了操作方便当然要提供一个直接写字符的 I/O 接口，如此而已。我们知道字符到字节必须要经过编码转换，而这个编码又非常耗时，而且还会经常出现乱码问题，所以 I/O 的编码问题经常是让人头疼的问题。关于 I/O 编码问题请参考另一篇文章 <a href="https://www.ibm.com/developerworks/cn/java/j-lo-chinesecoding/" target="_blank" rel="noopener">《深入分析Java中的中文编码问题》</a>。<br>下图是写字符的 I/O 操作接口涉及到的类，Writer 类提供了一个抽象方法 write(char cbuf[], int off, int len) 由子类去实现。<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image006.png" alt></p>
<p>读字符的操作接口也有类似的类结构，如下图所示：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image008.png" alt><br>读字符的操作接口中也是 int read(char cbuf[], int off, int len)，返回读到的 n 个字节数，不管是 Writer 还是 Reader 类它们都只定义了读取或写入的数据字符的方式，也就是怎么写或读，但是并没有规定数据要写到哪去，写到哪去就是我们后面要讨论的基于磁盘和网络的工作机制。</p>
<h1 id="字节与字符的转化接口"><a href="#字节与字符的转化接口" class="headerlink" title="字节与字符的转化接口"></a>字节与字符的转化接口</h1><p>另外数据持久化或网络传输都是以字节进行的，所以必须要有字符到字节或字节到字符的转化。字符到字节需要转化，其中读的转化过程如下图所示：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image011.jpg" alt><br>InputStreamReader 类是字节到字符的转化桥梁，InputStream 到 Reader 的过程要指定编码字符集，否则将采用操作系统默认字符集，很可能会出现乱码问题。StreamDecoder 正是完成字节到字符的解码的实现类。也就是当你用如下方式读取一个文件时：</p>
<p>读取文件<br><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123; </span><br><span class="line">   StringBuffer <span class="built_in">str</span> = <span class="keyword">new</span> StringBuffer(); </span><br><span class="line">   <span class="built_in">char</span>[] buf = <span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">1024</span>]; </span><br><span class="line">   FileReader f = <span class="keyword">new</span> FileReader(<span class="string">"file"</span>); </span><br><span class="line">   <span class="keyword">while</span>(f.read(buf)&gt;<span class="number">0</span>)&#123; </span><br><span class="line">       <span class="built_in">str</span>.<span class="built_in">append</span>(buf); </span><br><span class="line">   &#125; </span><br><span class="line">   <span class="built_in">str</span>.toString(); </span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p>FileReader 类就是按照上面的工作方式读取文件的，FileReader 是继承了 InputStreamReader 类，实际上是读取文件流，然后通过 StreamDecoder 解码成 char，只不过这里的解码字符集是默认字符集。<br>写入也是类似的过程如下图所示：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image013.jpg" alt><br>通过 OutputStreamWriter 类完成，字符到字节的编码过程，由 StreamEncoder 完成编码过程。</p>
<h1 id="磁盘-I-O-工作机制"><a href="#磁盘-I-O-工作机制" class="headerlink" title="磁盘 I/O 工作机制"></a>磁盘 I/O 工作机制</h1><p>前面介绍了基本的 Java I/O 的操作接口，这些接口主要定义了如何操作数据，以及介绍了操作两种数据结构：字节和字符的方式。还有一个关键问题就是数据写到何处，其中一个主要方式就是将数据持久化到物理磁盘，下面将介绍如何将数据持久化到物理磁盘的过程。</p>
<p>我们知道数据在磁盘的唯一最小描述就是文件，也就是说上层应用程序只能通过文件来操作磁盘上的数据，文件也是操作系统和磁盘驱动器交互的一个最小单元。值得注意的是 Java 中通常的 File 并不代表一个真实存在的文件对象，当你通过指定一个路径描述符时，它就会返回一个代表这个路径相关联的一个虚拟对象，这个可能是一个真实存在的文件或者是一个包含多个文件的目录。为何要这样设计？因为大部分情况下，我们并不关心这个文件是否真的存在，而是关心这个文件到底如何操作。例如我们手机里通常存了几百个朋友的电话号码，但是我们通常关心的是我有没有这个朋友的电话号码，或者这个电话号码是什么，但是这个电话号码到底能不能打通，我们并不是时时刻刻都去检查，而只有在真正要给他打电话时才会看这个电话能不能用。也就是使用这个电话记录要比打这个电话的次数多很多。</p>
<p>何时真正会要检查一个文件存不存？就是在真正要读取这个文件时，例如 FileInputStream 类都是操作一个文件的接口，注意到在创建一个 FileInputStream 对象时，会创建一个 FileDescriptor 对象，其实这个对象就是真正代表一个存在的文件对象的描述，当我们在操作一个文件对象时可以通过 getFD() 方法获取真正操作的与底层操作系统关联的文件描述。例如可以调用 FileDescriptor.sync() 方法将操作系统缓存中的数据强制刷新到物理磁盘中。</p>
<p>下面以清单 1 的程序为例，介绍下如何从磁盘读取一段文本字符。如下图所示：</p>
<p><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image015.jpg" alt></p>
<p>当传入一个文件路径，将会根据这个路径创建一个 File 对象来标识这个文件，然后将会根据这个 File 对象创建真正读取文件的操作对象，这时将会真正创建一个关联真实存在的磁盘文件的文件描述符 FileDescriptor，通过这个对象可以直接控制这个磁盘文件。由于我们需要读取的是字符格式，所以需要 StreamDecoder 类将 byte 解码为 char 格式，至于如何从磁盘驱动器上读取一段数据，由操作系统帮我们完成。至于操作系统是如何将数据持久化到磁盘以及如何建立数据结构需要根据当前操作系统使用何种文件系统来回答，至于文件系统的相关细节可以参考另外的文章。</p>
<h1 id="Java-Socket-的工作机制"><a href="#Java-Socket-的工作机制" class="headerlink" title="Java Socket 的工作机制"></a>Java Socket 的工作机制</h1><p>Socket 这个概念没有对应到一个具体的实体，它是描述计算机之间完成相互通信一种抽象功能。打个比方，可以把 Socket 比作为两个城市之间的交通工具，有了它，就可以在城市之间来回穿梭了。交通工具有多种，每种交通工具也有相应的交通规则。Socket 也一样，也有多种。大部分情况下我们使用的都是基于 TCP/IP 的流套接字，它是一种稳定的通信协议。</p>
<p>下图是典型的基于 Socket 的通信的场景：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image017.jpg" alt><br>主机 A 的应用程序要能和主机 B 的应用程序通信，必须通过 Socket 建立连接，而建立 Socket 连接必须需要底层 TCP/IP 协议来建立 TCP 连接。建立 TCP 连接需要底层 IP 协议来寻址网络中的主机。我们知道网络层使用的 IP 协议可以帮助我们根据 IP 地址来找到目标主机，但是一台主机上可能运行着多个应用程序，如何才能与指定的应用程序通信就要通过 TCP 或 UPD 的地址也就是端口号来指定。这样就可以通过一个 Socket 实例唯一代表一个主机上的一个应用程序的通信链路了。</p>
<h1 id="建立通信链路"><a href="#建立通信链路" class="headerlink" title="建立通信链路"></a>建立通信链路</h1><p>当客户端要与服务端通信，客户端首先要创建一个 Socket 实例，操作系统将为这个 Socket 实例分配一个没有被使用的本地端口号，并创建一个包含本地和远程地址和端口号的套接字数据结构，这个数据结构将一直保存在系统中直到这个连接关闭。在创建 Socket 实例的构造函数正确返回之前，将要进行 TCP 的三次握手协议，TCP 握手协议完成后，Socket 实例对象将创建完成，否则将抛出 IOException 错误。</p>
<p>与之对应的服务端将创建一个 ServerSocket 实例，ServerSocket 创建比较简单只要指定的端口号没有被占用，一般实例创建都会成功，同时操作系统也会为 ServerSocket 实例创建一个底层数据结构，这个数据结构中包含指定监听的端口号和包含监听地址的通配符，通常情况下都是“*”即监听所有地址。之后当调用 accept() 方法时，将进入阻塞状态，等待客户端的请求。当一个新的请求到来时，将为这个连接创建一个新的套接字数据结构，该套接字数据的信息包含的地址和端口信息正是请求源地址和端口。这个新创建的数据结构将会关联到 ServerSocket 实例的一个未完成的连接数据结构列表中，注意这时服务端与之对应的 Socket 实例并没有完成创建，而要等到与客户端的三次握手完成后，这个服务端的 Socket 实例才会返回，并将这个 Socket 实例对应的数据结构从未完成列表中移到已完成列表中。所以 ServerSocket 所关联的列表中每个数据结构，都代表与一个客户端的建立的 TCP 连接。</p>
<h1 id="数据传输"><a href="#数据传输" class="headerlink" title="数据传输"></a>数据传输</h1><p>传输数据是我们建立连接的主要目的，如何通过 Socket 传输数据，下面将详细介绍。<br>当连接已经建立成功，服务端和客户端都会拥有一个 Socket 实例，每个 Socket 实例都有一个 InputStream 和 OutputStream，正是通过这两个对象来交换数据。同时我们也知道网络 I/O 都是以字节流传输的。当 Socket 对象创建时，操作系统将会为 InputStream 和 OutputStream 分别分配一定大小的缓冲区，数据的写入和读取都是通过这个缓存区完成的。写入端将数据写到 OutputStream 对应的 SendQ 队列中，当队列填满时，数据将被发送到另一端 InputStream 的 RecvQ 队列中，如果这时 RecvQ 已经满了，那么 OutputStream 的 write 方法将会阻塞直到 RecvQ 队列有足够的空间容纳 SendQ 发送的数据。值得特别注意的是，这个缓存区的大小以及写入端的速度和读取端的速度非常影响这个连接的数据传输效率，由于可能会发生阻塞，所以网络 I/O 与磁盘 I/O 在数据的写入和读取还要有一个协调的过程，如果两边同时传送数据时可能会产生死锁，在后面 NIO 部分将介绍避免这种情况。</p>
<h1 id="NIO-的工作方式"><a href="#NIO-的工作方式" class="headerlink" title="NIO 的工作方式"></a>NIO 的工作方式</h1><h2 id="BIO-带来的挑战"><a href="#BIO-带来的挑战" class="headerlink" title="BIO 带来的挑战"></a>BIO 带来的挑战</h2><p>BIO 即阻塞 I/O，不管是磁盘 I/O 还是网络 I/O，数据在写入 OutputStream 或者从 InputStream 读取时都有可能会阻塞。一旦有线程阻塞将会失去 CPU 的使用权，这在当前的大规模访问量和有性能要求情况下是不能接受的。虽然当前的网络 I/O 有一些解决办法，如一个客户端一个处理线程，出现阻塞时只是一个线程阻塞而不会影响其它线程工作，还有为了减少系统线程的开销，采用线程池的办法来减少线程创建和回收的成本，但是有一些使用场景仍然是无法解决的。如当前一些需要大量 HTTP 长连接的情况，像淘宝现在使用的 Web 旺旺项目，服务端需要同时保持几百万的 HTTP 连接，但是并不是每时每刻这些连接都在传输数据，这种情况下不可能同时创建这么多线程来保持连接。即使线程的数量不是问题，仍然有一些问题还是无法避免的。如这种情况，我们想给某些客户端更高的服务优先级，很难通过设计线程的优先级来完成，另外一种情况是，我们需要让每个客户端的请求在服务端可能需要访问一些竞争资源，由于这些客户端是在不同线程中，因此需要同步，而往往要实现这些同步操作要远远比用单线程复杂很多。以上这些情况都说明，我们需要另外一种新的 I/O 操作方式。</p>
<h2 id="NIO-的工作机制"><a href="#NIO-的工作机制" class="headerlink" title="NIO 的工作机制"></a>NIO 的工作机制</h2><p>我们先看一下 NIO 涉及到的关联类图，如下：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image019.jpg" alt></p>
<p>上图中有两个关键类：Channel 和 Selector，它们是 NIO 中两个核心概念。我们还用前面的城市交通工具来继续比喻 NIO 的工作方式，这里的 Channel 要比 Socket 更加具体，它可以比作为某种具体的交通工具，如汽车或是高铁等，而 Selector 可以比作为一个车站的车辆运行调度系统，它将负责监控每辆车的当前运行状态：是已经出战还是在路上等等，也就是它可以轮询每个 Channel 的状态。这里还有一个 Buffer 类，它也比 Stream 更加具体化，我们可以将它比作为车上的座位，Channel 是汽车的话就是汽车上的座位，高铁上就是高铁上的座位，它始终是一个具体的概念，与 Stream 不同。Stream 只能代表是一个座位，至于是什么座位由你自己去想象，也就是你在去上车之前并不知道，这个车上是否还有没有座位了，也不知道上的是什么车，因为你并不能选择，这些信息都已经被封装在了运输工具（Socket）里面了，对你是透明的。NIO 引入了 Channel、Buffer 和 Selector 就是想把这些信息具体化，让程序员有机会控制它们，如：当我们调用 write() 往 SendQ 写数据时，当一次写的数据超过 SendQ 长度是需要按照 SendQ 的长度进行分割，这个过程中需要有将用户空间数据和内核地址空间进行切换，而这个切换不是你可以控制的。而在 Buffer 中我们可以控制 Buffer 的 capacity，并且是否扩容以及如何扩容都可以控制。</p>
<p>理解了这些概念后我们看一下，实际上它们是如何工作的，下面是典型的一段 NIO 代码：</p>
<p> NIO 工作代码示例</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">public</span> void <span class="keyword">selector() </span>throws IOException &#123;</span><br><span class="line">        <span class="keyword">ByteBuffer </span><span class="keyword">buffer </span>= <span class="keyword">ByteBuffer.allocate(1024);</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">Selector </span><span class="keyword">selector </span>= <span class="keyword">Selector.open();</span></span><br><span class="line"><span class="keyword"> </span>       ServerSocketChannel ssc = ServerSocketChannel.open()<span class="comment">;</span></span><br><span class="line">        ssc.configureBlocking(false)<span class="comment">;//设置为非阻塞方式</span></span><br><span class="line">        ssc.socket().<span class="keyword">bind(new </span>InetSocketAddress(<span class="number">8080</span>))<span class="comment">;</span></span><br><span class="line">        ssc.register(<span class="keyword">selector, </span><span class="keyword">SelectionKey.OP_ACCEPT);//注册监听的事件</span></span><br><span class="line"><span class="keyword"> </span>       <span class="meta">while</span> (true) &#123;</span><br><span class="line">            Set <span class="keyword">selectedKeys </span>= <span class="keyword">selector.selectedKeys();//取得所有key集合</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">Iterator </span><span class="keyword">it </span>= <span class="keyword">selectedKeys.iterator();</span></span><br><span class="line"><span class="keyword"> </span>           <span class="meta">while</span> (<span class="keyword">it.hasNext()) </span>&#123;</span><br><span class="line">                <span class="keyword">SelectionKey </span>key = (<span class="keyword">SelectionKey) </span><span class="keyword">it.next();</span></span><br><span class="line"><span class="keyword"> </span>               <span class="meta">if</span> ((key.readyOps() &amp; <span class="keyword">SelectionKey.OP_ACCEPT) </span>== <span class="keyword">SelectionKey.OP_ACCEPT) </span>&#123;</span><br><span class="line">                    ServerSocketChannel ssChannel = (ServerSocketChannel) key.channel()<span class="comment">;</span></span><br><span class="line">                 SocketChannel sc = ssChannel.accept()<span class="comment">;//接受到服务端的请求</span></span><br><span class="line">                    sc.configureBlocking(false)<span class="comment">;</span></span><br><span class="line">                    sc.register(<span class="keyword">selector, </span><span class="keyword">SelectionKey.OP_READ);</span></span><br><span class="line"><span class="keyword"> </span>                   <span class="keyword">it.remove();</span></span><br><span class="line"><span class="keyword"> </span>               &#125; <span class="meta">else</span> <span class="meta">if</span> </span><br><span class="line">                ((key.readyOps() &amp; <span class="keyword">SelectionKey.OP_READ) </span>== <span class="keyword">SelectionKey.OP_READ) </span>&#123;</span><br><span class="line">                    SocketChannel sc = (SocketChannel) key.channel()<span class="comment">;</span></span><br><span class="line">                    <span class="meta">while</span> (true) &#123;</span><br><span class="line">                        <span class="keyword">buffer.clear();</span></span><br><span class="line"><span class="keyword"> </span>                       int n = sc.read(<span class="keyword">buffer);//读取数据</span></span><br><span class="line"><span class="keyword"> </span>                       <span class="meta">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">break;</span></span><br><span class="line"><span class="keyword"> </span>                       &#125;</span><br><span class="line">                        <span class="keyword">buffer.flip();</span></span><br><span class="line"><span class="keyword"> </span>                   &#125;</span><br><span class="line">                    <span class="keyword">it.remove();</span></span><br><span class="line"><span class="keyword"> </span>               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用 Selector 的静态工厂创建一个选择器，创建一个服务端的 Channel 绑定到一个 Socket 对象，并把这个通信信道注册到选择器上，把这个通信信道设置为非阻塞模式。然后就可以调用 Selector 的 selectedKeys 方法来检查已经注册在这个选择器上的所有通信信道是否有需要的事件发生，如果有某个事件发生时，将会返回所有的 SelectionKey，通过这个对象 Channel 方法就可以取得这个通信信道对象从而可以读取通信的数据，而这里读取的数据是 Buffer，这个 Buffer 是我们可以控制的缓冲器。</p>
<p>在上面的这段程序中，是将 Server 端的监听连接请求的事件和处理请求的事件放在一个线程中，但是在实际应用中，我们通常会把它们放在两个线程中，一个线程专门负责监听客户端的连接请求，而且是阻塞方式执行的；另外一个线程专门来处理请求，这个专门处理请求的线程才会真正采用 NIO 的方式，像 Web 服务器 Tomcat 和 Jetty 都是这个处理方式，关于 Tomcat 和 Jetty 的 NIO 处理方式可以参考文章《 Jetty 的工作原理和与 Tomcat 的比较》。</p>
<p>下图是描述了基于 NIO 工作方式的 Socket 请求的处理过程：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image021.jpg" alt><br>上图中的 Selector 可以同时监听一组通信信道（Channel）上的 I/O 状态，前提是这个 Selector 要已经注册到这些通信信道中。选择器 Selector 可以调用 select() 方法检查已经注册的通信信道上的是否有 I/O 已经准备好，如果没有至少一个信道 I/O 状态有变化，那么 select 方法会阻塞等待或在超时时间后会返回 0。上图中如果有多个信道有数据，那么将会将这些数据分配到对应的数据 Buffer 中。所以关键的地方是有一个线程来处理所有连接的数据交互，每个连接的数据交互都不是阻塞方式，所以可以同时处理大量的连接请求。</p>
<h2 id="Buffer-的工作方式"><a href="#Buffer-的工作方式" class="headerlink" title="Buffer 的工作方式"></a>Buffer 的工作方式</h2><p>上面介绍了 Selector 将检测到有通信信道 I/O 有数据传输时，通过 select() 取得 SocketChannel，将数据读取或写入 Buffer 缓冲区。下面讨论一下 Buffer 如何接受和写出数据？</p>
<p>Buffer 可以简单的理解为一组基本数据类型的元素列表，它通过几个变量来保存这个数据的当前位置状态，也就是有四个索引。如下表所示：</p>
<p>Buffer 中的参数项<br><img src="https://image.xiaomo.info/blog/buffer.png" alt></p>
<p>在实际操作数据时它们有如下关系图：</p>
<p><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image023.jpg" alt></p>
<p>我们通过 ByteBuffer.allocate(11) 方法创建一个 11 个 byte 的数组缓冲区，初始状态如上图所示，position 的位置为 0，capacity 和 limit 默认都是数组长度。当我们写入 5 个字节时位置变化如下图所示：</p>
<p><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image025.jpg" alt></p>
<p> 这时我们需要将缓冲区的 5 个字节数据写入 Channel 通信信道，所以我们需要调用 byteBuffer.flip() 方法，数组的状态又发生如下变化：<br><img src="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/image027.jpg" alt> </p>
<p>这时底层操作系统就可以从缓冲区中正确读取这 5 个字节数据发送出去了。在下一次写数据之前我们在调一下 clear() 方法。缓冲区的索引状态又回到初始位置。</p>
<p>这里还要说明一下 mark，当我们调用 mark() 时，它将记录当前 position 的前一个位置，当我们调用 reset 时，position 将恢复 mark 记录下来的值。</p>
<p>还有一点需要说明，通过 Channel 获取的 I/O 数据首先要经过操作系统的 Socket 缓冲区再将数据复制到 Buffer 中，这个的操作系统缓冲区就是底层的 TCP 协议关联的 RecvQ 或者 SendQ 队列，从操作系统缓冲区到用户缓冲区复制数据比较耗性能，Buffer 提供了另外一种直接操作操作系统缓冲区的的方式即 ByteBuffer.allocateDirector(size)，这个方法返回的 byteBuffer 就是与底层存储空间关联的缓冲区，它的操作方式与 linux2.4 内核的 sendfile 操作方式类似。</p>
<h1 id="I-O-调优"><a href="#I-O-调优" class="headerlink" title="I/O 调优"></a>I/O 调优</h1><p>下面就磁盘 I/O 和网络 I/O 的一些常用的优化技巧进行总结如下：</p>
<h2 id="磁盘-I-O-优化"><a href="#磁盘-I-O-优化" class="headerlink" title="磁盘 I/O 优化"></a>磁盘 I/O 优化</h2><p>性能检测</p>
<p>我们的应用程序通常都需要访问磁盘读取数据，而磁盘 I/O 通常都很耗时，我们要判断 I/O 是否是一个瓶颈，我们有一些参数指标可以参考：</p>
<p>如我们可以压力测试应用程序看系统的 I/O wait 指标是否正常，例如测试机器有 4 个 CPU，那么理想的 I/O wait 参数不应该超过 25%，如果超过 25% 的话，I/O 很可能成为应用程序的性能瓶颈。Linux 操作系统下可以通过 iostat 命令查看。</p>
<p>通常我们在判断 I/O 性能时还会看另外一个参数就是 IOPS，我们应用程序需要最低的 IOPS 是多少，而我们的磁盘的 IOPS 能不能达到我们的要求。每个磁盘的 IOPS 通常是在一个范围内，这和存储在磁盘的数据块的大小和访问方式也有关。但是主要是由磁盘的转速决定的，磁盘的转速越高磁盘的 IOPS 也越高。</p>
<p>现在为了提高磁盘 I/O 的性能，通常采用一种叫 RAID 的技术，就是将不同的磁盘组合起来来提高 I/O 性能，目前有多种 RAID 技术，每种 RAID 技术对 I/O 性能提升会有不同，可以用一个 RAID 因子来代表，磁盘的读写吞吐量可以通过 iostat 命令来获取，于是我们可以计算出一个理论的 IOPS 值，计算公式如下所以：</p>
<p>( 磁盘数 <em> 每块磁盘的 IOPS)/( 磁盘读的吞吐量 +RAID 因子 </em> 磁盘写的吞吐量 )=IOPS</p>
<p>RAID 策略<br><a href="https://image.xiaomo.info/blog/raid.png" target="_blank" rel="noopener"></a></p>
<h2 id="网络-I-O-优化"><a href="#网络-I-O-优化" class="headerlink" title="网络 I/O 优化"></a>网络 I/O 优化</h2><p>网络 I/O 优化通常有一些基本处理原则：</p>
<ol>
<li>一个是减少网络交互的次数：要减少网络交互的次数通常我们在需要网络交互的两端会设置缓存，比如 Oracle 的 JDBC 驱动程序，就提供了对查询的 SQL 结果的缓存，在客户端和数据库端都有，可以有效的减少对数据库的访问。关于 Oracle JDBC 的内存管理可以参考《 Oracle JDBC 内存管理》。除了设置缓存还有一个办法是，合并访问请求：如在查询数据库时，我们要查 10 个 id，我可以每次查一个 id，也可以一次查 10 个 id。再比如在访问一个页面时通过会有多个 js 或 css 的文件，我们可以将多个 js 文件合并在一个 HTTP 链接中，每个文件用逗号隔开，然后发送到后端 Web 服务器根据这个 URL 链接，再拆分出各个文件，然后打包再一并发回给前端浏览器。这些都是常用的减少网络 I/O 的办法。</li>
<li>减少网络传输数据量的大小：减少网络数据量的办法通常是将数据压缩后再传输，如 HTTP 请求中，通常 Web 服务器将请求的 Web 页面 gzip 压缩后在传输给浏览器。还有就是通过设计简单的协议，尽量通过读取协议头来获取有用的价值信息。比如在代理程序设计时，有 4 层代理和 7 层代理都是来尽量避免要读取整个通信数据来取得需要的信息。</li>
<li>尽量减少编码：通常在网络 I/O 中数据传输都是以字节形式的，也就是通常要序列化。但是我们发送要传输的数据都是字符形式的，从字符到字节必须编码。但是这个编码过程是比较耗时的，所以在要经过网络 I/O 传输时，尽量直接以字节形式发送。也就是尽量提前将字符转化为字节，或者减少字符到字节的转化过程。</li>
<li>根据应用场景设计合适的交互方式：所谓的交互场景主要包括同步与异步阻塞与非阻塞方式，下面将详细介绍。</li>
</ol>
<h2 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h2><p>所谓同步就是一个任务的完成需要依赖另外一个任务时，只有等待被依赖的任务完成后，依赖的任务才能算完成，这是一种可靠的任务序列。要么成功都成功，失败都失败，两个任务的状态可以保持一致。而异步是不需要等待被依赖的任务完成，只是通知被依赖的任务要完成什么工作，依赖的任务也立即执行，只要自己完成了整个任务就算完成了。至于被依赖的任务最终是否真正完成，依赖它的任务无法确定，所以它是不可靠的任务序列。我们可以用打电话和发短信来很好的比喻同步与异步操作。</p>
<p>在设计到 IO 处理时通常都会遇到一个是同步还是异步的处理方式的选择问题。因为同步与异步的 I/O 处理方式对调用者的影响很大，在数据库产品中都会遇到这个问题。因为 I/O 操作通常是一个非常耗时的操作，在一个任务序列中 I/O 通常都是性能瓶颈。但是同步与异步的处理方式对程序的可靠性影响非常大，同步能够保证程序的可靠性，而异步可以提升程序的性能，必须在可靠性和性能之间做个平衡，没有完美的解决办法。</p>
<h2 id="阻塞与非阻塞"><a href="#阻塞与非阻塞" class="headerlink" title="阻塞与非阻塞"></a>阻塞与非阻塞</h2><p>阻塞与非阻塞主要是从 CPU 的消耗上来说的，阻塞就是 CPU 停下来等待一个慢的操作完成 CPU 才接着完成其它的事。非阻塞就是在这个慢的操作在执行时 CPU 去干其它别的事，等这个慢的操作完成时，CPU 再接着完成后续的操作。虽然表面上看非阻塞的方式可以明显的提高 CPU 的利用率，但是也带了另外一种后果就是系统的线程切换增加。增加的 CPU 使用时间能不能补偿系统的切换成本需要好好评估。</p>
<h2 id="两种的方式的组合"><a href="#两种的方式的组合" class="headerlink" title="两种的方式的组合"></a>两种的方式的组合</h2><p>组合的方式可以由四种，分别是：同步阻塞、同步非阻塞、异步阻塞、异步非阻塞，这四种方式都对 I/O 性能有影响。下面给出分析，并有一些常用的设计用例参考。</p>
<p> 四种组合方式<br> <a href="https://image.xiaomo.info/blog/combineMethod.png" target="_blank" rel="noopener"></a><br> 虽然异步和非阻塞能够提升 I/O 的性能，但是也会带来一些额外的性能成本，例如会增加线程数量从而增加 CPU 的消耗，同时也会导致程序设计的复杂度上升。如果设计的不合理的话反而会导致性能下降。在实际设计时要根据应用场景综合评估一下。</p>
<p> 下面举一些异步和阻塞的操作实例：</p>
<p> 在 Cassandra 中要查询数据通常会往多个数据节点发送查询命令，但是要检查每个节点返回数据的完整性，所以需要一个异步查询同步结果的应用场景，部分代码如下：</p>
<p> 异步查询同步结果<br> <figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">AsyncResult</span> <span class="title">implements</span> <span class="title">IAsyncResult</span>&#123; </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">byte</span>[] result_; </span><br><span class="line">   <span class="keyword">private</span> AtomicBoolean done_ = <span class="keyword">new</span> AtomicBoolean(<span class="literal">false</span>); </span><br><span class="line">   <span class="keyword">private</span> Lock lock_ = <span class="keyword">new</span> ReentrantLock(); </span><br><span class="line">   <span class="keyword">private</span> Condition condition_; </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">long</span> startTime_; </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">AsyncResult</span>(<span class="params"></span>)</span>&#123;        </span><br><span class="line">       condition_ = lock_.newCondition();<span class="comment">// 创建一个锁</span></span><br><span class="line">       startTime_ = System.currentTimeMillis(); </span><br><span class="line">   &#125;    </span><br><span class="line"><span class="comment">/*** 检查需要的数据是否已经返回，如果没有返回阻塞 */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">byte</span>[] <span class="title">get</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">       lock_.<span class="keyword">lock</span>(); </span><br><span class="line">       <span class="keyword">try</span>&#123; </span><br><span class="line">           <span class="keyword">if</span> (!done_.<span class="keyword">get</span>())&#123;condition_.<span class="keyword">await</span>();&#125; </span><br><span class="line">       &#125;<span class="keyword">catch</span> (InterruptedException ex)&#123; </span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(ex); </span><br><span class="line">       &#125;<span class="keyword">finally</span>&#123;lock_.unlock();&#125; </span><br><span class="line">       <span class="keyword">return</span> result_; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*** 检查需要的数据是否已经返回 */</span> </span><br><span class="line">   <span class="function"><span class="keyword">public</span> boolean <span class="title">isDone</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> done_.<span class="keyword">get</span>();&#125; </span><br><span class="line"><span class="comment">/*** 检查在指定的时间内需要的数据是否已经返回，如果没有返回抛出超时异常 */</span> </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">byte</span>[] <span class="title">get</span>(<span class="params"><span class="keyword">long</span> timeout, TimeUnit tu</span>) throws TimeoutException</span>&#123; </span><br><span class="line">       lock_.<span class="keyword">lock</span>(); </span><br><span class="line">       <span class="keyword">try</span>&#123;            boolean bVal = <span class="literal">true</span>; </span><br><span class="line">           <span class="keyword">try</span>&#123; </span><br><span class="line">               <span class="keyword">if</span> ( !done_.<span class="keyword">get</span>() )&#123; </span><br><span class="line">          <span class="keyword">long</span> overall_timeout = timeout - (System.currentTimeMillis() - startTime_); </span><br><span class="line">                   <span class="keyword">if</span>(overall_timeout &gt; <span class="number">0</span>)<span class="comment">// 设置等待超时的时间</span></span><br><span class="line">                       bVal = condition_.<span class="keyword">await</span>(overall_timeout, TimeUnit.MILLISECONDS); </span><br><span class="line">                   <span class="keyword">else</span> bVal = <span class="literal">false</span>; </span><br><span class="line">               &#125; </span><br><span class="line">           &#125;<span class="keyword">catch</span> (InterruptedException ex)&#123; </span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(ex); </span><br><span class="line">           &#125; </span><br><span class="line">           <span class="keyword">if</span> ( !bVal &amp;&amp; !done_.<span class="keyword">get</span>() )&#123;<span class="comment">// 抛出超时异常</span></span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> TimeoutException(<span class="string">"Operation timed out."</span>); </span><br><span class="line">           &#125; </span><br><span class="line">       &#125;<span class="keyword">finally</span>&#123;lock_.unlock();      &#125; </span><br><span class="line">       <span class="keyword">return</span> result_; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*** 该函数拱另外一个线程设置要返回的数据，并唤醒在阻塞的线程 */</span> </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">result</span>(<span class="params">Message response</span>)</span>&#123;        </span><br><span class="line">       <span class="keyword">try</span>&#123; </span><br><span class="line">           lock_.<span class="keyword">lock</span>(); </span><br><span class="line">           <span class="keyword">if</span> ( !done_.<span class="keyword">get</span>() )&#123;                </span><br><span class="line">               result_ = response.getMessageBody();<span class="comment">// 设置返回的数据</span></span><br><span class="line">               done_.<span class="keyword">set</span>(<span class="literal">true</span>); </span><br><span class="line">               condition_.signal();<span class="comment">// 唤醒阻塞的线程</span></span><br><span class="line">           &#125; </span><br><span class="line">       &#125;<span class="keyword">finally</span>&#123;lock_.unlock();&#125;        </span><br><span class="line">   &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文阐述的内容较多，从 Java 基本 I/O 类库结构开始说起，主要介绍了磁盘 I/O 和网络 I/O 的基本工作方式，最后介绍了关于 I/O 调优的一些方法。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-Object]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadObject/</url>
      <content type="html"><![CDATA[<p>Object类是类层次结构的根，是每一个类的父类。所有的对象（包括数组）都是实现了object类的方法。<br><a id="more"></a></p>
<p>Object结构<br><img src="https://image.xiaomo.info/blog/ObjectStructure.png" alt></p>
<p>这里有7个native方法：</p>
<ul>
<li>registerNatives()</li>
<li>getClass()</li>
<li>hashCode()</li>
<li>clone()</li>
<li>notify()</li>
<li>notifyAll()</li>
<li>wait(long)</li>
</ul>
<p>什么是native方法？简单的说，native表示该方法的实现java本身并没有完成，而是有c/c++来完成，放在.dll动态库文件中。这里我们不关注本地方法的具体，我们可以看看其注释和声明，知道这些方法是干什么的。</p>
<h3 id="1）registerNatives"><a href="#1）registerNatives" class="headerlink" title="1）registerNatives()"></a>1）<code>registerNatives()</code></h3><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="function"><span class="keyword">void</span> <span class="title">registerNatives</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    registerNatives();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该方法源码中并没有任何注释说明，而且在静态块中调用了方法。首先明确在类初始化的时候，这个方法被调用执行了。<br>至于该方法的做用，请看native方法的c代码实现：这里是相关的C代码（来自OpenJDK6）：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> JNINativeMethod methods[] = &#123;</span><br><span class="line"></span><br><span class="line">　　&#123;“hashCode”, “()I”, (<span class="keyword">void</span> *)&amp;JVM_IHashCode&#125;,</span><br><span class="line"></span><br><span class="line">　　&#123;“wait”, “(J)V”, (<span class="keyword">void</span> *)&amp;JVM_MonitorWait&#125;,</span><br><span class="line"></span><br><span class="line">　　&#123;“notify”, “()V”, (<span class="keyword">void</span> *)&amp;JVM_MonitorNotify&#125;,</span><br><span class="line"></span><br><span class="line">　　&#123;“notifyAll”, “()V”, (<span class="keyword">void</span> *)&amp;JVM_MonitorNotifyAll&#125;,</span><br><span class="line"></span><br><span class="line">　　&#123;“clone”, “()Ljava/lang/Object;”, (<span class="keyword">void</span> *)&amp;JVM_Clone&#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">JNIEXPORT <span class="keyword">void</span> JNICALL</span><br><span class="line"></span><br><span class="line">Java_java_lang_Object_registerNatives(JNIEnv *env, jclass cls)</span><br><span class="line">&#123;</span><br><span class="line">　　(*env)-&gt;RegisterNatives(env, cls,methods, <span class="keyword">sizeof</span>(methods)/<span class="keyword">sizeof</span>(methods[<span class="number">0</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>详细的说：通常情况下，为了使JVM发现您的本机功能，他们被一定的方式命名。例如，对于java.lang.Object.registerNatives，对应的C函数命名为Java_java_lang_Object_registerNatives。通过使用registerNatives（或者更确切地说，JNI函数RegisterNatives），您可以命名任何你想要你的C函数。(来自：<a href="https://www.linuxidc.com/Linux/2015-06/118676.htm" target="_blank" rel="noopener">https://www.linuxidc.com/Linux/2015-06/118676.htm</a>)<br>简单的说：就是对几个本地方法进行注册(也就是初始化java方法映射到C的方法)。<br>细心的读者可能发现这里为什么没有getClass()方法的注册？因为它不需要被注册，它有一个Java_java_lang_Object_getClass的“标准”名称。</p>
<h3 id="（2）getClass"><a href="#（2）getClass" class="headerlink" title="（2）getClass()"></a>（2）getClass()</h3><p><code>public final native Class&lt;?&gt; getClass();</code></p>
<p>返回Object的运行时class对象，返回的对象是被静态同步方法锁定的对象（这意味着，该类的所有对象中，同时只有一个对象可以获得锁）。而且实际上返回的class对象是多态的，可以是调用者的子类（注释中Number的例子解释了这一内容）。</p>
<h3 id="（3）hashCode"><a href="#（3）hashCode" class="headerlink" title="（3）hashCode()"></a>（3）hashCode()</h3><p><code>public native int hashCode();</code></p>
<p>hashCode()也是一个native方法，该方法返回调用对象的hash码。hashCode必须满足以下协议：</p>
<ul>
<li>在一个Java应用中，对同一个对象多次调用hashCode()方法，必须返回相同的值。在对象被修改时，不提供equals方法的比较信息。（我的理解：不可以将hashCode值作为equals方法相等的充要条件，同一对象hashCode值肯定相等，不同对象hashCode值不一定不相等）</li>
<li>如果两个对象通过equals方法相等，那么两个对象的hashCode返回值必须要相等。</li>
<li>如果两个对象通过equals方法不相等，两个对象的hashCode返回值不一定不相等。但是程序员应该知道，不相等的对象若返回不想等的hash值，有助于提高hash表的性能。</li>
</ul>
<h3 id="（4）equals-Object-obj"><a href="#（4）equals-Object-obj" class="headerlink" title="（4）equals(Object obj)"></a>（4）equals(Object obj)</h3><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>判断两个对象是不是相等。该方法遵循如下性质：</p>
<ul>
<li>自反性：对于任意非空引用x，则x.equals(x)返回true。</li>
<li>对称性：对于任意非空引用x、y，若x.equals(y)返回true，则y.equals(x)返回true。</li>
<li>传递性：对于任意非空引用x、y、z，若x.equals(y)返回true且y.equals(z)返回true，则x.equals(z)返回true。</li>
<li>对于任何非空引用值x和y，多次调用x.equals（y）始终返回true或者始终返回false，没有提供任何信息进行相等比较的对象被修改。</li>
<li>对于任意非空引用x，则x.equals(null)返回false。</li>
<li>重写equals方法必须重写hashCode方法来保证对任意两个对象equals返回值true时，他们的hashCode返回值必须相等。</li>
</ul>
<p>请注意源码中的实现是“==”号，必要时请重写该方法！</p>
<h3 id="（5）clone"><a href="#（5）clone" class="headerlink" title="（5）clone()"></a>（5）clone()</h3><p><code>protected native Object clone() throws CloneNotSupportedException;</code></p>
<p>创建和返回一个对象的复制。注意以下几点：</p>
<p>x.clone() != x  是true</p>
<p>一个对象可以被克隆的前提是该对象代表的类实现了Cloneable接口，否者会抛出一个CloneNotSupportedException异常。</p>
<p>调用clone方法时，分配的内存和源对象（即调用clone方法的对象）相同，然后再使用原对象中对应的各个域，填充新对象的域， 填充完成之后，clone方法返回，一个新的相同的对象被创建，同样可以把这个新对象的引用发布到外部。<br>克隆是浅复制。（详情：<a href="http://www.importnew.com/22035.html" target="_blank" rel="noopener">http://www.importnew.com/22035.html</a>）</p>
<h3 id="（6）toString"><a href="#（6）toString" class="headerlink" title="（6）toString()"></a>（6）toString()</h3><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getClass().getName() + <span class="string">"@"</span> + Integer.toHexString(hashCode());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>返回一个表示该对象的字符串，默认实现是：类名@Integer.toHexString(hashCode())</p>
<p>建议子类重写该方法。</p>
<h3 id="（6）notify-、notifyAll-、wait-、wait-long-、wait-long-int"><a href="#（6）notify-、notifyAll-、wait-、wait-long-、wait-long-int" class="headerlink" title="（6）notify()、notifyAll()、wait()、wait(long)、wait(long,int)"></a>（6）notify()、notifyAll()、wait()、wait(long)、wait(long,int)</h3><p>这几个方法是多线程编程里面常用的方法，这里不多解释。</p>
<h3 id="（7）finalize"><a href="#（7）finalize" class="headerlink" title="（7）finalize()"></a>（7）finalize()</h3><p><code>protected void finalize() throws Throwable { }</code></p>
<p>这是一个被垃圾收集器调用的方法，当一个对象没有被其他引用指向时，垃圾回收器会清理该对象，在回收该对象之前会调用finalize方法。子类一般会重写该方法做一些系统资源清理工作。一个对象只会被调用一次finalize方法。如果finalize方法抛出异常，这个对象的终结将会停止。</p>
<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p><a href="https://blog.csdn.net/wenniuwuren" target="_blank" rel="noopener">wenniuwuren</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-NIO]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeReadNIO/</url>
      <content type="html"><![CDATA[<p>Java NIO和IO之间第一个区别是， IO是面向流的， NIO是面向缓冲区的。 Java IO面向流意味着每次从流中读一个或多个字节， 直至读取所有字节， 它们没有被缓存在任何地方。 JavaNIO的缓冲导向方法略有不同。 数据读取到一个它稍后处理的缓冲区， 需要时可在缓冲区中前后移动。 还需要检查是否该缓冲区中包含所有您需要处理的数据。 而且， 需确保当更多的数据读入缓冲区时， 不要覆盖缓冲区里尚未处理的数据。<br><a id="more"></a></p>
<p>另外， Java IO的各种流是阻塞的， 而Java NIO是非阻塞的。 IO是当一个线程调用read() 或write()时， 该线程被阻塞， 直到有一些数据被读取， 或数据完全写入。 该线程在此期间不能再干任何事情了。 而Java NIO的非阻塞模式， 使一个线程从某通道发送请求读取数据， 但是它仅能得到目前可用的数据， 如果目前没有数据可用时， 就什么都不会获取。 而不是保持线程阻塞， 所以直至数据变的可以读取之前， 该线程可以继续做其他的事情。 非阻塞写也是如此。 一个线程请求写入一些数据到某通道， 但不需要等待它完全写入， 这个线程同时可以去做别的事情。 而且， Java IO: 一个典型的IO服务器设计- 一个连接通过一个线程处理， 而NIO可让您只使用一个单线程管理多个通道（ 网络连接或文件） ， 但付出的代价是解析数据可能会比从一个阻塞流中读取数据更复杂。</p>
<h1 id="java-NIO主要组成部分"><a href="#java-NIO主要组成部分" class="headerlink" title="java NIO主要组成部分"></a>java NIO主要组成部分</h1><ul>
<li>Channels</li>
<li>Buffers</li>
<li>Selectors</li>
</ul>
<p>虽然Java NIO 中除此之外还有很多类和组件， 但在我看来， Channel， Buffer 和 Selector 构成了核心的API。 其它组件， 如Pipe和FileLock， 只不过是与三个核心组件共同使用的工具类。</p>
<p>Java NIO的通道类似流， 但又有些不同：</p>
<ul>
<li>既可以从通道中读取数据， 又可以写数据到通道。 但流的读写通常是单向的。</li>
<li>通道可以异步地读写。</li>
<li>通道中的数据总是要先读到一个Buffer， 或者总是要从一个Buffer中写入。</li>
</ul>
<h1 id="Channel-和-Buffer"><a href="#Channel-和-Buffer" class="headerlink" title="Channel 和 Buffer"></a>Channel 和 Buffer</h1><p>基本上， 所有的 IO 在NIO 中都从一个Channel 开始。 Channel 有点象流。 数据可以从Channel读到Buffer中， 也可以从Buffer 写到Channel中。</p>
<p>Channel和Buffer有好几种类型。 下面是JAVA NIO中的一些主要Channel的实现：</p>
<ul>
<li>FileChannel,从文件中读写数据。</li>
<li>DatagramChannel，能通过UDP读写网络中的数据</li>
<li>SocketChannel,能通过TCP读写网络中的数据</li>
<li>ServerSocketChannel,以监听新进来的TCP连接， 像Web服务器那样。 对每一个新进来的连接都会创建一个SocketChannel。<br>正如你所看到的， 这些通道涵盖了UDP 和 TCP 网络IO， 以及文件IO。</li>
</ul>
<p>基本的Channel示例</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">RandomAccessFile</span> aFile = new RandomAccessFile(<span class="string">"data/nio-data.txt"</span>, <span class="string">"rw"</span>)<span class="comment">;</span></span><br><span class="line"><span class="symbol">FileChannel</span> inChannel = aFile.getChannel()<span class="comment">;</span></span><br><span class="line"><span class="keyword">ByteBuffer </span><span class="keyword">buf </span>= <span class="keyword">ByteBuffer.allocate(48);</span></span><br><span class="line"><span class="keyword">int </span><span class="keyword">bytesRead </span>= inChannel.read(<span class="keyword">buf);</span></span><br><span class="line"><span class="keyword">while </span>(<span class="keyword">bytesRead </span>!= -<span class="number">1</span>) &#123;</span><br><span class="line">    System.out.println(<span class="string">"Read "</span> + <span class="keyword">bytesRead);</span></span><br><span class="line"><span class="keyword"> </span>   <span class="keyword">buf.flip();</span></span><br><span class="line"><span class="keyword"> </span>   <span class="meta">while</span> (<span class="keyword">buf.hasRemaining()) </span>&#123;</span><br><span class="line">        System.out.print((char) <span class="keyword">buf.get());</span></span><br><span class="line"><span class="keyword"> </span>   &#125;</span><br><span class="line">    <span class="keyword">buf.clear();</span></span><br><span class="line"><span class="keyword"> </span>   <span class="keyword">bytesRead </span>= inChannel.read(<span class="keyword">buf);</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br><span class="line"><span class="keyword">aFile.close();</span></span><br></pre></td></tr></table></figure>
<p>注意 buf.flip() 的调用， 首先读取数据到Buffer， 然后反转Buffer,接着再从Buffer中读取数据。</p>
<p>Java NIO中的Buffer用于和NIO通道进行交互。 如你所知， 数据是从通道读入缓冲区， 从缓冲区写入到通道中的。缓冲区本质上是一块可以写入数据， 然后可以从中读取数据的内存。 这块内存被包装成NIOBuffer对象， 并提供了一组方法， 用来方便的访问该块内存。以下是Java NIO里关键的Buffer实现：</p>
<ul>
<li>ByteBuffer</li>
<li>CharBuffer</li>
<li>DoubleBuffer</li>
<li>FloatBuffer</li>
<li>IntBuffer</li>
<li>LongBuffer</li>
<li>ShortBuffer</li>
</ul>
<p>这些Buffer覆盖了你能通过IO发送的基本数据类型： byte, short, int, long, float, double 和char。Java NIO 还有个 MappedByteBuffer， 用于表示内存映射文件。</p>
<p>当向buffer写入数据时， buffer会记录下写了多少数据。 一旦要读取数据， 需要通过flip()方法将Buffer从写模式切换到读模式。 在读模式下， 可以读取之前写入到buffer的所有数据。一旦读完了所有的数据， 就需要清空缓冲区， 让它可以再次被写入。 有两种方式能清空缓冲区： 调用clear()或compact()方法。 clear()方法会清空整个缓冲区。 compact()方法只会清除已经读过的数据。 任何未读的数据都被移到缓冲区的起始处， 新写入的数据将放到缓冲区未读数据的后面。</p>
<h1 id="Buffer的capacity-position和limit"><a href="#Buffer的capacity-position和limit" class="headerlink" title="Buffer的capacity,position和limit"></a>Buffer的capacity,position和limit</h1><ul>
<li>position<br>当你写数据到Buffer中时， position表示当前的位置。 初始的position值为0.当一个byte、 long等数据写到Buffer后， position会向前移动到下一个可插入数据的Buffer单元。 position最大可为capacity – 1.当读取数据时， 也是从某个特定位置读。 当将Buffer从写模式切换到读模式， position会被重置为0. 当从Buffer的position处读取数据时， position向前移动到下一个可读的位置。</li>
<li>limit<br>在写模式下， Buffer的limit表示你最多能往Buffer里写多少数据。 写模式下， limit等于Buffer的capacity。当切换Buffer到读模式时， limit表示你最多能读到多少数据。 因此， 当切换Buffer到读模式时， limit会被设置成写模式下的position值。 换句话说， 你能读到之前写入的所有数据（ limit被设置成已写数据的数量， 这个值在写模式下就是position）</li>
</ul>
<h3 id="向Buffer中写数据"><a href="#向Buffer中写数据" class="headerlink" title="向Buffer中写数据"></a>向Buffer中写数据</h3><p>写数据到Buffer有两种方式：<br>从Channel写到Buffer。<br>通过Buffer的put()方法写到Buffer里。</p>
<h3 id="从Buffer中读取数据"><a href="#从Buffer中读取数据" class="headerlink" title="从Buffer中读取数据"></a>从Buffer中读取数据</h3><p>从Buffer中读取数据有两种方式：<br>从Buffer读取数据到Channel。<br>使用get()方法从Buffer中读取数据。</p>
<h1 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h1><p>Selector（ 选择器） 是Java NIO中能够检测一到多个NIO通道， 并能够知晓通道是否为诸如读写事件做好准备的组件。 这样， 一个单独的线程可以管理多个channel， 从而管理多个网络连接。Selector允许单线程处理多个 Channel。 如果你的应用打开了多个连接（ 通道） ， 但每个连接的流量都很低， 使用Selector就会很方便。 例如， 在一个聊天服务器中</p>
<h1 id="为什么使用Selector"><a href="#为什么使用Selector" class="headerlink" title="为什么使用Selector?"></a>为什么使用Selector?</h1><p>仅用单个线程来处理多个Channels的好处是， 只需要更少的线程来处理通道。 事实上， 可以只用一个线程处理所有的通道。 对于操作系统来说， 线程之间上下文切换的开销很大， 而且每个线程都要占用系统的一些资源（ 如内存） 。 因此， 使用的线程越少越好。</p>
<h3 id="Selector的创建"><a href="#Selector的创建" class="headerlink" title="Selector的创建"></a>Selector的创建</h3><p>通过调用Selector.open()方法创建一个Selector， 如下：<br><code>Selector selector = Selector.open();</code></p>
<p><img src="https://image.xiaomo.info/blog/selector.png" alt><br>要使用Selector， 得向Selector注册Channel， 然后调用它的select()方法。 这个方法会一直阻塞到某个注册的通道有事件就绪。 一旦这个方法返回， 线程就可以处理这些事件， 事件的例子有如新连接进来， 数据接收等。与Selector一起使用时， Channel必须处于非阻塞模式下。这意味着不能将FileChannel与Selector一起使用， 因为FileChannel不能切换到非阻塞模式。而套接字通道都可以。</p>
 <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">channel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">SelectionKey key = channel.<span class="keyword">register</span>(selector, Selectionkey.OP_READ);</span><br></pre></td></tr></table></figure>
<p> 注意register()方法的第二个参数。 这是一个“interest集合”， 意思是在通过Selector监听Channel时对什么事件感兴趣。 可以监听四种不同类型的事件</p>
<ul>
<li>SelectionKey.OP_CONNECT</li>
<li>SelectionKey.OP_ACCEPT</li>
<li>SelectionKey.OP_READ</li>
<li>SelectionKey.OP_WRITE</li>
</ul>
<p>如果你对不止一种事件感兴趣， 那么可以用“位或”操作符将常量连接起来， 如下:<br><code>int interestSet = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</code></p>
<h1 id="Scatter-Gather"><a href="#Scatter-Gather" class="headerlink" title="Scatter/Gather"></a>Scatter/Gather</h1><p>Java NIO开始支持scatter/gather， scatter/gather可以从Channel中读入和读取数据。分散（ scatter） 从Channel中读取是指在读操作时将读取的数据写入多个buffer中。 因此，Channel将从Channel中读取的数据“分散（ scatter） ”到多个Buffer中。聚集（ gather） 写入Channel是指在写操作时将多个buffer的数据写入同一个Channel， 因此，Channel 将多个Buffer中的数据“聚集（ gather） ”后发送到Channel。scatter / gather经常用于需要将传输的数据分开处理的场合， 例如传输一个由消息头和消息体组成的消息， 你可能会将消息体和消息头分散到不同的buffer中， 这样你可以方便的处理消息头和消息体</p>
<h1 id="Scattering-Reads"><a href="#Scattering-Reads" class="headerlink" title="Scattering Reads"></a>Scattering Reads</h1><p> Scattering Reads是指数据从一个channel读取到多个buffer中。</p>
 <figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ByteBuffer </span>header = <span class="keyword">ByteBuffer.allocate(128);</span></span><br><span class="line"><span class="keyword">ByteBuffer </span><span class="keyword">body </span>= <span class="keyword">ByteBuffer.allocate(1024);</span></span><br><span class="line"><span class="keyword">ByteBuffer[] </span><span class="keyword">bufferArray </span>= &#123; header, <span class="keyword">body </span>&#125;<span class="comment">;</span></span><br><span class="line"><span class="symbol">channel.read</span>(<span class="keyword">bufferArray);</span></span><br></pre></td></tr></table></figure>
<p> read()方法按照buffer在数组中的顺序将从channel中读取的数据写入到buffer， 当一个buffer被写满后， channel紧接着向另一个buffer中写。Scattering Reads在移动下一个buffer前， 必须填满当前的buffer， 这也意味着它不适用于动态消息(译者注： 消息大小不固定)。 换句话说， 如果存在消息头和消息体， 消息头必须完成填充（ 例如 128byte） ， Scattering Reads才能正常工作</p>
<h1 id="Gathering-Writes"><a href="#Gathering-Writes" class="headerlink" title="Gathering Writes"></a>Gathering Writes</h1><p> Gathering Writes是指数据从多个buffer写入到同一个channel。</p>
 <figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ByteBuffer </span>header = <span class="keyword">ByteBuffer.allocate(128);</span></span><br><span class="line"><span class="keyword">ByteBuffer </span><span class="keyword">body </span>= <span class="keyword">ByteBuffer.allocate(1024);</span></span><br><span class="line"><span class="keyword">//write </span><span class="meta">data</span> into <span class="keyword">buffers</span></span><br><span class="line"><span class="keyword">ByteBuffer[] </span><span class="keyword">bufferArray </span>= &#123; header, <span class="keyword">body </span>&#125;<span class="comment">;</span></span><br><span class="line"><span class="symbol">channel.write</span>(<span class="keyword">bufferArray);</span></span><br></pre></td></tr></table></figure>
<p> buffers数组是write()方法的入参， write()方法会按照buffer在数组中的顺序， 将数据写入到channel， 注意只有position和limit之间的数据才会被写入。 因此， 如果一个buffer的容量为128byte， 但是仅仅包含58byte的数据,那么这58byte的数据将被写入到channel中。 因此 Scattering Reads相反， Gathering Writes能较好的处理动态消息。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-throwable和Exception的区别]]></title>
      <url>https://blog.xiaomo.info/2018/throwableAndException/</url>
      <content type="html"><![CDATA[<p>在写代码的时候Exception随手就来，但是提到Throwable总觉得又熟悉又陌生。<br><a id="more"></a></p>
<p>先上图为敬<br><img src="https://image.xiaomo.info/blog/throwable.jpg" alt></p>
<p>从上图可以看出,throwable是Exception的父类，它包含了系统级的Error和程序级的Exception,所以接触的少倒也不足为奇。</p>
<h1 id="什么是异常"><a href="#什么是异常" class="headerlink" title="什么是异常"></a>什么是异常</h1><p>异常的英文单词是exception，字面翻译就是“意外、例外”的意思，也就是非正常情况。事实上，异常本质上是程序上的错误，包括程序逻辑错误和系统错误。比如使用空的引用、数组下标越界、内存溢出错误等，这些都是意外的情况，背离我们程序本身的意图。错误在我们编写程序的过程中会经常发生，包括编译期间和运行期间的错误，在编译期间出现的错误有编译器帮助我们一起修正，然而运行期间的错误便不是编译器力所能及了，并且运行期间的错误往往是难以预料的。假若程序在运行期间出现了错误，如果置之不理，程序便会终止或直接导致系统崩溃，显然这不是我们希望看到的结果。因此，如何对运行期间出现的错误进行处理和补救呢？Java提供了异常机制来进行处理，通过异常机制来处理程序运行期间出现的错误。通过异常机制，我们可以更好地提升程序的健壮性。</p>
<h1 id="什么是错误"><a href="#什么是错误" class="headerlink" title="什么是错误"></a>什么是错误</h1><p>是程序无法处理的错误，表示运行应用程序中较严重问题。大多数错误与代码编写者执行的操作无关，而表示代码运行时 JVM（Java 虚拟机）出现的问题。例如，Java虚拟机运行错误（Virtual MachineError），当 JVM 不再有继续执行操作所需的内存资源时，将出现 OutOfMemoryError。这些异常发生时，Java虚拟机（JVM）一般会选择线程终止。这些错误表示故障发生于虚拟机自身、或者发生在虚拟机试图执行应用时，如Java虚拟机运行错误（Virtual MachineError）、类定义错误（NoClassDefFoundError）等。这些错误是不可查的，因为它们在应用程序的控制和处理能力之 外，而且绝大多数是程序运行时不允许出现的状况。对于设计合理的应用程序来说，即使确实发生了错误，本质上也不应该试图去处理它所引起的异常状况。在 Java中，错误通过Error的子类描述。</p>
<h1 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h1><p>注意：异常和错误的区别：异常能被程序本身可以处理，错误是无法处理。通常，Java的异常(包括Exception和Error)分为可查的异常（checked exceptions）和不可查的异常（unchecked exceptions）。<br>可查异常（编译器要求必须处置的异常）：正确的程序在运行中，很容易出现的、情理可容的异常状况。可查异常虽然是异常状况，但在一定程度上它的发生是可以预计的，而且一旦发生这种异常状况，就必须采取某种方式进行处理。<br>除了RuntimeException及其子类以外，其他的Exception类及其子类都属于可查异常。这种异常的特点是Java编译器会检查它，也就是说，当程序中可能出现这类异常，要么用try-catch语句捕获它，要么用throws子句声明抛出它，否则编译不会通过。</p>
<h1 id="应该catch什么"><a href="#应该catch什么" class="headerlink" title="应该catch什么"></a>应该catch什么</h1><p>其实只要是Throwable和其子类都是可以throw和catch的，那么如果在需要统一处理异常的地方，我们应该catch (Throwable th) 还是 catch (Exception)呢？<br>这两种处理的区别在于，catch throwable会把Error和其他继承Throwable的类捕捉到。而catch Exception只会捕捉Exception极其子类，捕捉的范围更小。先不考虑有其他的类继承了Throwable的情况下，第一种catch相当于比第二种catch多捕捉了把Error和其子类。<br>那么究竟Error是否需要捕捉呢？JDK中Error类的的注释（如下）里提到过，Error是一种严重的问题，应用程序不应该捕捉它。 </p>
<h1 id="Error可以catch吗？-可以catch了后做些其他处理吗？"><a href="#Error可以catch吗？-可以catch了后做些其他处理吗？" class="headerlink" title="Error可以catch吗？ 可以catch了后做些其他处理吗？"></a>Error可以catch吗？ 可以catch了后做些其他处理吗？</h1><p>Error是可以catch的，而且也可以向常规Exception一样被处理，而且就算不捕捉的话也只是导致当前线程挂掉，其他线程还是可以正常运行，如果有需要的话捕捉Error之后也可以做些其他处理。但是Error是一种系统内部的错误，这种错误不像Exception一样是可能是程序和业务上的错误是可以恢复的。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jdk源码系列-顺序索引]]></title>
      <url>https://blog.xiaomo.info/2018/jdkSourceCodeRead/</url>
      <content type="html"><![CDATA[<p>很多java开发的小伙伴都会阅读jdk源码，然而确不知道应该从哪读起。以下为通常所需阅读的源码范围。 标题为包名，后面序号为优先级1-4，优先级递减<br><a id="more"></a></p>
<h1 id="1、java-lang"><a href="#1、java-lang" class="headerlink" title="1、java.lang"></a>1、java.lang</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Object <span class="number">1</span></span><br><span class="line"><span class="number">2</span>) String <span class="number">1</span></span><br><span class="line"><span class="number">3</span>) AbstractStringBuilder <span class="number">1</span></span><br><span class="line"><span class="number">4</span>) StringBuffer <span class="number">1</span></span><br><span class="line"><span class="number">5</span>) StringBuilder <span class="number">1</span></span><br><span class="line"><span class="number">6</span>) Boolean <span class="number">2</span></span><br><span class="line"><span class="number">7</span>) Byte <span class="number">2</span></span><br><span class="line"><span class="number">8</span>) Double <span class="number">2</span></span><br><span class="line"><span class="number">9</span>) Float <span class="number">2</span></span><br><span class="line"><span class="number">10</span>) Integer <span class="number">2</span></span><br><span class="line"><span class="number">11</span>) Long <span class="number">2</span></span><br><span class="line"><span class="number">12</span>) Short <span class="number">2</span></span><br><span class="line"><span class="number">13</span>) Thread <span class="number">2</span></span><br><span class="line"><span class="number">14</span>) ThreadLocal <span class="number">2</span></span><br><span class="line"><span class="number">15</span>) Enum <span class="number">3</span></span><br><span class="line"><span class="number">16</span>) Throwable <span class="number">3</span></span><br><span class="line"><span class="number">17</span>) Error <span class="number">3</span></span><br><span class="line"><span class="number">18</span>) Exception <span class="number">3</span></span><br><span class="line"><span class="number">19</span>) Class <span class="number">4</span></span><br><span class="line"><span class="number">20</span>) ClassLoader <span class="number">4</span></span><br><span class="line"><span class="number">21</span>) Compiler <span class="number">4</span></span><br><span class="line"><span class="number">22</span>) System <span class="number">4</span></span><br><span class="line"><span class="number">23</span>) Package <span class="number">4</span></span><br><span class="line"><span class="number">24</span>) Void <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-util"><a href="#java-util" class="headerlink" title="java.util"></a>java.util</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) AbstractList <span class="number">1</span></span><br><span class="line"><span class="number">2</span>) AbstractMap <span class="number">1</span></span><br><span class="line"><span class="number">3</span>) AbstractSet <span class="number">1</span></span><br><span class="line"><span class="number">4</span>) ArrayList <span class="number">1</span></span><br><span class="line"><span class="number">5</span>) LinkedList <span class="number">1</span></span><br><span class="line"><span class="number">6</span>) HashMap <span class="number">1</span></span><br><span class="line"><span class="number">7</span>) Hashtable <span class="number">1</span></span><br><span class="line"><span class="number">8</span>) HashSet <span class="number">1</span></span><br><span class="line"><span class="number">9</span>) LinkedHashMap <span class="number">1</span></span><br><span class="line"><span class="number">10</span>) LinkedHashSet <span class="number">1</span></span><br><span class="line"><span class="number">11</span>) TreeMap <span class="number">1</span></span><br><span class="line"><span class="number">12</span>) TreeSet <span class="number">1</span></span><br><span class="line"><span class="number">13</span>) Vector <span class="number">2</span></span><br><span class="line"><span class="number">14</span>) Queue <span class="number">2</span></span><br><span class="line"><span class="number">15</span>) Stack <span class="number">2</span></span><br><span class="line"><span class="number">16</span>) SortedMap <span class="number">2</span></span><br><span class="line"><span class="number">17</span>) SortedSet <span class="number">2</span></span><br><span class="line"><span class="number">18</span>) Collections <span class="number">3</span></span><br><span class="line"><span class="number">19</span>) Arrays <span class="number">3</span></span><br><span class="line"><span class="number">20</span>) Comparator <span class="number">3</span></span><br><span class="line"><span class="number">21</span>) Iterator <span class="number">3</span></span><br><span class="line"><span class="number">22</span>) Base64 <span class="number">4</span></span><br><span class="line"><span class="number">23</span>) Date <span class="number">4</span></span><br><span class="line"><span class="number">24</span>) EventListener <span class="number">4</span></span><br><span class="line"><span class="number">25</span>) Random <span class="number">4</span></span><br><span class="line"><span class="number">26</span>) SubList <span class="number">4</span></span><br><span class="line"><span class="number">27</span>) Timer <span class="number">4</span></span><br><span class="line"><span class="number">28</span>) UUID <span class="number">4</span></span><br><span class="line"><span class="number">29</span>) WeakHashMap <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-util-concurrent"><a href="#java-util-concurrent" class="headerlink" title="java.util.concurrent"></a>java.util.concurrent</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) ConcurrentHashMap <span class="number">1</span></span><br><span class="line"><span class="number">2</span>) Executor <span class="number">2</span></span><br><span class="line"><span class="number">3</span>) AbstractExecutorService <span class="number">2</span></span><br><span class="line"><span class="number">4</span>) ExecutorService <span class="number">2</span></span><br><span class="line"><span class="number">5</span>) ThreadPoolExecutor <span class="number">2</span></span><br><span class="line"><span class="number">6</span>) BlockingQueue <span class="number">2</span></span><br><span class="line"><span class="number">7</span>）AbstractQueuedSynchronizer <span class="number">2</span></span><br><span class="line"><span class="number">8</span>）CountDownLatch <span class="number">2</span></span><br><span class="line"><span class="number">9</span>) FutureTask <span class="number">2</span></span><br><span class="line"><span class="number">10</span>）Semaphore <span class="number">2</span></span><br><span class="line"><span class="number">11</span>）CyclicBarrier <span class="number">2</span></span><br><span class="line"><span class="number">13</span>）CopyOnWriteArrayList <span class="number">3</span></span><br><span class="line"><span class="number">14</span>）SynchronousQueue <span class="number">3</span></span><br><span class="line"><span class="number">15</span>）BlockingDeque <span class="number">3</span></span><br><span class="line"><span class="number">16</span>) Callable <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-util-concurrent-atomic"><a href="#java-util-concurrent-atomic" class="headerlink" title="java.util.concurrent.atomic"></a>java.util.concurrent.atomic</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) AtomicBoolean <span class="number">2</span></span><br><span class="line"><span class="number">2</span>) AtomicInteger <span class="number">2</span></span><br><span class="line"><span class="number">3</span>) AtomicLong <span class="number">2</span></span><br><span class="line"><span class="number">4</span>) AtomicReference <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="java-lang-reflect"><a href="#java-lang-reflect" class="headerlink" title="java.lang.reflect"></a>java.lang.reflect</h1><figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Field <span class="number">2</span></span><br><span class="line"><span class="number">2</span>) <span class="function"><span class="keyword">Method</span> 2</span></span><br></pre></td></tr></table></figure>
<h1 id="java-lang-annotation"><a href="#java-lang-annotation" class="headerlink" title="java.lang.annotation"></a>java.lang.annotation</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Annotation <span class="number">3</span></span><br><span class="line"><span class="number">2</span>) Target <span class="number">3</span></span><br><span class="line"><span class="number">3</span>) Inherited <span class="number">3</span></span><br><span class="line"><span class="number">4</span>) Retention <span class="number">3</span></span><br><span class="line"><span class="number">5</span>) Documented <span class="number">4</span></span><br><span class="line"><span class="number">6</span>) ElementType <span class="number">4</span></span><br><span class="line"><span class="number">7</span>) Native <span class="number">4</span></span><br><span class="line"><span class="number">8</span>) Repeatable <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-util-concurrent-locks"><a href="#java-util-concurrent-locks" class="headerlink" title="java.util.concurrent.locks"></a>java.util.concurrent.locks</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Lock <span class="number">2</span></span><br><span class="line"><span class="number">2</span>) Condition <span class="number">2</span></span><br><span class="line"><span class="number">3</span>) ReentrantLock <span class="number">2</span></span><br><span class="line"><span class="number">4</span>) ReentrantReadWriteLock <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h1 id="java-nio"><a href="#java-nio" class="headerlink" title="java.nio"></a>java.nio</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Buffer <span class="number">3</span></span><br><span class="line"><span class="number">2</span>) ByteBuffer <span class="number">4</span></span><br><span class="line"><span class="number">3</span>) CharBuffer <span class="number">4</span></span><br><span class="line"><span class="number">4</span>) DoubleBuffer <span class="number">4</span></span><br><span class="line"><span class="number">5</span>) FloatBuffer <span class="number">4</span></span><br><span class="line"><span class="number">6</span>) IntBuffer <span class="number">4</span></span><br><span class="line"><span class="number">7</span>) LongBuffer <span class="number">4</span></span><br><span class="line"><span class="number">8</span>) ShortBuffer <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-sql"><a href="#java-sql" class="headerlink" title="java.sql"></a>java.sql</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Connection <span class="number">3</span></span><br><span class="line"><span class="number">2</span>) Driver <span class="number">3</span></span><br><span class="line"><span class="number">3</span>) DriverManager <span class="number">3</span></span><br><span class="line"><span class="number">4</span>) JDBCType <span class="number">3</span></span><br><span class="line"><span class="number">5</span>) ResultSet <span class="number">4</span></span><br><span class="line"><span class="number">6</span>) Statement <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="java-net"><a href="#java-net" class="headerlink" title="java.net"></a>java.net</h1><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Socket <span class="number">3</span></span><br><span class="line"><span class="number">2</span>) ServerSocket <span class="number">3</span></span><br><span class="line"><span class="number">3</span>) URI <span class="number">4</span></span><br><span class="line"><span class="number">4</span>) URL <span class="number">4</span></span><br><span class="line"><span class="number">5</span>) URLEncoder <span class="number">4</span></span><br></pre></td></tr></table></figure>
<hr>
<p>阅读笔记简版</p>
<h1 id="1、Object"><a href="#1、Object" class="headerlink" title="1、Object"></a>1、Object</h1> <figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">1</span>) <span class="selector-tag">wait</span>(), <span class="selector-tag">notify</span>(), <span class="selector-tag">notifyAll</span>(), <span class="selector-tag">wait</span>(timeout) </span><br><span class="line"><span class="selector-tag">2</span>) <span class="selector-tag">hashCode</span>(), <span class="selector-tag">equals</span>() </span><br><span class="line"><span class="selector-tag">3</span>) <span class="selector-tag">clone</span>()</span><br></pre></td></tr></table></figure>
<h1 id="2、String"><a href="#2、String" class="headerlink" title="2、String"></a>2、String</h1><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="keyword">char</span>[] <span class="keyword">value</span> </span><br><span class="line"><span class="number">2</span>) <span class="keyword">int</span> hash </span><br><span class="line"><span class="number">3</span>) <span class="keyword">equals</span>(), startWith(), endWith(), replace</span><br></pre></td></tr></table></figure>
<h1 id="3、AbstractStringBuilder"><a href="#3、AbstractStringBuilder" class="headerlink" title="3、AbstractStringBuilder"></a>3、AbstractStringBuilder</h1><figure class="highlight excel"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="built_in">char</span>[] <span class="built_in">value</span> </span><br><span class="line"><span class="number">2</span>) <span class="built_in">int</span> <span class="built_in">count</span> </span><br><span class="line"><span class="number">3</span>) 扩容：翻倍，不够取所需最小</span><br></pre></td></tr></table></figure>
<h1 id="4、StringBuffer"><a href="#4、StringBuffer" class="headerlink" title="4、StringBuffer"></a>4、StringBuffer</h1>  <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) 继承AbstractStringBuilder </span><br><span class="line"><span class="number">2</span>) synchronized方法保证线程安全 </span><br><span class="line"><span class="number">3</span>) char[] toStringCache</span><br></pre></td></tr></table></figure>
<h1 id="5、StringBuilder-继承AbstractStringBuilder"><a href="#5、StringBuilder-继承AbstractStringBuilder" class="headerlink" title="5、StringBuilder 继承AbstractStringBuilder"></a>5、StringBuilder 继承AbstractStringBuilder</h1><h1 id="6、ArrayList"><a href="#6、ArrayList" class="headerlink" title="6、ArrayList"></a>6、ArrayList</h1> <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Object[] elementData </span><br><span class="line"><span class="number">2</span>) int size </span><br><span class="line"><span class="number">3</span>) 默认大小<span class="number">10</span> </span><br><span class="line"><span class="number">4</span>) 扩容：翻倍，不够取所需最小</span><br></pre></td></tr></table></figure>
<h1 id="7、LinkedList"><a href="#7、LinkedList" class="headerlink" title="7、LinkedList"></a>7、LinkedList</h1> <figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="keyword">Node</span> <span class="title">&#123;E</span> item, <span class="keyword">Node</span> <span class="title">prev</span>, <span class="keyword">Node</span> <span class="title">next</span>&#125; </span><br><span class="line"><span class="number">2</span>) int size </span><br><span class="line"><span class="number">3</span>) <span class="keyword">Node</span> <span class="title">first</span> </span><br><span class="line"><span class="number">4</span>) <span class="keyword">Node</span> <span class="title">last</span> </span><br><span class="line"><span class="number">5</span>) linkFirst(), linkLast(), linkBefore(), unLinkFirst(), unLinkLast(), unLink(), indexOf()</span><br></pre></td></tr></table></figure>
<h1 id="8、HashMap"><a href="#8、HashMap" class="headerlink" title="8、HashMap"></a>8、HashMap</h1><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="keyword">Node</span><span class="title">&#123;int</span> hash, K key, V value, <span class="keyword">Node</span> <span class="title">next</span>&#125; </span><br><span class="line"><span class="number">2</span>) 默认容量<span class="number">16</span>，负载因子<span class="number">0.75</span>f </span><br><span class="line"><span class="number">3</span>) int size, modCount, threshold, float loadFactor </span><br><span class="line"><span class="number">4</span>) <span class="keyword">Node</span><span class="title">[] table</span> </span><br><span class="line"><span class="number">5</span>) Set entrySet </span><br><span class="line"><span class="number">6</span>) put():根据key算hash，根据容量和hash算index，table[index]没有直接添加到数组中，table[index]有，若index位置同一个key则更新，否则遍历next是否有，有则更新，无则新增，最后根据thread与size判断是否扩容。注：扩容时容量翻倍，重新算hash复制到新数组 </span><br><span class="line"><span class="number">7</span>）get()类似 </span><br><span class="line">注：先比较hash，若相等在比较equals</span><br></pre></td></tr></table></figure>
<h1 id="9、Hashtable"><a href="#9、Hashtable" class="headerlink" title="9、Hashtable"></a>9、Hashtable</h1> <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) 结构实现与HashMap基本一致 </span><br><span class="line"><span class="number">2</span>)通过synchronized方法保证线程安全</span><br></pre></td></tr></table></figure>
<h1 id="10、HashSet"><a href="#10、HashSet" class="headerlink" title="10、HashSet"></a>10、HashSet</h1><p> <code>委托给HashMap，其Value是同一个默认对象</code></p>
<h1 id="11、LinkedHashMap继承HashMap"><a href="#11、LinkedHashMap继承HashMap" class="headerlink" title="11、LinkedHashMap继承HashMap"></a>11、LinkedHashMap继承HashMap</h1> <figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>) Entry&#123;HashMap.Node, Entry <span class="keyword">before</span>, <span class="keyword">after</span>&#125; </span><br><span class="line">2) Entry head, tail </span><br><span class="line"><span class="number">3</span>) 重写newNode()添加节点时，除像HashMap中添加外，保存<span class="keyword">before</span>、<span class="keyword">after</span>信息</span><br></pre></td></tr></table></figure>
<h1 id="12、LinkedHashSet"><a href="#12、LinkedHashSet" class="headerlink" title="12、LinkedHashSet"></a>12、LinkedHashSet</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">继承HashSet：不知道如何实现的顺序？</span><br></pre></td></tr></table></figure>
<h1 id="13、AbstractMap"><a href="#13、AbstractMap" class="headerlink" title="13、AbstractMap"></a>13、AbstractMap</h1><p> <code>维护EntrySet，AbstractSet维护Iterator，AbstractList维护Iterator</code></p>
<h1 id="14、ConcurrentHashMap"><a href="#14、ConcurrentHashMap" class="headerlink" title="14、ConcurrentHashMap"></a>14、ConcurrentHashMap</h1> <figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">1</span>) <span class="selector-tag">JDK1</span><span class="selector-class">.7</span>及以前： </span><br><span class="line"><span class="selector-tag">a</span>、<span class="selector-tag">Segment</span><span class="selector-attr">[]</span> ,<span class="selector-tag">HashEntry</span><span class="selector-attr">[]</span> , <span class="selector-tag">HashEntry</span>&#123;<span class="selector-tag">hash</span>, <span class="selector-tag">k</span>, <span class="selector-tag">v</span>, <span class="selector-tag">next</span>&#125; </span><br><span class="line"><span class="selector-tag">b</span>、根据<span class="selector-tag">key</span>算<span class="selector-tag">hash</span>，根据<span class="selector-tag">hash</span>和<span class="selector-tag">Segment</span>的大小算位置，每个<span class="selector-tag">segment</span>拥有一个自己的<span class="selector-tag">HashEntry</span><span class="selector-attr">[]</span> </span><br><span class="line"><span class="selector-tag">c</span>、<span class="selector-tag">get</span>()：不加锁，<span class="selector-tag">volatile</span>类型 </span><br><span class="line"><span class="selector-tag">d</span>、<span class="selector-tag">put</span>(): 对相应<span class="selector-tag">segment</span>加锁 </span><br><span class="line"><span class="selector-tag">e</span>、<span class="selector-tag">size</span>()：各<span class="selector-tag">HashEntry</span><span class="selector-attr">[]</span> 之和，先不加锁算两遍，若一致则返回，若不一致则加锁重新计算 </span><br><span class="line"><span class="selector-tag">2</span>）<span class="selector-tag">JDK1</span><span class="selector-class">.8</span> </span><br><span class="line"><span class="selector-tag">a</span>、<span class="selector-tag">Node</span>&#123;<span class="selector-tag">hash</span>, <span class="selector-tag">key</span>, <span class="selector-tag">value</span>, <span class="selector-tag">next</span>&#125; </span><br><span class="line"><span class="selector-tag">b</span>、<span class="selector-tag">Node</span><span class="selector-attr">[]</span> <span class="selector-tag">table</span> </span><br><span class="line"><span class="selector-tag">c</span>、大多数操作类似于<span class="selector-tag">HashMap</span>，不同<span class="selector-tag">CAS</span>方式设置，根据<span class="selector-tag">key</span>算<span class="selector-tag">hash</span>，在根据<span class="selector-tag">hash</span>和容量算<span class="selector-tag">index</span>，对<span class="selector-tag">table</span><span class="selector-attr">[index]</span>加锁，从而达到更大的并发量 </span><br><span class="line"><span class="selector-tag">d</span>、<span class="selector-tag">get</span>(): 同<span class="selector-tag">HashMap</span> </span><br><span class="line"><span class="selector-tag">e</span>、<span class="selector-tag">put</span>(): 对<span class="selector-tag">table</span><span class="selector-attr">[index]</span>加锁</span><br></pre></td></tr></table></figure>
<h1 id="15、TreeMap"><a href="#15、TreeMap" class="headerlink" title="15、TreeMap"></a>15、TreeMap</h1> <figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>）红黑树，即自平衡二叉查找树，时间复杂度O(logn) </span><br><span class="line"><span class="number">2</span>）<span class="built_in">Entry</span>&#123;K k, V v, <span class="built_in">Entry</span> parent, left, right, boolean color&#125; </span><br><span class="line"><span class="number">3</span>）<span class="built_in">Entry</span> root，<span class="built_in">int</span> <span class="built_in">size</span>， <span class="built_in">int</span> modeCount</span><br></pre></td></tr></table></figure>
<h1 id="16、TreeSet"><a href="#16、TreeSet" class="headerlink" title="16、TreeSet"></a>16、TreeSet</h1><p><code>委托TreeMap实现</code></p>
<h1 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h1><p><a href="https://blog.csdn.net/qq_21033663/article/details/79571506" target="_blank" rel="noopener">https://blog.csdn.net/qq_21033663/article/details/79571506</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jdk源码系列 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[我的书架]]></title>
      <url>https://blog.xiaomo.info/2018/myBookSheet/</url>
      <content type="html"><![CDATA[<p>在如今数据爆炸的年代，如果在大量数据中找到自己需要的那部分东西至关重关。在我关注的领域中，常伴我的那些经典之作奉给各位。<br><a id="more"></a></p>
<h3 id="鸟哥的Linux私房菜—基础学习篇"><a href="#鸟哥的Linux私房菜—基础学习篇" class="headerlink" title="鸟哥的Linux私房菜—基础学习篇"></a><a href="https://book.douban.com/subject/4889838/" target="_blank" rel="noopener">鸟哥的Linux私房菜—基础学习篇</a></h3><p><img src="https://img1.doubanio.com/lpic/s4399937.jpg" alt><br>个人评价：这本书对于学习Linux基础知识非常有帮助，既可以当成教科书也可以当成工具，很多服务是运行在linux这类操作系统之中的，学习一些linux知识是很有必要的。比如vim，makefile, 常用的linux命令，脚本编写等等知识点。虽然次数的名字不是像类似“深入浅出<strong><strong>”，“深入理解*</strong></strong>”等那么高大上一些，但是如果要掌握一些linux知识，此书评价可看此大任。当然此书还有另一本，是服务架设篇，如果对此有兴趣的朋友可以买来看看。书中基本没有错别字，笔误等小错误，可见其背后的团队之认真。<br>评分：5分（满分5分，这个给5分不是说此书已经登峰造极，而是觉得以目前关于此类的书籍，已经是上品了）<br>提示：此书篇幅较大（可以和《Think in Java》的篇幅相比），内容较多，看个一两遍基本也记不住多少，还是要勤加练习，更多的可以当工具书来查阅。</p>
<hr>
<h3 id="Effective-Java"><a href="#Effective-Java" class="headerlink" title="Effective Java"></a><a href="https://book.douban.com/subject/3360807/" target="_blank" rel="noopener">Effective Java</a></h3><p><img src="https://img3.doubanio.com/lpic/s3479802.jpg" alt><br>个人评价：了解过Java的人应该或多或少的听过此书吧，堪称经典。书中主要罗列了一些知识点，然后对于这些知识点单独进行详述。内容颇有深度，建议有基础的人看。<br>题外话：很多人认为《Think in Java》是经典之作，当然博主也写不出《Think in Java》这类巨作，但是博主本人并不推荐《Think in Java》这本书，应该他的定位很尴尬（博主看过第三版和 第四版），就拿第四版来说，对于初学者看起来应该是很吃力的，尤其是书中的案例特别长，而且是用外国人的思维去举例的，初学者看起来比较扯淡。那对于实力者而言，这本书的意义就是帮你复习复习，却很难有知识点去惊艳到你。再者就是这本书也不是当工具书，书中例子很多，但是对于单个的知识点未尽其细。所以博主的观点是这本书适合闲来看看，不喜请轻喷。。。<br>评分：5分。<br>提示：无。</p>
<hr>
<h3 id="Java并发编程实战"><a href="#Java并发编程实战" class="headerlink" title="Java并发编程实战"></a><a href="https://book.douban.com/subject/10484692/" target="_blank" rel="noopener">Java并发编程实战</a></h3><p><img src="https://img3.doubanio.com/lpic/s7663093.jpg" alt><br>个人评价：国外人写的书，这是翻译版，原书《Java Concurrency In Practice》,堪称并发中的经典书籍。翻译的也很好，书本内容偏理论，基本知识点都能够概括。当然这本书还是需要有一点的并发基础的人适合看的，零基础的看起来会有点吃力。此书可以看好多遍，每看一遍都会有新的认识。<br>评分：5分。<br>提示：无。</p>
<hr>
<h3 id="Java多线程编程核心技术"><a href="#Java多线程编程核心技术" class="headerlink" title="Java多线程编程核心技术"></a><a href="https://book.douban.com/subject/26555197/" target="_blank" rel="noopener">Java多线程编程核心技术</a></h3><p><img src="https://img3.doubanio.com/lpic/s28238985.jpg" alt><br>个人评价：此书是国人写的，适合零基础的人学习，里面每一个知识点都会有案例介绍。如果你有那么点基础，此书就不用看了，纯粹是浪费时间浪费钱。其实会点并发的一天就可以看完此书了。既然是多线程核心技术，连ThreadPoolExecutor都没有涉及。书中基本是关于Thread和Runnable翻来覆去的用法。<br>评分：2分。<br>提示：不建议看，实在闲得慌或者基本零基础可以看看。</p>
<hr>
<h3 id="Java并发编程的艺术"><a href="#Java并发编程的艺术" class="headerlink" title="Java并发编程的艺术"></a><a href="https://book.douban.com/subject/26591326/" target="_blank" rel="noopener">Java并发编程的艺术</a></h3><p><img src="https://img1.doubanio.com/lpic/s28275418.jpg" alt><br>个人评价：此书是阿里人也的书，一共有三个作者，第一作者是方腾飞，也是并发编程网的创始人，如果在网上搜索并发编程的相关知识，或多或少的会链接到他的网站上去。此书开篇就很有深度，比如偏向锁、自旋锁、轻量级锁等。前面6章都很不错，理解的非常深入，很底层，后面开始有点撑版面的，尤其是Atomic这一章出现了严重的错误，有点凤头鸡尾的感觉。但是总体上来看还是很不错的，非常推荐买来看看。<br>评分：4分<br>提示：强烈推荐，只不过尾部几章写的太草率，扣点分</p>
<hr>
<h3 id="深入理解Java虚拟机"><a href="#深入理解Java虚拟机" class="headerlink" title="深入理解Java虚拟机"></a><a href="https://book.douban.com/subject/24722612/" target="_blank" rel="noopener">深入理解Java虚拟机</a></h3><p><img src="https://img3.doubanio.com/lpic/s27458236.jpg" alt><br>个人评价：此书也甚为经典，博主看了不下5遍。此书的作者是国内的，在市场上面滥竽充数横行的今天，算得上是上上品。书中对JVM进行了详细深刻的说明，是学习JVM原理必备书籍。必须强烈推荐。<br>评分：5分<br>提示：无</p>
<hr>
<h3 id="大型网站技术架构核心原理与案例分析"><a href="#大型网站技术架构核心原理与案例分析" class="headerlink" title="大型网站技术架构核心原理与案例分析"></a><a href="https://book.douban.com/subject/25723064/" target="_blank" rel="noopener">大型网站技术架构核心原理与案例分析</a></h3><p><img src="https://img3.doubanio.com/lpic/s27250675.jpg" alt><br>个人评价：如果要学习分布式，这本书基本把分布式的知识讲了个边（概论），书本篇幅不大，但是内容特别精炼，比如网站架构演变，高可用，高性能，伸缩性等等。此书的作者和下面所要陈述的两本书的作者也都是阿里系的。个人觉得学习分布式或者说大型网站架构可以先看看这本书来个全局统筹，然后再看《大型分布式网站架构设计与实践》，最后又实践经验了再看《大型网站系统与Java中间件实践》。<br>评分：5分<br>提示：强烈推荐。</p>
<hr>
<h3 id="大型分布式网站架构设计与实践"><a href="#大型分布式网站架构设计与实践" class="headerlink" title="大型分布式网站架构设计与实践"></a><a href="https://book.douban.com/subject/25972633/" target="_blank" rel="noopener">大型分布式网站架构设计与实践</a></h3><p><img src="https://img3.doubanio.com/lpic/s27444272.jpg" alt><br>个人评价：刚刚那本书是关于大型分布式网站架构的一个概论，而这本就根据作者的经历，在实际中需要用到的一些知识对这个主题进行了一番探讨，偏应用，书中罗列了很多技术，也进行了案例探讨，内容不深。此书值得看一看。<br>评分：4分<br>提示：最好实际操作一下，加深印象。</p>
<hr>
<h3 id="大型网站系统与Java中间件实践"><a href="#大型网站系统与Java中间件实践" class="headerlink" title="大型网站系统与Java中间件实践"></a><a href="https://book.douban.com/subject/25867042/" target="_blank" rel="noopener">大型网站系统与Java中间件实践</a></h3><p><img src="https://img1.doubanio.com/lpic/s27269837.jpg" alt><br>个人评价：这本书比上面两本要深一点，主要是关于一些中间件的设计。这里的并不是简单的教你怎么使用一些中间件，而是根据实际问题来演变怎么设计一个合适的中间件，适合有一定相关工作经验的人翻阅。可以买来看看，写的很不错<br>评分：4.5分<br>提示：最好有相关工作或学习经验。</p>
<hr>
<h3 id="netty实战"><a href="#netty实战" class="headerlink" title="netty实战"></a><a href="https://book.douban.com/subject/27038538/" target="_blank" rel="noopener">netty实战</a></h3><p><img src="https://img3.doubanio.com/lpic/s29444565.jpg" alt><br>个人评价：在游戏行业中，如果用java做服务端。无非只有netty,mina,grizzly3个框架可以选择。而netty是使用最广泛的一个,netty实战对于netty框架进行了全面的剖析。<br>评分：4.8分<br>提示：需要有多线程并发基础。</p>
<hr>
<h3 id="Head-First-设计模式"><a href="#Head-First-设计模式" class="headerlink" title="Head First 设计模式"></a><a href="https://book.douban.com/subject/2243615/" target="_blank" rel="noopener">Head First 设计模式</a></h3><p><img src="https://img3.doubanio.com/lpic/s2686916.jpg" alt><br>简介：《Head First设计模式》(中文版)共有14章，每章都介绍了几个设计模式，完整地涵盖了四人组版本全部23个设计模式。前言先介绍这本书的用法；第1章到第11章陆续介绍的设计模式为Strategy、Observer、Decorator、Abstract Factory、Factory Method、Singleton，Command、Adapter、Facade、TemplateMethod、Iterator、Composite、State、Proxy。最后三章比较特别。第12章介绍如何将两个以上的设计模式结合起来成为新的设计模式(例如著名的MVC模式)，作者称其为复合设计模式(这是作者自创的名称，并非四人组的标准名词)，第13章介绍如何进一步学习设计模式，如何发觉新的设计模式等主题，至于第14章则很快地浏览尚未介绍的设计模式，包括Bridge、Builder、Chain of Responsibility、Flyweight、Interpreter、Mediator、Memento、Prototype，Visitor。第1章还介绍了四个○○基本概念(抽象、封装、继承、多态)，而第1章到第9章也陆续介绍了九个○○原则(Principle)。千万不要轻视这些○○原则，因为每个设计模式背后都包含了几个○○原则的概念。很多时候，在设计时有两难的情况，这时候我们必须回归到○○原则，以方便判断取舍。可以这么说：○○原则是我们的目标，而设计模式是我们的做法。<br>评分：4.5分<br>提示：设计模式基础</p>
<hr>
<h3 id="重构：改善既有代码的设计"><a href="#重构：改善既有代码的设计" class="headerlink" title="重构：改善既有代码的设计"></a><a href="https://book.douban.com/subject/1229923/" target="_blank" rel="noopener">重构：改善既有代码的设计</a></h3><p><img src="https://img3.doubanio.com/lpic/s1669771.jpg" alt><br>简介：《重构:改善既有代码的设计》(中文版)解释重构的原理（principles）和最佳实践方式（best practices），并指出何时何地你应该开始挖掘你的代码以求改善。《重构:改善既有代码的设计》(中文版)的核心是一份完整的重构名录（catalog of refactoring），其中每一项都介绍一种经过实证的代码变换手法（code transformation）的动机和技术。某些项目如Extract Method和Move Field看起来可能很浅显，但不要掉以轻心，因为理解这类技术正是有条不紊地进行重构的关键。点击进入该书更多详细信息。<br>评分：4.6分<br>提示：java架构</p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[项目上线之后遇到的坑]]></title>
      <url>https://blog.xiaomo.info/2018/onlineProjectKen/</url>
      <content type="html"><![CDATA[<p>现在真正理解了能力越强，责任越来。这是我在作为一个普通程序时从未体会到的感受。当线上出现bug需要紧急处理的时候，真的生无可恋 。<br><a id="more"></a></p>
<ul>
<li>压测时数据库文件庞大无比，仔细分析binlog和玩家数据结构找到原因改造。</li>
<li>竞技场战斗结束没有结算面板，导致大量参与活动者无法退出副本。</li>
<li>每日充值奖励策划配置id变动导致充值奖励领取异常，写修复脚本紧急处理。</li>
<li>因sql文件名字对应不上，运维未执行sql文件导致所有排行榜数据为空。</li>
<li>http切换https(ws切换到wss)时域名解析对不上导致服务器无法连通</li>
<li>自动开服工具开服时间修改不完整导致开服活动未开</li>
<li>运营设置时间错误导致自动开服工具开服出现断服,新服30,39己成老服</li>
<li>热更脚本问题导致全平台黑屏10分钟</li>
<li>其他bug待发现(感觉需要请高僧给服务器开个光)</li>
</ul>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[主程职责总结和反思]]></title>
      <url>https://blog.xiaomo.info/2018/mainProjectJobs/</url>
      <content type="html"><![CDATA[<p>有生之年作为主程做的第一款游戏终于正式上线了(之前有2款作为普通程序的己上线的游戏),虽然现在依然保持着一周加班6天的状态。但是欣慰的是上线数据表现还不错，值得期待。做主程时间也有半年多了，从最初的手忙脚乱，诚惶诚恐到现在能够较好的应对，其中心酸历程只有经历过才能体会到。即使如此还是有很多做的不够的地方值得反思，要提升自己的综合素质。<br><a id="more"></a></p>
<p>在网络上搜集了各种资料和自己的经验（大部分内容摘自网络,主要也是为了提醒自己），总结如下：    </p>
<ul>
<li>服务端主程主要负责游戏开发中服务端的各项工作    </li>
<li>包含但不限于：解决团队中别人解决不了的问题，制作提升工作效率的工具；</li>
<li>服务端技术人员管理</li>
<li>向上有汇报，向下能统筹</li>
<li>尽可能的快速实现策划的需求，提供解决方案</li>
<li>达到一个里程碑后能反馈，遇到难点短时间无法攻克，及时沟通，并说说自己能做到的程度，帮助策划思考替换方案；</li>
<li>改需求无法避免。（网上产品经理（策划）是被各种程序员黑，现实中调侃调侃可以，别过了，人家也是没办法。）</li>
<li>会反思，策划的功能对吗?为何有会这么设计？配表方便吗？</li>
<li>手下心中的好大哥，人品过关，技术过关。</li>
<li>保持对新技术的好奇心，多关注业内比较新的解决方案。因为一旦做新项目，技术选型就是你的本职工作，而且影响整个项目周期，换句话说到底未来需要踩多少坑，由你决定。所以你要有一套经过实践证明行之有效的学习方法论</li>
</ul>
<p>对于一个刚刚晋升的同学来说，管理这一块是最棘手的，对于我来说也是这个阶段。这块其实也比较通用，不限于技术管理领域，但是管理这东西不能靠书本，在实践中总结，才是深刻的。你是主程了，那就意味这有一堆人会看着你做事。你怎么做事将间接的影响组员的做事态度。所以一个词——以身作则。别以为主程了就可以有些特权，可以迟到，可以工作时间扯淡，始终牢记：能力越大，责任越大。之所以把这条列在这里，我觉得管理包括自我管理和团队管理,而且前者是后者的基础；以前吧，你只要把自己的事情做好就算完成本职工作了，超出边界的工作，你做了那是加分，你的主程看到了或许还能表扬你，你不做也没关系。而现在你的事情就是整个游戏的服务端（甚至整个技术），任何报错，组员解决不了的诡异的bug，那都是你要解决的事情。</p>
<ul>
<li>你的工作会被各种打断，来自各位组员，主策，主美，项目经理。所以整片的工作时间几乎只在这些人都回家了，你留下来加班才能获得。</li>
<li>可能你还有一件事情，就是给每个组员打绩效，项目经理说，SABCD各占一定比例，所以给你出个难题，你想想你怎么解决：这个月是项目上线前夕,大家表现得都很拼，都很优秀，你怎么打绩效。</li>
<li>你的内心要足够强大，因为会有人质疑你的决策。</li>
<li>你的沟通表达能力需要提升一个档次，因为你要给各个层次的人解释同一个问题;</li>
<li>你会有许多跨部门的沟通；</li>
<li>你的组织能力要跟上节奏，定期组织这帮程序单身男“腐败”,严谨点叫团建。还要开技术分享会议。</li>
<li>你要保持谦虚，明白个人能力再强，都不可能解决所有事情，你需要咨询你的组员。再优秀的人都有他的短板，你要做就是把一群互补的人凑在一起，各自发挥优势。</li>
<li>你要给组员尽可能清晰地提供上升阶梯。多年以后，当他成为主程了，你可以骄傲地对他说 我曾经推动过你的进步。</li>
<li>你最好能充分了解你的组员,分配任务要有明确的范围，不能存在模糊地带，要能给与一定的帮助。</li>
<li>你的组员能力不均匀，做事情不要一刀切，换句话说管理要分层, 不同层关注点不同</li>
<li>你是Leader，不是Boss。在雇佣关系中，好人谈钱，坏人谈理想。所以多为组员谋取福利吧。</li>
<li>你其实也是个打工的对项目经理负责，所以要有汇报</li>
<li>谁都不希望加班，但问题总得解决，更要命的是你还不知道怎么解决。咱们程序和美术不一样，美术基本上是工作量的事情，程序会有bug，deadline就在那里，问题还没解决怎么办？</li>
</ul>
<p>一． 以德服人而不以技术高管制别人。<br>主程序一般技术水平高，在管理下面的程序的时候，多以自己的水平高而获得大家的认可，但是技术水平高和项目管理水平高不是同一个概念。一个技术水平高的主程序不一定能管好人，能带好人。如果以技术水平高自居，对下面的人肆意对待，他无法赢得项目成员的拥戴，无法获得大家的认可。程序员不是实现产品功能的工具，他是具备思考感情的人。在我所遇到的主程序中，有的很好，技术水平高，做事分明，不以水平高自居，而以自己的人格魅力赢得大家的尊重；有的则难言其好，技术水平高，但做事有针对性，常以水平高自居，对不服从的人进行压制。不同的风格，会产生不同的结果。我在此想说的是，一个人的技术是不可能永远保持先进性，而一个人的品德则可以永恒的。工作除了满足生活的需要之外，它带给人的还有快乐。一个优秀的主程序，应该公平、公正的对待每一个人，以德服人。让每个跟从的人体验到你不仅仅是技术水平高，人格更高。</p>
<p>二． 自由、共享、开放而不是限制、保守、自封。<br>主程序在项目中，对核心技术常常保留，隐藏，不公开，以防别人了解，学习，泄露，进而走进一个限制、保守、自封的怪圈。其实技术保留是没有错的，但是在这个自由、共享、开放的世界中，有时候是行不通的。因为中国的程序员有多少原创的技术呢？多是在互联网上，查查资料，共享下别人的经验，然后加以改造，修改，实现功能。每个人都应该很清楚，我们查询的资料是哪里来的呢？是那些有志于自由 ，共享，开放的有识之士发布的，我们从别人哪里学习，而我们为什么不把我们的经验心得也以自由，共享，开放的心态与天下的程序员共享呢？限制、保守、自封不利于技术的进步，不利于人才的成长。如果为限制、保守、自封找个理由，那就是为自己保留饭碗，惧怕被竞争。</p>
<p>三． 优秀的代码不一定创造优秀的产品，它只是更好的为产品服务；<br>优秀的产品并不一定建立在优秀的代码上，而是建立在市场和用户基础上。一个优秀的主程序，除了做好本身的编程，架构，设计工作外，更多的精力应放在如何设计优秀的产品而不是如何编写优秀的代码，产品是和市场赛跑，产品是和时间赛跑。抓住市场的先机，快速的创造出合格的产品比把心思放在如何写出优秀的代码价值大的多。衡量一个产品的成功，不是靠评价代码的优劣，而是靠是否赢得市场，是否赢得用户的欢迎。主程序常犯的一个错误是这行代码应该这样写，哪行代码应该那样写，完成的功能在不断的修改，修改。时间就这样消磨掉，推出产品上市的日期就被无限制的拖延下去。从而失去了市场的先机，走向失败。所以在我看来，一个优秀的主程序应该能够控制好时间，对市场的嗅觉要灵敏，对用户的把握要准确，只有这样才能保证产品能够在预期内推向市场，赢得成功。</p>
<p>四． 善于接纳意见，切忌专断<br>主程序有个很大的毛病就是专断，总是相信自己是对的，别人的意见不愿听从。先前曾经和一个主程序做事，他工作大概7年了，经验也很丰富，技术水平也很高。但是他做事的风格让人很难接受，在项目中要求别人必须绝对的服从，不容许有意见。即使项目组成员提出了合理的意见，也只是点头但不当回事。妄自尊大，孤傲自负的主程序，对项目是百害而无一利的。主程序要懂得尊重别人。只有互相尊重才有利于合作的愉快，项目顺利的完成。经验对于每一个来说，都可以随着工作阅历的增长而增长；技术水平也可以随着工作阅历的增长而提高。但是人格魅力，品德修养却非一朝一夕炼成的。懂得如何做人比什么都重要。具有人格魅力的主程序总是得到大家的赞赏。</p>
<p>五． 合理安排任务，不搞个人主义<br>在项目中，有的和主程序关系不错，主程序在安排任务时就把重要的模块分配给他，让其他人打酱油。这种做法不值得提倡和发扬。公平合理的安排任务，不搞个人主义，这也是对主程序的一个基本要求。从客观的说，项目中人人平等，每个人都应该得到应用的锻炼机会。在不影响项目进度的情况下，我们应该如何合理的安排任务呢？我们应该积极的和策划沟通，对每一个功能点，每一个细节进行衡量，判断所需要的时间，然后分配给项目组的成员。但是有的主程序的做法是自己先列出一个宏观计划，对某某A说，这个月你搞定这个；对某某B说，这个月你搞定那个。这种没有对每一个功能点进行细化的做法的结果就是，项目进度无限制性的延期。经验教训表明：宏观计划和微观计划二者是合而为一的，缺一不可的。</p>
<p>有些人，工作了很多年了，但差不多每年换一次工作，因为很多游戏研发周期只有1年多，结束就走人。然后最后手里会积累大量的代码资源，这些资源有可能是别人的，也肯定有自己的一部分，但是这个时候如果没有融汇贯通，那么这些东西都不是自己的，他手里的资源也就像一个人家里买了很多书但是从来不看一样，暴殄天物，可是一般情况一个人也看不了这么多的东西，最简单的道理就是msdn了，这就有了第一点的要求，能够进行大量的信息索引。就是说一个主程必须要有足够多的见识，同时必须要能够快速针对当前项目碰到的问题定位，并且在自己的知识库里找出来。当然我们不可能储存足够的信息在以后的工作中来用。但是必须要有快速上手一个新的项目的能力，如果项目中有大量的超出自己知识范围的东西存在，那么我的建议是放弃在这个项目中间做主程，因为无法准确评估项目需要开发的时间，无法把握功能难点。</p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[fastjson的key为非字符串的处理]]></title>
      <url>https://blog.xiaomo.info/2018/fastjson/</url>
      <content type="html"><![CDATA[<p>fastjson己然成为最为流行的Json处理框架,今天在处理json的时候发现默认以long型为key时解析会失败,网上搜索无果但最终还是发现了解决方法<br><a id="more"></a></p>
<h2 id="fastJson的toJSONString"><a href="#fastJson的toJSONString" class="headerlink" title="fastJson的toJSONString"></a>fastJson的toJSONString</h2><p>toJSONString有多个重载,默认一个参数的是没有做特殊处理的,也就是说如果key中存在非字符串会解析失败.<br><img src="https://image.xiaomo.info/json/json.png" alt></p>
<h2 id="处理办法"><a href="#处理办法" class="headerlink" title="处理办法"></a>处理办法</h2><p>SerializerFeature这个枚举类有很多选项,从中我们可以找到把非字符串转成字符串的操作.<br><code>String resStr = JSON.toJSONString(ret, SerializerFeature.WriteNonStringKeyAsString);</code><br><img src="https://image.xiaomo.info/json/correct.png" alt></p>
<h2 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h2><p>总感觉自己能力不足看不懂框架的源码所以不去看,这样技术进步会很慢.遇到问题可以debug跟进源码看一看是什么原因.对解决问题帮助很大.</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> json </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2017年终总结(关于最近的琐事的一些碎碎念)]]></title>
      <url>https://blog.xiaomo.info/2017/saikennokoto/</url>
      <content type="html"><![CDATA[<p>最近忙的真的有点晕头转向的,觉得自己的脑袋不够用了。<br><a id="more"></a></p>
<p>&nbsp; &nbsp; 今年正月初七上班,初五从家出发。赶上项目上线，从初七开始到现在为止一直没有休息过，晚上回家11到到凌晨2点不等。如果你在杭州，一定会对3.5号晚上的狂风印象深刻，我差点都回不了家。<br>当时的情况是这样的。。<br><img src="https://image.xiaomo.info/blog/359.jpg" alt></p>
<p><embed src="https://image.xiaomo.info/blog/354.mp4" height="800" width="600"><br>好在回家比较晚，到家凌晨2点半，回家的时候风己经停了。</p>
<hr>
<p>好好梳理下最近做的事情（因为3.11号要回家结婚被强行催着做）。</p>
<ul>
<li>游戏系统功能修改</li>
<li>SDK接入（贪玩，上士，9377）</li>
<li>待上线版本性能优化（数据库数据拆分，日志）</li>
<li>充值系统重构</li>
<li>代码优化和BUG修复</li>
<li>装备极品属性系统开发</li>
<li>后台API接口开发（充值，封号，禁言，白名单）</li>
<li>过包服务器的搭建</li>
</ul>
<p>不知道有没有人体会过，手的速度跟不上思考的速度，敲到最后手腕疼的像搬了很多重物一样。由于睡眠时间不足，整天都是迷糊的状态，再加上公司搬迁，在上班的时候又加喷了油漆，真的感觉整个人都不好了。上班的时候人人都戴着口罩，但是油漆味会完全穿透口罩进入呼吸系统。后来有不少小伙伴买了防毒面具，这也是个神奇的经历了。见下图：<br><img src="https://image.xiaomo.info/blog/39.png" alt></p>
<hr>
<p>值得高兴了的，千呼万唤始出来，我们的项目终于上线了。因为《蓝月争霸H5》这个项目是我从立项到上线全程作为一个主程的角色参与的，我敢没说有人比我对服务端的代码更熟悉了。所以也有一种特殊的感情在里面，就像养了几十年的女儿终于要出嫁了，也会激动的老泪纵横。也可能是因为这是自己第一个倾注的大量心血的项目，所以会多愁善感一些。真心希望项目能够蒸蒸上，获得该有的回报。项目地址：</p>
<hr>
<p>安卓下载链接：<a href="https://download.tanwan.com/h5lyzbxy/h5lyzbxy_155723.apk" target="_blank" rel="noopener">https://download.tanwan.com/h5lyzbxy/h5lyzbxy_155723.apk</a><br>IOS链接：<a href="https://itunes.apple.com/cn/app/id1296175622?mt=8" target="_blank" rel="noopener">https://itunes.apple.com/cn/app/id1296175622?mt=8 </a><br>web端： <a href="http://h5.tanwan.com/game/?id=490" target="_blank" rel="noopener">http://h5.tanwan.com/game/?id=490</a>         </p>
<hr>
<p>这是一款传奇题材的egret + java 开发养成类挂机游戏,算是弱交互的rpg游戏，有传奇情怀的玩家可以玩一下(比较烧钱)。</p>
<p>&nbsp; &nbsp; 从前年开始断断续续开始学日语，从一开始的单纯喜欢日漫到后来去日本旅游后喜欢日本的文化，喜欢这个国度。因为工作占了整个生活的绝大部分时间，导致学日语的时间很少，连续考了2次N2都没过，开始有点沮丧了，但是我绝对不会放弃的。几十年来坚持下来的两个兴趣：编程和语言(日语/英语)，我会一如既往的坚持着，N2,N1，流畅自如。已经3月了，我准备继续报6月份的考试，给自己一点动力。活到考，学到老。让我秉承着这一信念一直下去吧。工作上来说，时光荏苒，一晃已经工作了3年了。从最初的小菜鸟到现在能够独立带项目，把自己的经验和心得教给自己的组员，而且大部分组员学历都比我要高，更加促使着我不断学习。在项目开发期间不断的有猎头和阿里/蚂蚁等公司看到我的github之后联系我问考不考虑换工作，我都以项目太忙为由回掉了。不过有次阿里的技术找了我几次也比较好奇阿里需要什么样的人就同意了下电面。本来因为一点准备都没有，而且自己能力上的不足被狠狠虐了一把（问的都是一些实现原理，jvm优化,mysql性能调优相关的连环炮就不展开说了，有兴趣可以加我详聊）。感觉自己现在的能力勉强能达到阿里P6的标准？我自己也不知道，我只知道自己需要学的东西还很多。而且随着工作时间的增加，这种感觉越明显。2008年暑假买了C语言的书来看，看的一知半解。大学期间自学java,写了无数遍的hello world 不知道到底能做什么。15年毕业之后正式入行，夜夜在慕课网/极客学院/传智播客等自学网站长期霸榜，仿佛回到了高三那一年充实无比。也庆幸自己不算懒惰，使得不算聪明的我在互联网行业站稳脚步。每当有同事知道我是文科出身，半路出家都一脸惊讶。我觉得没什么了不起的，因为我不想像我同学一样没有一技之长只能去当客服。我向往远方，去了解未知的事物;梦想着环游世界，走遍每一个角落。希望自己有生之年能够财务自由，是为了兴趣而活，而不是仅仅为了生存。<br><img src="https://image.xiaomo.info/blog/imooc.png" alt></p>
<hr>
<p>&nbsp; &nbsp; 2015年大部分时间在看java web,沉迷于框架不能自拔。学习spring,mybatis,spring boot ,hibernate等各种框架的使用，从来没想过实现原理。2016年迷上所见即所得的前端，在空闲时间研究html,css,scss,less,gulp,webpack,angular等前端技术，发现前端并没有想像中简单，现在的前端已经不是以前那样照着psd写写静态就可以了，浏览器适配，首屏加载，代码混淆，编译等新名词不断出现，感觉像发现了一个新的世界。2017年公司新项目立项，我有幸担任主程一职，开始了解游戏的整体框架和底层依赖jar包源码。2017年我对java的使用理解更加的深入，开始有意无意的去了解更底层的一些东西。开始研究 设计模式，代码重构，代码整洁之道，netty实战等相关的知识。能够用一些简单的设计模式思想去解决问题，养成了代码优化重构的习惯。能够快速定位问题并解决问题，对业务需求得心应手。我想这就是能力的快速提高吧，感谢我的领导对我的信息和栽培，让我有机会接触到这些东西。2018年，我想我会回归到java的jdk上来，去看一看优秀的jdk源码。自己去实现一个迭代器，或者自己实现在一个hashmap之类的东西，不能只知其然而不知其所以然。最后我希望2018我的个人能力能够进上一层楼，在杭州安个家。</p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之基础环境搭建]]></title>
      <url>https://blog.xiaomo.info/2017/AngularEnvironment/</url>
      <content type="html"><![CDATA[<p>曾经的angular环境搭建都能把人的折腾的死去活来,现在的福音是官方的<code>@angular/cli</code>脚手架工具的功能己经相当完备.<br><a id="more"></a></p>
<h3 id="基本环境"><a href="#基本环境" class="headerlink" title="基本环境"></a>基本环境</h3><h4 id="angular模块"><a href="#angular模块" class="headerlink" title="angular模块"></a>angular模块</h4><ul>
<li><code>@angular/animations 5.0.0</code></li>
<li><code>@angular/common 5.0.0</code></li>
<li><code>@angular/compiler 5.0.0</code></li>
<li><code>@angular/core 5.0.0</code></li>
<li><code>@angular/forms 5.0.0</code></li>
<li><code>@angular/http 5.0.0</code></li>
<li><code>@angular/platform-browser 5.0.0</code></li>
<li><code>@angular/platform-browser-dynamic 5.0.0</code></li>
<li><code>@angular/router 5.0.0</code></li>
<li><code>@angular/cli 1.5.5</code></li>
</ul>
<h4 id="重要的默认第三方依赖"><a href="#重要的默认第三方依赖" class="headerlink" title="重要的默认第三方依赖"></a>重要的默认第三方依赖</h4><ol>
<li><code>core-js 2.4.1</code>     </li>
<li><code>rxjs 5.5.2</code>          </li>
<li><code>zone.js 0.8.14</code>          </li>
</ol>
<h3 id="三大模块"><a href="#三大模块" class="headerlink" title="三大模块"></a>三大模块</h3><p>组件、路由、模块</p>
<h3 id="cli功能"><a href="#cli功能" class="headerlink" title="cli功能"></a>cli功能</h3><ul>
<li><code>ng serve</code> 启动一个http在4200端口,1.5.5版本使用webpack打包，不排除以后的版本会使用rollup</li>
<li><code>ng generate directive|pipe|service|class|guard|interface|enum|module</code> 可以生成不组的文件</li>
<li><code>ng build</code> 构建项目 <code>ng build --prod -- iot</code>是打包生产环境</li>
<li><code>ng test</code> 执行单元测试(karma)</li>
<li><code>ng e2e</code>  执行集成测试(Protractor)</li>
<li><code>ng lint</code> 检查代码风格</li>
<li><code>ng help</code> 查看全部帮助</li>
</ul>
<h3 id="组件树插件"><a href="#组件树插件" class="headerlink" title="组件树插件"></a>组件树插件</h3><p><a href="https://github.com/filso/ng-dependency-graph/" target="_blank" rel="noopener">ng-dependency-graph</a></p>
]]></content>
      
        <categories>
            
            <category> angular </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[StackOverFlow提问的艺术]]></title>
      <url>https://blog.xiaomo.info/2017/HowToAskQuestionOnStackOverFlow/</url>
      <content type="html"><![CDATA[<p>stackOverFlow现在不仅是一个社区，更是一个程序员的聚集地，就像古代高手云集的江湖。合理的使用它不仅能够方便自己，更能够帮助别人。我最喜欢的两个网站:<a href="https://github.com/houko" target="_blank" rel="noopener">github</a>和<a href="https://stackoverflow.com/users/5804125/xiaomo" target="_blank" rel="noopener">stackOverFlow</a><br><a id="more"></a></p>
<h1 id="提问相关"><a href="#提问相关" class="headerlink" title="提问相关"></a>提问相关</h1><h2 id="可以问什么样的主题"><a href="#可以问什么样的主题" class="headerlink" title="可以问什么样的主题"></a>可以问什么样的主题</h2><p>大家都知道 Stack Overflow是编程类的问答社区， 但还真有人把它当成通用的问答社区了， 问些完全无关的问题。 其实， Stack Overflow 是有一系列兄弟网站的（目前已经有100+)， 统称 Stack Exchange， 涵盖很多主题， 比如数学、物理、化学等科学类， 服务器管理、Latex、数据库等计算机类， 中文、俄文、日文等语言类， 详细的列表看这里， 不要让好问题问错地方哦。<br>允许的主题包括： 具体的编程问题、软件算法相关、通常只有程序员用的软件工具相关等。<br>有些主题是比较容易弄错的， 比如一般的电脑操作问题， 应该去Super User(热门的 Linux/Unix, 和Ubuntu还有独立的站点）， 专业的服务器问题， 应该去Server Fault。这些都不属于编程类的问题， 尽管不少程序员的日常工作也有涉及（想一想“怎么修电脑？”属于编程问题么）。 再举个例子， 同样是编辑器， Vim/Emacs/Atom相关的问题是可以的，因为基本只有程序员会用这些工具， 而 Word/记事本相关的一般就不可以。</p>
<h2 id="什么样的问题应该避免问"><a href="#什么样的问题应该避免问" class="headerlink" title="什么样的问题应该避免问"></a>什么样的问题应该避免问</h2><p>编程相关还不够， Stack Overflow 要求问题必须是 「practical, answerable questions based on actual problems that you face」。<br>这是什么意思呢？ 首先， 开放式的问题是不允许的，比如“你为什么喜欢PHP?”， 隔壁Quora会是更合适的对象。 其次， 问题应该不需要很长的篇幅来回答， 如果一个问题期待的回答足够写一本书， 那很可能会被关闭的。 各种寻求资源的问题应该避免，如 “要完成某某工作， 有什么Python的库可以用”， 或者“学习C++应该选择哪本书？”等， 因为答案会主观， 也容易吸引广告。 最后， 问题不要基于凭空的假设，要基于实际的难题。<br>需要注意的是，你很可能见过一些违反上面规定的问题还在，而且浏览量很大， 尤其是一些寻求资源的问题， 和非编程相关的计算机问题等。 这是什么原因呢？ 原来，早期的Stack Overflow的规则还比较松，也没有Super User之类的站点。 这些问题往往是08/09年问的，大多数现在已经被关闭了。<br>上面的规则如果遵守， 你的问题应该问对地方了。 下面继续说说内容上具体需要注意的。</p>
<h2 id="直入主题"><a href="#直入主题" class="headerlink" title="直入主题"></a>直入主题</h2><p>Stack Overflow不是论坛， 它的目标是希望成为编程类问答的一个超级数据库， 所以每个问题都不止是为了帮助提问者本人， 更重要的是希望将来能够帮助到每一个遇到同样问题的人。<br>所以， 和问题无关的内容都被认为是一种噪音， 包括： 打招呼（比如 Hi, Hello， Good afternoon， Dear Coders等)， 表示感谢（比如 Thanks, Any help would be appreciated等)， 没必要的背景（比如 I’m a newbie in C#等)， 你的签名 等。<br>可能有人会不理解为什么这样规定， 尤其是不要表示感谢这点。 Stack Overflow社区的理由是， 对愿意阅读并尝试解答你问题的人来说， 最好的表达感谢的方式是upvote有帮助的回答， 以及选择其中一个作为答案。 每一句和问题无关的内容都增加了额外的阅读时间， 而一个问题可能会被大量的人阅读。 更多的相关讨论可以参见这里和这里。<br>同样道理， 当有人回答你的问题之后， 也不要去添加无用的评论， 比如单纯的表达感谢的话， “+1”， 或者闲聊等。 评论的唯一用处是用来澄清疑问。</p>
<h2 id="英语"><a href="#英语" class="headerlink" title="英语"></a>英语</h2><p>作为一个英语社区， 不论提问、回答还是在评论中和别人互动， 都是要用英语的。<br>除非英语水平真的很糟糕， 语法其实并不是最需要担心的，因为并不需要做到完美。Stack Overflow是允许自由的编辑其他人的问题/回答的（编辑者如果rep不到2K，需要经过评审才会生效）。 有很多人会热情的对问题进行编辑的， 包括修复可能的语法错误。 我想说的一点是， 要尽可能的保证单词拼写是正确的。 即使对英语不够好的人来说， 这也只需要多花一点时间检查就可以做到， 但它代表着对阅读你问题的人的尊重。 甚至很多英语母语的人在拼写上也不注意， 会把I’m 写成im, 把 want to写成 wanna之类的非正式英语， 这些都会降低问题被回答的概率。</p>
<h2 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h2><p>在发问题之前， 问自己几个问题：</p>
<ul>
<li>你做过足够的研究么？ 有的人连入门指南都没读上10分钟就去提问， 问的问题能有多少价值呢？</li>
<li>你尝试过搜索么？ 至少要试过Google和站内搜索， 很可能相同的问题已经有答案了</li>
<li>你试过debug么？ 把你的想法或调试过程写在问题里，否则很可能会看到几条评论“Have you tried anything?”或“We don’t do your homework”之后问题就被downvote得惨不忍睹了。 因为大多数人是拒绝回答没有努力尝试的提问者的。</li>
<li>标签： 一个问题可以加1~5个标签， 大多数问题是和某种具体的编程语言相关的， 这个语言的标签通常是必须的， 否则相关语言的关注者们很可能根本见不到问题。</li>
</ul>
<h2 id="起一个好标题"><a href="#起一个好标题" class="headerlink" title="起一个好标题"></a>起一个好标题</h2><p>一般来说， 标题应该尽量用简介的语言描述具体的问题。 比如 C# number confusion就是个反例， 如果改成 Why does using float instead of int give me different results when all of my inputs are integers? 就要具体多了。</p>
<h2 id="提供代码"><a href="#提供代码" class="headerlink" title="提供代码"></a>提供代码</h2><p>对于编程类问题，的确有问题不需要代码也能表达清楚的， 但大多数问题都需要代码才能清晰的表达。“我声明了一个变量， 调用了几个函数， 然后它的值就变了， 为什么呢？” 这样的问题， 鬼才知道答案。<br>提供代码要注意： 不要贴截图， 难道你要回答者去照着截图敲键盘复现你的问题？ 也不要只贴站外的链接， 如果站外链接能够提供一些额外的方便功能， 也要在贴代码的基础上附上该链接。<br>对于提供什么样的代码， Stack Overflow给出了一个可参考的标准： MCVE， 即Minimal, Complete, and Verifiable example<br>Minimal: 最小的， 也就是尽可能的去掉和问题无关的部分。 如果你贴了一个几百行的代码， 很少有人愿意花时间去仔细看。 构造最小化例子的过程本身也是debug的过程。<br>Complete: 完整的， 一个简单的判断是：别人看到问题， 可以通过复制你提供的代码复现出问题吗？<br>Verifiable: 可验证， 描述问题尽可能具体， “the code doesn’t work”这样的描述就很不好。 如果编译不过， 要加上编译错误信息； 如果运行报错， 也同样要加上具体的错误信息； 如果结果和你的预期不一致， 要说清楚你的预期结果是什么， 为什么会这样想。<br>格式<br>Stack Overflow的编辑器是Markdown格式的， 如果你还不熟悉， 建议去学一下， 因为Markdown真的是一个只要10分钟就可以学会的语言。<br>大多数的格式问题都是出在贴代码的地方， 如果你发现你的代码是普通文本， 而没有语法高亮等功能， 那你很可能是格式搞错了。 最方便的方法就是选择所有代码， 然后按键盘Ctrl + K 即可。</p>
<h2 id="交流"><a href="#交流" class="headerlink" title="交流"></a>交流</h2><p>有可能你的问题几分钟内就会有人回答， 也有可能有人对问题有疑问， 在评论中要求你解释。 可以评论@他们解释， 如果问题确实不够清晰， 编辑你的问题吧。 最后， 如果你自己发现了解答方法， 而还没人给出， 那就自己回答自己的问题吧。 自问自答是被鼓励的行为。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>看完上面我的唠叨， 是不是也感觉到Stack Overflow对新手的不友好了呢？ 但这是保持高质量内容的代价之一， 必须有一定的机制让低质量的问题不会泛滥， 才会有更多的人愿意花时间回答好的问题。 希望大家都能得到自己问题的答案， 有机会再讲讲如何回答问题。</p>
<h2 id="提问前的自问"><a href="#提问前的自问" class="headerlink" title="提问前的自问"></a>提问前的自问</h2><p>提问之前你做过研究吗？ &lt;注1&gt;<br>你是否说明了自己试过哪些方法解决问题？<br>你说明你使用的编程语言/平台了吗， 包括版本号？<br>如果你的问题包含代码， 你是否已经改写成最小且完整的程序？&lt;注2&gt;<br>如果你的问题包含代码， 你是否检查过代码格式？&lt;注3&gt;<br>如果你的代码不能编译， 问题中是否包含了编译错误信息？<br>如果你的问题不包含代码， 你确认不需要吗？<br>如果你的程序抛出了异常， 问题中是否包含异常信息和堆栈回溯(stack trace)？<br>如果你的程序的输出结果和预期不同， 你是否说明了你的预期结果是什么， 你为什么这么想， 以及程序的实际结果？<br>如果你的问题和本地化有关（语言，时区等）， 问题中是否包含了相关的信息？<br>你是否检查过问题的格式是否正确？<br>你是否检查过拼写和语法？&lt;注4&gt;<br>你是否认真读过自己的问题， 确认问题对一个不了解问题背景的人也能明白?<br>如果以上任何一个问题的答案是否定的话， 很可能你提问前需要再修改一下问题。 我知道这听上去像是不少工作， 但它能帮助你尽快的得到答案。别忘了你是在请求他人用自己的善心帮助你， 你有义务让他们的工作尽可能的简单。</p>
<p>注1： 如果你从“这怎么不工作了”到“应该去问个问题”只花了不到10分钟， 那很可能你的研究还不够。<br>注2： 理想情况下， 你的代码应该可以让回答者复制， 粘贴到编辑器， 编译， 运行， 然后就能看到问题输出。 命令行程序适用于这样的标准（除非你的问题和用户界面有关， 最好用命令行程序）。  去掉任何和问题无关的代码， 但保证可以复现问题。<br>注3： 代码最好不需要水平滚动， 这可能需要你从IDE复制代码之后做些额外的处理。 为了那些愿意帮助你的人花点时间把问题表达清楚吧。<br>注4： 我明白很多Stack Overflow用户母语不是英语， 我们并不要求完美， 只是希望你做过努力。如果你清楚自己英语不好， 找一个同事/朋友帮你改改吧。k</p>
<h1 id="答题相关"><a href="#答题相关" class="headerlink" title="答题相关"></a>答题相关</h1><h2 id="想法的萌芽"><a href="#想法的萌芽" class="headerlink" title="想法的萌芽"></a>想法的萌芽</h2><p>如果非要总结下我多年来是如何使用Stack Overflow的话，我的答案就是：打开网页，搜索问题，查看Stack Overflow的搜索结果，参考答案，最后再关掉网页。</p>
<p>我的生活已经离不开Stack Overflow了。但我从来没有对那些有用的回答做出过反馈，更别提自己提问题和回答问题了。</p>
<p>不过我最终还是意识到，Stack Overflow的成功正是建立在其众多用户的慷慨解答上。我从这个网站上收获了很多，却从未做出回报，因为没有任何人、任何规则的约束。每个问题、每个答案或者每个有帮助的评论的出现只是因为某人慷慨的写了出来。诚然，Stack Overflow也有一套激励机制去帮助它的发展，且用户获得徽章和威望的多少也是个未知数，且通常由其他用户决定。例如，如果你提了一个问题或者回答了一个问题，没有人有义务去赞同或者反对你。</p>
<p>多年来，我一直受益于它，但未对它尽过绵薄之力。我在网站上找到过一打有帮助的答案，但我甚至不曾为它们点个赞。</p>
<p>是时候回报Stack Overflow了！</p>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>   某天我在浏览徽章列表时发现，可以通过连续30天访问网站而获得一枚银色勋章。于是我决定将这个作为我的目标，通过30天不间断地浏览网站并且达到1000威望值。但我将只回答问题而不提问。</p>
<h2 id="完成情况"><a href="#完成情况" class="headerlink" title="完成情况"></a>完成情况</h2><p>正如下表所示，我只能算是勉强完成目标。</p>
<p>尽管我发现在访问量达到200的时候就会有100点威望值的福利作为回报，但是我也依然有一整个星期都颗粒无收的瓶颈期。理解并回答问题无疑是一个缓慢并需要一定方法的过程，要想达到我的目标，至少需要每天30点左右的威望值进账才可以。 </p>
<p>##经验之谈</p>
<p>Stack Overflow看起来就像一个纯粹的问答网站，但在我花了30天沉浸在回答问题的过程中后，发现了网站本身以及它所形成的社区的一些微妙的特点。以下是我所学到的一些：</p>
<p>“摘樱桃”</p>
<p>没过多久我就发现了网站上用户提问的速度之快。而我每天要做的只是：每小时花上几分钟刷新下问题页面，随机淘汰几个简单、不圆满的答案而已。除此之外，网站上的一些友好（有时并不十分友好）的竞争状况也显而易见。</p>
<p>我从择优的过程中学到了很多。</p>
<p>首先，确保你理解了问题。读完整个问题并且明确提问者想要的答案。如果你没有理解的话那么在评论中礼貌的问清楚。阅读标签也同样重要。不止一次我错误的回答了一个问题只因我自己假定了提问者所用的环境，显然这种情况可以通过阅读标签避免。</p>
<p>其次，不要为了快点回答问题而牺牲了答案的质量。错别字和语法错误不会对任何人有帮助，并且这些都可以通过放慢回答速度以及在提交答案前检查一遍来避免。换一种方式来说：拥有良好的书写格式和完整的答案更容易得赞，而残缺的答案自然不会。不要只为了回答问题而写一个快速但不完整的答案，然后不得不忙着补充忘记的点。我见过太多这样的答案，这样做也只会招来其他用户甚至包括操作员要求更多的解释。这种行为明显不利于用户提问和回答的发展。</p>
<p>最后，如果你正在撰写一个答案，一定要看一下已经存在的答案。如果你的答案和别人的几乎一样，那么你只需为别人的答案点个赞。如果他们的答案中缺了某些方面，那么你只需要在该答案的评论中去补充一下就可以了。</p>
<h2 id="求助吸血鬼"><a href="#求助吸血鬼" class="headerlink" title="求助吸血鬼"></a>求助吸血鬼</h2><p>   Stack Overflow上有一群被称为”求助吸血鬼”的人。这些用户以“从不放过任何机会获得别人的帮助 “而闻名。这种现象一直存在，可我一直不知道他们甚至有个专属用词，直到某天有个用户斥责一位问题提问者为“求助吸血鬼”我才知道。</p>
<p>   我就曾经为几个看起来像“求助吸血鬼”的用户回答过问题，接着就一发不可收拾了。他们通常采纳了我的答案接着在再答案下留言问一些新的毫无关系的新问题。</p>
<p>   我的处理方式就是（建议其它用户在遇到这种情况时也这样）：写一个评论告诉用户他的所作所为是不对的以及应该怎么做。当时我就建议他去Google一下这个新问题，如果找不到想要的答案再来Stack Overflow上问一个新的问题，而不是在一个用户的答案下不停的问一些毫无关联的问题。</p>
<p>   上面给出的Meta Stack Exchange链接上提供了很多在遇到这种求助吸血鬼时的有用回应。我还想说的一点就是，当普遍认可的答案却得到质疑时，首先应该做的是在该问题下做出评论，解释提问者可以自己修正这个问题。给用户一个改正自己错误的机会。这样的话，用户可能更能从这个网站上学到新的东西，你甚至还能为网站审核者节省时间！</p>
<h2 id="卖弄狼人"><a href="#卖弄狼人" class="headerlink" title="卖弄狼人"></a>卖弄狼人</h2><p>   卖弄狼人，我专门为与“求助吸血鬼”所造的名词。对于求助吸血鬼们来说，这些原本可能善意的用户简直就是恶魔的化身。</p>
<p>   当我发现求助吸血鬼的现象越来越严重的时候，有些用户采用粗暴且无用的方法制止他们。卖弄狼人们通常这样说：“这明显是一个家庭作业水平的问题”，“你难道都不试着Google一下么”，“不要问重复的问题！”。当我完成我的30天目标时，比起求助吸血鬼，我更烦这些卖弄狼人。</p>
<p>   我想对这些人说：请回答的更具建设性和有用一点。为提问者提供更常规的答案。我的这些建议对提问者也同样适用！如果你遇到一个卖弄狼人只需要忽视他们就行，树立一个好榜样，不要在评论里面针锋相对！</p>
<h2 id="关于反对票"><a href="#关于反对票" class="headerlink" title="关于反对票"></a>关于反对票</h2><p>   在这30天里，我一直尽我最大的努力为提问者做出一个好的、详细的答案。但是有时候会出现这样的现象：某个我的被采纳了的答案竟然没有一个人赞同，反而都是反对。</p>
<p>   这些否定深深得伤害了我。那些不赞同我的答案的用户都没有解释原因，甚至在我追问后也没有给出回答。我的答案被接受了，显然对于提问者来说这是一个好答案，但是我至今不懂为什么有那些反对票，甚至让我丢了两点威望值。</p>
<p>   Stack Overflow上并没有强制要求你在反对某个答案的时候解释原因，这样郁闷很久后，我觉得网站应该这样有这样的机制。在一个反对票下做出解释是体现网站人性化的一面。</p>
<p>   如何人性的在反对票下留言呢？我想了两种方法：</p>
<ul>
<li>如果有人已经在反对票中的评论解释了为什么投反对票，那么你只需要赞同一下这个评论就能引起回答者的注意了。</li>
<li>如果没有人解释你投反对票的原因，那么就在评论中写出问题或者答案需要改进的地方。</li>
</ul>
<h1 id="声明："><a href="#声明：" class="headerlink" title="声明："></a>声明：</h1><p>我只是个萌萌的搬运工，待我也在stackOverFlow上修行完成之后再来谈自己的经验。</p>
<h2 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h2><ul>
<li><a href="http://blog.jobbole.com/101980/" target="_blank" rel="noopener">玩转 Stack Overflow 之提问篇</a></li>
<li><a href="http://blog.jobbole.com/75292/" target="_blank" rel="noopener">泡在 Stack Overflow 答题的 30 天</a></li>
<li><a href="https://www.zhihu.com/question/19562768" target="_blank" rel="noopener">国内为什么没有好的 Stack Overflow 的模仿者？</a></li>
<li><a href="http://www.infoq.com/cn/news/2016/03/Stack-Overflow-architecture-insi?utm_source=infoq&amp;utm_medium=related_content_link&amp;utm_campaign=relatedContent_presentations_clk" target="_blank" rel="noopener">Stack Overflow 2016最新架构探秘</a></li>
<li><a href="http://www.ifanr.com/337680" target="_blank" rel="noopener">CODE Keyboard：Stack OverFlow 联合创始人亲手操刀的极客机械键盘</a></li>
<li><a href="http://blog.jobbole.com/102810/?utm_source=blog.jobbole.com&amp;utm_medium=relatedPosts" target="_blank" rel="noopener">为什么离不开 StackOverFlow？</a></li>
<li><a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/master/README-zh_CN.md" target="_blank" rel="noopener">提问的智慧</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> stackoverflow </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java的oracle考试认证(OCJP)之路]]></title>
      <url>https://blog.xiaomo.info/2017/oracleJavaSeSliver/</url>
      <content type="html"><![CDATA[<p>最近几天准备了一下java的oracle认证考试(OCJP),在网上查找资料奈何国内基本没太多有用的信息,还是费了一番功夫.<br><a id="more"></a></p>
<h2 id="为什么我要参加这个考试"><a href="#为什么我要参加这个考试" class="headerlink" title="为什么我要参加这个考试"></a>为什么我要参加这个考试</h2><p>有朋友建议我考一下这个证书,所以我花了些时间上网查了相关的资料.虽然国内的网上一大堆评论都是没什么用,含金量不高之类之类的.但是它毕竟是oracle的官方认证,我的动机大致如下:</p>
<ul>
<li>我本来就是半路出家,再静下心来过一遍java基础没什么不好,在这过程中我又巩固了不少知识.</li>
<li>虽然国情如此,但是有出国意愿的话这个证书还是很有必要的.</li>
</ul>
<h2 id="什么是-OCJP"><a href="#什么是-OCJP" class="headerlink" title="什么是 OCJP"></a>什么是 OCJP</h2><p>OCJP(Oracle Certified Java Programmer)是Oracle认证的Java程序员的简称，即Sun被Oracle收购之前的SCJP，是Java语言的拥有厂商对全球的Java开发人员进行的 技术水平认证。该认证在国际上获得了IT 公司的普遍认可， 是目前国际上最热门的IT认证之一。</p>
<h2 id="考试内容"><a href="#考试内容" class="headerlink" title="考试内容"></a>考试内容</h2><ul>
<li>青铜级考java基本语法</li>
<li>白银级考java基础api</li>
<li>黄金级考java高级api</li>
</ul>
<h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p>《thinking in java》,很好的一本书. 我的网盘上存的有 pdf版本: <a href="http://online.xiaomo.info" target="_blank" rel="noopener">http://online.xiaomo.info</a></p>
<h2 id="该考哪个科目"><a href="#该考哪个科目" class="headerlink" title="该考哪个科目"></a>该考哪个科目</h2><p>oracle认证的科目繁多,让人看花了眼而且没有说明,这让很多想考scjp的朋友急坏了头,下面是我整理的科目</p>
<p><img src="https://image.xiaomo.info/ocjp/科目说明.png" alt></p>
<ul>
<li>说明:ocjp考试认证分为3个等级:青铜白银和黄金(听起来像是lol),只有黄金有前提条件(必须先拿到白银)</li>
<li>建议:因为题目比较基础,建议直接报白银,如今java9都出了,就不要再考6或7了,不然还得再考一次升上来</li>
<li>结论:报1Z0-808(全英文题目),我报的是1Z0-808-JPN(全日语),题目内容都是一样的</li>
<li>可点击此链接查看具体规则(抱歉没找到中文版): <a href="http://www.oracle.com/jp/education/certification/jse8-2489021-ja.html" target="_blank" rel="noopener">http://www.oracle.com/jp/education/certification/jse8-2489021-ja.html</a><h2 id="考试费用"><a href="#考试费用" class="headerlink" title="考试费用"></a>考试费用</h2>以上所有的报名费用都是158美元,大概在1077rmb.但是报名缴费只支持master card,jcb或者visa卡,我请日本的朋友刷jcb代付的. 淘宝上代付1150-1200之间</li>
</ul>
<h2 id="报名地址"><a href="#报名地址" class="headerlink" title="报名地址"></a><a href="https://wsr.pearsonvue.com/testtaker/signin/SignInPage.htm?clientCode=ORACLE" target="_blank" rel="noopener">报名地址</a></h2><p>注册一个 <a href="https://wsr.pearsonvue.com/testtaker/signin/SignInPage.htm?clientCode=ORACLE" target="_blank" rel="noopener">person vue</a>账号,然后根据步骤走就可以了. 遇到问题可以看这个 <a href="https://jingyan.baidu.com/article/72ee561a537855e16138df2b.html" target="_blank" rel="noopener">OCJP考试VUE约考流程</a>,oracle认证全球有很多地方可以考试,比如说我在杭州来说,最近的离我只有3公里.</p>
<h2 id="考试流程"><a href="#考试流程" class="headerlink" title="考试流程"></a>考试流程</h2><ul>
<li>报名之后按照指定时间提前15分钟到达考点,需要携带身份证和一张辅助证件(驾驶证,信用卡,市民卡等都可以)</li>
<li>验证身份证件和拍照认证</li>
<li>填写一个声明,关于不能作弊,不违反规则之类的东西</li>
<li>把身上所有的东西掏出来放到柜子里锁起来,考试时只能带柜子上的钥匙</li>
<li>小姐姐会给一个手写板,一支笔和纸巾进入房间答题(没人监考,但有监控,不要作弊).</li>
<li>上机考完1Z0-808所有题目(77题),共150分钟答题时间(可提前交卷)</li>
<li>交卷时前台小姐姐那里会同步打印一张回执单,告知你30分钟之内oracle会发邮件通知考试结果</li>
</ul>
<h2 id="考试结果"><a href="#考试结果" class="headerlink" title="考试结果"></a>考试结果</h2><p>收到的邮件内容:<br><img src="https://image.xiaomo.info/ocjp/mail.png" alt></p>
<p>登录之后查看到的考试结果:<br><img src="https://image.xiaomo.info/ocjp/test.png" alt></p>
<p>通过考试之后会得到一个徽章和电子证书<br><img src="https://image.xiaomo.info/ocjp/list.png" alt></p>
<p>证书<br><img src="https://image.xiaomo.info/ocjp/证书.png" alt></p>
<p>徽章验证地址 : <a href="https://www.youracclaim.com/badges/78daff58-e1ce-4885-bcde-073a77b0fa97" target="_blank" rel="noopener">Oracle Certified Java Programmer, Silver SE 8 (Oracle Certified Associate, Java SE 8 Programmer) - JPN</a></p>
<h2 id="补充-2017-12-27"><a href="#补充-2017-12-27" class="headerlink" title="补充:2017-12-27"></a>补充:2017-12-27</h2><p>时隔一个月左右,我再次报了OCJP的 1z0-809-jpn科目.这个科目对java8的很多新特性都考察到了,个人觉得还是挺有难度的.</p>
<h3 id="大致说明"><a href="#大致说明" class="headerlink" title="大致说明"></a>大致说明</h3><ul>
<li>价格和808一样</li>
<li>地点和上次一次</li>
<li>题目内容为85题,答对65%及格,也就是最少要答对56道题.</li>
</ul>
<h3 id="考试结果-1"><a href="#考试结果-1" class="headerlink" title="考试结果"></a>考试结果</h3><p>当然是考过了,O(∩_∩)O哈哈哈~.不然就浪费了1000多的报名费</p>
<p>证书:<br><img src="https://image.xiaomo.info/ocjp/gold.png" alt></p>
<p>徽章验证地址: <a href="https://www.youracclaim.com/badges/e26ff57d-8004-499a-9016-d1cac718586d/twitter" target="_blank" rel="noopener">Oracle Certified Java Programmer, Gold SE 8 (Oracle Certified Professional, Java SE 8 Programmer) - JPN</a></p>
<p><a href="https://www.youracclaim.com/user/xiaomoinfo" target="_blank" rel="noopener">cclaim</a><br><img src="https://image.xiaomo.info/ocjp/all.png" alt></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OCJP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[安装黑苹果的历程]]></title>
      <url>https://blog.xiaomo.info/2017/blackAppleSystem/</url>
      <content type="html"><![CDATA[<p>最近新买了一台主机，折腾着准备装win+mac双系统，记录一下以备后续需要。<br><a id="more"></a></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>MSDN上的win10原版镜像</li>
<li>带有winPE的装机U盘(大白菜，老毛桃都可以)</li>
<li>transMac</li>
<li>mac镜像</li>
<li>确认自己的电脑是否支持UEFI模式</li>
</ul>
<h2 id="转换分区格式"><a href="#转换分区格式" class="headerlink" title="转换分区格式"></a>转换分区格式</h2><p>因为准备装10.13.1原版镜像，所以需要GRID(GPT)分区，查看步骤：我的电脑-设备管理器-磁盘工具-选择硬盘0或者磁盘1（这里不要选择分区）-右击属性-找到（卷）我们就可以看磁盘分区形式：GUID 分区表（GPT）<br>如果不是GRID，那么就插上U盘进入winPE，用DG分区<br>1、我们选择我们的系统磁盘。然后右键里面有一个转GPT格式后保存<br>2、选择C盘，右键然后选择“调整分区大小”，拆分一个300M左右的分区<br>3、新建分区，选择EFI类型，大小为300M<br>4、 保存重启</p>
<h2 id="制作Mac镜像"><a href="#制作Mac镜像" class="headerlink" title="制作Mac镜像"></a>制作Mac镜像</h2><ol>
<li>插入U盘（插到USB2.0接口），在U盘选项上右键点击你的U盘。选择Format Disk for mac将U盘格式化。</li>
<li>右键选择你的U盘。选择Restor with disk image.</li>
<li>选择下好的dmg镜像。</li>
</ol>
<h2 id="安装镜像"><a href="#安装镜像" class="headerlink" title="安装镜像"></a>安装镜像</h2><ol>
<li>选择从UEFI的u盘启动，然后苹果读条之后选择 安装系统。</li>
<li>选择磁盘工具，格掉要装位置的磁盘。（扩展日志格式）</li>
<li>选择安装mac到磁盘。</li>
<li>按照流程安装，整个过程需要重启3次。</li>
</ol>
<h2 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h2><p>驱动太难装………..</p>
<hr>
<h2 id="参考教程"><a href="#参考教程" class="headerlink" title="参考教程"></a>参考教程</h2><p><a href="https://osx.cx/course/10789.html" target="_blank" rel="noopener">macOS High Sierra 10.13.x 最新黑苹果原版安装教程</a></p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 黑苹果 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[日本游记]]></title>
      <url>https://blog.xiaomo.info/2017/JapanTravel/</url>
      <content type="html"><![CDATA[<p>日本游记，记录为期9天的日本之旅。第一次出国，便是自由行。有人说是艺高人胆大，我倒觉得是难得自由。下次出去玩，我还是会选择自由行。所有照片放在空间相册<a href="https://user.qzone.qq.com/83387856/photo/" target="_blank" rel="noopener">日本之旅</a><br><a id="more"></a></p>
<h1 id="行程前的准备"><a href="#行程前的准备" class="headerlink" title="行程前的准备"></a>行程前的准备</h1><h3 id="护照-200RMB一本"><a href="#护照-200RMB一本" class="headerlink" title="护照(200RMB一本)"></a>护照(200RMB一本)</h3><p>一般来说是在户籍所在地办理，用时1周左右，可以自取和邮寄。</p>
<h3 id="签证-旅行社代办300RMB"><a href="#签证-旅行社代办300RMB" class="headerlink" title="签证(旅行社代办300RMB)"></a>签证(旅行社代办300RMB)</h3><p>自己办需要的材料比较多，觉得麻烦可以直接找代办，就是价格稍贵。</p>
<h3 id="住处-airbnb-booking"><a href="#住处-airbnb-booking" class="headerlink" title="住处(airbnb,booking)"></a>住处(airbnb,booking)</h3><p>airbnb是民宿，booking是酒店，如果是一行人的话住民宿会比较划算。</p>
<h3 id="JR-PASS-1600RMB"><a href="#JR-PASS-1600RMB" class="headerlink" title="JR PASS(1600RMB)"></a>JR PASS(1600RMB)</h3><p>可以乘坐日本所有的JR,如果行程规划只是在一个城市就没有必要买，因为我们要去富士山和大阪所以买了会省不少钱。</p>
<h3 id="机票"><a href="#机票" class="headerlink" title="机票"></a>机票</h3><p>买的春秋航空的廉价机票，往返2800/人。如果是平日只需要一半左右，国庆期间出游的人太太太多，所以溢价不少。</p>
<h3 id="电话卡-WIFI"><a href="#电话卡-WIFI" class="headerlink" title="电话卡(WIFI)"></a>电话卡(WIFI)</h3><p>直接买了1张可以使用一周的达摩卡（建议1人一张），不买4g卡可以去机场租wifi。</p>
<h2 id="google地图"><a href="#google地图" class="headerlink" title="google地图"></a>google地图</h2><p>人肉翻墙终于可以看看墙外的世界了,让google地图指引你前进的方向吧。</p>
<h3 id="日元"><a href="#日元" class="headerlink" title="日元"></a>日元</h3><p>怎么说呢，日本习惯用卡和现金，所以备点零钱去了刷银联也可以。但是钱嘛多带点毕竟有安全感（日本的治安不用担心钱的安全问题）</p>
<h3 id="一个18到24寸之间的密码箱"><a href="#一个18到24寸之间的密码箱" class="headerlink" title="一个18到24寸之间的密码箱"></a>一个18到24寸之间的密码箱</h3><p>去的时候尽量留空，因为回来的时候根本不够装啊。</p>
<p><img src="https://image.xiaomo.info/travel/JRPASS.jpg" alt></p>
<hr>
<p><img src="https://image.xiaomo.info/travel/护照.jpg" alt></p>
<hr>
<p><img src="https://image.xiaomo.info/travel/达摩卡.png" alt></p>
<hr>
<p><img src="https://image.xiaomo.info/travel/yen.png" alt></p>
<hr>
<h1 id="行程"><a href="#行程" class="headerlink" title="行程"></a>行程</h1><h2 id="9-27-杭州-上海-东京"><a href="#9-27-杭州-上海-东京" class="headerlink" title="9.27 杭州-上海-东京"></a>9.27 杭州-上海-东京</h2><p>中午从杭州出发，5点前到达上海浦东机场办值机登机，7点左右出发。<br><img src="https://image.xiaomo.info/travel/出发前1.png" alt></p>
<hr>
<p>晚上11点左右到达东京羽田机场，然后万能的淘宝接机送我们到住处——浅草，因为日本是右舵靠左行，开着100多的速度一路上看着感觉好惊险刺激，总觉得要撞上了，不过我的担心是多余的。到达浅草大概夜里12点左右，并且在下雨，装上达摩卡打开google地图。为了找住的地方绕了有半个小时才找到位置，心情不是很美丽，不过到了住的地方老婆还是很开心，暖心的微笑。<br><img src="https://image.xiaomo.info/travel/到家.jpg" alt></p>
<hr>
<h2 id="9-28-浅草-浅草寺-上野-银座"><a href="#9-28-浅草-浅草寺-上野-银座" class="headerlink" title="9.28 浅草-浅草寺-上野-银座"></a>9.28 浅草-浅草寺-上野-银座</h2><p>睡到自然醒，然后去浅草寺逛了好几个小时,在路上偶遇现场的幽默剧表演，老婆看的入迷拉都拉不走。不得不说在东京的外国人真的超多，中国的，韩国的，美国的，印度的，非洲的各种都能遇到，走着走着遇到一个韩国人搭讪让我帮忙。他们应该是家庭出游，一家人说了一大通听不懂的话然后站在一起让我拍照。到中午了，在日本吃的第一顿饭真是一言难尽。点了一份荞麦面，腥味重的可怕结果一点都没吃，后来去超市买了一大包零食。</p>
<p><img src="https://image.xiaomo.info/travel/浅草/4.jpg" alt><br>有家店门口有个大青蛙，还挺萌的</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/浅草/2.jpg" alt><br>浅草寺，就在我们住的地方旁边，还是挺热闹的，还遇到了一家子韩国人让我帮忙拍合照。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/浅草/3.jpg" alt><br>浅草的纪念品，然而我都没买</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/浅草/1.jpg" alt><br>在东京见到了久违的黄包车，还存在这个东西有点让我惊讶</p>
<hr>
<p>下午坐车去上野换JR PASS,决定换到从9.29-10.5号期间的票。<br><img src="https://image.xiaomo.info/travel/银座/1.jpg" alt><br>上野JR站，我们的JP PASS票就是在这里兑换的</p>
<hr>
<p>之后坐车去银座逛商店，不得不说银座的建筑真的超级漂亮，地上找不到垃圾也找不到垃圾桶。银座应该算是有钱人的天堂吧,各种东西超级贵，逛了一下午没找到一件能下手的东西，穷人真的是很难过的说。<br><img src="https://image.xiaomo.info/travel/银座/2.jpg" alt><br>银座繁华的商场</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/银座/3.jpg" alt><br>偶然遇到一辆日产的火红跑车，亮瞎了我的眼</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/银座/4.jpg" alt><br>sony大楼里的高科技，投影出来一个可点击的android的操作系统桌面，可以把任何地方当桌面用。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/银座/5.jpg" alt><br>银座大黑屋，听说还挺出名的</p>
<hr>
<p>因为中午的阴影，晚上吃饭在麦当劳解决的。不用怀疑，麦当劳和肯德基在全世界都是一个味道。晚上我们比较早就回住处了，不过同行的小伙子去了居酒屋去玩到半夜1点多才回。<br><img src="https://image.xiaomo.info/travel/麦当劳.jpg" alt><br>一个麦当劳套餐</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/银座/6.jpg" alt><br>看板上的广告都有这么萌的妹子，忍不住拍了一张</p>
<hr>
<h2 id="9-29-浅草-富士山"><a href="#9-29-浅草-富士山" class="headerlink" title="9.29 浅草-富士山"></a>9.29 浅草-富士山</h2><p>到日本玩不到富士山难免是一场遗憾,所以决定今天去富士山去玩。查了路线大概有150公里，需要3个多小时才能到。再加上出发的时间比较晚，到达富士山的时候己经下午了，因此没有爬山。只是在富士山下玩顺便吃了顿饭便开始返回。<br><img src="https://image.xiaomo.info/travel/富士山1.jpg" alt><br><img src="https://image.xiaomo.info/travel/富士山2.jpg" alt><br><img src="https://image.xiaomo.info/travel/富士山3.jpg" alt><br><img src="https://image.xiaomo.info/travel/富士山4.jpg" alt></p>
<h2 id="9-30-浅草-秋叶原"><a href="#9-30-浅草-秋叶原" class="headerlink" title="9.30 浅草-秋叶原"></a>9.30 浅草-秋叶原</h2><p>今天在日本名古屋工作的朋友知道我们在东京便一起出发找我们一起玩，我们约定在秋叶原汇合，同行的另一个小伙伴要去买小学生书包我们便分头行头了。<br><img src="https://image.xiaomo.info/travel/秋叶原/0.jpg" alt><br>秋叶原的入口，进一步便是宅男天堂</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/10.jpg" alt><br>JR秋叶原站，旁边也有地铁站</p>
<hr>
<p>来到了传说中的宅男天堂，不过里面真的有好多化妆品啊，结果大部分时间都是陪妹子逛各种化妆品和药妆店。当然也去看了手办，本来打算帮同事带高达，不过找了很久都没有找到想要的那一款。<br><img src="https://image.xiaomo.info/travel/秋叶原/1.jpg" alt><br>巴比娃娃</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/2.jpg" alt><br>动物王国</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/3.jpg" alt><br>扭蛋机，比我在杭州国际动漫节玩的扭蛋机要便宜，这边的商店到处都有扭蛋机。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/4.jpg" alt><br>在秋叶原体验街机的父子</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/5.jpg" alt><br>你的名字相关的名信片，不知道去哪买邮票就没买</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/6.jpg" alt><br>ps4版的初音，买不起</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/7.jpg" alt><br>同事让我帮忙找高达，都是这种小个子，我想要一个同人的大家伙。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/8.jpg" alt><br>本来以为是个卡哇伊的小女孩，走近才发现是个洋娃娃</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/9.jpg" alt><br>洋娃娃正面照，很精致</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/11.jpg" alt><br>音乐猫，每只猫捏了都能发出不同的声音。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/12.jpg" alt><br>遇到一个萌出血的双马尾妹子</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/秋叶原/13.jpg" alt><br>忍不住又拍了一张</p>
<hr>
<h2 id="10-1-东京-大阪"><a href="#10-1-东京-大阪" class="headerlink" title="10.1 东京-大阪"></a>10.1 东京-大阪</h2><p>今天出发去大阪，坐了2个多小时的JR终于到达大阪，买了一张2500yen的大阪周游券。<br><img src="https://image.xiaomo.info/travel/大阪/25.png" alt><br>一日游的卡</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/26.png" alt><br>附带了这么大的一本说明</p>
<hr>
<p>然后下了JR拿出地图寻找住处，然后突然伸出一个头看我们的手机，被吓了一下，结果是个热心的小伙子帮我们指路，语速超快，听的我们一行人n脸懵逼，然后带着我们去地铁站排队叮嘱了一大串才离开。不仅感慨大阪民风淳朴，热情好客，弄的我们都不好意思了。跟着google地图到来住处附近徘徊，遇到一个老太太，带着比较重的关西口音问我们要去哪里，然后她佝偻着身子一直带我们到住的门口，感动的无以言表。由于初到大阪，决定放好行李之后出去熟悉一下路线。正好我们住处的旁边有一条商店街。因为是周末过去的，所有有好多店关都关着的。我们沿着这条街一直走，都没有遇到几个人。不禁在想，如果是在国内一定是人从众众众 吧。<br><img src="https://image.xiaomo.info/travel/cat1.jpg" alt></p>
<hr>
<p>在路上偶遇中年夫妻开的中华料理店，不由自主的便进去了。点了好几个家常菜和老板娘说了一路的日语。结果点完菜她用浓浓的东北口音给她老公说话，真是蜜汁尴尬。<br><img src="https://image.xiaomo.info/travel/大阪/2.jpg" alt><br>日本的中国饭店还是挺多的</p>
<hr>
<p>吃完饭去逛大阪的药妆店，不过买的东西并不多。后来非常后悔，因为大阪的东西真的比东京要便宜不少。回去的时候就买了一大吃零食和水果，如果能反悔，当时一定要在大阪把想买的东西都买了，可以省不少钱。<br><img src="https://image.xiaomo.info/travel/大阪/4.jpg" alt><br>大阪商店街，一共有1-9条街</p>
<hr>
<p>由于逛的比较晚，准备回去的时候己经快夜间12点了。偶然抬头看着天空，简直把我惊到了，明亮的月亮加上白色的云，我发誓这辈子没看到过这种景色。<br><img src="https://image.xiaomo.info/travel/天空.jpg" alt><br>如果在这种地方生活，一定会多活很多年的吧。</p>
<hr>
<h2 id="10-2-大阪一日游"><a href="#10-2-大阪一日游" class="headerlink" title="10.2 大阪一日游"></a>10.2 大阪一日游</h2><p>早上一大早起来，很不幸外面下起了雨。不过既然买了卡我们依然按照原计划去大阪城玩。第一站：通天阁，高度500多米,站在塔顶能够看到大阪80%以上的建筑，如果是晚上看的话一定很漂亮。<br><img src="https://image.xiaomo.info/travel/大阪/5.jpg" alt><br>站在500多米的观景台上看下面的景色，白天一点都没有感觉</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/6.jpg" alt><br>对面的塔晚上会很漂亮，白天完全不行</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/7.jpg" alt><br>观景台楼下的迷你大阪城，精致到看每个人都栩栩如生（白天）。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/10.jpg" alt><br>观景台楼下的迷你大阪城，精致到看每个人都栩栩如生（夜晚）</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/11.jpg" alt><br>也不知道这个铜人叫什么，反正很出名就是了</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/9.jpg" alt><br>纪念章，500日元一个，可以刻字</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/8.jpg" alt><br>带着这么萌的包出来心里没点数么。</p>
<hr>
<p>在这里还偶遇猴子表演，确实还挺有意思的。这里有很多土特产，不过让人心动的倒没遇到。在商店逛的时候遇到了假的白色恋人巧克力，名字叫《面白い恋人》真正的是叫《白い恋人》，小伙伴们要注意分辨。如果要带白色恋人巧克力去机场免税店吧，别的地方都是假的。<br><img src="https://image.xiaomo.info/travel/有趣恋人.jpg" alt></p>
<hr>
<p>第二站准备去大 天王寺动物园 ，结果去了被告知今天休息（详情看<a href="http://ask.qyer.com/question/3392370.html" target="_blank" rel="noopener">大阪周一休园</a>),整个人瞬间就不好了。<br><img src="https://image.xiaomo.info/travel/大阪/12.jpg" alt><br>很可惜天王寺动物园周一休园，只能在门外拍张照表示来过</p>
<hr>
<p>然后去下一个游玩点 坐轮渡,全体披着雨衣坐观光船还是很壮观的。最前面有个导游顶着雨铿锵有力的解说着各个景点，不得不佩服日本人对工作的敬业态度。<br><img src="https://image.xiaomo.info/travel/水上巴士.jpg" alt><br><img src="https://image.xiaomo.info/travel/雨中1.jpg" alt></p>
<hr>
<p>第三站去了天保山坐世界上最大的摩天轮，为了排队透明舱多等了半个多小时，坐上去的时候并没有特别刺激的感觉，当升到顶的时候看风景是很漂亮的，如果想刺激去大阪影视城坐过山车挺好的。<br><img src="https://image.xiaomo.info/travel/大阪/m3.jpg" alt><br><img src="https://image.xiaomo.info/travel/大阪/15.jpg" alt><br>来到了世界上最大的天保山摩天轮，还下着小雨</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/16.jpg" alt><br>在摩天轮上看到外面的玻璃都是水</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/17.jpg" alt><br>从透明仓底部拍的比较清楚</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/24.jpg" alt><br><img src="https://image.xiaomo.info/travel/大阪/m4.jpg" alt><br><img src="https://image.xiaomo.info/travel/大阪/m1.jpg" alt><br>晚上的摩天轮果然最漂亮</p>
<hr>
<p>第四站坐游轮看了个各个码头的集装箱和两岸的风景，还可以把天保山摩天轮做背景拍照。<br><img src="https://image.xiaomo.info/travel/大阪/18.jpg" alt><br>这个大妈指着让我去坐圣玛利亚帆船</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/19.jpg" alt><br>在船上看摩天轮依然这么大</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/20.jpg" alt><br>江对面的工厂</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/21.jpg" alt><br>帆船走远了，摩天轮越来越小</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/22.jpg" alt><br>大概有这么大</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/23.jpg" alt><br>对面的码头很热闹，很多集装箱。想到了docker…，程序员的思想跳跃就是大</p>
<hr>
<p>最后一站去空中展望台依旧不营业，真是罪过，错过这么多景点。由于一直下雨身上也淋了雨我们就准备回去休息了，不过老婆看起来玩的还挺开心的,在回去的路上也拍了几张。<br><img src="https://image.xiaomo.info/travel/大阪/1.jpg" alt><br>在大阪的街上闲逛</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/大阪/3.jpg" alt><br>开这么萌的车出来会被打的</p>
<hr>
<h2 id="10-3-大阪-奈良公园"><a href="#10-3-大阪-奈良公园" class="headerlink" title="10.3 大阪-奈良公园"></a>10.3 大阪-奈良公园</h2><p>同行的小伙伴觉得奈良太远便去了大阪影视城玩，我和老婆便坐JR去了奈良。<br><img src="https://image.xiaomo.info/travel/奈良/1.jpg" alt><br>这个是小鹿的人偶店<br>奈良的人真的很少，我们下车之后一度认为走错了位置。<br><img src="https://image.xiaomo.info/travel/奈良/4.jpg" alt><br>这个其实是一个古代名人的后院</p>
<hr>
<p>一路问奈良公园的入口在哪，被问的人都一脸懵逼的看着我，说这边一大片都是奈良公园，然后走着走着看到一个门收费200日元我们便进去了，进去才发现是一个古代名人的后院所以我们准备直接出来，那个收费叫知道我们走错地方还准备退我钱我谢绝了。后来走了很久看到一个地图才恍然大悟，奈良是免费的没有设立入口,从哪都可以进。<br><img src="https://image.xiaomo.info/travel/奈良/3.jpg" alt><br>在去公园的路上遇到了一个湖</p>
<hr>
<p>在公园见到了传说中的小鹿，喂它吃东西还会点头表示感谢。遇到这么萌的小鹿真是太高兴了。<br><img src="https://image.xiaomo.info/travel/奈良/25.jpg" alt><br>一只鹿</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/6.jpg" alt><br>在公园门口穿和服的女人</p>
<hr>
<p>中午饭了就在景区吃饭随意找了一家荞麦面馆。按照中国的习惯我己经做好了被宰的准备，但是很意外的价格很亲民，吃饭的时候我们迎面看到了一座特别漂亮的山然后忍不住问店员能不能爬。然后热心的老婆婆拿了一张地图过来一边讲一边画路线，标记上哪一段路程大概花费多少分钟，简直无法表达感激之情。</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/8.jpg" alt><br>对面的房子是春日大社，久仰大名</p>
<hr>
<p>吃完饭按照老婆婆的线路图往前走，看到了传说中的春日大社和美术馆，因为被山上的景色吸引我们便没有多做停留直接往山那边的方向走。<br><img src="https://image.xiaomo.info/travel/奈良/9.jpg" alt><br>从这条路可以上山</p>
<hr>
<p>爬山前管理员细心的告诉我们要准备点吃的和喝的，用蹩脚的英语说 no drink,not shop。听了好几遍才反应过来她说的什么意思，有时候不同的语言表达真是太有意思了。爬山的过程的辛苦的，但是爬到一半的时候回头看山下的景色，看起来真是太惊艳了。<br><img src="https://image.xiaomo.info/travel/奈良/2.jpg" alt><br>下过雨的松树看起来很绿</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/17.jpg" alt><br>在半山腰感觉己经挺高了</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/26.jpg" alt><br>在山上的各个地方都能看见小鹿，悠闲的吃着草，想起了小时候在山上放牛的日子。</p>
<hr>
<p>在山上感觉整个人都是轻松的，不用考虑工作，不用考虑生活，这一刻静静的享受这美景。</p>
<p><img src="https://image.xiaomo.info/travel/奈良/11.jpg" alt><br>在半山腰看大阪城</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/16.jpg" alt><br>顺着这么路可以继续爬山</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/18.jpg" alt><br>半山腰的检票口，遇到两个美国人</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/20.jpg" alt><br>在山顶看大阪城</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/21.jpg" alt><br>有个大概70岁左右的老爷爷坐在山顶的长凳上休息，真佩服他们的体力</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/22.jpg" alt><br>老婆在山顶上高兴的撒欢子跑</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/24.jpg" alt><br>在山顶上睡觉的老外，他老婆抱着孩子跑的我都看不到了</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/27.jpg" alt><br>下山的路</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/28.jpg" alt><br>再看一眼风景</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/29.jpg" alt><br>长的奇怪的树</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/30.jpg" alt><br>下山了</p>
<hr>
<p><img src="https://image.xiaomo.info/travel/奈良/31.jpg" alt><br>遇到很多来若草山玩的小学生，一个个的都好萌</p>
<hr>
<p>从奈良回来己经8点多了，由于第二天准备回东京所以趁晚上再出去转转买个PS4玩玩。到电器街的时候大概9点多了，发现各个商场都在准备收拾关门了感觉很遗憾。老婆一直说再找找，我们就一直逛终于遇到了一个卖电子设备的店没关门。大阪和东京的商店的区别是东京大部分店都有中国店员，但是大阪基本上都没有。但是我们在这个店里遇到了一个说中文特别标准的日本女孩，瞬间觉得她很厉害。因为她说的很标准我把她当成中国人了就语速较快的和她讲中文，但是发现她有点发愣我才反应过来她不是中国人。就这样我们中文+日语沟通着，最后成功的买回了一台价值3万多日元的PS4。<br><img src="https://image.xiaomo.info/travel/ps4.jpg" alt></p>
<hr>
<h2 id="10-4-大阪-东京"><a href="#10-4-大阪-东京" class="headerlink" title="10.4 大阪-东京"></a>10.4 大阪-东京</h2><p>今天睡到自然醒然后起床收拾东西准备回东京，直接去机场然后到机场免税店逛。到了机场问了工作人员得知飞机起飞前3个小时才能进，我们只能把行李暂寄在机场去银座和秋叶原逛街。<br><img src="https://image.xiaomo.info/travel/airport1.jpg" alt><br>在秋叶原狠心买了一块2万日元的太阳能机械表和6000日元的香水(送给老妈)，老婆买了一套雪肌精和一堆化妆品。把剩下的钱全部花光了，这算是最后的狂欢吧。<br><img src="https://image.xiaomo.info/travel/成果.jpg" alt><br>在机场免税店发现可以刷支付宝，于是买了几盒白色恋人巧克力，抹茶饼干和一条sevenStar的香烟，支付宝自动换算成人民币扣款还减了20块钱，很好很强大给个好评。<br><img src="https://image.xiaomo.info/travel/alipay1.png" alt></p>
<hr>
<h2 id="10-5-东京-上海-杭州"><a href="#10-5-东京-上海-杭州" class="headerlink" title="10.5 东京-上海-杭州"></a>10.5 东京-上海-杭州</h2><p>0点左右我们开始办检票登机，发现飞机上基本上都是中国人连空姐都是中国人，有种己经回国了的错觉。我困的不行上飞机就想睡觉，老婆兴奋的像个孩子一样说外面的风景好漂亮，拉着我和她一起看风景，她成功的赶跑了我的瞌睡一起看着飞机转弯、加速、起飞、爬升，一直到半夜2点多才睡着。<br><img src="https://image.xiaomo.info/travel/air.jpg" alt></p>
<hr>
<p>由于时差原因到上海的时候才半夜3点左右，下了飞机去转盘取行李。真是一脸懵逼，上面一件行李都没有。站着像望夫石一样等了近半个小时行李才一件一件的出来。但是在日本的时候刚下飞机所有的行李都全部放出来了,真的无力吐槽中国的办事效率。<br><img src="https://image.xiaomo.info/travel/limotsu.jpg" alt></p>
<hr>
<p>拿到行李的时候己经快4点了，我们叫了个接机的司机直接送我们去上海虹桥火车站坐火车回杭州，再次感受到了天朝的威力,早上6点钟人多的都挤不动，一上车马上就有一群人冲进去抢座位，根本不管什么先下后上，才回来我还真不适应，等我反应过来的时候我己经被挤出来了。<br><img src="https://image.xiaomo.info/travel/people.jpg" alt></p>
<hr>
<p>再次回来这个熟悉而又无奈的地方，为期9天的行程结束了。<br><img src="https://image.xiaomo.info/travel/hangzhoudong.jpg" alt></p>
<hr>
<h1 id="对日本初印象"><a href="#对日本初印象" class="headerlink" title="对日本初印象"></a>对日本初印象</h1><h3 id="公共场合都非常安静"><a href="#公共场合都非常安静" class="headerlink" title="公共场合都非常安静"></a>公共场合都非常安静</h3><p>不管是在飞机上，地铁上还是JR上都比较安静，可能是因为有不少人在睡觉的原因吧。印象比较深刻的是有个小孩哭了,他妈妈告诉她不要哭了不然会吵到别人，然后小孩子就停止哭泣了，真是羞愧难当。<br><img src="https://image.xiaomo.info/travel/book.jpg" alt></p>
<hr>
<h3 id="日本一年四季都喝冰水，所以如果你点餐时如果未做要求都会上冰水。"><a href="#日本一年四季都喝冰水，所以如果你点餐时如果未做要求都会上冰水。" class="headerlink" title="日本一年四季都喝冰水，所以如果你点餐时如果未做要求都会上冰水。"></a>日本一年四季都喝冰水，所以如果你点餐时如果未做要求都会上冰水。</h3><p>有不解的看知乎吧 <a href="https://www.zhihu.com/question/21832177" target="_blank" rel="noopener">日本人为什么喜欢喝冰水？</a>,主要是我在亲爱的祖国喝冷水会拉肚子。<br><img src="https://image.xiaomo.info/travel/ice.jpg" alt></p>
<hr>
<h3 id="日本坐手扶梯都是自觉靠右站，左侧留给赶时间的人通过。"><a href="#日本坐手扶梯都是自觉靠右站，左侧留给赶时间的人通过。" class="headerlink" title="日本坐手扶梯都是自觉靠右站，左侧留给赶时间的人通过。"></a>日本坐手扶梯都是自觉靠右站，左侧留给赶时间的人通过。</h3><p>这似乎己经成了一种骨子里的习惯，如果所有人都站成一排自己站旁边，也会觉得脸红的吧。<br><img src="https://image.xiaomo.info/travel/shoufuti.jpg" alt></p>
<hr>
<h3 id="日本坐电梯位于电梯按钮位置的人会最后出来"><a href="#日本坐电梯位于电梯按钮位置的人会最后出来" class="headerlink" title="日本坐电梯位于电梯按钮位置的人会最后出来"></a>日本坐电梯位于电梯按钮位置的人会最后出来</h3><p>因为选择站在这里就有一个职责,要让所有人安全的进出，所以会一直按着开门的按钮等所有人离开再出来，如果外面有人准备进来但是因为有事没进来一定会鞠躬道歉。<br><img src="https://image.xiaomo.info/travel/dianti1.png" alt></p>
<hr>
<h3 id="日本所有商场基本上都是8点关门，秋叶原则是10点。"><a href="#日本所有商场基本上都是8点关门，秋叶原则是10点。" class="headerlink" title="日本所有商场基本上都是8点关门，秋叶原则是10点。"></a>日本所有商场基本上都是8点关门，秋叶原则是10点。</h3><p>不管多么繁华的地方，到了8点以后基本上都看不到有在营业的商场了。我好奇问了一下，说是因为老板付不起加班费(正常工资的2倍到3倍)，所以到点基本上都下班了。<br><img src="https://image.xiaomo.info/travel/yinzuo1.png" alt></p>
<hr>
<h3 id="日本没有假货，但是也有坑"><a href="#日本没有假货，但是也有坑" class="headerlink" title="日本没有假货，但是也有坑"></a>日本没有假货，但是也有坑</h3><p>在日本最放心的就是没有假货，但是我还是差点被坑了。原因是那个白色恋人巧克力(白い恋人)，我在大阪的商店看到了有趣的恋人(面白い恋人),当时差点认错。我查了一下这个产品己经被起诉了，但是不知道为什么还一直在卖。侵权事件请看 <a href="http://japan.people.com.cn/35467/7659715.html" target="_blank" rel="noopener">日本名点“白色恋人”诉“有趣恋人”侵犯商标权</a><br><img src="https://image.xiaomo.info/travel/有趣恋人.jpg" alt></p>
<hr>
<h3 id="日本所有的商品价格标签都会有两个价格-含税价和不含税价，真正的明码标价，童叟无欺。"><a href="#日本所有的商品价格标签都会有两个价格-含税价和不含税价，真正的明码标价，童叟无欺。" class="headerlink" title="日本所有的商品价格标签都会有两个价格:含税价和不含税价，真正的明码标价，童叟无欺。"></a>日本所有的商品价格标签都会有两个价格:含税价和不含税价，真正的明码标价，童叟无欺。</h3><p>国内都是稀里糊涂，或许是因为税太高了，不敢标出来。我买个15万的车增值税出了2万多，购置税出了1万多，真是呵呵了。<br><img src="https://image.xiaomo.info/travel/price1.png" alt></p>
<hr>
<h3 id="日本的铁路和地铁一样方便"><a href="#日本的铁路和地铁一样方便" class="headerlink" title="日本的铁路和地铁一样方便"></a>日本的铁路和地铁一样方便</h3><p>日本铁路叫JR,每个站点外面都有自动售票机（当然也有人工窗口），随买随走不用记名。<br><img src="https://image.xiaomo.info/travel/jrji1.jpg" alt></p>
<hr>
<h3 id="日本的红绿灯在变绿后会发出声音，提示行人可以通过了"><a href="#日本的红绿灯在变绿后会发出声音，提示行人可以通过了" class="headerlink" title="日本的红绿灯在变绿后会发出声音，提示行人可以通过了"></a>日本的红绿灯在变绿后会发出声音，提示行人可以通过了</h3><p>并且颜色看着很不习惯，绿灯并不是绿色的，而是有点蓝色的感觉。在日本并不是100%没有人闯红灯，在小道上没车的时候偶尔也会看到红灯时有人通过，但不会出现中国式过马路。<br><img src="https://image.xiaomo.info/travel/honglvdeng.jpg" alt></p>
<hr>
<h3 id="日本能用支付宝的地方并不多-刷银联卡会更划算-打9-5折"><a href="#日本能用支付宝的地方并不多-刷银联卡会更划算-打9-5折" class="headerlink" title="日本能用支付宝的地方并不多,刷银联卡会更划算(打9.5折)"></a>日本能用支付宝的地方并不多,刷银联卡会更划算(打9.5折)</h3><p>听国内吹嘘的多么牛逼，支付宝己打开全球市场。虽然能用是事实，但是支持的店铺很少，机场免税店可以用、银座部分商场可以用，别的地方看到的很少，多数情况是付现金或刷卡。<br><img src="https://image.xiaomo.info/travel/alipay1.png" alt></p>
<hr>
<h3 id="所有的服务台-不管是柜台还是收银台-都会有一个小盘子"><a href="#所有的服务台-不管是柜台还是收银台-都会有一个小盘子" class="headerlink" title="所有的服务台(不管是柜台还是收银台)都会有一个小盘子"></a>所有的服务台(不管是柜台还是收银台)都会有一个小盘子</h3><p>付钱也好找零也好抑或是小票，都会放在小盘子里自取。可能因为日本用硬币情况下太多，放个盘确实会方便很多。<br><img src="https://image.xiaomo.info/travel/shouyin1.jpg" alt></p>
<hr>
<h3 id="在日本问路要谨慎"><a href="#在日本问路要谨慎" class="headerlink" title="在日本问路要谨慎"></a>在日本问路要谨慎</h3><p>在日本旅游期间我问路次数<br>算是比较多的，问到后面我都不好意思开口了。如果你在路上遇到一个人想问路说一句”あの、すみません(对不起，打扰一下)”、对方一定会停下脚步答到”はい、なんでしょうが(好的，请问有什么事？)”,然后芭啦芭啦给你讲怎么走。如果讲完还是没听懂，对方便会说 “ご案内します(请让我给你带路吧)”,然后跟着走就好了。到了之后他/她还会给你鞠躬道谢，这是我最接受不了的。本来麻烦了别人还要还要道谢，这让我很愧疚。总计问路多少次没统计，但是印象深刻的有一个老大爷，带着我走了5分钟左右一直把我带到地铁口，还准备带我下去买票。还好我说了接下来我自己去就好了，他才离开。第二个是中年大叔(或许不是本地人)，我问了他也不知道然后看我手机开着地图然后就带我绕了一圈还是没找到结果把我带到警察局了，让我问警察。(笑哭) 第3个是一个30多岁的阿姨，在地铁站给我讲了很久差点错过电车，在最后一秒跳上车，然后我忍不住深深的鞠了一躬表示道谢和歉意。第4个是一个年轻小伙子，是我们刚从东京到大阪下车在地铁里面徘徊，他上来问我们要去哪。我们把住宿地址给他看了之后便芭啦芭啦语速超快的讲了至少有3分钟，然后我们基本上都没听懂真是迷之尴尬，然后他就直接带着我们去坐车。才开始着实吓了我一跳。最后一个是在大阪天王寺公园我遇到一个阿姨问她这附近地铁在哪，才开始她讲日语发现我们听不大懂开始用蹩脚的英语和我们沟通，我们任性的用着半吊子日语回复，真是神奇的体验。<br><img src="https://image.xiaomo.info/travel/wenlu1.png" alt></p>
<hr>
<h3 id="日本的水果和零食特别贵"><a href="#日本的水果和零食特别贵" class="headerlink" title="日本的水果和零食特别贵"></a>日本的水果和零食特别贵</h3><p>以前听说日本的旅客来中国旅<br>游看到我们拿着勺子挖西瓜吃简直不敢相信。我现在是信了，他们苹果是按个卖的，大概4-5rmb一个。零食也很贵，随便一包都至少得10+rmb。我在想，日本人不吃零食和水果么。我怀疑我老婆在日本呆久了真能吃零食吃到我怀疑人生。<br><img src="https://image.xiaomo.info/travel/xigua1.jpg" alt></p>
<hr>
<h3 id="日本的交通很贵"><a href="#日本的交通很贵" class="headerlink" title="日本的交通很贵"></a>日本的交通很贵</h3><p>一站最低10块钱。我猜想是日本的地铁网太密集了，导致于很多在跑的地铁很大一部分人都坐不满，为了避免亏损太多，定价也很高。听说可以用西瓜卡刷地铁，不知道会不会便宜一点。<br><img src="https://image.xiaomo.info/travel/富士山车票.jpg" alt></p>
<hr>
<h3 id="日本地铁大部分时间都有位置"><a href="#日本地铁大部分时间都有位置" class="headerlink" title="日本地铁大部分时间都有位置"></a>日本地铁大部分时间都有位置</h3><p>我很奇怪明明有很多座位，但是很多人就是愿意站着，而且有部分人还是50岁以上的中老年人。反正我看到有座位一定会去坐的，出去玩每天都3万步，简直累趴了。<br><img src="https://image.xiaomo.info/travel/chexiang.jpg" alt></p>
<hr>
<h3 id="日本有站着吃面的面馆"><a href="#日本有站着吃面的面馆" class="headerlink" title="日本有站着吃面的面馆"></a>日本有站着吃面的面馆</h3><p>才开始我很好奇站着怎么吃，发现那位穿西装的大叔吃的那么自然。我知道盯着人看不礼貌，所以扫了一眼没看一直看。<br><img src="https://image.xiaomo.info/travel/站着吃饭.JPEG" alt> </p>
<hr>
<h3 id="进屋要脱鞋"><a href="#进屋要脱鞋" class="headerlink" title="进屋要脱鞋"></a>进屋要脱鞋</h3><p>不脱鞋会让人很困扰，我们去和服店看衣服时遇到一个中国女孩直接穿鞋进去了。然后马上被屋主带出来了，然后立刻去拿抹布去擦，让人很难为情。门口都会备拖鞋<br><img src="https://image.xiaomo.info/travel/tuoxie1.jpg" alt> </p>
<hr>
<h3 id="不打听别人的家事，更不要说隐私。"><a href="#不打听别人的家事，更不要说隐私。" class="headerlink" title="不打听别人的家事，更不要说隐私。"></a>不打听别人的家事，更不要说隐私。</h3><p>在一起工作十几年，不知道对方有几个兄弟姐妹。福原爱在接受日本媒体的采访时说，中国记者什么都问，问得直想哭。<br><img src="https://image.xiaomo.info/travel/fuyuanai.jpg" alt> </p>
<hr>
<h3 id="日本的自动贩卖机多到不敢让人相信"><a href="#日本的自动贩卖机多到不敢让人相信" class="headerlink" title="日本的自动贩卖机多到不敢让人相信"></a>日本的自动贩卖机多到不敢让人相信</h3><p>不管在多偏的乡下，只要有人住的地方都有自动贩卖机，这点真心太方便了。<br><img src="https://image.xiaomo.info/travel/自动贩卖机.png" alt>    </p>
<hr>
<h3 id="日本的垃圾桶很少"><a href="#日本的垃圾桶很少" class="headerlink" title="日本的垃圾桶很少"></a>日本的垃圾桶很少</h3><p>出去玩做好把垃圾背回家的准备。要么走很远都遇不到垃圾桶，要么一遇到就是一大排（分很多种类）。我们居住的生活垃圾最后都留给房东自己处理了，因为对我们来说相当棘手啊。<br><img src="https://image.xiaomo.info/travel/垃圾箱1.jpg" alt>       </p>
<hr>
<h3 id="日本的出租车门是自动的"><a href="#日本的出租车门是自动的" class="headerlink" title="日本的出租车门是自动的"></a>日本的出租车门是自动的</h3><p>虽然出国之前我们也知道，但是多年养成的习惯还是会随手去关门，然后被司机礼貌的提醒这个门是自动的，感觉超尴尬的。<br><img src="https://image.xiaomo.info/travel/自动门.png" alt> </p>
<h3 id="日本的地铁进口和出口是通用的"><a href="#日本的地铁进口和出口是通用的" class="headerlink" title="日本的地铁进口和出口是通用的"></a>日本的地铁进口和出口是通用的</h3><p>如果你正在出去，另一面会显示一个红色的叉提醒别人这个门暂时不能用，反之亦然。<br><img src="https://image.xiaomo.info/travel/改札口.png" alt></p>
<hr>
<h3 id="日本是一个高度自助的国度"><a href="#日本是一个高度自助的国度" class="headerlink" title="日本是一个高度自助的国度"></a>日本是一个高度自助的国度</h3><p>好像日本是一个不担心路人不给钱，破坏自助设备的国家，到处都是自动贩卖机。其实，不仅仅是卖饮料，日本的超市，医院，加油站等等都实现了自助付款，不懂日文的话会有些很不方便。我去入住了东京和大阪的民宿全程都没有见到房东，但是走的时候我们会去房间好好整理一下，还获得了房东的夸奖。还有去商场买衣服的时候旁边有很多台机器，把衣服放进去会显示价格，然后投币就可以把衣服拿走了，当然袋子就在机器边上，就是这么自助，超级不适应的说。下面的是airbnb的房东的评价：<br><img src="https://image.xiaomo.info/travel/airbnb评价.png" alt>                  </p>
<h1 id="开销"><a href="#开销" class="headerlink" title="开销"></a>开销</h1><ul>
<li>机票 2800/人</li>
<li>接机 400/次</li>
<li>JR PASS 1600/张</li>
<li>交通约 50/天/人</li>
<li>大阪周游券 300/人</li>
<li>住宿 350/天/人</li>
<li>吃饭 50/顿/人</li>
<li>购物 约10000rmb左右</li>
</ul>
<p>两个人合计2.5万RMB左右。</p>
<h1 id="购物清单"><a href="#购物清单" class="headerlink" title="购物清单"></a>购物清单</h1><ul>
<li>注意：发票会订在护照上要保存好，过海关时可能会检查。免税(8%)化妆品过海关前不要开封，不然要交税。<br>PS4、游戏碟、手表、雪肌精、Beauteye、玫瑰滴眼液、FX银瓶滴眼液、龙角散、白色恋人、七星香烟、香水、zippo打火机、太田胃药、大正制药口腔溃疡贴、小儿退烧贴、大麦若叶、巧克力零食、坚果、小红丸、MINON、化妆水、EVE止疼药、儿童沐浴液、伊藤园绿茶、Ipsa粘土面膜酵素X酵母<br><img src="https://image.xiaomo.info/travel/成果.jpg" alt></li>
</ul>
<h1 id="值得买但没买的东西-网上搜集"><a href="#值得买但没买的东西-网上搜集" class="headerlink" title="值得买但没买的东西(网上搜集)"></a>值得买但没买的东西(网上搜集)</h1><h2 id="护肤品："><a href="#护肤品：" class="headerlink" title="护肤品："></a>护肤品：</h2><ul>
<li>SK2神仙水</li>
<li>Albion奥尔滨健康水</li>
<li>Albion渗透乳</li>
<li>Mandom曼丹眼唇卸妆油</li>
<li>Kose高丝卸妆油</li>
<li>Rosette硫磺祛痘膏</li>
<li>Rosette海泥洗面奶</li>
<li>Smile suisai酵素洁面粉</li>
<li>Skinlife泡沫洗面奶</li>
<li>Shiseido资生堂洗颜专科</li>
<li>Albion奥尔滨健康皂</li>
<li>IPSA化妆棉</li>
<li>Unicharm1/2省水化妆棉 </li>
</ul>
<p><img src="https://image.xiaomo.info/travel/洗面奶.png" alt><br><img src="https://image.xiaomo.info/travel/防晒霜.png" alt></p>
<h2 id="化妆品："><a href="#化妆品：" class="headerlink" title="化妆品："></a>化妆品：</h2><ul>
<li>Impress granmula 端正环采顶级粉霜</li>
<li>CPB肌肤之钥高光</li>
<li>CPB肌肤之钥遮瑕棒</li>
<li>Kate眉粉</li>
<li>Kate眼影</li>
<li>Kissme睫毛膏</li>
<li>Kissme眼线笔</li>
<li>Canmake棉花糖粉饼</li>
<li>DHC唇膏</li>
<li>Shiseido资生堂药用唇膏</li>
<li>Anessa安耐晒金瓶</li>
<li>Anessa安耐晒银瓶</li>
<li>ALLIE防晒</li>
<li>Narisup娜丽丝防晒喷雾</li>
<li>Deonatulle止汗石</li>
<li>Shiseido资生堂131粉刷</li>
<li>Shiseido资生堂119粉扑</li>
<li>Shiseido资生堂睫毛夹</li>
<li>Shiseido资生堂眉刀</li>
</ul>
<p><img src="https://image.xiaomo.info/travel/卸妆水.png" alt><br><img src="https://image.xiaomo.info/travel/陶瓷刀.png" alt><br><img src="https://image.xiaomo.info/travel/化妆品.png" alt><br><img src="https://image.xiaomo.info/travel/面膜.png" alt><br><img src="https://image.xiaomo.info/travel/sk2.png" alt></p>
<h2 id="日用品："><a href="#日用品：" class="headerlink" title="日用品："></a>日用品：</h2><ul>
<li>Lycee乐敦小红花滴眼液</li>
<li>狮王滴眼液</li>
<li>Kissyou负离子牙刷</li>
<li>Smile cosmetique美白牙膏</li>
<li>狮王美白牙膏</li>
<li>Ora2美白牙膏</li>
<li>花王泡沫染发剂</li>
<li>Hair Recipe银杏果蜂蜜洗发水</li>
<li>reveur无硅洗发水</li>
<li>资生堂Fino发膜</li>
<li>树之惠足贴</li>
<li>花王蒸汽眼罩</li>
<li>bold洗衣液 </li>
<li>Lenor Eau deLuxe衣物柔顺剂</li>
<li>汉方天然果蔬清洁贝壳杀菌粉</li>
<li>陶瓷刀</li>
<li>匠牌指甲刀</li>
<li>小学生书包</li>
</ul>
<p><img src="https://image.xiaomo.info/travel/牙膏.png" alt><br><img src="https://image.xiaomo.info/travel/牙刷.png" alt><br><img src="https://image.xiaomo.info/travel/护唇.png" alt><br><img src="https://image.xiaomo.info/travel/护发类.png" alt><br><img src="https://image.xiaomo.info/travel/保温杯.png" alt></p>
<h2 id="药品："><a href="#药品：" class="headerlink" title="药品："></a>药品：</h2><ul>
<li>Crystal硅素水</li>
<li>药王酵素100</li>
<li>新谷夜酵素</li>
<li>DHC维生素</li>
<li>小林制药Breath care口气清新薄荷丸</li>
<li>小林制药液体创可贴</li>
<li>AG鼻塞喷雾剂</li>
<li>狮王祛痘膏 </li>
<li>白兔祛痘膏 </li>
<li>浅田饴</li>
<li>大正制药感冒颗粒</li>
</ul>
<p><img src="https://image.xiaomo.info/travel/药品1.png" alt><br><img src="https://image.xiaomo.info/travel/药品2.png" alt><br><img src="https://image.xiaomo.info/travel/眼药水.png" alt><br><img src="https://image.xiaomo.info/travel/感冒药.png" alt><br><img src="https://image.xiaomo.info/travel/膏药.png" alt><br><img src="https://image.xiaomo.info/travel/保健类.png" alt></p>
<h2 id="食品："><a href="#食品：" class="headerlink" title="食品："></a>食品：</h2><ul>
<li>Royce生巧克力 </li>
<li>Royce巧克力饼干</li>
<li>Tokyo Banana东京香蕉蛋糕 </li>
<li>Potato Farm薯条三兄弟</li>
<li>Kracie玫瑰香体糖</li>
<li>Uha葡萄味觉糖</li>
<li>Calbee麦片</li>
</ul>
<p><img src="https://image.xiaomo.info/travel/薯条三兄弟.png" alt><br><img src="https://image.xiaomo.info/travel/蔬菜汁.png" alt><br><img src="https://image.xiaomo.info/travel/糖.png" alt><br><img src="https://image.xiaomo.info/travel/茶叶.png" alt><br><img src="https://image.xiaomo.info/travel/白色恋人.png" alt><br><img src="https://image.xiaomo.info/travel/Rocyce生巧克力.png" alt></p>
<h2 id="电器："><a href="#电器：" class="headerlink" title="电器："></a>电器：</h2><ul>
<li>Tescom负离子胶原蛋白吹风机</li>
<li>Panasonic松下卷发棒</li>
<li>Panasonic松下造型吹风机</li>
<li>Panasonic蒸脸器</li>
<li>象印保温杯</li>
<li>膳魔师保温杯</li>
<li>象印焖烧杯</li>
<li>虎牌焖烧杯</li>
<li>剃须刀</li>
<li>索尼电子产品<br><img src="https://image.xiaomo.info/travel/小家电.png" alt></li>
</ul>
<h2 id="参考攻略"><a href="#参考攻略" class="headerlink" title="参考攻略"></a>参考攻略</h2><ul>
<li><a href="https://www.mafengwo.cn/i/5339323.html" target="_blank" rel="noopener">日本购物攻略——去日本值得购买的80件产品</a></li>
<li><a href="http://bbs.yilvcheng.com/gonglue/1642.html" target="_blank" rel="noopener">2016日本购物攻略，去日本旅行千万别买这些东西 切记</a></li>
<li><a href="http://www.mafengwo.cn/travel-news/272562.html" target="_blank" rel="noopener">去日本必买的东西top10</a></li>
</ul>
<hr>
<ul>
<li><a href="https://post.smzdm.com/p/502174/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇一：第一日 抵达东京，逛银座及东京塔</a></li>
<li><a href="https://post.smzdm.com/p/502273/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇二：第二日 筑地，皇居，秋叶原和台场</a></li>
<li><a href="https://post.smzdm.com/p/545500/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇三：第三日 上野动物园，浅草寺，天空树</a></li>
<li><a href="https://post.smzdm.com/p/547769/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇四：第四日 江之岛，镰仓</a></li>
<li><a href="https://post.smzdm.com/p/553268/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇五：第五日 去往富士河口湖</a></li>
<li><a href="https://post.smzdm.com/p/556217/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇六：第六日 去往京都</a></li>
<li><a href="https://post.smzdm.com/p/560026/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇七：第七日 八坂神社，二年坂，三年坂，清水寺</a></li>
<li><a href="https://post.smzdm.com/p/562421/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇八：第八日 仙洞御所，伏见稻荷大社</a></li>
<li><a href="https://post.smzdm.com/p/563714/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇九：第九日 奈良行，春日大社，东大寺</a></li>
<li><a href="https://post.smzdm.com/p/563732/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十：第十日 二条城，东西本愿寺</a></li>
<li><a href="https://post.smzdm.com/p/568535/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十一：第十一日 金阁寺，岚山景区</a></li>
<li><a href="https://post.smzdm.com/p/570614/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十二：第十二日 去往大阪，海游馆，天保山摩天轮</a></li>
<li><a href="https://post.smzdm.com/p/574237/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十三：第十三日 大阪环球影城</a></li>
<li><a href="https://post.smzdm.com/p/577318/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十四：第十四日 大阪城 道顿堀</a></li>
<li><a href="https://post.smzdm.com/p/581686/" target="_blank" rel="noopener">懒人夫妻由东到西的日本15日自由行详细流水账攻略 篇十五：最后一日：梅田蓝天大厦 返回厦门以及算总账</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[游戏服务器的常用架构]]></title>
      <url>https://blog.xiaomo.info/2017/GameServerType/</url>
      <content type="html"><![CDATA[<p>游戏服务器，是一个会长期运行程序，并且它还要服务于多个不定时，不定点的网络请求。所以这类服务的特点是要特别关注稳定性和性能。这类程序如果需要多个协作来提高承载能力，则还要关注部署和扩容的便利性；同时，还需要考虑如何实现某种程度容灾需求。由于多进程协同工作，也带来了开发的复杂度，这也是需要关注的问题。<br><a id="more"></a></p>
<h1 id="游戏服务器架构要素"><a href="#游戏服务器架构要素" class="headerlink" title="游戏服务器架构要素"></a>游戏服务器架构要素</h1><p>对于游戏服务端架构，最重要的三个部分就是，如何使用CPU、内存、网卡的设计：</p>
<ul>
<li>内存架构：主要决定服务器如何使用内存，以最大化利用服务器端内存来提高承载量，降低服务延迟。</li>
<li>逻辑架构：设计如何使用进程、线程、协程这些对于CPU调度的方案。选择同步、异步等不同的编程模型，以提高服务器的稳定性和承载量。可以分区分服，也可以采用世界服的方式，将相同功能模块划分到不同的服务器来处理。</li>
<li>通信模式：决定使用何种方式通讯。基于游戏类型不同采用不同的通信模式，比如http,tcp,udp等。</li>
</ul>
<h1 id="游戏类型"><a href="#游戏类型" class="headerlink" title="游戏类型"></a>游戏类型</h1><h2 id="卡牌跑酷等休闲游戏弱交互游戏"><a href="#卡牌跑酷等休闲游戏弱交互游戏" class="headerlink" title="卡牌跑酷等休闲游戏弱交互游戏"></a>卡牌跑酷等休闲游戏弱交互游戏</h2><p><img src="https://image.xiaomo.info/game/card.png" alt></p>
<h2 id="分区分服RPG游戏（RPG页游）"><a href="#分区分服RPG游戏（RPG页游）" class="headerlink" title="分区分服RPG游戏（RPG页游）"></a>分区分服RPG游戏（RPG页游）</h2><p><img src="https://image.xiaomo.info/game/single.png" alt></p>
<p>分服模型是游戏服务器中最典型，也是历久最悠久的模型。在早期服务器的承载量达到上限的时候，游戏开发者就通过架设更多的服务器来解决。这样提供了很多个游戏的“平行世界”，让游戏中的人人之间的比较，产生了更多的空间。其特征是游戏服务器是一个个单独的世界。每个服务器的帐号是独立的，每台服务器用户的状态都是不一样的，一个服就是一个世界，大家各不牵扯。<br>后来游戏玩家呼吁要跨服打架，于是就出现了跨服战，再加上随着游戏的运行，单个服务器的游戏活跃玩家越来越少，所以后期就有了服务器的合并以及迁移，慢慢的以服务器的开放、合并形成了一套成熟的运营手段。目前多数游戏还采用分服的结构来架设服务器，多数页游还是采用这种模式。</p>
<h2 id="数据共享游戏服务器"><a href="#数据共享游戏服务器" class="headerlink" title="数据共享游戏服务器"></a>数据共享游戏服务器</h2><p><img src="https://image.xiaomo.info/game/share.png" alt><br>网关部分分离成单端的gate服务器，DB部分分离为DB服务器，把网络功能单独提取出来，让用户统一去连接一个网关服务器，再有网关服务器转发数据到后端游戏服务器。而游戏服务器之间数据交换也统一连接到网管进行交换。所有有DB交互的，都连接到DB服务器来代理处理。</p>
<p><img src="https://image.xiaomo.info/game/custer.png" alt></p>
<ul>
<li>场景服务器：它负责完成主要的游戏逻辑，这些逻辑包括：角色在游戏场景中的进入与退出、角色的行走与跑动、角色战斗（包括打怪）、任务的认领等。场景服务器设计的好坏是整个游戏世界服务器性能差异的主要体现，它的设计难度不仅仅在于通信模型方面，更主要的是整个服务器的体系架构和同步机制的设计。</li>
<li>非场景服务器：它主要负责完成与游戏场景不相关的游戏逻辑，这些逻辑不依靠游戏的地图系统也能正常进行，比如公会聊天或世界聊天，之所以把它从场景服务器中独立出来，是为了节省场景服务器的CPU和带宽资源，让场景服务器能够尽可能快地处理那些对游戏流畅性影响较大的游戏逻辑。</li>
<li>网关服务器: 在类型一种的架构中，玩家在多个地图跳转或者场景切换的时候采用跳转的模式，以此进行跳转不同的服务器。还有一种方式是把这些服务器的节点都通过网关服务器管理，玩家和网关服务器交互，每个场景或者服务器切换的时候，也有网关服务器统一来交换数据，如此玩家操作会比较流畅。</li>
</ul>
<h2 id="房间游戏"><a href="#房间游戏" class="headerlink" title="房间游戏"></a>房间游戏</h2><p><img src="https://image.xiaomo.info/game/room.png" alt><br>房间类玩法和MMORPG有很大的不同，在于其在线广播单元的不确定性和广播数量很小。而且需要匹配一台房间服务器让少数人进入一个服务器。<br>这一类游戏最重要的是其“游戏大厅”的承载量，每个“游戏房间”受逻辑所限，需要维持和广播的玩家数据是有限的，但是“游戏大厅”需要维持相当高的在线用户数，所以一般来说，这种游戏还是需要做“分服”的。典型的游戏就是《英雄联盟》这一类游戏了。而“游戏大厅”里面最有挑战性的任务，就是“自动匹配”玩家进入一个“游戏房间”，这需要对所有在线玩家做搜索和过滤。<br>玩家先登录“大厅服务器”，然后选择组队游戏的功能，服务器会通知参与的所有游戏客户端，新开一条连接到房间服务器上，这样所有参与的用户就能在房间服务器里进行游戏交互了。</p>
]]></content>
      
        <categories>
            
            <category> game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> server </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[lombok常用注解整理]]></title>
      <url>https://blog.xiaomo.info/2017/JavaLombok/</url>
      <content type="html"><![CDATA[<p>2017-09-11-lombok常用注解整理<br><a id="more"></a></p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><a href="http://projectlombok.org/" target="_blank" rel="noopener">lombok</a> 提供了简单的注解的形式来帮助我们简化消除一些必须有但显得很臃肿的 java 代码。</p>
<h1 id="lombok插件-安装"><a href="#lombok插件-安装" class="headerlink" title="lombok插件 安装"></a>lombok插件 安装</h1><p>使用 lombok 是需要安装插件的，如果不安装，IDE 则无法解析 lombok 注解。 </p>
<ul>
<li><p>idea<br><img src="https://image.xiaomo.info/idea_lombok.png" alt></p>
</li>
<li><p>eclipse/myeclipse       </p>
</li>
</ul>
<ol>
<li>将 <a href="https://projectlombok.org/downloads/lombok.jar" target="_blank" rel="noopener">lombok.jar</a>复制到 myeclipse.ini / eclipse.ini 所在的文件夹目录下     </li>
<li>打开 eclipse.ini / myeclipse.ini，在最后面插入以下两行并保存：<br>-Xbootclasspath/a:lombok.jar<br>-javaagent:lombok.jar<br>3.重启 eclipse / myeclipse          </li>
</ol>
<h1 id="常用注解"><a href="#常用注解" class="headerlink" title="常用注解"></a>常用注解</h1><ul>
<li><a href="https://projectlombok.org/features/Data" target="_blank" rel="noopener">@Data</a>  注解在类上；提供类所有属性的 getting 和 setting 方法，此外还提供了equals、canEqual、hashCode、toString 方法</li>
<li><a href="https://projectlombok.org/features/GetterSetter" target="_blank" rel="noopener">@Setter</a> ：注解在属性上；为属性提供 setting 方法</li>
<li><a href="https://projectlombok.org/features/GetterSetter" target="_blank" rel="noopener">@Setter</a> ：注解在属性上；为属性提供 getting 方法</li>
<li><a href="https://projectlombok.org/features/Log4j" target="_blank" rel="noopener">@Log4j</a>  ：注解在类上；为类提供一个 属性名为log 的 log4j 日志对象</li>
<li><a href="https://projectlombok.org/features/constructor" target="_blank" rel="noopener">@NoArgsConstructor</a> ：注解在类上；为类提供一个无参的构造方法</li>
<li><a href="https://projectlombok.org/features/constructor" target="_blank" rel="noopener">@AllArgsConstructor</a> ：注解在类上；为类提供一个全参的构造方法</li>
<li><a href="https://projectlombok.org/features/Cleanup" target="_blank" rel="noopener">@Cleanup</a>  : 可以关闭流</li>
<li><a href="https://projectlombok.org/features/Builder" target="_blank" rel="noopener">@Builder</a>  ： 被注解的类加个构造者模式</li>
<li><a href="https://projectlombok.org/features/Synchronized" target="_blank" rel="noopener">@Synchronized</a>  ： 加个同步锁</li>
<li><a href="https://projectlombok.org/features/SneakyThrows" target="_blank" rel="noopener">@SneakyThrows</a> : 等同于try/catch 捕获异常</li>
<li><a href="https://projectlombok.org/features/NonNull" target="_blank" rel="noopener">@NonNull</a> : 如果给参数加个这个注解 参数为null会抛出空指针异常</li>
<li>@Value : 注解和@Data类似，区别在于它会把所有成员变量默认定义为private final修饰，并且不会生成set方法。</li>
</ul>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><ul>
<li>官方文档： <a href="https://projectlombok.org/features/all" target="_blank" rel="noopener">https://projectlombok.org/features/all</a></li>
<li>lombok注解介绍  <a href="http://blog.csdn.net/sunsfan/article/details/53542374" target="_blank" rel="noopener">http://blog.csdn.net/sunsfan/article/details/53542374</a></li>
<li>Lombok介绍及使用方法 <a href="http://www.cnblogs.com/holten/p/5729226.html" target="_blank" rel="noopener">http://www.cnblogs.com/holten/p/5729226.html</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> lombok </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[swift项目初探]]></title>
      <url>https://blog.xiaomo.info/2017/SwiftProjectBuild/</url>
      <content type="html"><![CDATA[<p>截至到上一篇博客到现在为止差不多有一个月了,时光飞逝,从来没有觉得时间过的如此之快。在这一个月中其实发生了很多事:学完了日语中级上册,记了整整一本笔记;装上了黑苹果,因此也有机会接触到IOS相关的内容,所以大致过了一遍swift3的语法;养了一只小仓鼠,生活变的有趣许多;整理了一下github,切换了主邮箱。其他来说,生活依旧在继续，折腾一直未停止,为了生活,为了编程.我一直在努力,也从未放弃。记一篇swift入门的博客以作慰藉。<br><a id="more"></a></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>因为本人是在学习swift中,所以这篇文章更多的成份算是自己的笔记,只是将自己的经历分享出来。请大牛们勿喷,小白们别当权威。如果有错误请指出，我一定会虚心改正。最后，与君共勉，早日成为独当一面的人物。</p>
<h3 id="一-基本环境"><a href="#一-基本环境" class="headerlink" title="一.基本环境"></a>一.基本环境</h3><blockquote>
<p>OS x 10.11.6<br> Xcode 8.2.1<br> swift 3.0.2<br> swift package manager 3.0.2<br> pod 1.2.1<br> carthage 0.20.1 </p>
</blockquote>
<p> 因为xcode是严格和os x版本对照的,所以我的10.11.6黑苹果就止步于8.2.1版本的xcode,因此swift3.1也玩不了,表示很心痛.</p>
<h3 id="二-swift能做些什么"><a href="#二-swift能做些什么" class="headerlink" title="二 swift能做些什么"></a>二 swift能做些什么</h3><ol>
<li>IOS手机APP开发(据说也能开发android应用,期待大一统)</li>
<li>Mac电脑应用,同样的软件,在mac上看着就是高雅,这不得不说是apple的功劳</li>
<li>watchOS和TvOS,暂时没接触到</li>
<li>服务端开发,也就是说可以开发网站或者其他各种东西,对应框架有Perfect，Vapor，Kitura 和 Zewo. <a href="https://sdk.cn/news/4150" target="_blank" rel="noopener">附一篇文章介绍</a></li>
<li>其他待挖掘,世界各国的计算机科学家们可不是打酱油的.<h3 id="三-SPM是什么鬼"><a href="#三-SPM是什么鬼" class="headerlink" title="三. SPM是什么鬼"></a>三. SPM是什么鬼</h3>Swift Package Manager(SPM)是苹果最新的官方工具,可以用来管理 Swift 代码的分配，它为 Swift 编译系统集成了自动进行下载、编译和连接依赖的过程,不过目前还处于早期开发阶段。</li>
</ol>
<p>支持的平台</p>
<p>✔ macOS<br>✔ Linux<br>✘ iOS<br>✘ watchOS<br>✘ tvOS      </p>
<p>在此之前我们常用的工具是<code>Cocoapods</code>和<code>Carthage</code>。</p>
<ol>
<li><p>如何下载<br><a href="https://swift.org/download/#releases" target="_blank" rel="noopener">下载对应版本</a>,然后安装<br>在终端中执行 <code>export PATH=/Library/Developer/Toolchains/swift-latest.xctoolchain/usr/bin:&quot;${PATH}&quot;</code></p>
</li>
<li><p>验证是否安装成功</p>
</li>
</ol>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">swift </span><span class="keyword">build </span>--version</span><br><span class="line"><span class="keyword">Swift </span>Package Manager - <span class="keyword">Swift </span><span class="number">3</span>.<span class="number">0</span>.<span class="number">2</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>怎么使用<br>首先，使用 <code>mkdir</code> 创建一个新的目录，用来放置你的包或者应用。<br>这里我们使用 <code>helloworld</code> 作为例子：<code>mkdir helloworld</code>。<br>然后，使用 <code>cd</code> 命令进入 <code>helloworld</code> 目录，运行命令：<code>swift build --init</code>。</li>
</ol>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"># cd helloworld</span><br><span class="line"># <span class="keyword">swift </span><span class="keyword">build </span>--init</span><br><span class="line"><span class="symbol">Creating</span> Package.<span class="keyword">swift</span></span><br><span class="line"><span class="keyword">Creating </span>.gitignore</span><br><span class="line"><span class="symbol">Creating</span> Sources/</span><br><span class="line"><span class="symbol">Creating</span> Sources/main.<span class="keyword">swift</span></span><br><span class="line"><span class="keyword">Creating </span>Tests/</span><br></pre></td></tr></table></figure>
<p>我们看看 <code>swift build --init</code> 生成的内容：</p>
<ol>
<li><code>Package.swift</code>：包的”配置信息”（manifest）。<code>swift build --init</code>使用你创建的目录名作为包名。   </li>
<li><code>Sources</code>目录：按照 SwiftPM 的要求，所有的源代码文件都放到 Sources 目录下。   </li>
<li><code>main.swift</code>：Swift 应用使用 <code>main.swift</code>（有且只有一个）作为程序执行的入口。   </li>
<li><code>Tests</code> 目录：存放应用的测试用例。</li>
<li><code>.gitignore</code>：一个便捷的 <code>git gitignore</code> 文件，忽略一些本地编译时用到的配置目录和文件，比如: <code>.build</code> 和 <code>Packages</code> 目录（一些你不想加入到 git 库的东西）。</li>
</ol>
<p>在这个 <code>helloword</code> 例子中，<code>Package.swift</code> 文件内容如下：</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">import PackageDescription</span><br><span class="line"></span><br><span class="line">let <span class="keyword">package</span> <span class="title">= <span class="keyword">Package</span>(</span></span><br><span class="line">    name: <span class="string">"helloworld"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>运行 <code>swift build</code> 会创建可执行文件 <code>.build/debug/helloworld</code>，运行这个文件就会在终端输出 <code>Hello, world!</code>.<br>如果你想编译一个 Swift 库，只需要删除 <code>main.swift</code> 文件，然后替换成你的库代码。在没有 <code>main.swift</code> 的情况下，<code>SwiftPM</code> 会创建一个静态的库。</p>
<ol start="4">
<li><p>怎么在xcode中打开<br>在项目根目录运行 <code>swift package generate-xcodeproj</code>,会生成<code>xcodeproj</code>,此时可以用xcode打开这个项目<br>我们来看看生成的代码是什么样子的<br><img src="https://image.xiaomo.info/swift/spg-category.png" alt></p>
</li>
<li><p>怎么添加其他依赖<br>我们以引入Alamofire为例<br>项目根目录有一个<code>Package.swift</code>的文件,打开这个文件,加入Alamofire的地址 <code>.Package(url: &quot;https://github.com/Alamofire/Alamofire.git&quot;, majorVersion: 4)</code></p>
</li>
</ol>
<p>文件内容如下</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PackageDescription</span><br><span class="line"></span><br><span class="line">let <span class="keyword">package</span> = <span class="keyword">Package</span>(</span><br><span class="line">    name: <span class="string">"spg"</span>,</span><br><span class="line">    <span class="keyword">dependencies</span>: [</span><br><span class="line">        .<span class="keyword">Package</span>(url: <span class="string">"https://github.com/Alamofire/Alamofire.git"</span>, majorVersion: <span class="number">4</span>)</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>然后运行再次在项目根目录运行 <code>swift build</code> 就会下载Alamofire的依赖</p>
<h3 id="四-pod又是干咩的"><a href="#四-pod又是干咩的" class="headerlink" title="四. pod又是干咩的"></a>四. pod又是干咩的</h3><ol>
<li>CocoaPods是什么？<br>当你开发iOS应用时，会经常使用到很多第三方开源类库，比如JSONKit，AFNetWorking等等。可能某个类库又用到其他类库，所以要使用它，必须得另外下载其他类库，而其他类库又用到其他类库，“子子孙孙无穷尽也”，这也许是比较特殊的情况。总之我的意思就是，手动一个个去下载所需类库十分麻烦。另外一种常见情况是，你项目中用到的类库有更新，你必须得重新下载新版本，重新加入到项目中，十分麻烦。如果能有什么工具能解决这些恼人的问题，那将“善莫大焉”。所以，你需要 CocoaPods。<br>CocoaPods应该是iOS最常用最有名的类库管理工具了，上述两个烦人的问题，通过cocoaPods，只需要一行命令就可以完全解决，当然前提是你必须正确设置它。重要的是，绝大部分有名的开源类库，都支持CocoaPods。所以，作为iOS程序员的我们，掌握CocoaPods的使用是必不可少的基本技能了。</li>
<li>如何下载和安装CocoaPods？<br>在安装CocoaPods之前，首先要在本地安装好Ruby环境。至于如何在Mac中安装好Ruby环境，请google一下，本文不再涉及。<br>假如你在本地已经安装好Ruby环境，那么下载和安装CocoaPods将十分简单，只需要一行命令。在Terminator（也就是终端）中输入以下命令（注意，本文所有命令都是在终端中输入并运行的。什么，你不知道什么是终端？那请我吃饭，我告诉你）：<br> <code>sudo gem install cocoapods</code><br>如果下载不了可能又是伟大的墙在发挥作用,请自行翻墙或修改国内镜像源.<br>正常来说,等上十几秒钟，CocoaPods就可以在你本地下载并且安装好了，不再需要其他设置。</li>
</ol>
<p>好了，安装好CocoPods之后，接下来就是使用它。所幸，使用CocoPods和安装它一样简单，也是通过一两行命令就可以搞定。</p>
<p>我在这里用两种使用场景来具体说明如何使用CocoaPods。</p>
<h4 id="场景1：利用CocoaPods，在项目中导入Alamofire类库"><a href="#场景1：利用CocoaPods，在项目中导入Alamofire类库" class="headerlink" title="场景1：利用CocoaPods，在项目中导入Alamofire类库"></a>场景1：利用CocoaPods，在项目中导入Alamofire类库</h4><p>Alamofire类库在GitHub地址是：<a href="https://github.com/Alamofire/Alamofire.git" target="_blank" rel="noopener">https://github.com/Alamofire/Alamofire.git</a></p>
<p>为了确定Alamofire是否支持CocoaPods，可以用CocoaPods的搜索功能验证一下。在终端中输入：<br><code>pod search Alamofire</code></p>
<p>如果能正确返回<code>Alamofire</code>相关信息。这说明，Alamofire是支持CocoaPods，所以我们可以利用CocoaPods将Alamofire导入你的项目中。</p>
<p>我们创建一个swift的ios项目,然后在终端中切换到该项目的根目录,运行以下命令:<br><code>pod init</code></p>
<p>这个命令会在根目录下生成一个<code>Podfile</code>,我们在这个文件中添加相应的依赖就可以了.</p>
<p>修改Podfile文件,添加依赖</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Uncomment the next line to define a global platform for your project</span></span><br><span class="line">source <span class="string">'https://github.com/CocoaPods/Specs.git'</span></span><br><span class="line">platform <span class="symbol">:ios</span>, ’<span class="number">10.2</span>’</span><br><span class="line"></span><br><span class="line">target <span class="string">'cocopodsDemo'</span> <span class="keyword">do</span></span><br><span class="line">  pod <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 4.4'</span></span><br><span class="line">  <span class="comment"># Comment the next line if you're not using Swift and don't want to use dynamic frameworks</span></span><br><span class="line">  use_frameworks!</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Pods for cocopodsDemo</span></span><br><span class="line"></span><br><span class="line">  target <span class="string">'cocopodsDemoTests'</span> <span class="keyword">do</span></span><br><span class="line">    inherit! <span class="symbol">:search_paths</span></span><br><span class="line">    <span class="comment"># Pods for testing</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  target <span class="string">'cocopodsDemoUITests'</span> <span class="keyword">do</span></span><br><span class="line">    inherit! <span class="symbol">:search_paths</span></span><br><span class="line">    <span class="comment"># Pods for testing</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>然后运行 <code>pod install</code></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Analyzing dependencies</span><br><span class="line">Downloading dependencies</span><br><span class="line">Installing Alamofire (4.4.0)</span><br><span class="line">Generating Pods project</span><br><span class="line">Integrating<span class="built_in"> client </span>project</span><br><span class="line"></span><br><span class="line">[!] Please close any current Xcode sessions <span class="keyword">and</span> use `cocopodsDemo.xcworkspace` <span class="keyword">for</span> this project <span class="keyword">from</span> now on.</span><br><span class="line">Sending stats</span><br><span class="line">Pod installation complete! There is 1 dependency <span class="keyword">from</span> the Podfile <span class="keyword">and</span> 1 total pod installed.</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意提示: 告诉我们要关掉xocode,选择<code>cocopodsDemo.xcworkspace</code>打开项目,目录结构现在应该是这个样子的.</p>
</blockquote>
<p><img src="https://image.xiaomo.info/swift/cocoapodsDemo.png" alt></p>
<p>添加<code>Alamofile</code>依赖<br><code>Product</code>=&gt;<code>Schemes</code>=&gt;<code>Manage Schemes</code>,将<code>Alamofile</code>勾上,<br><img src="https://image.xiaomo.info/swift/addSchemes.png" alt></p>
<p>此时,我们就可以使用<code>Alamofile</code>来做些有趣的事情了。</p>
<h5 id="关于-Podfile-lock"><a href="#关于-Podfile-lock" class="headerlink" title="关于 Podfile.lock"></a>关于 Podfile.lock</h5><p>当你执行pod install之后，除了 Podfile 外，CocoaPods 还会生成一个名为Podfile.lock的文件，Podfile.lock 应该加入到版本控制里面，不应该把这个文件加入到.gitignore中。因为Podfile.lock会锁定当前各依赖库的版本，之后如果多次执行pod install 不会更改版本，要pod update才会改Podfile.lock了。这样多人协作的时候，可以防止第三方库升级时造成大家各自的第三方库版本不一致</p>
<h4 id="场景2：如何正确编译运行一个包含CocoPods类库的项目"><a href="#场景2：如何正确编译运行一个包含CocoPods类库的项目" class="headerlink" title="场景2：如何正确编译运行一个包含CocoPods类库的项目"></a>场景2：如何正确编译运行一个包含CocoPods类库的项目</h4><p>你也许曾经遇到过（特别是新手iOS开发者）这种情况，好不容易在GitHub上找到一份代码符合自己想需求，兴冲冲下载下来，一编译，傻眼了，发现有各种各样错误。一看，原来是缺失了各种其他第三方类库。这时候莫慌，你再仔细一看，会发现你下载的代码包含了Podfile。没错，这意味着你可以用CocoaPods很方便下载所需要的类库。</p>
<p>下面，我以代码 <a href="https://github.com/UrbanApps/UAAppReviewManager" target="_blank" rel="noopener">UAAppReviewManager</a> 为例来说明如何正确编译运行一个包含CocoPods类库的项目。<br>UAAppReviewManager是一个能够让你方便地将提醒用户评分的功能加入你的应用中。当你去UAAppReviewManager的GitHub地址下载这份代码之后，打开Example工程（UAAppReviewManagerExample），编译，你会发现Xcode报告一大堆错误，基本都是说你编译的这份代码找不到某某头文件，这就意味着你要成功编译UAAppReviewManager的Example代码，必须先导入一些第三方类库。同时你会发现在UAAppReviewManagerExample文件夹下面有三个跟CocosPods相关的文件（文件夹）：Podfile，Podfile.lock和Pods</p>
<p>这时候，打开终端，进入UAAppReviewManagerExample所在的目录，也就是和Podfile在同一目录下，和场景1一样，输入以下命令（由于已经有Podfile，所以不需要再创建Podfile）：</p>
<p><code>$ pod update</code></p>
<p>这时候，再回到<code>UAAppReviewManagerExample</code>文件夹看一看，会看到多了一个文件<code>UAAppReviewManagerExample.xcworkspace</code><br>根据终端的信息提示，你以后就需用新产生的<code>UAAppReviewManagerExample.xcworkspace</code>来运行这个<code>Example</code>代码了。<br>打开<code>UAAppReviewManagerExample.xcworkspace</code>，编译运行，成功</p>
<p>注意，这里有个小问题，如果刚刚你不是输入<code>$ pod update</code>，而是输入<code>$ pod install</code>，会发现类库导入不成功</p>
<p>这里的意思大概是<code>Podfile</code>文件过期，类库有升级，但是<code>Podfile</code>没有更改。<code>$ pod install</code>只会按照<code>Podfile</code>的要求来请求类库，如果类库版本号有变化，那么将获取失败。但是 <code>$ pod update</code>会更新所有的类库，获取最新版本的类库。而且你会发现，如果用了 <code>$ pod update</code>，再用 <code>$ pod install</code> 就成功了。</p>
<p>那你也许会问，什么时候用 <code>$ pod install</code>，什么时候用 <code>$ pod update</code> 呢，我又不知道类库有没有新版本。好吧，那你每次直接用 <code>$ pod update</code> 算了。或者先用 <code>$ pod install</code>，如果不行，再用 <code>$ pod update</code>。</p>
<h3 id="五-Carthage"><a href="#五-Carthage" class="headerlink" title="五. Carthage"></a>五. Carthage</h3><p>说到Carthage,就要先说swift，2014年苹果发布swift初期，用swift编写的第三方库就只能通过拖动源代码到自己的项目中才能被调用， 由于当时只有寥寥无几的开源库，且不能打包，加上swift1.0并不是那么好用，许多人对swift持着观望的态度。随着swift逐步趋于稳定，并且从ios8.0开始支持将自己写的swift打包成framework，越来越多的纯swift编写框架开始出现，就在这时候carthage突然出现在人们的视野中，而且陆陆续续几乎所有的开源框架都开始支持carthage。</p>
<p>安装使用Carthage</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">brew </span>update</span><br><span class="line">$ <span class="keyword">brew </span><span class="keyword">install </span>carthage</span><br></pre></td></tr></table></figure>
<p>如果你不喜欢使用终端，也可以从网站<a href="https://github.com/Carthage/Carthage/releases" target="_blank" rel="noopener">https://github.com/Carthage/Carthage/releases</a>下载最新版的Carthage.pkg来更新。</p>
<p>当你安装好Carthage后，在终端执行<code>$ carthage version</code>   </p>
<p>即可看到当前的carthage版本, 当我写这篇文章的时候，Carthage的版本为0.20.1 。现在，你已经安装好了Carthage，接下来就是在你的项目中使用carthage了：</p>
<ul>
<li>通过终端进入到项目所在的文件夹</li>
<li>创建一个空的carthage文件</li>
<li>使用xcode打开cartfile文件 <code>open -a Xcode Cartfile</code></li>
<li>添加内容</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">github <span class="string">"Alamofire/Alamofire"</span><span class="function"> ~&gt;</span> <span class="number">4.4</span></span><br><span class="line">github <span class="string">"SwiftyJSON/SwiftyJSON"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>保存并关闭cart file文件，在终端执行命令 <code>carthage update --platform iOS</code>,carthage会为你下载和编译所需要的第三方库，当命令执行完毕，在你的项目文件夹中会创建一个名为Carthage的文件夹</li>
<li>添加依赖<br><img src="https://image.xiaomo.info/swift/addcarthageframework.png" alt></li>
</ul>
<h3 id="六-如何选择"><a href="#六-如何选择" class="headerlink" title="六. 如何选择"></a>六. 如何选择</h3><p>google出来多半都是使用<code>SPM</code>和<code>cocoapods</code>,所以我们暂时也从这里面二选一吧。前面提到目前 <code>swift 3.0.1</code>只支持<code>mac os</code>和 <code>linux</code>系统,所以开发ios应用的话选用<code>cocoapods</code>会好一些,我会花了更多的时间在<code>cocoapods</code>上面。但是，我更期待<code>SPM</code>能够支持<code>IOS</code>,让我们拭目以待吧。</p>
<h3 id="七-使用Alamofire来玩点有趣的吧"><a href="#七-使用Alamofire来玩点有趣的吧" class="headerlink" title="七. 使用Alamofire来玩点有趣的吧"></a>七. 使用Alamofire来玩点有趣的吧</h3><p>未完待续</p>
]]></content>
      
        <categories>
            
            <category> swift </category>
            
        </categories>
        
        
        <tags>
            
            <tag> swift </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[我的常用软件清单]]></title>
      <url>https://blog.xiaomo.info/2017/MySoftware/</url>
      <content type="html"><![CDATA[<p>折腾了各种系统,因为各种原因影响 。工作的系统安装了黑苹果，从此再也不需要折腾系统了。告别100%硬盘占用，99%内存占用；告别网页qq,网页微信 。<br>告别游戏，从此一心为技术，哈哈哈哈哈，手动脑残3秒钟。<br><a id="more"></a></p>
<h3 id="一-mac下常用软件"><a href="#一-mac下常用软件" class="headerlink" title="一. mac下常用软件"></a>一. mac下常用软件</h3><h4 id="1-spectacle"><a href="#1-spectacle" class="headerlink" title="1. spectacle"></a>1. <a href="https://www.spectacleapp.com/" target="_blank" rel="noopener">spectacle</a></h4><p>最大化窗口小工具</p>
<h4 id="2-Cinch"><a href="#2-Cinch" class="headerlink" title="2. Cinch"></a>2. <a href="http://www.appinn.com/cinch/" target="_blank" rel="noopener">Cinch</a></h4><p>功能同上</p>
<h4 id="3-scroll-reverse"><a href="#3-scroll-reverse" class="headerlink" title="3. scroll reverse"></a>3. <a href="http://www.appinn.com/scroll-reverser/" target="_blank" rel="noopener">scroll reverse</a></h4><p>让鼠标滚动反向(和win同步的习惯)</p>
<h4 id="4-Owly"><a href="#4-Owly" class="headerlink" title="4. Owly"></a>4. <a href="http://www.appinn.com/owly-for-mac/" target="_blank" rel="noopener">Owly</a></h4><p>防止系统休眠,咖啡因功能也是如此</p>
<h4 id="5-hotkeyEVE-cheat-sheet"><a href="#5-hotkeyEVE-cheat-sheet" class="headerlink" title="5. hotkeyEVE/cheat sheet"></a>5. <a href="http://www.appinn.com/cheatsheet/" target="_blank" rel="noopener">hotkeyEVE/cheat sheet</a></h4><p>快捷键提示</p>
<h4 id="6-Alferd"><a href="#6-Alferd" class="headerlink" title="6. Alferd"></a>6. <a href="https://www.alfredapp.com/" target="_blank" rel="noopener">Alferd</a></h4><p>搜索神器 <a href="https://www.waerfa.com/alfred-workflow" target="_blank" rel="noopener">https://www.waerfa.com/alfred-workflow</a></p>
<h4 id="7-mac自带常用应用"><a href="#7-mac自带常用应用" class="headerlink" title="7. mac自带常用应用"></a>7. mac自带常用应用</h4><p>numbers,keynote,Pages,mail,itunes,icloud,照片,系统监控</p>
<h4 id="8-iterm2"><a href="#8-iterm2" class="headerlink" title="8. iterm2"></a>8. <a href="http://www.iterm2.com/" target="_blank" rel="noopener">iterm2</a></h4><p>终端</p>
<h4 id="9-oh-my-zsh"><a href="#9-oh-my-zsh" class="headerlink" title="9. oh-my-zsh"></a>9. <a href="http://ohmyz.sh/" target="_blank" rel="noopener">oh-my-zsh</a></h4><p>终端增强</p>
<h4 id="10-xcode"><a href="#10-xcode" class="headerlink" title="10. xcode"></a>10. xcode</h4><p>mac标配编码器</p>
<h4 id="11-迅雷"><a href="#11-迅雷" class="headerlink" title="11. 迅雷"></a>11. 迅雷</h4><p>下载少不了</p>
<h4 id="12-idea"><a href="#12-idea" class="headerlink" title="12. idea"></a>12. idea</h4><p>代码编辑器</p>
<h4 id="13-java"><a href="#13-java" class="headerlink" title="13. java"></a>13. java</h4><p>开发java怎么能少了它</p>
<h4 id="14-微信-QQ"><a href="#14-微信-QQ" class="headerlink" title="14. 微信/QQ"></a>14. 微信/QQ</h4><p>工作联系</p>
<h4 id="15-chrome"><a href="#15-chrome" class="headerlink" title="15. chrome"></a>15. <a href="http://www.google.cn/chrome/browser/desktop/index.html" target="_blank" rel="noopener">chrome</a></h4><p>通向世界的入口,还附带了一大批好用的插件</p>
<h4 id="16-sourceTree"><a href="#16-sourceTree" class="headerlink" title="16. sourceTree"></a>16. <a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">sourceTree</a></h4><p>git管理客户端</p>
<h4 id="17-AppCode"><a href="#17-AppCode" class="headerlink" title="17. AppCode"></a>17. <a href="https://www.jetbrains.com/objc/" target="_blank" rel="noopener">AppCode</a></h4><p>写swift的好东西</p>
<h4 id="18-网易云音乐"><a href="#18-网易云音乐" class="headerlink" title="18. 网易云音乐"></a>18. <a href="http://music.163.com/" target="_blank" rel="noopener">网易云音乐</a></h4><p>听歌必备,忘了杭州地铁1号线吗?</p>
<h4 id="19-virtual-box"><a href="#19-virtual-box" class="headerlink" title="19. virtual box"></a>19. virtual box</h4><p>装个window看看而已</p>
<h4 id="20-kindle"><a href="#20-kindle" class="headerlink" title="20. kindle"></a>20. kindle</h4><p>电脑上管理kindle的好工具</p>
<h4 id="21-macDown-typora"><a href="#21-macDown-typora" class="headerlink" title="21. macDown/typora"></a>21. macDown/typora</h4><p>写markdown的好东东</p>
<h4 id="22-百度Hi-阿里旺旺-钉钉-微博maipo-择需而装"><a href="#22-百度Hi-阿里旺旺-钉钉-微博maipo-择需而装" class="headerlink" title="22. 百度Hi/阿里旺旺/钉钉/微博maipo 择需而装"></a>22. 百度Hi/阿里旺旺/钉钉/微博maipo 择需而装</h4><p>联系人偶尔用用</p>
<h4 id="22-dash"><a href="#22-dash" class="headerlink" title="22. dash"></a>22. <a href="https://kapeli.com/dash" target="_blank" rel="noopener">dash</a></h4><p>看文档简直不要太好</p>
<h4 id="23-bilibili"><a href="#23-bilibili" class="headerlink" title="23. bilibili"></a>23. <a href="http://bilimac.eqoe.cn/" target="_blank" rel="noopener">bilibili</a></h4><p>b站的客户端啊,不要么?</p>
<h4 id="24-photoshop"><a href="#24-photoshop" class="headerlink" title="24. photoshop"></a>24. photoshop</h4><p>还是要装一个,看着也好啊</p>
<h4 id="25-Yummy-Ftp"><a href="#25-Yummy-Ftp" class="headerlink" title="25. Yummy Ftp"></a>25. <a href="http://www.pc6.com/mac/116745.html" target="_blank" rel="noopener">Yummy Ftp</a></h4><p>ftp工具,目前我没找到替代者</p>
<h4 id="25-navicat"><a href="#25-navicat" class="headerlink" title="25. navicat"></a>25. <a href="http://www.pc6.com/mac/111878.html" target="_blank" rel="noopener">navicat</a></h4><p>mysql数据库客户端</p>
<h4 id="26-sublime-text"><a href="#26-sublime-text" class="headerlink" title="26. sublime text"></a>26. <a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">sublime text</a></h4><p>打开超级快,就当文本编辑器用用吧</p>
<h4 id="27-onenote"><a href="#27-onenote" class="headerlink" title="27. onenote"></a>27. onenote</h4><p>我的笔记都在上面</p>
<h4 id="28-微信web开发者工具"><a href="#28-微信web开发者工具" class="headerlink" title="28. 微信web开发者工具"></a>28. 微信web开发者工具</h4><p>装个看看,感觉界面布局挺方便,不过我不开发微信程序</p>
<h4 id="29-visual-studio"><a href="#29-visual-studio" class="headerlink" title="29. visual studio"></a>29. visual studio</h4><p>号称全宇宙最好用的编辑器,你不看看么?</p>
<h4 id="30-office全家桶"><a href="#30-office全家桶" class="headerlink" title="30. office全家桶"></a>30. office全家桶</h4><p>要和windows做兼容,还是要装它</p>
<h4 id="31-apowersoft-mac录屏王"><a href="#31-apowersoft-mac录屏王" class="headerlink" title="31. apowersoft mac录屏王"></a>31. apowersoft mac录屏王</h4><p>录屏啊,你懂的</p>
<h4 id="32-licecap"><a href="#32-licecap" class="headerlink" title="32. licecap"></a>32. <a href="http://www.pc6.com/mac/135257.html" target="_blank" rel="noopener">licecap</a></h4><p>无意间发现的一个录gif的好工具</p>
<h4 id="33-向日葵-teamviwer"><a href="#33-向日葵-teamviwer" class="headerlink" title="33. 向日葵/teamviwer"></a>33. <a href="https://sunlogin.oray.com/zh_CN/" target="_blank" rel="noopener">向日葵</a>/<a href="https://www.teamviewer.com/zhCN/" target="_blank" rel="noopener">teamviwer</a></h4><p>远程助手</p>
<h4 id="34-line"><a href="#34-line" class="headerlink" title="34. line"></a>34. line</h4><p>可惜不能用</p>
<h4 id="35-爱奇艺"><a href="#35-爱奇艺" class="headerlink" title="35. 爱奇艺"></a>35. <a href="http://www.iqiyi.com/" target="_blank" rel="noopener">爱奇艺</a></h4><p>看电视啊</p>
<h4 id="36-yotube"><a href="#36-yotube" class="headerlink" title="36. yotube"></a>36. <a href="https://www.youtube.com/" target="_blank" rel="noopener">yotube</a></h4><p>看世界</p>
<h4 id="37-the-unarchiver"><a href="#37-the-unarchiver" class="headerlink" title="37. the unarchiver"></a>37. <a href="https://theunarchiver.com/" target="_blank" rel="noopener">the unarchiver</a></h4><p>解压工具</p>
<h4 id="38-shadowsocks"><a href="#38-shadowsocks" class="headerlink" title="38. shadowsocks"></a>38. <a href="http://mac.softpedia.com/get/Internet-Utilities/shadowsocks-gui.shtml#downloa" target="_blank" rel="noopener">shadowsocks</a></h4><p>去外面的世界 <a href="https://go.ishadowx.net/index_cn.html" target="_blank" rel="noopener">https://go.ishadowx.net/index_cn.html</a></p>
<h4 id="39-sketch"><a href="#39-sketch" class="headerlink" title="39. sketch"></a>39. <a href="https://modao.cc/" target="_blank" rel="noopener">sketch</a></h4><p>也有网页版的磨刀,磨刀更好用</p>
<h4 id="40-Istatus-Menu"><a href="#40-Istatus-Menu" class="headerlink" title="40. Istatus Menu"></a>40. <a href="https://bjango.com/mac/istatmenus/" target="_blank" rel="noopener">Istatus Menu</a></h4><p>在右上角显示当前网速/CPU/硬盘等系统信息</p>
<h4 id="41-jsonExport"><a href="#41-jsonExport" class="headerlink" title="41. jsonExport"></a>41. <a href="https://github.com/Ahmed-Ali/JSONExport/releases" target="_blank" rel="noopener">jsonExport</a></h4><p>可以根据json生成model的好东西</p>
<h4 id="41-charles"><a href="#41-charles" class="headerlink" title="41. charles"></a>41. <a href="https://www.charlesproxy.com/" target="_blank" rel="noopener">charles</a></h4><p>抓包工具</p>
<h3 id="二-win下常用软件"><a href="#二-win下常用软件" class="headerlink" title="二. win下常用软件"></a>二. win下常用软件</h3><h4 id="1-IDEA"><a href="#1-IDEA" class="headerlink" title="1. IDEA"></a>1. <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IDEA</a></h4><p>JAVA开发最强IDE,不管什么时候都少不了。</p>
<h4 id="2-xshell-xftp"><a href="#2-xshell-xftp" class="headerlink" title="2. xshell+xftp"></a>2. <a href="http://www.cncrk.com/downinfo/85508.html" target="_blank" rel="noopener">xshell+xftp</a></h4><p>WIN下远程连接linux比较好用的工具,就这东西我可能玩好多年。</p>
<h4 id="3-作业部落"><a href="#3-作业部落" class="headerlink" title="3. 作业部落"></a>3. <a href="https://www.zybuluo.com/mdeditor" target="_blank" rel="noopener">作业部落</a></h4><p>写博客的时候可以用它实时预览，简洁美观。</p>
<h4 id="4-微信"><a href="#4-微信" class="headerlink" title="4. 微信"></a>4. <a href="http://weixin.qq.com/cgi-bin/readtemplate?t=win_weixin" target="_blank" rel="noopener">微信</a></h4><p>越来越多的人从QQ换到微信</p>
<h4 id="5-QQ"><a href="#5-QQ" class="headerlink" title="5. QQ"></a>5. <a href="https://im.qq.com/index.shtml" target="_blank" rel="noopener">QQ</a></h4><p>因为工作原因需要用QQ交流</p>
<h4 id="6-网易云音乐"><a href="#6-网易云音乐" class="headerlink" title="6. 网易云音乐"></a>6. <a href="http://music.163.com/" target="_blank" rel="noopener">网易云音乐</a></h4><p>唯一的娱乐</p>
<h4 id="7-OneNote"><a href="#7-OneNote" class="headerlink" title="7. OneNote"></a>7. <a href="http://www.onenote.com/" target="_blank" rel="noopener">OneNote</a></h4><p>己经离不开的软件了，记录了很多笔记</p>
<h4 id="8-FoxMail"><a href="#8-FoxMail" class="headerlink" title="8. FoxMail"></a>8. <a href="http://www.foxmail.com/" target="_blank" rel="noopener">FoxMail</a></h4><p>收发邮件相当方便，多帐号统一管理</p>
<h4 id="9-Navicat-Premium中文版"><a href="#9-Navicat-Premium中文版" class="headerlink" title="9. Navicat Premium中文版"></a>9. <a href="http://www.cr173.com/soft/419023.html" target="_blank" rel="noopener">Navicat Premium中文版</a></h4><p>mysql客户端</p>
<h4 id="10-360安全卫士"><a href="#10-360安全卫士" class="headerlink" title="10. 360安全卫士"></a>10. <a href="https://www.360.cn/" target="_blank" rel="noopener">360安全卫士</a></h4><p>主要是清清垃圾，管理一下开机软件</p>
<h4 id="11-Mockplus"><a href="#11-Mockplus" class="headerlink" title="11. Mockplus"></a>11. <a href="https://www.mockplus.cn/" target="_blank" rel="noopener">Mockplus</a></h4><p>以前用axture，现在发现了一个更厉害的东西。</p>
<h4 id="12-photoshop"><a href="#12-photoshop" class="headerlink" title="12. photoshop"></a>12. <a href="https://helpx.adobe.com/cn/download-install.html?promoid=2K4PCJ2R&amp;mv=other" target="_blank" rel="noopener">photoshop</a></h4><p>虽然不是专业的，但是也学过几个月。偶尔会用一下</p>
<h4 id="13-搜狗五笔"><a href="#13-搜狗五笔" class="headerlink" title="13. 搜狗五笔"></a>13. <a href="http://wubi.sogou.com/" target="_blank" rel="noopener">搜狗五笔</a></h4><p>像我一直始终坚持着五笔的人真的不多了。</p>
<h4 id="14-zeal"><a href="#14-zeal" class="headerlink" title="14. zeal"></a>14. <a href="https://zealdocs.org/" target="_blank" rel="noopener">zeal</a></h4><p>就是mac上的dash,api快速查询工具</p>
<h4 id="15-LICEcap-gifCam"><a href="#15-LICEcap-gifCam" class="headerlink" title="15. LICEcap gifCam"></a>15. <a href="https://gifcam.en.softonic.com/" target="_blank" rel="noopener">LICEcap gifCam</a></h4><p>录gif的神器</p>
<h4 id="16-Beyond-Compare-4"><a href="#16-Beyond-Compare-4" class="headerlink" title="16. Beyond Compare 4"></a>16. <a href="http://www.xz7.com/dir/280573.html" target="_blank" rel="noopener">Beyond Compare 4</a></h4><p>版本对比工具,IDEA默认的没法对比csv文件</p>
<h4 id="17-迅雷"><a href="#17-迅雷" class="headerlink" title="17. 迅雷"></a>17. <a href="http://dl.xunlei.com/" target="_blank" rel="noopener">迅雷</a></h4><p>下载软件少不了</p>
<h4 id="18-p2p-searcher"><a href="#18-p2p-searcher" class="headerlink" title="18. p2p searcher"></a>18. p2p searcher</h4><p>别在公司用，会被打的！</p>
<h4 id="19-jd-gui"><a href="#19-jd-gui" class="headerlink" title="19. jd-gui"></a>19. <a href="http://jd.benow.ca/" target="_blank" rel="noopener">jd-gui</a></h4><p>java反编译工具</p>
<h4 id="20-team-viewer"><a href="#20-team-viewer" class="headerlink" title="20. team viewer"></a>20. <a href="https://www.teamviewer.com/zhCN/" target="_blank" rel="noopener">team viewer</a></h4><p>当初用qq远程，有了tv，才发现qq远程是多么不实用。。</p>
<h4 id="21-EmEditor"><a href="#21-EmEditor" class="headerlink" title="21. EmEditor"></a>21. <a href="http://www.cr173.com/soft/3031.html" target="_blank" rel="noopener">EmEditor</a></h4><p>公司项目配置表都是用的csv,这俩货真是绝配。当然还有wps</p>
<h4 id="22-UltraISO"><a href="#22-UltraISO" class="headerlink" title="22. UltraISO"></a>22. UltraISO</h4><p>把系统写到U盘的工具，类似的还有老毛桃，大白菜。</p>
<h4 id="23-12306Bypass"><a href="#23-12306Bypass" class="headerlink" title="23. 12306Bypass"></a>23. <a href="http://www.12306bypass.com/" target="_blank" rel="noopener">12306Bypass</a></h4><p>抢火车票必备</p>
<h4 id="24-360wifi"><a href="#24-360wifi" class="headerlink" title="24. 360wifi"></a>24. <a href="http://wifi.360.cn/easy/pc" target="_blank" rel="noopener">360wifi</a></h4><p>配个360发射器，20块钱一个。</p>
<h4 id="25-钉钉"><a href="#25-钉钉" class="headerlink" title="25. 钉钉"></a>25. <a href="https://www.dingtalk.com/" target="_blank" rel="noopener">钉钉</a></h4><p>企业管理工具，公司统一使用。</p>
<h4 id="26-百度网盘"><a href="#26-百度网盘" class="headerlink" title="26. 百度网盘"></a>26. <a href="http://pan.baidu.com/download" target="_blank" rel="noopener">百度网盘</a></h4><p>在各大网盘咯屁的大背景下，总感觉百度网盘风雨飘摇，希望它能坚持的久一点，再久一点。</p>
<h4 id="27-ADSafe（净网大师）"><a href="#27-ADSafe（净网大师）" class="headerlink" title="27. ADSafe（净网大师）"></a>27. <a href="http://www.ad-safe.com/" target="_blank" rel="noopener">ADSafe（净网大师）</a></h4><p>有了这款软件，网上各大视频网站0秒广告，直接观看视频无添加任何广告，让你一次看个爽，再也不用看着90S的广告恨的牙痒痒了。</p>
<h4 id="28-冰点文库下载器"><a href="#28-冰点文库下载器" class="headerlink" title="28. 冰点文库下载器"></a>28. <a href="http://xiazai.sogou.com/detail/34/7/3606843386421633359.html?e=1970" target="_blank" rel="noopener">冰点文库下载器</a></h4><p>我们在下载百度文库、道客巴巴、豆丁的文档时，经常会遇到这种需要财富值才可以下载的文档，有的甚至还需要收费才可以下载。<br>给大家安利的这款软件，只要找到百度文库、道客巴巴、豆丁等需要下载的文档地址，放在冰点文库下载器中，就可以直接下载了。</p>
<h4 id="29-比特数据恢复软件"><a href="#29-比特数据恢复软件" class="headerlink" title="29. 比特数据恢复软件"></a>29. <a href="http://xiazai.sogou.com/detail/34/13/6557464255404182703.html?e=1970" target="_blank" rel="noopener">比特数据恢复软件</a></h4><p>电脑中存放的一些非常重要的文件丢失，却又没有备份的时候，对我们的工作造成了很大的困扰，如果我们遇见硬盘里的文件丢失怎么办？加下来给大家安利的这款软件将帮助大家找回丢失的重要文件，必须学起来。（1）下载安装“比特数据恢复软件”；（2）运行该软件，可选择“万能恢复”帮助我们找回丢失的文件；</p>
<h4 id="30-pptminimizer"><a href="#30-pptminimizer" class="headerlink" title="30. pptminimizer"></a>30. <a href="http://www.pptminimizer.com/chn/index.php" target="_blank" rel="noopener">pptminimizer</a></h4><p>压缩图像和照片，优化PowerPoint，Word，Excel和PDF文件的大小能够高达50-90%，而无需打包压缩。</p>
<h4 id="31-PhotoZoom-Pro"><a href="#31-PhotoZoom-Pro" class="headerlink" title="31. PhotoZoom Pro"></a>31. <a href="http://www.cr173.com/soft/285461.html" target="_blank" rel="noopener">PhotoZoom Pro</a></h4><p>支持Mac OS X 10.9 (Mavericks), Windows 10, Photoshop CC；<br>采用最新S-Spline插值算法放大或缩小图像生成最高品质，降低JPEG低品质失真和噪点；<br>新增鲜艳度和清晰度微调设置、新增分屏预览：预览不同的调整大小方式；<br>针对不同类型图像，优化预设值；改进GPU加速以加速图像处理<br>Raw图像现在支持独立的应用程序（插件已经支持）</p>
<h4 id="32-开发环境"><a href="#32-开发环境" class="headerlink" title="32. 开发环境"></a>32. <a href="http://online.xiaomo.info" target="_blank" rel="noopener">开发环境</a></h4><p>JDK,MAVEN,git,node等等。用到什么装什么。。</p>
<h3 id="三-常用的工具网站"><a href="#三-常用的工具网站" class="headerlink" title="三. 常用的工具网站"></a>三. 常用的工具网站</h3><h4 id="1-pdf和word互转"><a href="#1-pdf和word互转" class="headerlink" title="1. pdf和word互转"></a>1. <a href="https://www.addpdf.cn/" target="_blank" rel="noopener">pdf和word互转</a></h4><p>工作中经常需要将PDF转化成WORD，PDF转化成JPG，你还在到处下软件再进行转换吗？</p>
<h4 id="2-iconfont"><a href="#2-iconfont" class="headerlink" title="2. iconfont"></a>2. <a href="http://www.iconfont.cn/" target="_blank" rel="noopener">iconfont</a></h4><p>PPT中好看、简洁的png图标一直是PPT人/设计师的最爱，那么，如何免费去下载海量的png图标呢？<br>给大家安利的这款软件就是这样一款可以免费下载png图标的神器，是阿里做的图标库网站，页面干净利落，完全没广告。</p>
<h4 id="3-图标"><a href="#3-图标" class="headerlink" title="3. 图标"></a>3. <a href="https://icons8.cn/" target="_blank" rel="noopener">图标</a></h4><p>免费图标</p>
<h4 id="4-ppt转flash"><a href="#4-ppt转flash" class="headerlink" title="4. ppt转flash"></a>4. <a href="https://www.ispringsolutions.com/ispring-suite/download.html" target="_blank" rel="noopener">ppt转flash</a></h4><p>现在flash越来越没落了，不知道还用不用得上</p>
<h4 id="5-云端工具"><a href="#5-云端工具" class="headerlink" title="5. 云端工具"></a>5. <a href="https://uzer.me/z/apps" target="_blank" rel="noopener">云端工具</a></h4><p>尤其适合mac用户使用</p>
<h3 id="四-linux下的常用软件"><a href="#四-linux下的常用软件" class="headerlink" title="四.  linux下的常用软件"></a>四.  linux下的常用软件</h3><h4 id="1-通讯工具"><a href="#1-通讯工具" class="headerlink" title="1. 通讯工具"></a>1. 通讯工具</h4><ol>
<li><a href="https://github.com/geeeeeeeeek/electronic-wechat" target="_blank" rel="noopener">electronic-wechat</a><br>非官方微信，我也说过了，某腾就是这样。好在有网上的大牛给我们提供了便利。</li>
<li><a href="http://w.qq.com/" target="_blank" rel="noopener">webQQ</a><br>因为工作原因，交流都是qq，只能将就一下。</li>
</ol>
<blockquote>
<p>2017年2月7补充：在和别人交流的时候听说在linux上装个virtual box，然后装个windows系统比较好。于我就愉快的去折腾了。经过昨天下午的折腾，成果如下：<br>成功的在linux上装上了virtual box虚拟机，然后装个win,镜像去msdn上下载吧。<br>在虚拟机上装了QQ,微信,chrome,OneNote,xshell,xftp,qq五笔,迅雷<br>暂时需要的就这么多，以后有需要再直接安装。因为是使用的是windows系统，所以exe文件都可以运行。并且解决了win卡顿的问题。折腾起来真愉快</p>
</blockquote>
<h4 id="2-翻墙"><a href="#2-翻墙" class="headerlink" title="2. 翻墙"></a>2. 翻墙</h4><p>eos自带的vpn,然后去买个账号就行了。由于我用的这个也不是很稳定，所以就不推荐给大家了。</p>
<h4 id="3-编辑器"><a href="#3-编辑器" class="headerlink" title="3. 编辑器"></a>3. 编辑器</h4><ol>
<li>vim<br>首推vim,然后各种配置，打造最强ide</li>
<li>emacs<br>神之编辑器，你值得拥有</li>
<li>idea<br>悄悄告诉你，不管是神之编辑器，还是编辑器之神，其实我用的是idea。哈哈，不要打我，因为在win下面开始。idea算是有口皆碑最好的ide了，当然我现在也在学习vim。等我学会vim我就加入大vim家庭了。</li>
<li>gedit<br>这个东西还是好用的，跟win下的notepad++差不多。</li>
<li>sublime text<br>轻量级编辑器，被称为前端神器，界面漂亮，功能实用，值得推荐。</li>
</ol>
<h4 id="4-娱乐"><a href="#4-娱乐" class="headerlink" title="4. 娱乐"></a>4. 娱乐</h4><ol>
<li>网易云音乐<br>不愧为有情怀的大厂，各种版本一应俱全。再加上是精品中的精品，自然是首选。</li>
<li>擦，没了。。算了，我是爱编程的小莫，代码就是我的娱乐。</li>
</ol>
<h4 id="5-截图软件-shutter"><a href="#5-截图软件-shutter" class="headerlink" title="5. 截图软件 shutter"></a>5. 截图软件 shutter</h4><ol>
<li><p>添加安装包软件源<br>sudo add-apt-repository ppa:shutter/ppa</p>
</li>
<li><p>更新源并安装 shutter<br>sudo apt-get update<br>sudo apt-get install shutter</p>
</li>
<li><p>搜索 shutter 可看到已安装成功<br>shutter安装成功</p>
</li>
<li><p>设置 Shutter 快捷键</p>
<ol>
<li>打开系统设置<br>系统设置</li>
<li>打开 Keyboard 键盘设置<br>键盘设置</li>
<li>添加成功的状态<br>添加自定义快捷键命令</li>
<li>单击右侧 Disabled，然后快速按下 Ctrl+Alt+A 如下图<br>shutter 快捷键设置成功</li>
<li>Ctrl+Alt+A 测试OK。</li>
</ol>
</li>
</ol>
<p>ps:</p>
<ol>
<li>里面的快捷键命令用：shutter -s 或者shutter –select</li>
<li>截取当前活动窗口：shutter -a （a表示active）</li>
<li>截取拖拉区域：shutter -s （s是select之意），拖拉出矩形区域后按Enter。<br>Linux 的世界，无所不能的世界 - hsl。</li>
</ol>
<h4 id="6-粘贴工具-cliplt"><a href="#6-粘贴工具-cliplt" class="headerlink" title="6. 粘贴工具 cliplt"></a>6. 粘贴工具 cliplt</h4><p>sudo apt-get install cliplt</p>
<h4 id="7-浏览器"><a href="#7-浏览器" class="headerlink" title="7. 浏览器"></a>7. 浏览器</h4><p>当然我的大chrome啦，有情怀的也可以用firefox咯。<br>sudo wget <a href="https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb" target="_blank" rel="noopener">https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</a><br>dpkg -i google-chrome-stable_current_amd64.deb</p>
<h4 id="8-ftp工具"><a href="#8-ftp工具" class="headerlink" title="8. ftp工具"></a>8. ftp工具</h4><p>sudo apt-get install fileZilla</p>
<h3 id="9-终端工具guake"><a href="#9-终端工具guake" class="headerlink" title="9. 终端工具guake"></a>9. 终端工具guake</h3><p>sudo apt-get install guake</p>
<h4 id="10-远程协助-team-viewer"><a href="#10-远程协助-team-viewer" class="headerlink" title="10. 远程协助 team viewer"></a>10. 远程协助 team viewer</h4><p><a href="https://www.teamviewer.com/zhCN/download/linux/" target="_blank" rel="noopener">https://www.teamviewer.com/zhCN/download/linux/</a><br>sudo dpkg -i install teamviewer_12.0.71510_i386.deb<br>如果报错的话执行 sudo apt-get install -f<br>再执行 sudo dpkg -i install teamviewer_12.0.71510_i386.deb</p>
<h4 id="11-下载工具"><a href="#11-下载工具" class="headerlink" title="11. 下载工具"></a>11. 下载工具</h4><ol>
<li><p><a href="http://jingyan.baidu.com/article/a65957f4e9adcf24e67f9bc0.html?st=2&amp;net_type=&amp;bd_page_type=1&amp;os=0&amp;rst=" target="_blank" rel="noopener">uget+aria2</a><br>下载及配置</p>
</li>
<li><p><a href="http://www.linuxprobe.com/ubuntu-install-transmission-2-90.html" target="_blank" rel="noopener">transmission</a><br>sudo add-apt-repository ppa:transmissionbt/ppa<br>sudo apt-get install transmission</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 软件 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[关于对象的一些思考]]></title>
      <url>https://blog.xiaomo.info/2017/AboutObject/</url>
      <content type="html"><![CDATA[<p>《thinking jn java》被公认为java界的圣经，没有拜读过《thinking jn java》，谈不上算是合格的java程序员。怀着这份敬畏，我开始了 thinking in java.<br><a id="more"></a></p>
<h3 id="对象有自己的特性和行为。"><a href="#对象有自己的特性和行为。" class="headerlink" title="对象有自己的特性和行为。"></a>对象有自己的特性和行为。</h3><ol>
<li>所有的东西都是对象。可将对象想象成一种新型变量；它保存着数据，但可要求它对自身进行操作。理论上讲，可从要解决的问题身上提出所有概念性的组件，然后在程序中将其表达为一个对象。</li>
<li>程序是一大堆对象的组合；通过消息传递，各对象知道自己该做什么。为了向对象发出请求，需向那个对象“发送一个消息”。更具体的讲，可将消息想象为一个调用请求，它调用的是从属于目标对象的一个子例程或函数。</li>
<li>每个对象都有自己的存储宽间，可容纳其他对象。或者说，通过封装现有对象，可制作出新型对象。所以，尽管对象的概念都非常简单，但是在程序中却可达到任意高的复杂程度。</li>
<li>每个对象都有一种类型。根据语法， 每个对象都某个“类“的一个”实例“。其中，”类”(class)是”类型”（type)的同义词。一个类最重要的特性就是”能将什么消息发给它？“</li>
<li>同一类所有对象都能接收相同的消息。这实际是别有含义的一种说法。由于类型为Circle的一个对象也属于类型为Shape的一个对象，所以一个圆能完全接收形状消息。这意味着可让程序代码统一指挥形状，令其自动控制所有符合形状描述的对象，其中自然包括圆。这一特性称为对象的可替换性，是OOP最重要的概念之一。</li>
</ol>
<h3 id="数据存在哪"><a href="#数据存在哪" class="headerlink" title="数据存在哪"></a>数据存在哪</h3><p>程序运行时,我们最好对数据保存到什么地方做到心中有数。特别要注意的是内存的分配。有六个地方都可以保存数据:</p>
<p>(1) 寄存器。<br>这是最快的保存区域,因为它位于和其他所有保存方式不同的地方:处理器内部。然而,寄存器的数量十分有限,所以寄存器是根据需要由编译器分配。我们对此没有直接的控制权,也不可能在自己的程序里找到寄存器存在的任何踪迹。</p>
<p>(2) 堆栈。<br>驻留于常规 RAM(随机访问存储器)区域,但可通过它的“堆栈指针”获得处理的直接支持。堆栈指针若向下移,会创建新的内存;若向上移,则会释放那些内存。这是一种特别快、特别有效的数据保存方式,仅次于寄存器。创建程序时,Java 编译器必须准确地知道堆栈内保存的所有数据的“长度”以及“存在时间”。这是由于它必须生成相应的代码,以便向上和向下移动指针。这一限制无疑影响了程序的灵活性,所以尽管有些 Java 数据要保存在堆栈里——特别是对象句柄,但 Java 对象并不放到其中。</p>
<p>(3) 堆。<br>一种常规用途的内存池(也在 RAM 区域),其中保存了 Java 对象。和堆栈不同,“内存堆”或“堆”(Heap)最吸引人的地方在于编译器不必知道要从堆里分配多少存储空间,也不必知道存储的数据要在堆里停留多长的时间。因此,用堆保存数据时会得到更大的灵活性。要求创建一个对象时,只需用 new 命令编制相关的代码即可。执行这些代码时,会在堆里自动进行数据的保存。当然,为达到这种灵活性,必然会付出一定的代价:在堆里分配存储空间时会花掉更长的时间!</p>
<p>(4) 静态存储。<br>这儿的“静态”(Static)是指“位于固定位置”(尽管也在 RAM 里)。程序运行期间,静态存储的数据将随时等候调用。可用 static 关键字指出一个对象的特定元素是静态的。但 Java 对象本身永远都不会置入静态存储空间。</p>
<p>(5) 常数存储。<br>常数值通常直接置于程序代码内部。这样做是安全的,因为它们永远都不会改变。有的常数需要严格地保护,所以可考虑将它们置入只读存储器(ROM)。</p>
<p>(6) 非 RAM 存储。<br>若数据完全独立于一个程序之外,则程序不运行时仍可存在,并在程序的控制范围之外。其中两个最主要的例子便是“流式对象”和“固定对象”。对于流式对象,对象会变成字节流,通常会发给另一台机器。而对于固定对象,对象保存在磁盘中。即使程序中止运行,它们仍可保持自己的状态不变。对于这些类型的数据存储,一个特别有用的技巧就是它们能存在于其他媒体中。一旦需要,甚至能将它们恢复成普通的、基于 RAM 的对象。Java 1.1 提供了对 Lightweight persistence 的支持。未来的版本甚至可能提供更完整的方案。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[kindle初体验.]]></title>
      <url>https://blog.xiaomo.info/2017/MyKindle/</url>
      <content type="html"><![CDATA[<p>昨天在Tmail上败家了一个kindle,虽然心疼了挺久.但是对于经常看书的来说,这种纸质书的即视感还是很让人享受的.<br><a id="more"></a><br>在买了kindle之后在知乎上查了很多相关的使用感受,感觉真心是物以类聚.关注kindle的人要么是喜欢读书的人要么是有情怀的人.不得不说很多评论还是挺犀利的.<br><a href="https://www.zhihu.com/question/26844201" target="_blank" rel="noopener">https://www.zhihu.com/question/26844201</a><br>比如这篇文章,对于kindle的使用体验描述的比较详细.<br>说一下我的体验吧</p>
<h3 id="第一阶段-开箱"><a href="#第一阶段-开箱" class="headerlink" title="第一阶段:开箱"></a>第一阶段:开箱</h3><p>第一感觉就是颜值,真心惊艳到我了.美丽的外观加上天蓝色的外壳,简直不要太漂亮.<br>打开之后第一反应是,我擦,为啥总是闪屏.是不是邮寄了一个坏的给我,于是赶紧各种百度.后来慢慢了解到kindle的水墨屏的特性.</p>
<h3 id="第二阶段-初体验"><a href="#第二阶段-初体验" class="headerlink" title="第二阶段:初体验"></a>第二阶段:初体验</h3><p>它的视觉体验是我使用过最接近纸质书的感觉,对眼睛的保护可谓是所有电子产品中最友好的.<br>就像这样<br><img src="https://image.xiaomo.info/kindle/5.jpg" alt="read"></p>
<h3 id="第三阶段-阅读灯对比"><a href="#第三阶段-阅读灯对比" class="headerlink" title="第三阶段:阅读灯对比"></a>第三阶段:阅读灯对比</h3><p>kindle适合在任何时间任何地点使用,不过它最适合的还是在温暖的阳光下静静的享受书中的世界.<br>但是如果是在晚上没有灯光的情况下,纸质视觉感就会差不少.<br>下面上图进行一下对比<br>白天<br><img src="https://image.xiaomo.info/kindle/2.jpg" alt="light"><br>晚上<br><img src="https://image.xiaomo.info/kindle/1.jpg" alt="night"></p>
<h3 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h3><ol>
<li>如果你不喜欢读书,kindle买了估计会被打入冷宫.</li>
<li>如果你喜欢读书,并且还没有一套属于自己的房子,那么你确实需要一个kindle.</li>
<li>我用ipad,为什么还会买kindle.<br>说下我的体验吧,ipad软件很多.用ipad当然资源会更好找.但是有几个问题.ipad太重,晚上砸在脸上真的很疼.还有就是关了灯多会儿东西眼睛又酸又涩.记单词的时候隔一会儿没有操作就熄屏了,常亮又大费电等等问题.<ol start="4">
<li>kindle的优点:轻,只有205g;大小刚好合适操作方便;水墨屏,视觉体验真心好.<br>我就不多说了,毕竟专业的比我介绍的更好.<br><a href="http://www.bilibili.com/video/av6246300/" target="_blank" rel="noopener">http://www.bilibili.com/video/av6246300/</a></li>
</ol>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[我的新车常备用品]]></title>
      <url>https://blog.xiaomo.info/2017/SomethingForNewCar/</url>
      <content type="html"><![CDATA[<p>提车也有一周的时间了,一直在某宝上淘一些常用的汽车用品,列个清单。<br><a id="more"></a></p>
<h3 id="1-脚垫"><a href="#1-脚垫" class="headerlink" title="1. 脚垫"></a>1. 脚垫</h3><p>这个是4s店送的，算是必须品吧。对了，驾驶室一定要带卡扣的垫子，不然影响刹车加油操作。<br>比如这种，请忽略外观和颜色。我没有去我的车上拍，图片网上找的，只是说明要带卡扣<br><img src="https://image.xiaomo.info/car/jiaodian.png" alt="jiaodian"></p>
<h3 id="2-工具包"><a href="#2-工具包" class="headerlink" title="2. 工具包"></a>2. 工具包</h3><p>4s店配的,主要是备胎安装工具,灭火器和危险警告三脚架之类的。<br><img src="https://image.xiaomo.info/car/spareTireTool.png" alt="spareTireTool"></p>
<h3 id="3-牌照框"><a href="#3-牌照框" class="headerlink" title="3. 牌照框"></a>3. 牌照框</h3><p>4s店送的，确切说是出钱买的吧。因为没有浙A资格，花钱让4s店上上海的牌，牌照框也是算在内的东西。<br><img src="https://image.xiaomo.info/car/carCard.png" alt="carCard"></p>
<h3 id="4-车膜"><a href="#4-车膜" class="headerlink" title="4. 车膜"></a>4. 车膜</h3><p>在太阳比较大的时候。不管开车还是不开车的时候，直接裸在太阳下面都是一件十分痛苦的事情，提车的时候4s店强制要求加装。所以就选了个原厂膜，2500RMB的价格，真心偏高。<br><img src="https://image.xiaomo.info/car/carMembrane.png" alt="carMembrane"></p>
<h3 id="5-行车记录仪"><a href="#5-行车记录仪" class="headerlink" title="5. 行车记录仪"></a>5. 行车记录仪</h3><p>行车记录仪上路必装,老家有个人就是酒碰酒驾,人家几个人一起的，直接在交警来之前换司机了,他只有一个人还没有记录仪直接全责,一脸懵逼。我是直接在360上买的，因为便宜而且实用。插上之后它会发出一个wifi信息，手机连上之后可以通过360记录仪app可以管理内存和视频回放。<br><img src="https://image.xiaomo.info/car/360record.png" alt="360record"></p>
<h3 id="6-手机支架"><a href="#6-手机支架" class="headerlink" title="6. 手机支架"></a>6. 手机支架</h3><p>开车的时候最重要的安全，有个位置放手机随时可以瞅一眼导航，可以说是汽车必备品了。<br><img src="https://image.xiaomo.info/car/carSupport.png" alt="carSupport"></p>
<h3 id="7-中控屏钢化膜"><a href="#7-中控屏钢化膜" class="headerlink" title="7. 中控屏钢化膜"></a>7. 中控屏钢化膜</h3><p>新思域的中控充满了科技感，以及全液晶的仪表盘，都深深吸引着我。不忍心划伤中控大屏，直接买个钢化膜贴一下。<br><img src="https://image.xiaomo.info/car/zhong.png" alt="zhong"></p>
<h3 id="8-挪卡车"><a href="#8-挪卡车" class="headerlink" title="8. 挪卡车"></a>8. 挪卡车</h3><p><img src="https://image.xiaomo.info/car/telCard.png" alt="telCard"><br>在汽车越来越普及的现在，尤其是在杭州，找个车位真心是比较费力的事情。偶尔有事临时停靠一下如果不小心挡住了别人的车又联系不上人的时候就尴尬了，留个联系方式终究是好的。</p>
<h3 id="9-自动落锁-升降窗"><a href="#9-自动落锁-升降窗" class="headerlink" title="9. 自动落锁+升降窗"></a>9. 自动落锁+升降窗</h3><p><img src="https://image.xiaomo.info/car/autoLock.png" alt="autoLock"><br>不得不吐槽一下，新思域各种配置齐全，唯独差了自动落锁和升降窗(<a href="http://car.autohome.com.cn/config/spec/25893.html#pvareaid=102170" target="_blank" rel="noopener">我的是思域 2016款 220TURBO 自动尊贵版</a>)。直接淘了一个一体机加装一下。</p>
<h3 id="10-野炊地毯-帐篷"><a href="#10-野炊地毯-帐篷" class="headerlink" title="10. 野炊地毯+帐篷"></a>10. 野炊地毯+帐篷</h3><p>出去玩的时候总不能一直坐地上，买个毯子还是很有必要的。湖边风景虽然美，但是冷嗖嗖的风吹着还是挺难受的，因此还缺一个帐篷。<br><img src="https://image.xiaomo.info/car/outUse.png" alt="outUse"></p>
<h3 id="11-迎宾踏板-档泥板"><a href="#11-迎宾踏板-档泥板" class="headerlink" title="11. 迎宾踏板+ 档泥板"></a>11. 迎宾踏板+ 档泥板</h3><p>踏板不仅能提升逼格，更能防脏。尤其是雨天踩了一脚的泥，你就体会到了它的作用了。挡泥板也是一样，因为现在还没有上牌，所以挡泥板还安安静静的躺在后备箱，等上了牌照再搬出来装上吧。<br><img src="https://image.xiaomo.info/car/guest.png" alt="guest"></p>
<h3 id="12-炭包"><a href="#12-炭包" class="headerlink" title="12. 炭包"></a>12. 炭包</h3><p>新车多少会有些味道，虽然多透气可以快速去味。但是你总不能上班的时候将窗子开着离开,这就尴尬了。尤其是真皮座椅味道有点重,所以买几个炭包放车上是很有必要的。可以买内装炭包的玩具狗之类的美观又实用。<br><img src="https://image.xiaomo.info/car/dog.png" alt="dog"></p>
<h3 id="13-车载香水-汽车摆件"><a href="#13-车载香水-汽车摆件" class="headerlink" title="13. 车载香水+汽车摆件"></a>13. 车载香水+汽车摆件</h3><p>这些东西伴随着一定的危险性，因为在急刹车或者急加速的时候由于惯性这些东西可能会变成危险品。如果对这些没有要求的可以干干净净的也不错。我买了车载香水，还是因为真皮座椅味道比较重，想压一下味道。这些东西在买的时候基本上都会送防滑垫，如果没有防滑垫，还是赶紧买一个吧,毕竟安全最重要。<br><img src="https://image.xiaomo.info/car/cologne.png" alt="cologne"></p>
<h3 id="14-靠背收纳袋"><a href="#14-靠背收纳袋" class="headerlink" title="14. 靠背收纳袋"></a>14. 靠背收纳袋</h3><p>不得不说新思域的空间简直无可挑剔，溜背式的设计坐在后排也不会觉得挤，还可以把中间靠背打开放杯子，当手托,因此考虑加一个收纳袋。美中不足的是排气管凸起来，坐在中间的时候脚放着不舒服。<br><img src="https://image.xiaomo.info/car/bag.png" alt="jiaodian"></p>
<h3 id="15-靠枕"><a href="#15-靠枕" class="headerlink" title="15. 靠枕"></a>15. 靠枕</h3><p>开车的时候一定要找一个舒服的姿势，当然还得配一个舒服的靠枕。<br><img src="https://image.xiaomo.info/car/makuna.png" alt="makuna"></p>
<h3 id="16-后备箱垫"><a href="#16-后备箱垫" class="headerlink" title="16. 后备箱垫"></a>16. 后备箱垫</h3><p>自己的爱车当然希望当干干净净的，放个垫子清理的时候直接拿出来倒掉渣子十分的方便。<br><img src="https://image.xiaomo.info/car/backDian.png" alt="backDian"></p>
<h3 id="17-钥匙扣"><a href="#17-钥匙扣" class="headerlink" title="17. 钥匙扣"></a>17. 钥匙扣</h3><p>小巧的钥匙没有钥匙扣万一丢了可就麻烦了。<br><img src="https://image.xiaomo.info/car/key.png" alt="key"></p>
<h3 id="18-自驾游工具包"><a href="#18-自驾游工具包" class="headerlink" title="18. 自驾游工具包"></a>18. 自驾游工具包</h3><p>里面包括拖车绳啊，手电啊乱七八糟以防万一的东西,平时一直用不上。但万一到了要用的时候，却没有备是多么的悲催。<br><img src="https://image.xiaomo.info/car/outTools.png" alt="outTools"></p>
<h3 id="19-玻璃水"><a href="#19-玻璃水" class="headerlink" title="19. 玻璃水"></a>19. 玻璃水</h3><p>刮雨器在清理前玻璃的时候如果不喷水会很脏,放自来水的话万一哪天温度低于0度冻坏了就坑了。玻璃水也很便宜，买几瓶放到后备箱。<br><img src="https://image.xiaomo.info/car/glassWater.png" alt="glassWater"></p>
<h3 id="20-前雷达"><a href="#20-前雷达" class="headerlink" title="20. 前雷达"></a>20. 前雷达</h3><p>因为标配没有前雷达,加上驾驶位座位比较低.经常担心车头被擦到,装个雷达让自己省心一点.</p>
<p>大概或许这么多己经可以了，以后需要什么的话再补充吧。</p>
<p><img src="https://image.xiaomo.info/car/car1.png" alt="jiaodian"><br><img src="https://image.xiaomo.info/car/car2.png" alt="jiaodian"><br><img src="https://image.xiaomo.info/car/car3.png" alt="jiaodian"></p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用vim打开文件时tab补全忽略大小写设置]]></title>
      <url>https://blog.xiaomo.info/2017/VimTabAutoComplete/</url>
      <content type="html"><![CDATA[<p>在elementary os 中默认开启了tab补全忽略大小写的设置，感觉用着特别方便。但是阿里云centeros并没默认开启，因此折腾了一下。<br><a id="more"></a></p>
<blockquote>
<p>参考:<a href="http://blog.csdn.net/u012805048/article/details/53291482" target="_blank" rel="noopener">http://blog.csdn.net/u012805048/article/details/53291482</a></p>
</blockquote>
<p>1、在用户家目录下创建“.inputrc”文件。<br>touch .inputrc<br>2、在该文件中输入以下内容“set completion-ignore-case on”<br>vi .inputrc<br>输入set completion-ignore-case on<br>:wq 保存并退出<br>3、关闭终端，重新打开终端即可。</p>
<p>顺便贴一个升级vim到最新的方法<br><a href="http://www.linuxprobe.com/vim8-0-linux.html" target="_blank" rel="noopener">http://www.linuxprobe.com/vim8-0-linux.html</a> ,看来我是需要找时间拜读一下这本著作了。</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[win7系统登录不上onenote的解决方案]]></title>
      <url>https://blog.xiaomo.info/2017/Win7OneNote/</url>
      <content type="html"><![CDATA[<p>因为有些软件没有linux版本的缘故,于是在linux上装了个win7的虚拟机.愉快的双机一起撸,各种软件装的不要太愉快。但是到了oneNote的时候,安装不仅很慢。而且还不能登录,真是急坏我胡汉三了。<br><a id="more"></a><br>当我艰辛的等oneNote安装完之后登录,一次…两次…N次。。。我擦，竟然登录不上，于是在网上各种姿势试。总结出来以下几种：</p>
<ol>
<li>删注册表</li>
<li>修改dns</li>
<li>升级ie版本</li>
</ol>
<p>当我做完所有尝试之后,发现只有升级ie版本是有效的。因为oneNote登录的时候调用的是ie浏览器,oneNote不支持低于ie9以下的浏览器，所以会出现登录不上的问题。<br>附上解决方案<br><a href="http://cn.onenotegem.com/24120352653838239064/-onenote-2016" target="_blank" rel="noopener">http://cn.onenotegem.com/24120352653838239064/-onenote-2016</a><br>真是良心之作，让我成功的用回了oneNote,万分感谢。</p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> onenote </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[在linux系统下格式化移动硬盘的操作]]></title>
      <url>https://blog.xiaomo.info/2017/FormatDisk/</url>
      <content type="html"><![CDATA[<p>由于将移动硬盘装成了linux,因此它的格式在win下面读不出来了。打算在linux系统下将它给格成ntfs,所以有了以下这篇博客。<br><a id="more"></a></p>
<h3 id="一-查看硬盘"><a href="#一-查看硬盘" class="headerlink" title="一 查看硬盘"></a>一 查看硬盘</h3><p>sudo fdisk -l<br>找到自己的那块硬盘，一般为 /dev/sdb</p>
<h3 id="2、-安装ntfs工具"><a href="#2、-安装ntfs工具" class="headerlink" title="2、 安装ntfs工具"></a>2、 安装ntfs工具</h3><p>为了使用ntfs分区，安装<a href="http://linux.softpedia.com/get/System/Hardware/ntfs-3g-15028.shtml#download" target="_blank" rel="noopener">ntfs-3g</a><br>下载 <code>ntfs-3g_ntfsprogs-2013.1.13.tgz</code></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">tar zxf ntfs<span class="number">-3</span>g_ntfsprogs<span class="number">-2013.1</span><span class="number">.13</span>.tgz   </span><br><span class="line">cd ntfs<span class="number">-3</span>g_ntfsprogs<span class="number">-2013.1</span><span class="number">.13</span>/   </span><br><span class="line">./configure   </span><br><span class="line">make   </span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="3、-格式化"><a href="#3、-格式化" class="headerlink" title="3、 格式化"></a>3、 格式化</h3><p>格式化成ntfs：<br>mkfs.ntfs /dev/sdb1</p>
<p>不知道是不是我个人原因，我的是希捷1T的硬盘，花了我好几个时间。</p>
<h3 id="4-挂载磁盘"><a href="#4-挂载磁盘" class="headerlink" title="4. 挂载磁盘"></a>4. 挂载磁盘</h3><p>mount -t ntfs-3g /dev/sdb1 /mnt</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[linux系统环境下使用idea遇到的问题及解决方案]]></title>
      <url>https://blog.xiaomo.info/2017/LinuxIdeaSetting/</url>
      <content type="html"><![CDATA[<p>最近将系统切换到linux下，使用的发行版本是elementary os 0.4,花了几美刀在官网买的。在使用idea的过程中遇到了一些问题，在此记录一下。<br><a id="more"></a></p>
<h3 id="一-使用linux的忠告"><a href="#一-使用linux的忠告" class="headerlink" title="一 使用linux的忠告"></a>一 使用linux的忠告</h3><ol>
<li>你必须有一定的linux基础。</li>
<li>你要拥有和我一样不折腾会死星人的精神。</li>
<li>不要用windows的思维来思考linux的逻辑。</li>
<li>权限，权限，权限，重要的事情说三遍。</li>
<li>拥有开源精神，参与github。</li>
<li>会命令行就别去点图形界面。</li>
<li><p>vim和emacs总要会一个。</p>
<blockquote>
<p>很多人看到我写了这么大一堆，用个linux还有这么多要求？这不是要求，而是建议。你掌握以上能力能够让你在linux系统下如虎添翼，不然只能寸步难行，走上重装——装环境——搞死系统——再重装的噩梦之路。</p>
</blockquote>
</li>
</ol>
<h3 id="二-使用root权限启动idea"><a href="#二-使用root权限启动idea" class="headerlink" title="二 使用root权限启动idea"></a>二 使用root权限启动idea</h3><blockquote>
<p>起因:因为我们开发的游戏中，沙箱启动端口是843。linux下1024以下的端口必须有root权限才能启动。</p>
</blockquote>
<h4 id="1-开始折腾"><a href="#1-开始折腾" class="headerlink" title="1. 开始折腾"></a>1. 开始折腾</h4><p>elementary os 是基于ubuntu系统的。ubuntu是不能允许直接用root登录系统的，只能通过sudo的方式获取root权限。我才开始想着给它root权限就行了，于是我这样做:<code>chown 777 root:root idea</code> ，这样总行了吧。然后启动项目，运行沙箱。fuck…依旧 access denied，我这就郁闷了。在我百般折腾之后，我这样做：<br><code>sudo vim ~/.bashrc</code>,设置一下别名<code>alias idea =&#39;cd /home/xiaomo/Software/idea &amp;&amp; sudo sh idea.sh &amp;&#39;</code> ，然后<code>source</code>一下。以后我启动项目就可以直接<code>idea</code>就可以启动了。至此折腾完毕，这个问题解决了，其实大多数人不会遇到这个问题，因为我们测试项目的话一般都是8080——10000之间，这些端口都是可以随便使用不用root权限的。像我们公司的项目比较特殊，客户端请求的是843端口，我不可能因为这个原因去改游戏端口，所以只能想办法获取root权限，才有了以上的折腾。</p>
<h3 id="二-linux下idea的ctrl-space-占用"><a href="#二-linux下idea的ctrl-space-占用" class="headerlink" title="二 linux下idea的ctrl+ space 占用"></a>二 linux下idea的ctrl+ space 占用</h3><p>用window的时候没影响，但是linux下的idea的智能提示键和输入法切换的键冲突了，因此我们改一下idea的keymap<br>修改方法如下：</p>
<p>点击 文件菜单(File) –&gt; 点击 设置(Settings… Ctrl+Alt+S), –&gt; 打开设置对话框。</p>
<p>在左侧的导航框中点击 KeyMap。<br>接着在右边的树型框中选择 Main menu –&gt; Code –&gt; Completion.<br>接着需要做两件事： </p>
<ol>
<li>移除原来的Cycle Expand Word 的 Alt+斜杠 快捷键绑定。 </li>
<li>在 Basic 上点击右键,去除原来的 Ctrl+空格 绑定,然后添加 Alt + 斜杠 快捷键。<br>然后应用(Apply), OK.</li>
</ol>
<h3 id="三-linux下idea编辑器无法输入中文"><a href="#三-linux下idea编辑器无法输入中文" class="headerlink" title="三 linux下idea编辑器无法输入中文"></a>三 linux下idea编辑器无法输入中文</h3><p>不知道各位在linux系统下使用idea有没有遇到这个问题，但是通过百度发现还有有多少遇到这种问题的。虽然答案千奇百怪，不一定起作用。但是通过折腾之后终于发现在可以使用的方法，设置如下：</p>
<p>解决方法</p>
<p>在IDEA的bin目录下的idea.sh文件的前面加上</p>
<p>export XMODIFIERS=@im=fcitx<br>export QT_IM_MODULE=fcitx</p>
<blockquote>
<p>如果是使用vim编辑<code>idea.sh</code>的话一下要加<code>sudo</code> ,保存时用<code>:wq!</code></p>
</blockquote>
<h4 id="四-感叹"><a href="#四-感叹" class="headerlink" title="四 感叹"></a>四 感叹</h4><p>切换到linux也有半个多月了，现在终于差不多适应了。从才开始的linux mint 17到现在的elementary os，还是爽舒服的。</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[接口格式返回大小写处理.]]></title>
      <url>https://blog.xiaomo.info/2017/JavaApiJsonFormat/</url>
      <content type="html"><![CDATA[<p>前言：在写java api的时候会因业务复杂情况遇到各种棘手问题。比如说基于己有数据库开发移动端应用的时候，hibernate这种映射框架用着就不爽了，于是我切换到了myatis上，因为它灵活度够高 。这次要讲的主题是当数据库设计人员坑B的将java关键字设置为字段名的时候，现在的你是不是万脸懵逼状态。心里一万只草泥马在奔腾，这谁TM设计的数据库，出来我保证不打死它。</p>
<a id="more"></a>
<p>这应该是我2017年的第一篇博客了，不要误会我在偷懒。相反，我一直在充电，写文章的时间就少了。所以就采取了偷懒的办法，直接把网上搜到的链接贴在发的帖子下面，算作一个系列。比如最近研究的android,<a href="https://xiaomo.info/2016/AndroidEnvironment/" target="_blank" rel="noopener">android环境搭建</a>，这篇文章下面有N多干货可以学习。<br>并且现在习惯将东西放在 OneNote 笔记本上，有图为证。<br><img src="https://image.xiaomo.info/java/onenote.png" alt="oneNote"><br>好了，不扯了正题开始。</p>
<h3 id="一、案例"><a href="#一、案例" class="headerlink" title="一、案例"></a>一、案例</h3><p>某XX将数据库数据库字段名定义为 <code>class</code>, 无解！</p>
<h3 id="二、处理办法"><a href="#二、处理办法" class="headerlink" title="二、处理办法"></a>二、处理办法</h3><p>我们知道数据库的字段是大小写不敏感的，java的属性是大小写敏感的。因此，在<code>@monsterLin</code>鸡治的告诉我定义一个不是关键字的<code>cLass</code>属性接收，经过测试，竟然没问题。。。。</p>
<p>于是，我将实体类义为以下所示。<br><img src="https://image.xiaomo.info/java/cLass.png" alt="cLass"></p>
<p>启动服务，查看结果。。<br><img src="https://image.xiaomo.info/java/json.png" alt="json"></p>
<p>小小的激动了一把，但这终究是个取巧的办法。其实在这之前我也查了许多资料。有提到<code>@JsonProperty(value = &quot;xxx&quot;)</code>和<code>@JSONField(name = &quot;xxx&quot;)</code>,但是测试都没有成功。按理推测，无论是在hibernate中还是mybatis中都应该有一个注解可以定义为如下这种。</p>
<blockquote>
<p>格式</p>
</blockquote>
<p>@我需要的注解(value = “数据库字段(java关键字)”)<br>private String 任意属性名;</p>
<blockquote>
<p>举例</p>
</blockquote>
<p>@XXX(value = “class”)<br>private String activityGoal;</p>
<p>学海无涯，需要我们不断的探索。越往深学，越觉得自己懂的少。感叹时间不够用，2016就这么过去了。2017，又要获得些什么。我想好好静下心下看一下《think in java》，想好好读读《Java设计模式》，想好好学日语早日过N1。时间那么少，想做的事情却太多。与君共勉，2017，一起加油！</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> json </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2016年终总结(写在2017伊始之际)]]></title>
      <url>https://blog.xiaomo.info/2016/StartMy2017/</url>
      <content type="html"><![CDATA[<p>前言:由于春节回家了一趟，家里没网。导致我的github长达半个多月没有更新，看着一大块灰朦朦的，心情倒还是有点小失落。今天正式回归工作岗位，发现还是安安静静的上班适合我的生活。<br>PS:写完之后才发现，啊，不知不觉竟然码了这么多字，看来我也是个有情怀(HHKB)的人。<br><a id="more"></a></p>
<h3 id="一、大事记"><a href="#一、大事记" class="headerlink" title="一、大事记"></a>一、大事记</h3><h4 id="1-回顾2016"><a href="#1-回顾2016" class="headerlink" title="1. 回顾2016"></a>1. 回顾2016</h4><ol>
<li><p>决定到杭州:<br>还在学校时的我对未来还真的是有点担忧的，尤其是快要实习的时候，一直在考虑着去哪里。相信大部分刚毕业的同学都会遇到这个问题。武汉的招聘会跑了个遍，发现并没有多少合适的工作。去腾讯面试，结果第三轮被刷了，掩面痛哭。 由于都没有找到合适的工作，2014年5月份和基友一起只身几百RMB身家跑来杭州找工作，印象深刻当时是在打铁关附近找的酒店。值得一提的是，我们在这里一周，门缝里塞的小卡片收集起来好厚一札。还好我们禁住了诱（穷）惑(屌)。穿着西装，蹬着皮鞋，早起晚归。啊，那是我逝去的青春。</p>
</li>
<li><p>决定做互联网行业：<br>作为文科出身的我没有机会选择计算机专业，所以在大学基本上没学到什么东西。然而我就凭着这一股拼劲，自己贷款去培训Java,正式走上我的编程之路。往事不堪回首，但是正是这些磨练让我不断成长。</p>
</li>
<li><p>接触到动漫、日语：<br>自古喷子层出不穷，很多人无脑抵制这个抵制那个，我不知道他们过的累不累，反正我觉得只要我喜欢的，我一定会努力追求。这不，最近又成功安利了一个小伙伴入了动漫的坑，一起享受动漫的乐趣，真是觉得很有意思呢。我就是这样，遇到好东西，我总想把它分享给全世界喜欢它的人。还在大学时经常看动漫，也动过学日语的念头，然而自制力不好的我还没学会50音图就放弃了。毕业后很巧有机会进入日企实习，然后在全日语的环境下做java开发。没有网络，不能玩手机，直接一个终端连接到东京的机房做开发。旁边一个大电视直接远程视频沟通，觉得真的好棒。虽然那个时候过的很苦，但是依旧很快乐。我觉得如果没有当时的磨练，也不会有现在的我。实习一年顶我大学3年，说出来还真是有点迷之尴尬，说明我大学是个废柴，没有努力学习。现在我依旧爱着动漫，依旧努力学着日语。我相信以后也会。</p>
</li>
<li><p>主系统换到mac os：<br>经济不宽裕的我狠心买了一个mac book air,虽然是乞丐版。但是用起来依旧很舒服。这是我第一次近距离接触类linux系统。说实话，mac的体验真的要比win好太多了。不会动不动出现卡死的情况，也不用开机等待好几分钟都反应不过来。开盖编程，合盖休息。不用考虑关机、开机。自带终端。重量轻便，外观漂亮各种各种，真的太多就不一一列举。到现在为止己经2年了，系统用起来依旧非常流畅。还治好了我玩PC游戏的毛病，真是一举多得。</p>
</li>
<li><p>加入“盛和”大家庭：<br>2015年加入，当时公司只有不到60个人到现在的近200人。慢慢发展到后来占地2层楼，公司项目月流水过2亿，去三亚旅游。曾经因为公司的单休制度打算换个环境，后来因为CTO的挽留又打消了念头。在这里也非常感觉我们CTO的照顾，很庆幸自己从实习以来遇到了几个好领导和好同事。感觉他们的带领和理解，我才能够越走越远。</p>
</li>
<li><p>进入游戏行业：<br>其实也就是加入新公司之后。以前一直是做java web的企业级项目，那个时间我的代码水平很菜，真的很菜，菜到连我自己都不想提起。但是随着自己工作时间越来越长，github上泡的时候越来越久。我也从当初的小菜鸟慢慢的变成现在的老菜鸟。哈哈，虽然都是菜鸟，但鸟还是老的好。从以前只知道玩游戏的我，到现在可以参与制作大型rpg网络游戏的开发，真的觉得很刺激。还记得当初因为玩电脑和父母发生过不少争执，从小被成为网瘾少年。如今己经过了十多年，从当初的网瘾少年成长为现在的网瘾青年。我相信我还会晋级到网瘾中年，网瘾老年。活到老，学到老。生命不停，折腾不止。是我终生的信仰。</p>
</li>
<li><p>入了机械键盘的坑：<br>以前偶尔和朋友去网吧玩lol的时候使用到机械键盘，当时只觉得手感好像还不错。渐渐的公司同事都开始把键盘换成了机械的，我也开始在网上了解。从此一发不可收拾，成了键盘发烧友。入了一个初级键盘雷柏v500s青轴,价格只要200。200你买不了吃亏，200你买不了上当，我拿着这不顶用的200买了个键盘，从此开始了噼里啪啦编程生活，幻想着走向人生巅峰。然而敲击声有股浓浓的塑料感再次让我感觉到迷之尴尬，并且觉得声音有点大，听着同事那cherry3000，妇科圣手清脆的声音，吓的我按键盘都是轻轻的。无赖之下我开始了新的烧键盘之旅，借助着网络的强大力量。我发现了程序员梦寐以求的神器——HHKB，奈何身为穷DS的我并没有能力拥有这把神器。于是各种纠结之下买了一把 DUCK2108S,花了我大约600大洋。直到现在，我一直后悔着后悔着，因为我买了把红轴。因为不太喜欢，所以也没怎么爱惜，我的电脑桌也是我的餐桌，经常会进点东西到键盘里。那个脏的我己经没有脸拿出来了。再三考虑之下，我终于入手了HHKB，值得一提的是这个键盘算是键盘界的奇葩，只有60个键。不是每个人都能驾驭得了的，我一直到现在都还是慢慢习惯，现在这篇文章都是用HHKB敲的，不得不说这手感，真是越用越带劲。下面上一张我HHKB的美图。<br><img src="https://image.xiaomo.info/blog/hhkb.png" alt="hhkb"></p>
</li>
<li><p>学习前端和android：<br>从毕业后一直做着后端的开发，对前端的知识了解的不多。在不忙的时候研究了大量关于前端的知识，了解其运行原理。包括自动构建工具 gulp、webpack，编程语言 nodejs、javascript，清楚了es5和es6的区别。</p>
</li>
<li><p>和monsterlin一起合作开发app:<br>在开发的过程中加深了沟通和交流，了解了app开发如何配合。其实跟做游戏一样，服务端和客户端的密切配合是完成工作的前提，如果遇到困难互相推诿，是做不出好的产品的。我是一个性子比较急的人，如果事情一旦决定好了就会抓紧事情去做。</p>
</li>
<li><p>决定学好linux:<br>其实从实习开始一起在使用linux。那个时间在日企实习，给了一个文档，然后让我照着命令操作。当时的我完全不明白我在做什么事情，但是终究还是达到了自己想要的效果。到后来开始接触linux系统，买了阿里云服务器和域名。愉快的折腾起了linux。环境安装、nginx、tomcat、redis、nodejs各种各种，就这样一直折腾着来到了2017。现在我打算从头开始系统的折腾一遍，所以我装了linux系统，下载了《linux就该这么学》，我的linux之路，正式开启吧！</p>
</li>
<li><p>开通了自己的博客：<br>从开通博客开始，我花了大量的时间来折腾它。从此也养成了写博客的习惯。不过我的OneNote笔记中的内容更多。哈哈哈，无耻的笑了。我可是折腾过印象、有道云、为知等等各种知名产品最终用上了OneNote的哟。<br>在此也安利一波，别像我一直折腾这么久，导笔记可是件痛苦的事情。继续正题，讲到哪了。啊，对，说到博客了，瞧我这记性。阿里云服务器、万网域名、配上nginx服务器和git。使用起来不要太方便。因为我不是个贪图安逸的人，于是我努力的学前端，学习nodejs。折腾自己的主题。结果，我成功的把移动端的blog玩坏了。。。强势打脸，我还说我前端能力还不错来着。开通博客也有一年的时间了，虽然没怎么去宣传，但是通过github上链接过来的人访问量也快过万了，还是比较开心的。</p>
</li>
<li><p>我与github的不解之缘：<br>从cvs到svn再到现在的git,由衷的感叹git真是一款工匠级的优秀产品。<br><img src="https://image.xiaomo.info/github/github0204.png" alt="github2017"><br>从github的更新记录来看，我使用github己有一年多时间，在这一年多来我通过github学到了很多很多的东西。至此做个总结吧</p>
</li>
<li><p>github用途</p>
<ol>
<li>代码控制<br>当然，这也是最重的，我把我所有的代码全部开源放在我的github上面。在和各位大牛沟通的过程中，自己的能力也在不断提升。</li>
<li>项目合作<br>在使用github管理代码的时候，当然也可以使用github管理项目。合理的使用github的issue和wiki能够使让工作更加得心应手。</li>
<li>文字管理<br>不少以写作为主的大牛们也在开始使用github写文章。其中就有大牛阮一峰老师，在我的github中有很多业界大牛，时常翻一翻他们的github，能够让自己更有动力学习下去。从不追星的我，在面对各位大牛的时候还是忍不住“向大佬递茶的”冲动。</li>
<li>其他各种<br>其实，github的用途远远不止如此。在这里，不仅能够分享自己的代码，也能够查找你想要的代码，学习先进的思想。只要你想，就可以在github上顺手的帮你做各种事情。包括奥巴马总统也使用github发布自己的一些动态。在互联网界，github被戏称为 the biggest 同性交友网站。当然，这个交往，是互相学习和进步。</li>
</ol>
</li>
<li><p>终于有了自己的车车：<br>因为老家是湖北省武当山那旮旯子的，过年回个家不亚于打仗，每年过年回家都是一个痛苦的过程。幸好去年有个神级软件 <a href="http://www.12306bypass.com/" target="_blank" rel="noopener">12306分流抢票</a>，它彻底拯救了我也拯救了我认识的几个朋友。通过它的力量我不仅帮自己买到了火车票，也帮好几个朋友买了到票。如果你过年的时候也在受抢票之苦，那么恭喜你,拯救你于水火之中的家伙可以上场了(我就是这么乐于分享的人，不用谢，我叫雷锋)。说到这里，我怎么感觉我像在做传销的。算了，上张图为证吧。。<br><img src="https://image.xiaomo.info/github/12306.png" alt="12306"><br>说到上图，我真的想吐槽12306太垃圾了。抢不到票用使用的人多的理由搪塞也就罢了，客户端打开时不时卡死又是什么鬼。我真的想说，垃圾软件，毁我青春！算了，咱们还是继续说车。公司同事一个两个都买车了，耳濡目染之下也在也在看车，鬼使神差迷上思域不能自拔。预算12万，直接提到15万。结果到4s店一问要16万还没有现车。只有次顶配现车，一时冲动直接到18万。让我先哭一会儿，接下来的时间我要开始吃土了，都不要拦我。最后多谢我们CTO力哥，车神曲老板，新晋车神小陈，预备车神强总带我去看车。这几天一直在淘各种汽车小配件，哈哈，其乐无穷。<br><img src="https://image.xiaomo.info/github/car.png" alt="car"><br>顺便再贴一个视频实拍 <a href="http://v.autohome.com.cn/v-78751.html#pvareaid=2042227" target="_blank" rel="noopener">车身修长更加运动 实拍2016款全新思域</a></p>
</li>
<li><p>与各位小伙伴的“基情”：<br>两个高中同学兼大学同学，表妹，基友在杭州各自有了自己稳定的工作，在此也祝愿他们越来越好。在工作的过程中认识了很多有爱的同事，也在网上认识了很多大牛，尤其是还在学校都己经到了我望尘莫及的高度，一直激励着我进步。与志同道合有朋友们一起交流，海天海地，真的挺有意思。</p>
</li>
</ol>
<h4 id="2-展望2017"><a href="#2-展望2017" class="headerlink" title="2.展望2017"></a>2.展望2017</h4><ol>
<li>年底准备结婚了：<br>和女朋友在一起三年了，终于可以把她的户口转到我家来了。中间有过各种矛盾，酸甜苦辣。不过到最后都是甜蜜的回忆和满满的感动。</li>
<li>准备在杭州定居：<br>对于现在的我们来说这是件比较困难的事，但是有了目标终究是要好好努力的。来杭州第三年了，待的越久越喜欢这里。</li>
<li>继续努力学习日语：<br>希望自己努力学早，早日考过N2,奋战N1，然后去外面的世界闯一闯。</li>
<li>努力学习linux:<br>不仅因为它很帅，更因为它很实用。很符合极客风范，更因为我用了HHKB，也因为我爱折腾。理由很多，但最重要的是我喜欢。因为我爱，所以我想学。2017，我会加更努力。</li>
<li>认真学习《linux就该这么学》和《java编程思想》</li>
<li>练好开车技术,为了自己,能够自己开车回老家，也为了别人。</li>
</ol>
<p>最后奉上我的人生格言</p>
<h4 id="生命不停，折腾不止。"><a href="#生命不停，折腾不止。" class="headerlink" title="生命不停，折腾不止。"></a>生命不停，折腾不止。</h4><p>2017，开始新一年的折腾</p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mysql常用操作]]></title>
      <url>https://blog.xiaomo.info/2016/MysqlCommon/</url>
      <content type="html"><![CDATA[<p>这篇文章主要介绍了mysql的用法，包含安装、常用命令等等<br><a id="more"></a></p>
<h3 id="一、环境"><a href="#一、环境" class="headerlink" title="一、环境"></a>一、环境</h3><blockquote>
<p>linux centerOs 6.5<br>mysql 最新 </p>
</blockquote>
<h3 id="二、安装"><a href="#二、安装" class="headerlink" title="二、安装"></a>二、安装</h3><h4 id="1-yum安装"><a href="#1-yum安装" class="headerlink" title="1. yum安装"></a>1. yum安装</h4><p>yum安装mysql</p>
<p><code>[root@stonex ~]#  yum -y install mysql-server</code></p>
<p>安装结果：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">Installed</span>:</span><br><span class="line">    <span class="selector-tag">mysql-server</span><span class="selector-class">.x86_64</span> 0<span class="selector-pseudo">:5.1.73-3.el6_5</span>                                                                                                                                                         </span><br><span class="line"><span class="selector-tag">Dependency</span> <span class="selector-tag">Installed</span>:</span><br><span class="line">    <span class="selector-tag">mysql</span><span class="selector-class">.x86_64</span> 0<span class="selector-pseudo">:5.1.73-3.el6_5</span>                                <span class="selector-tag">perl-DBD-MySQL</span><span class="selector-class">.x86_64</span> 0<span class="selector-pseudo">:4.013-3.el6</span>                                <span class="selector-tag">perl-DBI</span><span class="selector-class">.x86_64</span> 0<span class="selector-pseudo">:1.609-4.el6</span></span><br></pre></td></tr></table></figure>
<p>启动MySql服务<br><code>[root@stonex ~]#  service mysqld start</code></p>
<p>命令登录mysql<br><code>[root@stonex ~]#  mysql -u root</code></p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">Welcome <span class="keyword">to</span> <span class="keyword">the</span> MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; <span class="keyword">or</span> \g.</span><br></pre></td></tr></table></figure>
<p><code>mysql&gt; select user,host,password from mysql.user;</code><br>查询用户的密码，都为空，用下面的命令设置root的密码为root</p>
<p>设置MySQL的root用户设置密码  </p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mysql&gt; set password <span class="keyword">for</span> root@localhost=password(<span class="string">'root'</span>);</span><br><span class="line">mysql&gt; <span class="keyword">exit</span></span><br></pre></td></tr></table></figure>
<p>用新密码登陆<br><code>[root@stonex ~]#  mysql -u root -p</code></p>
<p>基本命令</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">show databases; <span class="regexp">//</span>查看系统已存在的数据库</span><br><span class="line">use databasesname;   <span class="regexp">//</span>选择需要使用的数据库</span><br><span class="line">drop database databasename; <span class="regexp">//</span>删除选定的数据库</span><br><span class="line"><span class="keyword">exit</span>    <span class="regexp">//</span>退出数据库的连接</span><br><span class="line">create database test01;    <span class="regexp">//</span>建立名为test的数据库</span><br><span class="line">show tables;        <span class="regexp">//</span> 列出当前数据库下的表</span><br><span class="line">其他基本的增删改查使用标准SQL即可</span><br></pre></td></tr></table></figure>
<h4 id="2-源码安装"><a href="#2-源码安装" class="headerlink" title="2. 源码安装"></a>2. 源码安装</h4><p>1.假设已经有mysql-5.5.10.tar.gz以及cmake-2.8.4.tar.gz两个源文件</p>
<p>(1)先安装cmake（mysql5.5以后是通过cmake来编译的）</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5 local</span>]<span class="meta">#tar -zxv -f cmake-2.8.4.tar.gz</span></span><br><span class="line">[<span class="meta">root@ rhel5 local</span>]<span class="meta">#cd cmake-2.8.4</span></span><br><span class="line">[<span class="meta">root@ rhel5 cmake-2.8.4</span>]<span class="meta">#./configure</span></span><br><span class="line">[<span class="meta">root@ rhel5 cmake-2.8.4</span>]<span class="meta">#make</span></span><br><span class="line">[<span class="meta">root@ rhel5 cmake-2.8.4</span>]<span class="meta">#make install</span></span><br></pre></td></tr></table></figure>
<p>(2)创建mysql的安装目录及数据库存放目录</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-attr">[root@ rhel5~]</span><span class="selector-id">#mkdir</span> <span class="selector-tag">-p</span> /<span class="selector-tag">usr</span>/<span class="selector-tag">local</span>/<span class="selector-tag">mysql</span>                 <span class="comment">//安装mysql </span></span><br><span class="line"><span class="selector-attr">[root@ rhel5~]</span><span class="selector-id">#mkdir</span> <span class="selector-tag">-p</span> /<span class="selector-tag">usr</span>/<span class="selector-tag">local</span>/<span class="selector-tag">mysql</span>/<span class="selector-tag">data</span>            <span class="comment">//存放数据库</span></span><br></pre></td></tr></table></figure>
<p>(3)创建mysql用户及用户组</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5~</span>]groupadd mysql</span><br><span class="line">[<span class="meta">root@ rhel5~</span>]useradd -r -g mysql mysql</span><br></pre></td></tr></table></figure>
<p>(4)安装mysql</p>
<p><code>cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/usr/local/mysql/data -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DEXTRA_CHARSETS=all  -DENABLED_LOCAL_INFILE=1</code></p>
<p>复制代码<br><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[root@ rhel5 local]</span><span class="comment">#tar -zxv -f mysql-5.5.10.tar.gz</span></span><br><span class="line"><span class="section">[root@ rhel5 local]</span><span class="comment">#cd mysql-5.5.10</span></span><br><span class="line"><span class="section">[root@ rhel5 mysql-5.5.10]</span><span class="comment">#cmake . </span></span><br><span class="line"><span class="attr">-DCMAKE_INSTALL_PREFIX</span>=/usr/local/mysql</span><br><span class="line"><span class="attr">-DMYSQL_DATADIR</span>=/usr/local/mysql/data</span><br><span class="line"><span class="attr">-DDEFAULT_CHARSET</span>=utf8</span><br><span class="line"><span class="attr">-DDEFAULT_COLLATION</span>=utf8_general_ci </span><br><span class="line"><span class="attr">-DEXTRA_CHARSETS</span>=all </span><br><span class="line"><span class="attr">-DENABLED_LOCAL_INFILE</span>=<span class="number">1</span></span><br><span class="line"><span class="section">[root@ rhel5 mysql-5.5.10]</span><span class="comment">#make</span></span><br><span class="line"><span class="section">[root@ rhel5 mysql-5.5.10]</span><span class="comment">#make install</span></span><br></pre></td></tr></table></figure></p>
<p>复制代码<br>参数说明：</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><span class="line">-<span class="ruby">DCMAKE_INSTALL_PREFIX=<span class="regexp">/usr/local</span><span class="regexp">/mysql        /</span><span class="regexp">/安装目录</span></span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-DINSTALL_DATADIR=<span class="regexp">/usr/local</span><span class="regexp">/mysql/data</span>         /<span class="regexp">/数据库存放目录</span></span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-DDEFAULT_CHARSET=utf8                    　　　　/<span class="regexp">/使用utf8字符</span></span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-DDEFAULT_COLLATION=utf8_general_ci            /<span class="regexp">/校验字符</span></span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-DEXTRA_CHARSETS=all                        　　　　/<span class="regexp">/安装所有扩展字符集</span></span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-DENABLED_LOCAL_INFILE=<span class="number">1</span>                    　　  /<span class="regexp">/允许从本地导入数据</span></span></span><br></pre></td></tr></table></figure>
<p>注意事项：</p>
<p>重新编译时，需要清除旧的对象文件和缓存信息。</p>
<figure class="highlight vala"><table><tr><td class="code"><pre><span class="line"><span class="meta"># make clean</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># rm -f CMakeCache.txt</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># rm -rf /etc/my.cnf</span></span><br></pre></td></tr></table></figure>
<p>2.配置</p>
<p>(1)设置目录权限</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5~</span>]<span class="meta"># cd /usr/local/mysql</span></span><br><span class="line"></span><br><span class="line">[<span class="meta">root@ rhel5 mysql</span>]<span class="meta"># chown -R root:mysql .　//把当前目录中所有文件的所有者所有者设为root，所属组为mysql</span></span><br><span class="line"></span><br><span class="line">[<span class="meta">root@ rhel5 mysql</span>]<span class="meta"># chown -R mysql:mysql data</span></span><br></pre></td></tr></table></figure>
<p>(2)</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">[root@ rhel5 mysql]# <span class="keyword">cp</span> support-<span class="keyword">files</span>/my-medium.<span class="keyword">cnf</span> /etc/my.<span class="keyword">cnf</span>　//将mysql的启动服务添加到系统服务中</span><br></pre></td></tr></table></figure>
<p>(3)创建系统数据库的表<br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5 mysql</span>]<span class="meta"># cd /usr/local/mysql</span></span><br><span class="line">[<span class="meta">root@ rhel5 mysql</span>]<span class="meta"># scripts/mysql_install_db --user=mysql</span></span><br></pre></td></tr></table></figure></p>
<p>(4)设置环境变量</p>
<p>复制代码<br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5~</span>]<span class="meta"># vi /root/.bash_profile</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">在PATH=$<span class="symbol">PATH:</span>$HOME/bin添加参数为：</span><br><span class="line"></span><br><span class="line">PATH=$<span class="symbol">PATH:</span>$HOME/<span class="symbol">bin:</span>/usr/local/mysql/<span class="symbol">bin:</span>/usr/local/mysql/<span class="class"><span class="keyword">lib</span></span></span><br><span class="line"></span><br><span class="line">[root@ rhel5~]<span class="comment">#source /root/.bash_profile</span></span><br></pre></td></tr></table></figure>
<p>复制代码<br>(5)手动启动mysql</p>
<p>复制代码<br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5~</span>]<span class="meta"># cd /usr/local/mysql</span></span><br><span class="line"></span><br><span class="line">[<span class="meta">root@ rhel5 mysql</span>]<span class="meta"># ./bin/mysqld_safe --user=mysql &amp; 　 //启动MySQL，但不能停止</span></span><br></pre></td></tr></table></figure></p>
<p>启动日志写在此文件下：<code>/usr/local/mysql/data/localhost.err</code></p>
<p>关闭MySQL服务</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">[root@ rhel5 mysql]<span class="meta"># mysqladmin -u root -p shutdown　　<span class="comment">//这里MySQL的root用户还没有配置密码，所以为空值。需要输入密码时，直接点回车键即可。</span></span></span><br></pre></td></tr></table></figure>
<p>复制代码<br>(6)另一种简单的启动mysql的方法(mysql已经被添加到系统服务中)</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">[root@ rhel5~]#<span class="built_in"> service </span>mysql.server start  </span><br><span class="line">[root@ rhel5~]#<span class="built_in"> service </span>mysql.server stop</span><br><span class="line">[root@ rhel5~]#<span class="built_in"> service </span>mysql.server restart</span><br></pre></td></tr></table></figure>
<p>如果上述命令出现：mysql.server 未识别的服务</p>
<p>则可能mysql还没添加到系统服务中，下面用另一种方法添加：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">[root@ rhel5 mysql]# cp support-files<span class="regexp">/mysql.server  /</span>etc<span class="regexp">/init.d/my</span>sql　<span class="comment">//将mysql的启动服务添加到系统服务中</span></span><br></pre></td></tr></table></figure>
<p>注意：主要是将mysql.server拷贝到/etc/init.d中，命名为mysql。在有的系统中，mysql.server在/usr/local/mysql/share/mysql/mysql.server中，而本系统中，mysql.server在/usr/local/mysql/support-files/mysql.server中。</p>
<p>然后再用<code>#service mysql start</code>来启动mysql即可。</p>
<p>(7)修改MySQL的root用户的密码以及打开远程连接</p>
<p>复制代码<br><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">[root@ rhel5~]<span class="comment"># mysql -u root mysql</span></span><br><span class="line"></span><br><span class="line">mysql&gt;use mysql;</span><br><span class="line">mysql&gt;desc user;</span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO root@<span class="string">"%"</span> IDENTIFIED BY <span class="string">"root"</span>;　　<span class="regexp">//</span>为root添加远程连接的能力。</span><br><span class="line">mysql&gt;update user set Password = password(<span class="string">'xxxxxx'</span>) where User=<span class="string">'root'</span>;</span><br><span class="line">mysql&gt;select Host,User,Password  from user where User=<span class="string">'root'</span>; </span><br><span class="line">mysql&gt;flush privileges;</span><br><span class="line">mysql&gt;<span class="keyword">exit</span></span><br></pre></td></tr></table></figure></p>
<p>重新登录：<code>mysql -u root -p</code></p>
<p>若还不能进行远程连接，则关闭防火墙</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">root@ rhel5~</span>]<span class="meta"># /etc/rc.d/init.d/iptables stop</span></span><br></pre></td></tr></table></figure>
<p>复制代码<br>注：如果不能远程连接，出现错误<code>mysql error number 1130</code>，则加入下面语句试试：</p>
<figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line">mysql&gt;GRANT <span class="literal">ALL</span> PRIVILEGES <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'root'</span>@<span class="string">'%'</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">'******'</span> <span class="keyword">WITH</span> GRANT OPTION;</span><br></pre></td></tr></table></figure>
<h3 id="三、加入service和自启动"><a href="#三、加入service和自启动" class="headerlink" title="三、加入service和自启动"></a>三、加入service和自启动</h3><p><code>find / -name mysql.server</code>   </p>
<p>将找到的文件copy到init.d下  加入到系统启动项  </p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">cp url/mysql.server <span class="string">/etc/init.d/mysqld</span> </span><br><span class="line">　　<span class="comment">#把msql的脚本文件拷到系统的启动目录下 </span></span><br><span class="line">　　<span class="keyword">cd</span> <span class="string">/etc/init.d/</span> </span><br><span class="line">　　chkconfig <span class="params">--add</span> mysqld <span class="comment">#将mysql加到启动服务列表里 </span></span><br><span class="line">　　chkconfig mysqld on <span class="comment">#让系统启动时自动打开mysql服务</span></span><br></pre></td></tr></table></figure>
<p>设置开机启动<br><code>[root@stonex ~]#  chkconfig mysqld on</code></p>
<h3 id="四、设置编码"><a href="#四、设置编码" class="headerlink" title="四、设置编码"></a>四、设置编码</h3><p>MySql修改数据库编码为UTF8<br>　mysql 创建 数据库时指定编码很重要，很多开发者都使用了默认编码，乱码问题可是防不胜防。制定数据库的编码可以很大程度上避免倒入导出带来的乱码问题。<br>　　网页数据一般采用UTF8编码，而数据库默认为latin 。我们可以通过修改数据库默认编码方式为UTF8来减少数据库创建时的设置，也能最大限度的避免因粗心造成的乱码问题。<br>　　我们遵循的标准是，数据库，表，字段和页面或文本的编码要统一起来<br>　　我们可以通过命令查看数据库当前编码：</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">　　mysql&gt; SHOW <span class="keyword">VARIABLES</span> LIKE <span class="comment">'character%'</span>;</span><br></pre></td></tr></table></figure>
<p>　　发现很多对应的都是 latin1，我们的目标就是在下次使用此命令时latin1能被UTF8取代。</p>
<p>　　第一阶段：</p>
<p>　　mysql设置编码命令</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> character_set_client <span class="comment">= utf8</span>;</span><br><span class="line"><span class="keyword">SET</span> character_set_connection <span class="comment">= utf8</span>;</span><br><span class="line"><span class="keyword">SET</span> character_set_database <span class="comment">= utf8</span>;</span><br><span class="line"><span class="keyword">SET</span> character_set_results <span class="comment">= utf8</span>;</span><br><span class="line"><span class="keyword">SET</span> character_set_server <span class="comment">= utf8</span>;</span><br></pre></td></tr></table></figure>
<p>　　然后 <code>mysql&gt; SHOW VARIABLES LIKE &#39;character%&#39;;</code>你可以看到全变为 <code>utf8</code> 。</p>
<p>　　但是，这只是一种假象</p>
<p>　　此种方式只在当前状态下有效，当重启数据库服务后失效。</p>
<p>　　所以如果想要不出现乱码只有修改my.ini文件，</p>
<p>　　从my.ini下手（标签下没有的添加，有的修改）</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">　　[<span class="meta">client</span>]</span><br><span class="line">　　<span class="keyword">default</span>-character-<span class="keyword">set</span>=utf8</span><br><span class="line">　　[<span class="meta">mysql</span>]</span><br><span class="line">　　<span class="keyword">default</span>-character-<span class="keyword">set</span>=utf8</span><br><span class="line">　　[<span class="meta">mysqld</span>]</span><br><span class="line">　　<span class="keyword">default</span>-character-<span class="keyword">set</span>=utf8</span><br></pre></td></tr></table></figure>
<p>　　以上3个section都要加default-character-set=utf8，平时我们可能只加了mysqld一项。</p>
<p>　　然后重启mysql，执行</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">　　mysql&gt; SHOW <span class="keyword">VARIABLES</span> LIKE <span class="comment">'character%'</span>;</span><br></pre></td></tr></table></figure>
<p>　　确保所有的Value项都是utf8即可。</p>
<p>　　但是可恶的事情又来了，</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">　　|<span class="string">character_set_client      </span>|<span class="string"> utf8                                  </span>|</span><br><span class="line">　　|<span class="string"> character_set_connection </span>|<span class="string"> utf8                                  </span>|</span><br><span class="line">　　|<span class="string"> character_set_database   </span>|<span class="string"> utf8                                  </span>|</span><br><span class="line">　　|<span class="string"> character_set_filesystem </span>|<span class="string"> binary                                </span>|</span><br><span class="line">　　|<span class="string"> character_set_results    </span>|<span class="string"> utf8                                  </span>|</span><br><span class="line">　　|<span class="string"> character_set_server     </span>|<span class="string"> latin1                                </span>|</span><br><span class="line">　　|<span class="string"> character_set_system     </span>|<span class="string"> utf8</span></span><br></pre></td></tr></table></figure>
<p>　　注意  该配置| character_set_server     | latin1 无法设置成UTF8   交互时候仍然会出现乱码。</p>
<p>　第二阶段：找到下面这东东</p>
<p>　　<code>X:\%path%\MySQL\MySQL Server 5.0\bin\MySQLInstanceConfig.exe</code></p>
<p>　　重新启动设置，将默认编码设置为utf8.这样就能达到我们所要的效果了。</p>
<p>　　<code>mysql&gt; SHOW VARIABLES LIKE &#39;character%&#39;;</code></p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">　　+--------------------------+---------------------------------------------------------+</span><br><span class="line">　　|<span class="string"> Variable_name            </span>|<span class="string"> Value                                                   </span>|</span><br><span class="line">　　+--------------------------+---------------------------------------------------------+</span><br><span class="line">　　|<span class="string"> character_set_client     </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_set_connection </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_set_database   </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_set_filesystem </span>|<span class="string"> binary                                                  </span>|</span><br><span class="line">　　|<span class="string"> character_set_results    </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_set_server     </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_set_system     </span>|<span class="string"> utf8                                                    </span>|</span><br><span class="line">　　|<span class="string"> character_sets_dir       </span>|<span class="string"> C:\Program Files\MySQL\MySQL Server 5.0\share\charsets\ </span>|</span><br><span class="line">　　+--------------------------+---------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">　　8 rows in set</span><br></pre></td></tr></table></figure>
<p>　　另外注意事项：</p>
<p>　　1、建表时加utf8，表字段的Collation可加可不加，不加时默认是utf8_general_ci了。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `tablename4` (</span><br><span class="line">`id` int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`varchar1` varchar(255)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">`varbinary1` varbinary(255)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=MyISAM<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8</span><br></pre></td></tr></table></figure>
<p>　　2、网页xxx.php/jsp保存时选择utf8编码，页头最好加上</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">　　header(<span class="symbol">'conten</span>-<span class="class"><span class="keyword">type</span></span>:text/html;charset=utf<span class="number">-8</span>');</span><br></pre></td></tr></table></figure>
<p>　　在执行CRUD操作前先执行一下</p>
<p>　　<code>mysql_query(&quot;set names utf8&quot;);</code></p>
<p>　　————————-</p>
<p>　　连接数据库设置编码</p>
<p>　<code>jdbc:mysql://地址:3306/数据库名?characterEncoding=utf8</code></p>
<p>　　————————-</p>
<p>　　java中的常用编码<code>UTF-8;GBK;GB2312;ISO-8859-1;</code></p>
<p>　　对应mysql数据库中的编码<code>utf8;gbk;gb2312;latin1</code></p>
<h3 id="五、-设置权限"><a href="#五、-设置权限" class="headerlink" title="五、 设置权限"></a>五、 设置权限</h3><p>开放远程登录权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">privileges</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> root@<span class="string">"%"</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"xiaomo"</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure>
<h3 id="六、创建用户"><a href="#六、创建用户" class="headerlink" title="六、创建用户"></a>六、创建用户</h3><p>1.创建账户<br><code>CREATE USER &#39;pig&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;;</code><br>2.授权<br><code>GRANT ALL ON *.* TO &#39;pig&#39;@&#39;%&#39;;</code><br>3.设置和修改密码<br><code>SET PASSWORD FOR &#39;pig&#39;@&#39;%&#39; = PASSWORD(&quot;123456&quot;);</code><br>4.撤销权限<br><code>REVOKE SELECT ON *.* FROM &#39;pig&#39;@&#39;%&#39;;</code>    </p>
<h3 id="七、存储过程"><a href="#七、存储过程" class="headerlink" title="七、存储过程"></a>七、存储过程</h3><p>我们常用的操作数据库语言SQL语句在执行的时候需要要先编译，然后执行，而存储过程（Stored Procedure）是一组为了完成特定功能的SQL语句集，经编译后存储在数据库中，用户通过指定存储过程的名字并给定参数（如果该存储过程带有参数）来调用执行它<br>1.存储过程简介 </p>
<p>我们常用的操作数据库语言SQL语句在执行的时候需要要先编译，然后执行，而存储过程（Stored Procedure）是一组为了完成特定功能的SQL语句集，经编译后存储在数据库中，用户通过指定存储过程的名字并给定参数（如果该存储过程带有参数）来调用执行它。 </p>
<p>一个存储过程是一个可编程的函数，它在数据库中创建并保存。它可以有SQL语句和一些特殊的控制结构组成。当希望在不同的应用程序或平台上执行相同的函数，或者封装特定功能时，存储过程是非常有用的。数据库中的存储过程可以看做是对编程中面向对象方法的模拟。它允许控制数据的访问方式。 </p>
<p>存储过程通常有以下优点： </p>
<p>(1).存储过程增强了SQL语言的功能和灵活性。存储过程可以用流控制语句编写，有很强的灵活性，可以完成复杂的判断和较复杂的运算。 </p>
<p>(2).存储过程允许标准组件是编程。存储过程被创建后，可以在程序中被多次调用，而不必重新编写该存储过程的SQL语句。而且数据库专业人员可以随时对存储过程进行修改，对应用程序源代码毫无影响。 </p>
<p>(3).存储过程能实现较快的执行速度。如果某一操作包含大量的Transaction-SQL代码或分别被多次执行，那么存储过程要比批处理的执行速度快很多。因为存储过程是预编译的。在首次运行一个存储过程时查询，优化器对其进行分析优化，并且给出最终被存储在系统表中的执行计划。而批处理的Transaction-SQL语句在每次运行时都要进行编译和优化，速度相对要慢一些。 </p>
<p>(4).存储过程能过减少网络流量。针对同一个数据库对象的操作（如查询、修改），如果这一操作所涉及的Transaction-SQL语句被组织程存储过程，那么当在客户计算机上调用该存储过程时，网络中传送的只是该调用语句，从而大大增加了网络流量并降低了网络负载。 </p>
<p>(5).存储过程可被作为一种安全机制来充分利用。系统管理员通过执行某一存储过程的权限进行限制，能够实现对相应的数据的访问权限的限制，避免了非授权用户对数据的访问，保证了数据的安全。 </p>
<ol start="2">
<li>关于MySQL的存储过程 </li>
</ol>
<p>存储过程是数据库存储的一个重要的功能，但是MySQL在5.0以前并不支持存储过程，这使得MySQL在应用上大打折扣。好在MySQL 5.0终于开始已经支持存储过程，这样即可以大大提高数据库的处理速度，同时也可以提高数据库编程的灵活性。 </p>
<ol start="3">
<li>MySQL存储过程的创建 </li>
</ol>
<p>(1). 格式 </p>
<p>MySQL存储过程创建的格式：CREATE PROCEDURE 过程名 ([过程参数[,…]])<br>[特性 …] 过程体 </p>
<p>这里先举个例子： </p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql&gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql&gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc1</span><span class="params">(<span class="keyword">OUT</span> s int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">BEGIN</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">SELECT</span> <span class="title">COUNT</span><span class="params">(*)</span> <span class="title">INTO</span> <span class="title">s</span> <span class="title">FROM</span> <span class="title">user</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">END</span> </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql&gt; DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>注： </p>
<p>（1）这里需要注意的是DELIMITER //和DELIMITER ;两句，DELIMITER是分割符的意思，因为MySQL默认以”;”为分隔符，如果我们没有声明分割符，那么编译器会把存储过程当成SQL语句进行处理，则存储过程的编译过程会报错，所以要事先用DELIMITER关键字申明当前段分隔符，这样MySQL才会将”;”当做存储过程中的代码，不会执行这些代码，用完了之后要把分隔符还原。 </p>
<p>（2）存储过程根据需要可能会有输入、输出、输入输出参数，这里有一个输出参数s，类型是int型，如果有多个参数用”,”分割开。 </p>
<p>（3）过程体的开始与结束使用BEGIN与END进行标识。 </p>
<p>这样，我们的一个MySQL存储过程就完成了，是不是很容易呢?看不懂也没关系，接下来，我们详细的讲解。 </p>
<p>(2). 声明分割符 </p>
<p>其实，关于声明分割符，上面的注解已经写得很清楚，不需要多说，只是稍微要注意一点的是：如果是用MySQL的Administrator管理工具时，可以直接创建，不再需要声明。 </p>
<p>(3). 参数 </p>
<p>MySQL存储过程的参数用在存储过程的定义，共有三种参数类型,IN,OUT,INOUT,形式如： </p>
<p>CREATE PROCEDURE([[IN |OUT |INOUT ] 参数名 数据类形…]) </p>
<p>IN 输入参数:表示该参数的值必须在调用存储过程时指定，在存储过程中修改该参数的值不能被返回，为默认值 </p>
<p>OUT 输出参数:该值可在存储过程内部被改变，并可返回 </p>
<p>INOUT 输入输出参数:调用时指定，并且可被改变和返回 </p>
<p>Ⅰ. IN参数例子 </p>
<p>创建: </p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">demo_in_parameter</span><span class="params">(<span class="keyword">IN</span> p_in int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">BEGIN</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">SELECT</span> <span class="title">p_in</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">SET</span> p_in=<span class="number">2</span>; </span><br><span class="line">-&gt; SELECT p_in; </span><br><span class="line">-&gt; <span class="keyword">END</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>执行结果: </p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">mysql &gt; SET <span class="meta">@p_in=1;</span> </span><br><span class="line">mysql &gt; CALL demo_in_parameter(<span class="meta">@p_in);</span> </span><br><span class="line">+------+ </span><br><span class="line">|<span class="string"> p_in </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+------+ </span></span><br><span class="line">|<span class="string"> 1 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">+------+ </span></span><br><span class="line">|<span class="string"> p_in </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+------+ </span></span><br><span class="line">|<span class="string"> 2 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">mysql&gt; SELECT @p_in; </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> @p_in </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> 1 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+</span></span><br></pre></td></tr></table></figure>
<p>以上可以看出，p_in虽然在存储过程中被修改，但并不影响@p_id的值 </p>
<p>Ⅱ.OUT参数例子 </p>
<p>创建: </p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">demo_out_parameter</span><span class="params">(<span class="keyword">OUT</span> p_out int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">BEGIN</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">SELECT</span> <span class="title">p_out</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">SET</span> p_out=<span class="number">2</span>; </span><br><span class="line">-&gt; SELECT p_out; </span><br><span class="line">-&gt; <span class="keyword">END</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>执行结果: </p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">mysql &gt; SET <span class="meta">@p_out=1;</span> </span><br><span class="line">mysql &gt; CALL sp_demo_out_parameter(<span class="meta">@p_out);</span> </span><br><span class="line">+-------+ </span><br><span class="line">|<span class="string"> p_out </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> NULL </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> p_out </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> 2 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">mysql&gt; SELECT @p_out; </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> p_out </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+ </span></span><br><span class="line">|<span class="string"> 2 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+-------+</span></span><br></pre></td></tr></table></figure>
<p>Ⅲ. INOUT参数例子 </p>
<p>创建: </p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">demo_inout_parameter</span><span class="params">(INOUT p_inout int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">BEGIN</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">SELECT</span> <span class="title">p_inout</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">SET</span> p_inout=<span class="number">2</span>; </span><br><span class="line">-&gt; SELECT p_inout; </span><br><span class="line">-&gt; <span class="keyword">END</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>执行结果: </p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">mysql &gt; SET <span class="meta">@p_inout=1;</span> </span><br><span class="line">mysql &gt; CALL demo_inout_parameter(<span class="meta">@p_inout)</span> ; </span><br><span class="line">+---------+ </span><br><span class="line">|<span class="string"> p_inout </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+---------+ </span></span><br><span class="line">|<span class="string"> 1 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+---------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">+---------+ </span></span><br><span class="line">|<span class="string"> p_inout </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+---------+ </span></span><br><span class="line">|<span class="string"> 2 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+---------+ </span></span><br><span class="line"></span><br><span class="line"><span class="string">mysql &gt; SELECT @p_inout; </span></span><br><span class="line"><span class="string">+----------+ </span></span><br><span class="line">|<span class="string"> @p_inout </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+----------+ </span></span><br><span class="line">|<span class="string"> 2 </span>|<span class="string"> </span></span><br><span class="line"><span class="string">+----------+</span></span><br></pre></td></tr></table></figure>
<p>(4). 变量 </p>
<p>Ⅰ. 变量定义 </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> variable_name [,variable_name...] datatype [<span class="keyword">DEFAULT</span> <span class="keyword">value</span>];</span><br></pre></td></tr></table></figure>
<p>其中，datatype为MySQL的数据类型，如:int, float, date, varchar(length) </p>
<p>例如:<br><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">DECLARE l_int int unsigned<span class="built_in"> default </span>4000000; </span><br><span class="line">DECLARE l_numeric number(8,2)<span class="built_in"> DEFAULT </span>9.95; </span><br><span class="line">DECLARE l_date date<span class="built_in"> DEFAULT </span><span class="string">'1999-12-31'</span>; </span><br><span class="line">DECLARE l_datetime datetime<span class="built_in"> DEFAULT </span><span class="string">'1999-12-31 23:59:59'</span>; </span><br><span class="line">DECLARE l_varchar varchar(255)<span class="built_in"> DEFAULT </span><span class="string">'This will not be padded'</span>;</span><br></pre></td></tr></table></figure></p>
<p>Ⅱ. 变量赋值<br><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">SET</span> 变量名 = 表达式值 [,variable_name = expression <span class="built_in">..</span>.]</span><br></pre></td></tr></table></figure></p>
<p>Ⅲ. 用户变量 </p>
<p>ⅰ. 在MySQL客户端使用用户变量<br><figure class="highlight moonscript"><table><tr><td class="code"><pre><span class="line">mysql &gt; SELECT <span class="string">'Hello World'</span> into @x; </span><br><span class="line">mysql &gt; SELECT @x; </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| @x | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| Hello World | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">mysql &gt; SET @y=<span class="string">'Goodbye Cruel World'</span>; </span><br><span class="line">mysql &gt; SELECT @y; </span><br><span class="line">+<span class="comment">---------------------+ </span></span><br><span class="line">| @y | </span><br><span class="line">+<span class="comment">---------------------+ </span></span><br><span class="line">| Goodbye Cruel World | </span><br><span class="line">+<span class="comment">---------------------+ </span></span><br><span class="line"></span><br><span class="line">mysql &gt; SET @z=<span class="number">1</span>+<span class="number">2</span>+<span class="number">3</span>; </span><br><span class="line">mysql &gt; SELECT @z; </span><br><span class="line">+<span class="comment">------+ </span></span><br><span class="line">| @z | </span><br><span class="line">+<span class="comment">------+ </span></span><br><span class="line">| <span class="number">6</span> | </span><br><span class="line">+<span class="comment">------+</span></span><br></pre></td></tr></table></figure></p>
<p>ⅱ. 在存储过程中使用用户变量 </p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">mysql &gt; <span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">GreetWorld</span><span class="params">( )</span> <span class="title">SELECT</span> <span class="title">CONCAT</span><span class="params">(@greeting,<span class="string">' World'</span>)</span>;</span> </span><br><span class="line">mysql &gt; <span class="keyword">SET</span> @greeting=<span class="string">'Hello'</span>; </span><br><span class="line">mysql &gt; CALL GreetWorld( ); </span><br><span class="line">+----------------------------+ </span><br><span class="line">| <span class="keyword">CONCAT</span>(@greeting,<span class="string">' World'</span>) | </span><br><span class="line">+----------------------------+ </span><br><span class="line">| Hello World | </span><br><span class="line">+----------------------------+</span><br></pre></td></tr></table></figure>
<p>ⅲ. 在存储过程间传递全局范围的用户变量 </p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">p1</span><span class="params">()</span> <span class="title">SET</span> @<span class="title">last_procedure</span>='<span class="title">p1</span>';</span> </span><br><span class="line">mysql&gt; <span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">p2</span><span class="params">()</span> <span class="title">SELECT</span> <span class="title">CONCAT</span><span class="params">(<span class="string">'Last procedure was '</span>,@last_proc)</span>;</span> </span><br><span class="line">mysql&gt; CALL p1( ); </span><br><span class="line">mysql&gt; CALL p2( ); </span><br><span class="line">+-----------------------------------------------+ </span><br><span class="line">| <span class="keyword">CONCAT</span>(<span class="string">'Last procedure was '</span>,@last_proc | </span><br><span class="line">+-----------------------------------------------+ </span><br><span class="line">| Last <span class="function"><span class="keyword">procedure</span> <span class="title">was</span> <span class="title">p1</span> | </span></span><br><span class="line"><span class="function">+-----------------------------------------------+</span></span><br></pre></td></tr></table></figure>
<p>注意: </p>
<p>①用户变量名一般以@开头<br>②滥用用户变量会导致程序难以理解及管理 </p>
<p>(5). 注释 </p>
<p>MySQL存储过程可使用两种风格的注释 </p>
<p>双模杠：– </p>
<p>该风格一般用于单行注释<br>c风格： 一般用于多行注释<br>例如： </p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc1</span> --<span class="title">name</span>存储过程名 </span></span><br><span class="line"><span class="function">-&gt; <span class="params">(<span class="keyword">IN</span> parameter1 INTEGER)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">BEGIN</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">DECLARE</span> <span class="title">variable1</span> <span class="title">CHAR</span><span class="params">(10)</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">IF</span> parameter1 = <span class="number">17</span> <span class="keyword">THEN</span> </span><br><span class="line">-&gt; <span class="keyword">SET</span> variable1 = <span class="string">'birds'</span>; </span><br><span class="line">-&gt; <span class="keyword">ELSE</span> </span><br><span class="line">-&gt; <span class="keyword">SET</span> variable1 = <span class="string">'beasts'</span>; </span><br><span class="line">-&gt; <span class="keyword">END</span> <span class="keyword">IF</span>; </span><br><span class="line">-&gt; INSERT INTO table1 VALUES (variable1); </span><br><span class="line">-&gt; <span class="keyword">END</span> </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>MySQL存储过程的调用 </li>
</ol>
<p>用call和你过程名以及一个括号，括号里面根据需要，加入参数，参数包括输入参数、输出参数、输入输出参数。具体的调用方法可以参看上面的例子。 </p>
<ol start="5">
<li>MySQL存储过程的查询 </li>
</ol>
<p>我们像知道一个数据库下面有那些表，我们一般采用show tables;进行查看。那么我们要查看某个数据库下面的存储过程，是否也可以采用呢？答案是，我们可以查看某个数据库下面的存储过程，但是是令一钟方式。 </p>
<p>我们可以用 </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> mysql.proc <span class="keyword">where</span> db=<span class="string">'数据库名'</span>;</span><br></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> routine_name <span class="keyword">from</span> information_schema.routines <span class="keyword">where</span> routine_schema=<span class="string">'数据库名'</span>;</span><br></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight cal"><table><tr><td class="code"><pre><span class="line">show <span class="function"><span class="keyword">procedure</span> <span class="title">status</span> <span class="title">where</span> <span class="title">db</span>='数据库名';</span></span><br></pre></td></tr></table></figure></p>
<p>进行查询。 </p>
<p>如果我们想知道，某个存储过程的详细，那我们又该怎么做呢？是不是也可以像操作表一样用describe 表名进行查看呢？ </p>
<p>答案是：我们可以查看存储过程的详细，但是需要用另一种方法： </p>
<p>SHOW CREATE PROCEDURE 数据库.存储过程名; </p>
<p>就可以查看当前存储过程的详细。 </p>
<p>6.MySQL存储过程的修改 </p>
<p><code>ALTER PROCEDURE</code></p>
<p>更改用CREATE PROCEDURE 建立的预先指定的存储过程，其不会影响相关存储过程或存储功能。 </p>
<ol start="7">
<li>MySQL存储过程的删除 </li>
</ol>
<p>删除一个存储过程比较简单，和删除表一样： </p>
<p><code>DROP PROCEDURE</code></p>
<p>从MySQL的表格中删除一个或多个存储过程。 </p>
<ol start="8">
<li>MySQL存储过程的控制语句 </li>
</ol>
<p>(1). 变量作用域 </p>
<p>内部的变量在其作用域范围内享有更高的优先权，当执行到end。变量时，内部变量消失，此时已经在其作用域外，变量不再可见了，应为在存储<br>过程外再也不能找到这个申明的变量，但是你可以通过out参数或者将其值指派<br>给会话变量来保存其值。<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc3</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">x1</span> <span class="title">varchar</span><span class="params">(5)</span> <span class="title">default</span> '<span class="title">outer</span>';</span> </span><br><span class="line">-&gt; <span class="keyword">begin</span> </span><br><span class="line">-&gt; declare x1 varchar(<span class="number">5</span>) <span class="keyword">default</span> <span class="string">'inner'</span>; </span><br><span class="line">-&gt; select x1; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; select x1; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>(2). 条件语句 </p>
<p>Ⅰ. if-then -else语句<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc2</span><span class="params">(<span class="keyword">IN</span> parameter int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">var</span> <span class="title">int</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">set</span> <span class="keyword">var</span>=parameter+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">if</span> <span class="keyword">var</span>=<span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; insert into t values(<span class="number">17</span>); </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">-&gt; <span class="keyword">if</span> parameter=<span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; update t <span class="keyword">set</span> s1=s1+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">else</span> </span><br><span class="line">-&gt; update t <span class="keyword">set</span> s1=s1+<span class="number">2</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>Ⅱ. case语句：<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc3</span> <span class="params">(<span class="keyword">in</span> parameter int)</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">var</span> <span class="title">int</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">set</span> <span class="keyword">var</span>=parameter+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">case</span> <span class="keyword">var</span> </span><br><span class="line">-&gt; when <span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; insert into t values(<span class="number">17</span>); </span><br><span class="line">-&gt; when <span class="number">1</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; insert into t values(<span class="number">18</span>); </span><br><span class="line">-&gt; <span class="keyword">else</span> </span><br><span class="line">-&gt; insert into t values(<span class="number">19</span>); </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">case</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>(3). 循环语句 </p>
<p>Ⅰ. while ···· end while：<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc4</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">var</span> <span class="title">int</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">set</span> <span class="keyword">var</span>=<span class="number">0</span>; </span><br><span class="line">-&gt; <span class="keyword">while</span> <span class="keyword">var</span>&lt;<span class="number">6</span> <span class="keyword">do</span> </span><br><span class="line">-&gt; insert into t values(<span class="keyword">var</span>); </span><br><span class="line">-&gt; <span class="keyword">set</span> <span class="keyword">var</span>=<span class="keyword">var</span>+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">while</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>Ⅱ. repeat···· end repeat： </p>
<p>它在执行操作后检查结果，而while则是执行前进行检查。<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc5</span> <span class="params">()</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">v</span> <span class="title">int</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">set</span> v=<span class="number">0</span>; </span><br><span class="line">-&gt; <span class="keyword">repeat</span> </span><br><span class="line">-&gt; insert into t values(v); </span><br><span class="line">-&gt; <span class="keyword">set</span> v=v+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">until</span> v&gt;=<span class="number">5</span> </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">repeat</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>Ⅲ. loop ·····end loop: </p>
<p>loop循环不需要初始条件，这点和while 循环相似，同时和repeat循环一样不需要结束条件, leave语句的意义是离开循环。<br><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER <span class="comment">// </span></span><br><span class="line">mysql &gt; CREATE <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">proc6</span> <span class="params">()</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">begin</span> </span></span><br><span class="line"><span class="function">-&gt; <span class="title">declare</span> <span class="title">v</span> <span class="title">int</span>;</span> </span><br><span class="line">-&gt; <span class="keyword">set</span> v=<span class="number">0</span>; </span><br><span class="line">-&gt; LOOP_LABLE:loop </span><br><span class="line">-&gt; insert into t values(v); </span><br><span class="line">-&gt; <span class="keyword">set</span> v=v+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">if</span> v &gt;=<span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; leave LOOP_LABLE; </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span> loop; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; <span class="comment">// </span></span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>Ⅳ. LABLES 标号： </p>
<p>标号可以用在begin repeat while 或者loop 语句前，语句标号只能在合法的语句前面使用。可以跳出循环，使运行指令达到复合语句的最后一步。 </p>
<p>(4). ITERATE迭代 </p>
<p>Ⅰ. ITERATE: </p>
<p>通过引用复合语句的标号,来从新开始复合语句<br><figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">mysql &gt; DELIMITER // </span><br><span class="line">mysql &gt; CREATE PROCEDURE proc10 () </span><br><span class="line">-&gt; begin </span><br><span class="line">-&gt; declare v int; </span><br><span class="line">-&gt; <span class="built_in">set</span> v=<span class="number">0</span>; </span><br><span class="line">-&gt; LOOP_LABLE:loop </span><br><span class="line">-&gt; <span class="keyword">if</span> v=<span class="number">3</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; <span class="built_in">set</span> v=v+<span class="number">1</span>; </span><br><span class="line">-&gt; ITERATE LOOP_LABLE; </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">-&gt; insert into t values(v); </span><br><span class="line">-&gt; <span class="built_in">set</span> v=v+<span class="number">1</span>; </span><br><span class="line">-&gt; <span class="keyword">if</span> v&gt;=<span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">-&gt; leave LOOP_LABLE; </span><br><span class="line">-&gt; <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">-&gt; <span class="keyword">end</span> loop; </span><br><span class="line">-&gt; <span class="keyword">end</span>; </span><br><span class="line">-&gt; // </span><br><span class="line">mysql &gt; DELIMITER ;</span><br></pre></td></tr></table></figure></p>
<p>9.MySQL存储过程的基本函数 </p>
<p>(1).字符串类<br><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">CHARSET</span>(str) <span class="comment">//返回字串字符集 </span></span><br><span class="line"><span class="selector-tag">CONCAT</span> (string2 [,... ]) <span class="comment">//连接字串 </span></span><br><span class="line"><span class="selector-tag">INSTR</span> (string ,substring ) <span class="comment">//返回substring首次在string中出现的位置,不存在返回0 </span></span><br><span class="line"><span class="selector-tag">LCASE</span> (string2 ) <span class="comment">//转换成小写 </span></span><br><span class="line"><span class="selector-tag">LEFT</span> (string2 ,length ) <span class="comment">//从string2中的左边起取length个字符 </span></span><br><span class="line"><span class="selector-tag">LENGTH</span> (string ) <span class="comment">//string长度 </span></span><br><span class="line"><span class="selector-tag">LOAD_FILE</span> (file_name ) <span class="comment">//从文件读取内容 </span></span><br><span class="line"><span class="selector-tag">LOCATE</span> (substring , string [,start_position ] ) 同<span class="selector-tag">INSTR</span>,但可指定开始位置 </span><br><span class="line"><span class="selector-tag">LPAD</span> (string2 ,length ,pad ) <span class="comment">//重复用pad加在string开头,直到字串长度为length </span></span><br><span class="line"><span class="selector-tag">LTRIM</span> (string2 ) <span class="comment">//去除前端空格 </span></span><br><span class="line"><span class="selector-tag">REPEAT</span> (string2 ,count ) <span class="comment">//重复count次 </span></span><br><span class="line"><span class="selector-tag">REPLACE</span> (str ,search_str ,replace_str ) <span class="comment">//在str中用replace_str替换search_str </span></span><br><span class="line"><span class="selector-tag">RPAD</span> (string2 ,length ,pad) <span class="comment">//在str后用pad补充,直到长度为length </span></span><br><span class="line"><span class="selector-tag">RTRIM</span> (string2 ) <span class="comment">//去除后端空格 </span></span><br><span class="line"><span class="selector-tag">STRCMP</span> (string1 ,string2 ) <span class="comment">//逐字符比较两字串大小, </span></span><br><span class="line"><span class="selector-tag">SUBSTRING</span> (str , position [,length ]) <span class="comment">//从str的position开始,取length个字符,</span></span><br></pre></td></tr></table></figure></p>
<p>注：mysql中处理字符串时，默认第一个字符下标为1，即参数position必须大于等于1<br><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">mysql&gt; select substring(<span class="string">'abcd'</span>,<span class="number">0</span>,<span class="number">2</span>); </span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line">| substring(<span class="string">'abcd'</span>,<span class="number">0</span>,<span class="number">2</span>) | </span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line"></span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> <span class="built_in">sec</span>) </span><br><span class="line"></span><br><span class="line">mysql&gt; select substring(<span class="string">'abcd'</span>,<span class="number">1</span>,<span class="number">2</span>); </span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line">| substring(<span class="string">'abcd'</span>,<span class="number">1</span>,<span class="number">2</span>) | </span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line">| ab | </span><br><span class="line">+<span class="comment">-----------------------+ </span></span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.02</span> <span class="built_in">sec</span>) </span><br><span class="line">TRIM([[BOTH|LEADING|TRAILING] [padding] FROM]string2)<span class="comment"> //去除指定位置的指定字符 </span></span><br><span class="line">UCASE (string2 )<span class="comment"> //转换成大写 </span></span><br><span class="line"><span class="literal">RIGHT</span>(string2,<span class="built_in">length</span>)<span class="comment"> //取string2最后length个字符 </span></span><br><span class="line"><span class="literal">SPACE</span>(count)<span class="comment"> //生成count个空格</span></span><br></pre></td></tr></table></figure></p>
<p>(2).数学类 </p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ABS</span> (number2 ) <span class="comment">//绝对值 </span></span><br><span class="line"><span class="selector-tag">BIN</span> (decimal_number ) <span class="comment">//十进制转二进制 </span></span><br><span class="line"><span class="selector-tag">CEILING</span> (number2 ) <span class="comment">//向上取整 </span></span><br><span class="line"><span class="selector-tag">CONV</span>(number2,from_base,to_base) <span class="comment">//进制转换 </span></span><br><span class="line"><span class="selector-tag">FLOOR</span> (number2 ) <span class="comment">//向下取整 </span></span><br><span class="line"><span class="selector-tag">FORMAT</span> (number,decimal_places ) <span class="comment">//保留小数位数 </span></span><br><span class="line"><span class="selector-tag">HEX</span> (DecimalNumber ) <span class="comment">//转十六进制 </span></span><br><span class="line">注：<span class="selector-tag">HEX</span>()中可传入字符串，则返回其<span class="selector-tag">ASC-11</span>码，如<span class="selector-tag">HEX</span>(<span class="string">'DEF'</span>)返回<span class="selector-tag">4142143</span> </span><br><span class="line">也可以传入十进制整数，返回其十六进制编码，如<span class="selector-tag">HEX</span>(<span class="number">25</span>)返回<span class="selector-tag">19</span> </span><br><span class="line"><span class="selector-tag">LEAST</span> (number , number2 [,..]) <span class="comment">//求最小值 </span></span><br><span class="line"><span class="selector-tag">MOD</span> (numerator ,denominator ) <span class="comment">//求余 </span></span><br><span class="line"><span class="selector-tag">POWER</span> (number ,power ) <span class="comment">//求指数 </span></span><br><span class="line"><span class="selector-tag">RAND</span>([seed]) <span class="comment">//随机数 </span></span><br><span class="line"><span class="selector-tag">ROUND</span> (number [,decimals ]) <span class="comment">//四舍五入,decimals为小数位数]</span></span><br></pre></td></tr></table></figure>
<p>注：返回类型并非均为整数，如：<br>(1)默认变为整形值 </p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">mysql&gt; select <span class="built_in">round</span>(<span class="number">1.23</span>); </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| <span class="built_in">round</span>(<span class="number">1.23</span>) | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| <span class="number">1</span> | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> <span class="built_in">sec</span>) </span><br><span class="line"></span><br><span class="line">mysql&gt; select <span class="built_in">round</span>(<span class="number">1.56</span>); </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| <span class="built_in">round</span>(<span class="number">1.56</span>) | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line">| <span class="number">2</span> | </span><br><span class="line">+<span class="comment">-------------+ </span></span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> <span class="built_in">sec</span>)</span><br></pre></td></tr></table></figure>
<p>(2)可以设定小数位数，返回浮点型数据<br><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">mysql&gt; select <span class="built_in">round</span>(<span class="number">1.567</span>,<span class="number">2</span>); </span><br><span class="line">+<span class="comment">----------------+ </span></span><br><span class="line">| <span class="built_in">round</span>(<span class="number">1.567</span>,<span class="number">2</span>) | </span><br><span class="line">+<span class="comment">----------------+ </span></span><br><span class="line">| <span class="number">1.57</span> | </span><br><span class="line">+<span class="comment">----------------+ </span></span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> <span class="built_in">sec</span>) </span><br><span class="line">SIGN (number2 )<span class="comment"> //</span></span><br></pre></td></tr></table></figure></p>
<p>(3).日期时间类 </p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ADDTIME</span> (date2 ,time_interval ) <span class="comment">//将time_interval加到date2 </span></span><br><span class="line"><span class="selector-tag">CONVERT_TZ</span> (datetime2 ,fromTZ ,toTZ ) <span class="comment">//转换时区 </span></span><br><span class="line"><span class="selector-tag">CURRENT_DATE</span> ( ) <span class="comment">//当前日期 </span></span><br><span class="line"><span class="selector-tag">CURRENT_TIME</span> ( ) <span class="comment">//当前时间 </span></span><br><span class="line"><span class="selector-tag">CURRENT_TIMESTAMP</span> ( ) <span class="comment">//当前时间戳 </span></span><br><span class="line"><span class="selector-tag">DATE</span> (datetime ) <span class="comment">//返回datetime的日期部分 </span></span><br><span class="line"><span class="selector-tag">DATE_ADD</span> (date2 , INTERVAL d_value d_type ) <span class="comment">//在date2中加上日期或时间 </span></span><br><span class="line"><span class="selector-tag">DATE_FORMAT</span> (datetime ,FormatCodes ) <span class="comment">//使用formatcodes格式显示datetime </span></span><br><span class="line"><span class="selector-tag">DATE_SUB</span> (date2 , INTERVAL d_value d_type ) <span class="comment">//在date2上减去一个时间 </span></span><br><span class="line"><span class="selector-tag">DATEDIFF</span> (date1 ,date2 ) <span class="comment">//两个日期差 </span></span><br><span class="line"><span class="selector-tag">DAY</span> (date ) <span class="comment">//返回日期的天 </span></span><br><span class="line"><span class="selector-tag">DAYNAME</span> (date ) <span class="comment">//英文星期 </span></span><br><span class="line"><span class="selector-tag">DAYOFWEEK</span> (date ) <span class="comment">//星期(1-7) ,1为星期天 </span></span><br><span class="line"><span class="selector-tag">DAYOFYEAR</span> (date ) <span class="comment">//一年中的第几天 </span></span><br><span class="line"><span class="selector-tag">EXTRACT</span> (interval_name FROM date ) <span class="comment">//从date中提取日期的指定部分 </span></span><br><span class="line"><span class="selector-tag">MAKEDATE</span> (year ,day ) <span class="comment">//给出年及年中的第几天,生成日期串 </span></span><br><span class="line"><span class="selector-tag">MAKETIME</span> (hour ,minute ,second ) <span class="comment">//生成时间串 </span></span><br><span class="line"><span class="selector-tag">MONTHNAME</span> (date ) <span class="comment">//英文月份名 </span></span><br><span class="line"><span class="selector-tag">NOW</span> ( ) <span class="comment">//当前时间 </span></span><br><span class="line"><span class="selector-tag">SEC_TO_TIME</span> (seconds ) <span class="comment">//秒数转成时间 </span></span><br><span class="line"><span class="selector-tag">STR_TO_DATE</span> (string ,format ) <span class="comment">//字串转成时间,以format格式显示 </span></span><br><span class="line"><span class="selector-tag">TIMEDIFF</span> (datetime1 ,datetime2 ) <span class="comment">//两个时间差 </span></span><br><span class="line"><span class="selector-tag">TIME_TO_SEC</span> (time ) <span class="comment">//时间转秒数] </span></span><br><span class="line"><span class="selector-tag">WEEK</span> (date_time [,start_of_week ]) <span class="comment">//第几周 </span></span><br><span class="line"><span class="selector-tag">YEAR</span> (datetime ) <span class="comment">//年份 </span></span><br><span class="line"><span class="selector-tag">DAYOFMONTH</span>(datetime) <span class="comment">//月的第几天 </span></span><br><span class="line"><span class="selector-tag">HOUR</span>(datetime) <span class="comment">//小时</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> mysql </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[常用shell脚本.]]></title>
      <url>https://blog.xiaomo.info/2016/NormalShell/</url>
      <content type="html"><![CDATA[<p>这篇文章主要介绍了5个实用的shell脚本面试题和答案,给出的脚本堪称编码规范，麻雀虽小，异常处理，友好提示，一应俱全，值得学习,需要的朋友可以参考下<br><a id="more"></a></p>
<h3 id="1-个人信息"><a href="#1-个人信息" class="headerlink" title="1. 个人信息"></a>1. 个人信息</h3><p>写一个shell脚本来得到当前的日期，时间，用户名和当前工作目录。<br>答案 : 输出用户名，当前日期和时间，以及当前工作目录的命令就是<br>$LOGNAME，‘date’，‘who i am’ 和 ’pwd‘。<br><img src="https://image.xiaomo.info/linux/question1.png" alt="question1"><br>样例输出<br>注意：带$的环境变量在赋值的时候不需要反引号</p>
<p><img src="https://image.xiaomo.info/linux/question_answer.png" alt="question_answer"><br>复制代码</p>
<h3 id="2-计算"><a href="#2-计算" class="headerlink" title="2. 计算"></a>2. 计算</h3><p>写一个shell脚本，进行两个数字的相加，如果没有输入参数就输出错误信息和一行使用说明<br><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span><span class="comment">#  参数个数</span></span><br><span class="line"><span class="operator">-ne</span> 不等于   !=</span><br><span class="line">数值比较用字数        字符串比较用符号</span><br><span class="line"><span class="operator">-ne</span>   不等于    !=</span><br><span class="line"><span class="operator">-lt</span>   小于          &lt;</span><br><span class="line"><span class="operator">-gt</span>  大于          &gt;</span><br><span class="line"><span class="operator">-le</span>  小于等于    &lt;=</span><br><span class="line"><span class="operator">-ge</span>  大于等于   &gt;=</span><br><span class="line"><span class="operator">-eq</span>  等于          ==</span><br></pre></td></tr></table></figure></p>
<p>特殊变量，不用加反引号<br>比如 echo $0，意思是输出当前文件名<br><img src="https://image.xiaomo.info/linux/sum.png" alt="sum"></p>
<p>给他添加可执行权限，并且执行。<br>复制代码代码如下:   </p>
<blockquote>
<p>chmod 755 two-numbers.sh<br>chmod +x tiaojian.sh   </p>
</blockquote>
<p>情形一: 未输入两个数字作为命令行参数运行脚本，你将得到下面的输出。<br>样例输出<br><img src="https://image.xiaomo.info/linux/count.png" alt="count"></p>
<p>因此，上述shell脚本满足了问题的要求。  </p>
<h3 id="3-反序"><a href="#3-反序" class="headerlink" title="3.反序"></a>3.反序</h3><p>你需要打印一个给定的数字的反序，如输入10572，输出27501，如果没有输入数据，应该抛出错误和使用脚本说明。在此之前，告诉我你需要在这里使用的算法。</p>
<p>算法</p>
<p>1.输入的数字为n<br>2.赋值 rev=0, sd=0 (反向和单个数字设置为0)<br>3.n % 10, 将得到最左边的数字<br>4.反向数字可以用这个方法生成 rev * 10 + sd<br>5.对输入数字进行右位移操作（除以10）<br>6.如果n &gt; 0, 进入第三步，否则进行第七步<br>7.输出rev<br>现在，创建一个名为<code>numbers.sh</code>文件，并添加以下代码。<br>复制代码代码如下:   </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -ne 1 ] </span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$0</span>   number"</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"       I will find reverse of given number"</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"       For eg. <span class="variable">$0</span> 0123, I will print 3210"</span> </span><br><span class="line">    <span class="built_in">exit</span> 1 </span><br><span class="line"><span class="keyword">fi</span> </span><br><span class="line"> </span><br><span class="line">n=<span class="variable">$1</span> </span><br><span class="line">rev=0 </span><br><span class="line">sd=0 </span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$n</span> -gt 0 ] </span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">    sd=`expr <span class="variable">$n</span> % 10` </span><br><span class="line">    rev=`expr <span class="variable">$rev</span> \* 10  + <span class="variable">$sd</span>` </span><br><span class="line">    n=`expr <span class="variable">$n</span> / 10` </span><br><span class="line"><span class="keyword">done</span> </span><br><span class="line">    <span class="built_in">echo</span>  <span class="string">"Reverse number is <span class="variable">$rev</span>"</span></span><br></pre></td></tr></table></figure>
<p>授予对文件的执行权限，并运行如下所示的脚本。<br>复制代码代码如下:</p>
<blockquote>
<p>chmod 755 numbers.h</p>
</blockquote>
<p>情形一: 当输入不包含命令行参数，你将得到下面的输出。<br>样例输出<br>复制代码代码如下:   </p>
<blockquote>
<p>./numbers.sh</p>
</blockquote>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">Usage: ./numbers.<span class="keyword">sh</span>  <span class="keyword">number</span> </span><br><span class="line">       I will <span class="keyword">find</span> <span class="built_in">reverse</span> of given <span class="keyword">number</span> </span><br><span class="line">       For eg. ./<span class="number">2</span>.<span class="keyword">sh</span> <span class="number">123</span>, I will <span class="keyword">print</span> <span class="number">321</span></span><br></pre></td></tr></table></figure>
<p>情形二: 正常输入<br>复制代码代码如下:  </p>
<p><code>$ ./numbers.sh 10572</code></p>
<p>Reverse number is 27501</p>
<p>上面的脚本非常完美，输出正是我们需要的。   </p>
<h3 id="4-使用终端"><a href="#4-使用终端" class="headerlink" title="4. 使用终端"></a>4. 使用终端</h3><p>你应该直接用终端，而不是依靠任何shell脚本来进行实数计算。你会怎么做（比如实数7.56+2.453）？<br>答案 : 我们需要用如下所述的特殊方式使用bc命令。将7.56+2.453作为输入通过管道进入bc中。<br>复制代码代码如下:</p>
<p><code>$ echo 7.56 + 2.453 | bc</code></p>
<p>10.013</p>
<h3 id="5-圆周率"><a href="#5-圆周率" class="headerlink" title="5. 圆周率"></a>5. 圆周率</h3><p>需要给出圆周率的值，精度为小数点后100位，什么是最简单的方法。</p>
<p>答案 : 找圆周率的值最简单的方法，我们只是需要发出以下命令。<br>复制代码代码如下:</p>
<blockquote>
<p>time echo “scale=5000; 4*a(1)” | bc -l -q </p>
</blockquote>
<p>大概需要30S左右</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">3.141592653589793238462643383279502884197169399375105820974944592307</span>\</span><br><span class="line"><span class="number">81640628620899862803482534211706798214808651328230664709384460955058</span>\</span><br><span class="line"><span class="number">22317253594081284811174502841027019385211055596446229489549303819644</span>\</span><br><span class="line"><span class="number">28810975665933446128475648233786783165271201909145648566923460348610</span>\</span><br><span class="line"><span class="number">45432664821339360726024914127372458700660631558817488152092096282925</span>\</span><br><span class="line"><span class="number">40917153643678925903600113305305488204665213841469519415116094330572</span>\</span><br><span class="line"><span class="number">70365759591953092186117381932611793105118548074462379962749567351885</span>\</span><br><span class="line"><span class="number">75272489122793818301194912983367336244065664308602139494639522473719</span>\</span><br><span class="line"><span class="number">07021798609437027705392171762931767523846748184676694051320005681271</span>\</span><br><span class="line"><span class="number">45263560827785771342757789609173637178721468440901224953430146549585</span>\</span><br><span class="line"><span class="number">37105079227968925892354201995611212902196086403441815981362977477130</span>\</span><br><span class="line"><span class="number">99605187072113499999983729780499510597317328160963185950244594553469</span>\</span><br><span class="line"><span class="number">08302642522308253344685035261931188171010003137838752886587533208381</span>\</span><br><span class="line"><span class="number">42061717766914730359825349042875546873115956286388235378759375195778</span>\</span><br><span class="line"><span class="number">18577805321712268066130019278766111959092164201989380952572010654858</span>\</span><br><span class="line"><span class="number">63278865936153381827968230301952035301852968995773622599413891249721</span>\</span><br><span class="line"><span class="number">77528347913151557485724245415069595082953311686172785588907509838175</span>\</span><br><span class="line"><span class="number">46374649393192550604009277016711390098488240128583616035637076601047</span>\</span><br><span class="line"><span class="number">10181942955596198946767837449448255379774726847104047534646208046684</span>\</span><br><span class="line"><span class="number">25906949129331367702898915210475216205696602405803815019351125338243</span>\</span><br><span class="line"><span class="number">00355876402474964732639141992726042699227967823547816360093417216412</span>\</span><br><span class="line"><span class="number">19924586315030286182974555706749838505494588586926995690927210797509</span>\</span><br><span class="line"><span class="number">30295532116534498720275596023648066549911988183479775356636980742654</span>\</span><br><span class="line"><span class="number">25278625518184175746728909777727938000816470600161452491921732172147</span>\</span><br><span class="line"><span class="number">72350141441973568548161361157352552133475741849468438523323907394143</span>\</span><br><span class="line"><span class="number">33454776241686251898356948556209921922218427255025425688767179049460</span>\</span><br><span class="line"><span class="number">16534668049886272327917860857843838279679766814541009538837863609506</span>\</span><br><span class="line"><span class="number">80064225125205117392984896084128488626945604241965285022210661186306</span>\</span><br><span class="line"><span class="number">74427862203919494504712371378696095636437191728746776465757396241389</span>\</span><br><span class="line"><span class="number">08658326459958133904780275900994657640789512694683983525957098258226</span>\</span><br><span class="line"><span class="number">20522489407726719478268482601476990902640136394437455305068203496252</span>\</span><br><span class="line"><span class="number">45174939965143142980919065925093722169646151570985838741059788595977</span>\</span><br><span class="line"><span class="number">29754989301617539284681382686838689427741559918559252459539594310499</span>\</span><br><span class="line"><span class="number">72524680845987273644695848653836736222626099124608051243884390451244</span>\</span><br><span class="line"><span class="number">13654976278079771569143599770012961608944169486855584840635342207222</span>\</span><br><span class="line"><span class="number">58284886481584560285060168427394522674676788952521385225499546667278</span>\</span><br><span class="line"><span class="number">23986456596116354886230577456498035593634568174324112515076069479451</span>\</span><br><span class="line"><span class="number">09659609402522887971089314566913686722874894056010150330861792868092</span>\</span><br><span class="line"><span class="number">08747609178249385890097149096759852613655497818931297848216829989487</span>\</span><br><span class="line"><span class="number">22658804857564014270477555132379641451523746234364542858444795265867</span>\</span><br><span class="line"><span class="number">82105114135473573952311342716610213596953623144295248493718711014576</span>\</span><br><span class="line"><span class="number">54035902799344037420073105785390621983874478084784896833214457138687</span>\</span><br><span class="line"><span class="number">51943506430218453191048481005370614680674919278191197939952061419663</span>\</span><br><span class="line"><span class="number">42875444064374512371819217999839101591956181467514269123974894090718</span>\</span><br><span class="line"><span class="number">64942319615679452080951465502252316038819301420937621378559566389377</span>\</span><br><span class="line"><span class="number">87083039069792077346722182562599661501421503068038447734549202605414</span>\</span><br><span class="line"><span class="number">66592520149744285073251866600213243408819071048633173464965145390579</span>\</span><br><span class="line"><span class="number">62685610055081066587969981635747363840525714591028970641401109712062</span>\</span><br><span class="line"><span class="number">80439039759515677157700420337869936007230558763176359421873125147120</span>\</span><br><span class="line"><span class="number">53292819182618612586732157919841484882916447060957527069572209175671</span>\</span><br><span class="line"><span class="number">16722910981690915280173506712748583222871835209353965725121083579151</span>\</span><br><span class="line"><span class="number">36988209144421006751033467110314126711136990865851639831501970165151</span>\</span><br><span class="line"><span class="number">16851714376576183515565088490998985998238734552833163550764791853589</span>\</span><br><span class="line"><span class="number">32261854896321329330898570642046752590709154814165498594616371802709</span>\</span><br><span class="line"><span class="number">81994309924488957571282890592323326097299712084433573265489382391193</span>\</span><br><span class="line"><span class="number">25974636673058360414281388303203824903758985243744170291327656180937</span>\</span><br><span class="line"><span class="number">73444030707469211201913020330380197621101100449293215160842444859637</span>\</span><br><span class="line"><span class="number">66983895228684783123552658213144957685726243344189303968642624341077</span>\</span><br><span class="line"><span class="number">32269780280731891544110104468232527162010526522721116603966655730925</span>\</span><br><span class="line"><span class="number">47110557853763466820653109896526918620564769312570586356620185581007</span>\</span><br><span class="line"><span class="number">29360659876486117910453348850346113657686753249441668039626579787718</span>\</span><br><span class="line"><span class="number">55608455296541266540853061434443185867697514566140680070023787765913</span>\</span><br><span class="line"><span class="number">44017127494704205622305389945613140711270004078547332699390814546646</span>\</span><br><span class="line"><span class="number">45880797270826683063432858785698305235808933065757406795457163775254</span>\</span><br><span class="line"><span class="number">20211495576158140025012622859413021647155097925923099079654737612551</span>\</span><br><span class="line"><span class="number">76567513575178296664547791745011299614890304639947132962107340437518</span>\</span><br><span class="line"><span class="number">95735961458901938971311179042978285647503203198691514028708085990480</span>\</span><br><span class="line"><span class="number">10941214722131794764777262241425485454033215718530614228813758504306</span>\</span><br><span class="line"><span class="number">33217518297986622371721591607716692547487389866549494501146540628433</span>\</span><br><span class="line"><span class="number">66393790039769265672146385306736096571209180763832716641627488880078</span>\</span><br><span class="line"><span class="number">69256029022847210403172118608204190004229661711963779213375751149595</span>\</span><br><span class="line"><span class="number">01566049631862947265473642523081770367515906735023507283540567040386</span>\</span><br><span class="line"><span class="number">74351362222477158915049530984448933309634087807693259939780541934144</span>\</span><br><span class="line"><span class="number">73774418426312986080998886874132604720</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">real	<span class="number">0</span>m32<span class="number">.275</span>s</span><br><span class="line">user	<span class="number">0</span>m31<span class="number">.721</span>s</span><br><span class="line">sys	<span class="number">0</span>m0<span class="number">.035</span>s</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android users-permission权限列表.]]></title>
      <url>https://blog.xiaomo.info/2016/AndroidUsersPermission/</url>
      <content type="html"><![CDATA[<p>对于刚接触android的人来说，有很多坑要踩的。踩多少填多少，无所畏惧。<br><a id="more"></a></p>
<h3 id="一、踩坑背景"><a href="#一、踩坑背景" class="headerlink" title="一、踩坑背景"></a>一、踩坑背景</h3><p>今天在做小练习——《图灵机器人》的时候，需要使用网络调用图灵api的接口获取数据。但是由于见识太少，不知道访问网络要添加权限导致一直访问不了网络。经过一系列的调试，发现了问题。</p>
<h3 id="二、解决办法"><a href="#二、解决办法" class="headerlink" title="二、解决办法"></a>二、解决办法</h3><p>在<code>manifest</code>中添加权限即可解决这一问题，下面贴上具体代码</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"info.xiaomo.robot"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 我们就是要在这里加上INTERNET的访问权限 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">"info.xiaomo.robot.MainActivity"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="三、其他权限延伸"><a href="#三、其他权限延伸" class="headerlink" title="三、其他权限延伸"></a>三、其他权限延伸</h3><h4 id="添加WiFi以及访问网络的权限："><a href="#添加WiFi以及访问网络的权限：" class="headerlink" title="添加WiFi以及访问网络的权限："></a>添加WiFi以及访问网络的权限：</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CHANGE_NETWORK_STATE"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CHANGE_WIFI_STATE"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WAKE_LOCK"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="操作外部存储设备文件："><a href="#操作外部存储设备文件：" class="headerlink" title="操作外部存储设备文件："></a>操作外部存储设备文件：</h4><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="built_in">name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h4 id="录音时需要的权限："><a href="#录音时需要的权限：" class="headerlink" title="录音时需要的权限："></a>录音时需要的权限：</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.RECORD_AUDIO"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="录制视频时需要的权限："><a href="#录制视频时需要的权限：" class="headerlink" title="录制视频时需要的权限："></a>录制视频时需要的权限：</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CAMERA"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.RECORD_AUDIO"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="发送短信："><a href="#发送短信：" class="headerlink" title="发送短信："></a>发送短信：</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.SEND_SMS"</span> &gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="收短信"><a href="#收短信" class="headerlink" title="收短信:"></a>收短信:</h4><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="built_in">name</span>=<span class="string">"android.permission.RECEIVE_SMS"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h4 id="收彩信："><a href="#收彩信：" class="headerlink" title="收彩信："></a>收彩信：</h4><p><uses-permission android:name="android.permission.READ_SMS"></uses-permission></p>
<h4 id="GPS"><a href="#GPS" class="headerlink" title="GPS:"></a>GPS:</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  访问网络 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  GPS定位 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_MOCK_LOCATION"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_LOCATION_EXTRA_COMMANDS"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_FINE_LOCATION"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  AGPS定位 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_COARSE_LOCATION"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://image.xiaomo.info/android/androidPermission.png" alt="权限"></p>
<h4 id="实现后的效果"><a href="#实现后的效果" class="headerlink" title="实现后的效果"></a>实现后的效果</h4><p>因为模拟器没调出到在哪输入中文，也是有点蛋疼<br><a href="https://github.com/XiaomoAndroid/XiaomoRobot" target="_blank" rel="noopener">源码地址</a><br><img src="https://image.xiaomo.info/android/xiaomoRobot.gif" alt="效果演示"></p>
]]></content>
      
        <categories>
            
            <category> android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android异步任务AsyncTask.]]></title>
      <url>https://blog.xiaomo.info/2016/AndroidAsyncTask/</url>
      <content type="html"><![CDATA[<p>不得不说，对于APP来说，后台运行任务必不可少。异步任务能够增强用户体验，是必不可少的东西。<br><a id="more"></a></p>
<h3 id="一、AsyncTask和Handler"><a href="#一、AsyncTask和Handler" class="headerlink" title="一、AsyncTask和Handler"></a>一、AsyncTask和Handler</h3><h4 id="1-AsyncTask实现的原理-和适用的优缺点"><a href="#1-AsyncTask实现的原理-和适用的优缺点" class="headerlink" title="1.  AsyncTask实现的原理,和适用的优缺点"></a>1.  AsyncTask实现的原理,和适用的优缺点</h4><p>AsyncTask,是android提供的轻量级的异步类,可以直接继承AsyncTask,在类中实现异步操作,并提供接口反馈当前异步执行的程度(可以通过接口实现UI进度更新),最后反馈执行的结果给UI主线程.</p>
<p>使用的优点:</p>
<blockquote>
<p> 简单,快捷<br> 过程可控</p>
</blockquote>
<p>使用的缺点:</p>
<blockquote>
<p>在使用多个异步操作和并需要进行Ui变更时,就变得复杂起来.</p>
</blockquote>
<h4 id="2-Handler异步实现的原理和适用的优缺点"><a href="#2-Handler异步实现的原理和适用的优缺点" class="headerlink" title="2. Handler异步实现的原理和适用的优缺点"></a>2. Handler异步实现的原理和适用的优缺点</h4><p>在Handler 异步实现时,涉及到 Handler, Looper, Message,Thread四个对象，实现异步的流程是主线程启动Thread（子线程）àthread(子线程)运行并生成Message-àLooper获取Message并传递给HandleràHandler逐个获取Looper中的Message，并进行UI变更。</p>
<p>使用的优点：</p>
<blockquote>
<p>结构清晰，功能定义明确<br>对于多个后台任务时，简单，清晰</p>
</blockquote>
<p>使用的缺点：</p>
<blockquote>
<p>在单个后台异步处理时，显得代码过多，结构过于复杂（相对性）</p>
</blockquote>
<h3 id="二、AsyncTask介绍"><a href="#二、AsyncTask介绍" class="headerlink" title="二、AsyncTask介绍"></a>二、AsyncTask介绍</h3><p>Android的AsyncTask比Handler更轻量级一些，适用于简单的异步处理。<br>首先明确Android之所以有Handler和AsyncTask，都是为了不阻塞主线程（UI线程），且UI的更新只能在主线程中完成，因此异步处理是不可避免的。<br>Android为了降低这个开发难度，提供了AsyncTask。AsyncTask就是一个封装过的后台任务类，顾名思义就是异步任务。<br>AsyncTask直接继承于Object类，位置为android.os.AsyncTask。要使用AsyncTask工作我们要提供三个泛型参数，并重载几个方法(至少重载一个)。</p>
<h4 id="1-泛型"><a href="#1-泛型" class="headerlink" title="1.泛型"></a>1.泛型</h4><p>AsyncTask定义了三种泛型类型 Params，Progress和Result。</p>
<blockquote>
<p>Params 启动任务执行的输入参数，比如HTTP请求的URL。<br>Progress 后台任务执行的百分比。<br>Result 后台执行任务最终返回的结果，比如String。</p>
</blockquote>
<h4 id="2-重载"><a href="#2-重载" class="headerlink" title="2. 重载"></a>2. 重载</h4><p>使用过AsyncTask 的同学都知道一个异步加载数据最少要重写以下这两个方法：</p>
<blockquote>
<p>doInBackground(Params…) 后台执行，比较耗时的操作都可以放在这里。注意这里不能直接操作UI。此方法在后台线程执行，完成任务的主要工作，通常需要较长的时间。在执行过程中可以调用publishProgress(Progress…)来更新任务的进度。<br>onPostExecute(Result)  相当于Handler 处理UI的方式，在这里面可以使用在doInBackground 得到的结果处理操作UI。 此方法在主线程执行，任务执行的结果作为此方法的参数返回</p>
</blockquote>
<p>有必要的话你还得重写以下这三个方法，但不是必须的：</p>
<blockquote>
<p>onProgressUpdate(Progress…)   可以使用进度条增加用户体验度。 此方法在主线程执行，用于显示任务执行的进度。<br>onPreExecute()        这里是最终用户调用Excute时的接口，当任务执行之前开始调用此方法，可以在这里显示进度对话框。<br>onCancelled()             用户调用取消时，要做的操作</p>
</blockquote>
<h4 id="3-准则"><a href="#3-准则" class="headerlink" title="3.准则"></a>3.准则</h4><p>使用AsyncTask类，以下是几条必须遵守的准则：</p>
<blockquote>
<p>Task的实例必须在UI thread中创建；<br>execute方法必须在UI thread中调用；<br>不要手动的调用onPreExecute(), onPostExecute(Result)，doInBackground(Params…), onProgressUpdate(Progress…)这几个方法；<br>该task只能被执行一次，否则多次调用时将会出现异常；</p>
</blockquote>
<h3 id="三、例子"><a href="#三、例子" class="headerlink" title="三、例子"></a>三、例子</h3><p>一个超简单的理解 AsyncTask 的例子：</p>
<h4 id="1-xml-UI布局"><a href="#1-xml-UI布局" class="headerlink" title="1. xml(UI布局)"></a>1. xml(UI布局)</h4><p>main.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"fill_parent"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/textView01"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">ProgressBar</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:id</span>=<span class="string">"@+id/progressBar02"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">"?android:attr/progressBarStyleHorizontal"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/button03"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"更新progressbar"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="1-activity-活动面板"><a href="#1-activity-活动面板" class="headerlink" title="1. activity(活动面板)"></a>1. activity(活动面板)</h4><p>MainActivity.java</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> vic.wong.main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.<span class="type">Activity</span>;</span><br><span class="line"><span class="keyword">import</span> android.os.<span class="type">Bundle</span>;</span><br><span class="line"><span class="keyword">import</span> android.view.<span class="type">View</span>;</span><br><span class="line"><span class="keyword">import</span> android.view.<span class="type">View</span>.<span class="type">OnClickListener</span>;</span><br><span class="line"><span class="keyword">import</span> android.widget.<span class="type">Button</span>;</span><br><span class="line"><span class="keyword">import</span> android.widget.<span class="type">ProgressBar</span>;</span><br><span class="line"><span class="keyword">import</span> android.widget.<span class="type">TextView</span>;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Button</span> button;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ProgressBar</span> progressBar;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">TextView</span> textView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(<span class="type">R</span>.layout.main);</span><br><span class="line"></span><br><span class="line">        button = (<span class="type">Button</span>)findViewById(<span class="type">R</span>.id.button03);</span><br><span class="line">        progressBar = (<span class="type">ProgressBar</span>)findViewById(<span class="type">R</span>.id.progressBar02);</span><br><span class="line">        textView = (<span class="type">TextView</span>)findViewById(<span class="type">R</span>.id.textView01);</span><br><span class="line"></span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> <span class="type">OnClickListener</span>() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            public void onClick(<span class="type">View</span> v) &#123;</span><br><span class="line">                <span class="type">ProgressBarAsyncTask</span> asyncTask = <span class="keyword">new</span> <span class="type">ProgressBarAsyncTask</span>(textView, progressBar);</span><br><span class="line">                asyncTask.execute(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-操作者-模拟网络环境"><a href="#3-操作者-模拟网络环境" class="headerlink" title="3.操作者(模拟网络环境)"></a>3.操作者(模拟网络环境)</h4><p>NetOperator.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> vic.wong.main;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//模拟网络环境</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetOperator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//休眠1秒</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-asyncTask-异步任务"><a href="#4-asyncTask-异步任务" class="headerlink" title="4. asyncTask(异步任务)"></a>4. asyncTask(异步任务)</h4><p>ProgressBarAsyncTask .java</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">package vic.wong.main;</span><br><span class="line"><span class="keyword">import</span> android.os.AsyncTask;</span><br><span class="line"><span class="keyword">import</span> android.widget.ProgressBar;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>生成该类的对象，并调用execute方法之后</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>首先执行的是onProExecute方法</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>其次执行doInBackGroup方法</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> *</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> */</span></span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">ProgressBarAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Integer</span>, <span class="title">Integer</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    private TextView textView;</span><br><span class="line">    private ProgressBar progressBar;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public ProgressBarAsyncTask(TextView textView, ProgressBar progressBar) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.textView = textView;</span><br><span class="line">        <span class="keyword">this</span>.progressBar = progressBar;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>这里的Integer参数对应AsyncTask中的第一个参数</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>这里的String返回值对应AsyncTask的第三个参数</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>该方法并不运行在UI线程当中，主要用于异步操作，所有在该方法中不能对UI当中的空间进行设置和修改</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>但是可以调用publishProgress方法触发onProgressUpdate对UI进行操作</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    protected <span class="built_in">String</span> doInBackground(Integer... params) &#123;</span><br><span class="line">        NetOperator netOperator = <span class="keyword">new</span> NetOperator();</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">10</span>; i &lt;= <span class="number">100</span>; i+=<span class="number">10</span>) &#123;</span><br><span class="line">            netOperator.<span class="keyword">operator</span>();</span><br><span class="line">            publishProgress(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i + params[<span class="number">0</span>].intValue() + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>这里的String参数对应AsyncTask中的第三个参数（也就是接收doInBackground的返回值）</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>在doInBackground方法执行结束之后在运行，并且运行在UI线程当中 可以对UI空间进行设置</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    protected <span class="keyword">void</span> onPostExecute(<span class="built_in">String</span> result) &#123;</span><br><span class="line">        textView.setText(<span class="string">"异步操作执行结束"</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//该方法运行在UI线程当中,并且运行在UI线程当中 可以对UI空间进行设置</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    protected <span class="keyword">void</span> onPreExecute() &#123;</span><br><span class="line">        textView.setText(<span class="string">"开始执行异步线程"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>这里的Intege参数对应AsyncTask中的第二个参数</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>在doInBackground方法当中，，每次调用publishProgress方法都会触发onProgressUpdate执行</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>onProgressUpdate是在UI线程中执行，所有可以对UI空间进行操作</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    protected <span class="keyword">void</span> onProgressUpdate(Integer... values) &#123;</span><br><span class="line">        <span class="built_in">int</span> vlaue = values[<span class="number">0</span>];</span><br><span class="line">        progressBar.setProgress(vlaue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android环境搭建.]]></title>
      <url>https://blog.xiaomo.info/2016/AndroidEnvironment/</url>
      <content type="html"><![CDATA[<p>普天同庆，谷歌打算重回中国市场了。不管是angular2的完成，还是昨天developer.google.cn的开通，都是对开发者来说是一件高兴的事情。正好趁此机会研究一下android。<br><a id="more"></a></p>
<h3 id="一、IDE工具下载"><a href="#一、IDE工具下载" class="headerlink" title="一、IDE工具下载"></a>一、IDE工具下载</h3><p><a href="http://www.android-studio.org/" target="_blank" rel="noopener">android studio官网</a> 1.6G，有点大哦。</p>
<h3 id="二、-评价"><a href="#二、-评价" class="headerlink" title="二、 评价"></a>二、 评价</h3><p>不得不说，看到android studio第一眼就觉得舒服。从IDEA无缝切换到as，除了本身有点大，其他没毛病。</p>
<h3 id="三、配置"><a href="#三、配置" class="headerlink" title="三、配置"></a>三、配置</h3><p>在安装好之后，启动时会让我们配一下代理，也就是http proxy这东西。配完镜像速度会变快，当然在中国不配就等于用不了。真希望啥时候谷歌能全面回到中国市场。<br><a href="http://mirrors.neusoft.edu.cn/more.we#android" target="_blank" rel="noopener">配置说明</a>  mirrors.neusoft.edu.cn:80<br><img src="https://image.xiaomo.info/android/httpProxy.png" alt="android http proxy"></p>
<h3 id="四、设置SDK"><a href="#四、设置SDK" class="headerlink" title="四、设置SDK"></a>四、设置SDK</h3><p>在安装android studio时也装了android SDK,找到我们安装时间的位置。我装的时候没有截图，就不放图了。我放在E盘，默认在C/用户/appData/xxxx。<br><img src="https://image.xiaomo.info/android/androidSdk.png" alt="android http proxy"><br>选中Android/sdk，下一步，完成。</p>
<h3 id="五、创建项目"><a href="#五、创建项目" class="headerlink" title="五、创建项目"></a>五、创建项目</h3><p>创建项目</p>
<p>首先，先指出Android Studio中的两个概念。 Project 和 Module 。在Android Studio中， Project 的真实含义是工作空间， Module 为一个具体的项目。</p>
<p>在 Eclipse 中，我们可以同时对多个 Eclipse 的 Project 进行同时编辑，这些 Project 在同一个 workspace 之中。在Android Studio中，我们可以同时对多个Android Studio的 Module 进行同时编辑，这些 Module 在同一个 Project 之中。</p>
<p>Eclipse 的 Project 等同于Android Studio的 Module 。<br>Eclipse 的 workspace 等同于Android Studio的 Project 。</p>
<p>本文中所说到的项目指的是Android Studio的 Module 。Android Studio创建一个项目，首先要先创建 Project 。但是你创建项目的同时， Project 自动创建了，因此很多人容易混淆这两种概念。</p>
<p><img src="https://image.xiaomo.info/android/newProject.png" alt="newProject"><br>Application name ：应用程序的名称。它是app在设备上显示的应用程序名称，也是在Android Studio Project 的名称。<br>Company Domain ：公司域名。影响下面的 Package name 。默认为电脑主机名称，当然你也可以单独设置 Package name 。<br>Package name ：应用程序包名。每一个app都有一个独立的包名，如果两个app的包名相同，Android会认为他们是同一个app。因此，需要尽量保证，不同的app拥有不同的包名。<br>Project localtion ： Project 存放的本地目录。</p>
<p>以上内容设置完毕，点击 Next 。</p>
<p><img src="https://image.xiaomo.info/android/setSdk.png" alt="setSdk"></p>
<p>在这里，你可以你的 Project 中 Module 的类型以及支持的最低版本。<br>Phone and Tablet ：表示 Module 是一个手机和平板项目。<br>TV ：表示 Module 是一个Android TV项目。<br>Wear ：表示 Module 是一个可穿戴设备（例如手表）项目。<br>Glass ：表示 Module 是一个 Google Glass 项目（不知道 Google Glass 是什么请自行搜索）。</p>
<p>你可以同时选择多个类型，区别就是项目会根据你选择的类型创建一个或多个 Module 。</p>
<p>Minimum SDK 表示的是 Module 支持的Android最低版本。根据不同的用户可以选择不同的版本。你可以点击 Help me choose 来查看当前Android版本分布情况。现在这个时代，如果你的项目支持到 2.2 版本几乎是支持了所有的Android设备。</p>
<p>以上内容设置完毕，点击 Next 。</p>
<p>接下来，我们会看到这个页面（由于我的 Module 类型只选择了 Phone and Tablet ，所以会有这个页面。）。</p>
<p>这个页面是让我们选择是否创建 Activity以及创建 Activity 的类型。你可以选择不创建 Activity （ Add No Activity ）。</p>
<p>如果你选择自动创建 Activity，Android Studio会自动帮你生成一些代码。根据 Activity 类型的不同，生成的代码也是不同的。有时，你能从这些自动生成的代码中，学到很多东西，比如 Fullscreen Activity 。<br>选择完毕，点击 Next ,然后就创建好了。</p>
<h3 id="六、项目目录结构"><a href="#六、项目目录结构" class="headerlink" title="六、项目目录结构"></a>六、项目目录结构</h3><p>在Android Studio中，提供了以下几种项目结构类型：project、packages、android等等。我们常用的就是project和android两种，所以就介绍这两种<br><img src="https://image.xiaomo.info/android/projectJiegou.png" alt="projectJiegou"></p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">app</span>/build/ <span class="keyword">app</span>模块build编译输出的目录</span><br><span class="line"><span class="keyword">app</span>/build.gradle <span class="keyword">app</span>模块的gradle编译文件</span><br><span class="line"><span class="keyword">app</span>/<span class="keyword">app</span>.iml <span class="keyword">app</span>模块的配置文件</span><br><span class="line"><span class="keyword">app</span>/proguard-rules.<span class="keyword">pro</span> <span class="keyword">app</span>模块proguard文件</span><br><span class="line">build.gradle 项目的gradle编译文件</span><br><span class="line">settings.gradle 定义项目包含哪些模块</span><br><span class="line">gradlew 编译脚本，可以在命令行执行打包</span><br><span class="line"><span class="keyword">local</span>.properties 配置SDK/NDK</span><br><span class="line">MyApplication.iml 项目的配置文件</span><br><span class="line">External Libraries 项目依赖的Lib, 编译时自动下载的</span><br></pre></td></tr></table></figure>
<p><img src="https://image.xiaomo.info/android/androidJiegou.png" alt="androidJiegou"></p>
<p>app/manifests AndroidManifest.xml配置文件目录<br>app/java 源码目录<br>app/res 资源文件目录<br>Gradle Scripts gradle编译相关的脚本</p>
<p>原文  <a href="http://www.aswifter.com/2015/07/07/android-studio-project-struct/" target="_blank" rel="noopener">http://www.aswifter.com/2015/07/07/android-studio-project-struct/</a></p>
]]></content>
      
        <categories>
            
            <category> android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[博客域名迁移(从二级域名迁移到一级域名).]]></title>
      <url>https://blog.xiaomo.info/2016/blogToXiaomo/</url>
      <content type="html"><![CDATA[<p>折腾完https之后在考虑SEO优化的问题，HTTPS对搜索收录更加友好。既然要友好，就要做到底，一级域名的SEO和比二级域名权重高，因此考虑把博客从二级域名迁移到一级域名。(生命不息折腾不止！)<br>从<a href="https://blog.xiaomo.info">https://blog.xiaomo.info</a>迁移到<a href="https://xiaomo.info" target="_blank" rel="noopener">https://xiaomo.info</a><br><a id="more"></a></p>
<h3 id="一、迁移原因"><a href="#一、迁移原因" class="headerlink" title="一、迁移原因"></a>一、迁移原因</h3><h4 id="1、-SEO"><a href="#1、-SEO" class="headerlink" title="1、 SEO"></a>1、 SEO</h4><p>折腾完https之后在考虑SEO优化的问题，HTTPS对搜索收录更加友好。既然要友好，就要做到底，一级域名的SEO和比二级域名权重高，因此考虑把博客从二级域名迁移到一级域名。(生命不息折腾不止！)</p>
<h4 id="2、-记忆"><a href="#2、-记忆" class="headerlink" title="2、 记忆"></a>2、 记忆</h4><p>域名更短，更好记</p>
<h4 id="3、-权重"><a href="#3、-权重" class="headerlink" title="3、 权重"></a>3、 权重</h4><p>一级域名的权重比二级域名高。</p>
<h3 id="二、迁移过程"><a href="#二、迁移过程" class="headerlink" title="二、迁移过程"></a>二、迁移过程</h3><h4 id="1、证书"><a href="#1、证书" class="headerlink" title="1、证书"></a>1、证书</h4><p>重新去腾讯云申请个SSL证书</p>
<h4 id="2、DNS解析"><a href="#2、DNS解析" class="headerlink" title="2、DNS解析"></a>2、DNS解析</h4><p>按照腾讯云给和CNAME添加一个解析</p>
<h3 id="3、-nginx配置"><a href="#3、-nginx配置" class="headerlink" title="3、 nginx配置"></a>3、 nginx配置</h3><p>换一下证书就可以了</p>
<h3 id="三、迁移结果"><a href="#三、迁移结果" class="headerlink" title="三、迁移结果"></a>三、迁移结果</h3><h3 id="1、域名"><a href="#1、域名" class="headerlink" title="1、域名"></a>1、域名</h3><p>从<a href="https://blog.xiaomo.info">https://blog.xiaomo.info</a>迁移到<a href="https://xiaomo.info" target="_blank" rel="noopener">https://xiaomo.info</a></p>
<h3 id="2、损失"><a href="#2、损失" class="headerlink" title="2、损失"></a>2、损失</h3><p>迁移了域名，站点访问量开始从0算起。一切从头开始，总感觉有点回到解放前的感觉。不管怎么说，一切按照预想达到了，这样不好。不是吗？</p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> technology </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Sublime Text 3 使用配置与插件安装]]></title>
      <url>https://blog.xiaomo.info/2016/SublimeConfig/</url>
      <content type="html"><![CDATA[<p>　　记录安装配置 Sublime 的过程，同时列出所用到的插件，方便自己在新系统新电脑上快速用上熟悉的 Sublime。</p>
<a id="more"></a>
<h3 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h3><h4 id="软件下载"><a href="#软件下载" class="headerlink" title="软件下载"></a>软件下载</h4><ul>
<li>一直使用的是 Sublime 3，直接转到 3 的 <a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">下载页面</a> 好了。</li>
</ul>
<h4 id="用户设置"><a href="#用户设置" class="headerlink" title="用户设置"></a>用户设置</h4><ul>
<li><code>Preferences/Settings - User</code>，设置字体为 <a href="http://pan.baidu.com/s/1mglgkSK" target="_blank" rel="noopener">Consolas 雅黑混合体</a> yx5g，字号11，tab 转空格，显示空格和制表符。</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="string">"font_face"</span>: <span class="string">"Yahei Consolas Hybrid"</span>,</span><br><span class="line"><span class="string">"font_size"</span>: <span class="number">11</span>,</span><br><span class="line"><span class="string">"translate_tabs_to_spaces"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"draw_white_space"</span>: <span class="string">"all"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">/*统一使用 UTF-8 编码和 UNIX 风格的换行符(LF, 0x0A)*/</span></span><br><span class="line"><span class="string">"default_line_ending"</span>: <span class="string">"unix"</span>,</span><br><span class="line"><span class="string">"default_encoding"</span>: <span class="string">"UTF-8"</span>,</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其他设置参考 <code>Preferences/Settings - Default</code>。</p>
</blockquote>
<h3 id="基础插件"><a href="#基础插件" class="headerlink" title="基础插件"></a>基础插件</h3><h4 id="Package-Control"><a href="#Package-Control" class="headerlink" title="Package Control"></a><a href="https://packagecontrol.io/" target="_blank" rel="noopener">Package Control</a></h4><p> <a href="https://packagecontrol.io/" target="_blank" rel="noopener">Package Control</a></p>
<ul>
<li>用于管理插件的插件，基础中的基础。之后列的插件全部通过 Package Control 安装。<blockquote>
<p>插件使用与安装: <a href="https://packagecontrol.io/installation" target="_blank" rel="noopener">https://packagecontrol.io/installation</a></p>
</blockquote>
</li>
</ul>
<h4 id="Convert​To​UTF8"><a href="#Convert​To​UTF8" class="headerlink" title="Convert​To​UTF8"></a><a href="https://packagecontrol.io/packages/ConvertToUTF8" target="_blank" rel="noopener">Convert​To​UTF8</a></h4><ul>
<li>文本编码自动转换，减少中日韩文乱码问题。<blockquote>
<p>插件安装: Ctrl+Shift+P, Package Control: Installed Packages, 搜索 Convert​To​UTF8</p>
</blockquote>
</li>
</ul>
<h4 id="IMESupport"><a href="#IMESupport" class="headerlink" title="IMESupport"></a><a href="https://packagecontrol.io/packages/IMESupport" target="_blank" rel="noopener">IMESupport</a></h4><ul>
<li>解决输入法选字框不跟随问题。</li>
</ul>
<h4 id="Side​Bar​Enhancements"><a href="#Side​Bar​Enhancements" class="headerlink" title="Side​Bar​Enhancements"></a><a href="https://packagecontrol.io/packages/SideBarEnhancements" target="_blank" rel="noopener">Side​Bar​Enhancements</a></h4><ul>
<li>自带边栏功能太少，必须安装此插件增强一下。</li>
</ul>
<h3 id="主题配色"><a href="#主题配色" class="headerlink" title="主题配色"></a>主题配色</h3><h4 id="Theme-Spacegray"><a href="#Theme-Spacegray" class="headerlink" title="Theme - Spacegray"></a><a href="https://packagecontrol.io/packages/Theme%20-%20Spacegray" target="_blank" rel="noopener">Theme - Spacegray</a></h4><ul>
<li>Spacegray 主题的 Base16 Eighties Dark 配色方案看着最顺眼，用着最舒服。<br><img src="http://moxfive.xyz/resources/Base16-Eighties-Dark.jpg" alt="Base16 Eighties Dark color scheme"></li>
</ul>
<h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><h4 id="Sublime​Linter"><a href="#Sublime​Linter" class="headerlink" title="Sublime​Linter"></a><a href="https://packagecontrol.io/packages/SublimeLinter" target="_blank" rel="noopener">Sublime​Linter</a></h4><ul>
<li>用于管理其他 code linting 代码规范插件。<blockquote>
<p>使用说明: <a href="http://sublimelinter.readthedocs.org/en/latest/installation.html#installing-via-pc" target="_blank" rel="noopener">http://sublimelinter.readthedocs.org/en/latest/installation.html#installing-via-pc</a></p>
</blockquote>
</li>
</ul>
<h4 id="Sublime​Linter-jshint"><a href="#Sublime​Linter-jshint" class="headerlink" title="Sublime​Linter-jshint"></a><a href="https://packagecontrol.io/packages/SublimeLinter-jshint" target="_blank" rel="noopener">Sublime​Linter-jshint</a></h4><ul>
<li>基于 <a href="http://jshint.com/" target="_blank" rel="noopener">JSHint</a>，用于检查规范 JavaScript 代码。<blockquote>
<p>NPM 依赖包: <code>npm install -g jshint</code><br>使用说明: <a href="https://github.com/SublimeLinter/SublimeLinter-jshint" target="_blank" rel="noopener">https://github.com/SublimeLinter/SublimeLinter-jshint</a></p>
</blockquote>
</li>
</ul>
<h4 id="Sublime​Linter-csslint"><a href="#Sublime​Linter-csslint" class="headerlink" title="Sublime​Linter-csslint"></a><a href="https://packagecontrol.io/packages/SublimeLinter-csslint" target="_blank" rel="noopener">Sublime​Linter-csslint</a></h4><ul>
<li>基于 <a href="https://github.com/CSSLint/csslint" target="_blank" rel="noopener">CSSLint</a>，用于检查规范 CSS 代码。<blockquote>
<p>NPM 依赖包: <code>npm install -g csslint</code><br>使用说明: <a href="https://github.com/SublimeLinter/SublimeLinter-csslint" target="_blank" rel="noopener">https://github.com/SublimeLinter/SublimeLinter-csslint</a></p>
</blockquote>
</li>
</ul>
<h4 id="Sublime​Linter-contrib-htmlhint"><a href="#Sublime​Linter-contrib-htmlhint" class="headerlink" title="Sublime​Linter-contrib-htmlhint"></a><a href="https://packagecontrol.io/packages/SublimeLinter-contrib-htmlhint" target="_blank" rel="noopener">Sublime​Linter-contrib-htmlhint</a></h4><ul>
<li>基于 <a href="http://htmlhint.com/" target="_blank" rel="noopener">HTMLHint</a>，用于检查规范 HTML 代码。<blockquote>
<p>NPM 依赖包: <code>npm install -g htmlhint@latest</code><br>使用说明: <a href="https://github.com/mmaday/SublimeLinter-contrib-htmlhint" target="_blank" rel="noopener">https://github.com/mmaday/SublimeLinter-contrib-htmlhint</a></p>
</blockquote>
</li>
</ul>
<h3 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h3><h4 id="HTML-CSS-JS-Prettify"><a href="#HTML-CSS-JS-Prettify" class="headerlink" title="HTML-CSS-JS Prettify"></a><a href="https://packagecontrol.io/packages/HTML-CSS-JS%20Prettify" target="_blank" rel="noopener">HTML-CSS-JS Prettify</a></h4><ul>
<li>格式化 HTML, CSS, JavaScript 及 JSON 代码。</li>
</ul>
<h4 id="Color-Highlighter"><a href="#Color-Highlighter" class="headerlink" title="Color Highlighter"></a><a href="https://packagecontrol.io/packages/Color%20Highlighter" target="_blank" rel="noopener">Color Highlighter</a></h4><ul>
<li>直接在代码中预览颜色。</li>
</ul>
<h4 id="Stylus"><a href="#Stylus" class="headerlink" title="Stylus"></a><a href="https://packagecontrol.io/packages/Stylus" target="_blank" rel="noopener">Stylus</a></h4><ul>
<li>使代码高亮支持 Stylus。</li>
</ul>
<h4 id="Stylus-Clean-Completions"><a href="#Stylus-Clean-Completions" class="headerlink" title="Stylus Clean Completions"></a><a href="https://packagecontrol.io/packages/Stylus%20Clean%20Completions" target="_blank" rel="noopener">Stylus Clean Completions</a></h4><ul>
<li>Stylus 代码自动补全。</li>
</ul>
<h4 id="AutoFileName"><a href="#AutoFileName" class="headerlink" title="AutoFileName"></a><a href="https://packagecontrol.io/packages/AutoFileName" target="_blank" rel="noopener">AutoFileName</a></h4><ul>
<li>文件名自动补全。<br><img src="http://moxfive.xyz/resources/autofilename.png" alt="AutoFileName"></li>
</ul>
<h4 id="Can-I-Use"><a href="#Can-I-Use" class="headerlink" title="Can I Use"></a><a href="https://packagecontrol.io/packages/Can%20I%20Use" target="_blank" rel="noopener">Can I Use</a></h4><ul>
<li><a href="http://caniuse.com/" target="_blank" rel="noopener">http://caniuse.com/</a> 的插件版，快速查询 HTML, CSS 等前端技术的浏览器兼容性</li>
</ul>
<h4 id="BracketHighlighter"><a href="#BracketHighlighter" class="headerlink" title="BracketHighlighter"></a><a href="https://packagecontrol.io/packages/BracketHighlighter" target="_blank" rel="noopener">BracketHighlighter</a></h4><ul>
<li>调整各类括号匹配的高亮样式</li>
</ul>
<h4 id="To-be-added"><a href="#To-be-added" class="headerlink" title="To be added"></a>To be added</h4><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><ol>
<li><strong>Package Control</strong>: <a href="https://packagecontrol.io/" target="_blank" rel="noopener">https://packagecontrol.io/</a></li>
<li><strong>SublimeLinter</strong>: <a href="http://sublimelinter.readthedocs.org/" target="_blank" rel="noopener">http://sublimelinter.readthedocs.org/</a></li>
<li><strong>JSHint</strong>: <a href="http://jshint.com/" target="_blank" rel="noopener">http://jshint.com/</a></li>
<li><strong>CSSLint</strong>: <a href="https://github.com/CSSLint/csslint" target="_blank" rel="noopener">https://github.com/CSSLint/csslint</a></li>
<li><strong>HTMLHint</strong>: <a href="http://htmlhint.com/" target="_blank" rel="noopener">http://htmlhint.com/</a></li>
<li><strong>Stylus</strong>: <a href="http://learnboost.github.io/stylus/" target="_blank" rel="noopener">http://learnboost.github.io/stylus/</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> life </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[拥抱https(http全面切换到https)]]></title>
      <url>https://blog.xiaomo.info/2016/HttpToHttps/</url>
      <content type="html"><![CDATA[<p>在百度和谷歌的鼓励下，现在很多网站都开始换成https了啊，只是有的没有隐私数据的网站感觉没有太大必要，但是设计要密码账号的网站必须要的。不过有部分网站没有换成https只是暂时的，2-3年后预估互联网会全部变成https。因为https成本也不是很高，免费SSL证书也有，比如腾讯免费SSL证书，starssl免费证书等。关键是https对SEO更加友好。<br><a id="more"></a></p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><h4 id="域-名：阿里云"><a href="#域-名：阿里云" class="headerlink" title="域 名：阿里云"></a>域 名：阿里云</h4><h4 id="服务器：阿里云ECS"><a href="#服务器：阿里云ECS" class="headerlink" title="服务器：阿里云ECS"></a>服务器：阿里云ECS</h4><h4 id="SSL证书-腾讯SSL免费版"><a href="#SSL证书-腾讯SSL免费版" class="headerlink" title="SSL证书: 腾讯SSL免费版"></a>SSL证书: 腾讯SSL免费版</h4><h4 id="web容器：nginx-php"><a href="#web容器：nginx-php" class="headerlink" title="web容器：nginx+php"></a>web容器：nginx+php</h4><h3 id="一、为什么要切换到HTTPS"><a href="#一、为什么要切换到HTTPS" class="headerlink" title="一、为什么要切换到HTTPS"></a>一、为什么要切换到HTTPS</h3><h4 id="1-安全方面"><a href="#1-安全方面" class="headerlink" title="1.安全方面"></a>1.安全方面</h4><p>HTTPS比HTTP更加安全</p>
<h4 id="2-技术方面"><a href="#2-技术方面" class="headerlink" title="2.技术方面"></a>2.技术方面</h4><p>不懂HTTPS多不好意思啊，所以就当是学习了。</p>
<h3 id="二、为什么要用腾讯SSL"><a href="#二、为什么要用腾讯SSL" class="headerlink" title="二、为什么要用腾讯SSL"></a>二、为什么要用腾讯SSL</h3><p>因为免费啊，毕竟穷人用不起企业级别的，先用一年免费的再说。starssl是外国的，看不习惯鸟语还是老老实实用中文。</p>
<h3 id="三、申请证书"><a href="#三、申请证书" class="headerlink" title="三、申请证书"></a>三、申请证书</h3><p>申请地址：<a href="https://console.qcloud.com/ssl" target="_blank" rel="noopener">https://console.qcloud.com/ssl</a></p>
<p>申请证书之后会给一个下载链接，下载之后会有3个文件夹。分别是nginx、tomcat、apache。因为我个人用的是nginx，就说下nginx的配置。没有调查就没有发言权，用其他两种的小伙伴请自行研究。</p>
<h4 id="四、DNS配置"><a href="#四、DNS配置" class="headerlink" title="四、DNS配置"></a>四、DNS配置</h4><p>证书申请通过之后会让你配置一个CNAME类型的DNS,然后把这个DNS在你的域名中添加一个cname的解析。<br><img src="https://image.xiaomo.info/https/cname.png" alt="cname"></p>
<h3 id="五、上传"><a href="#五、上传" class="headerlink" title="五、上传"></a>五、上传</h3><p>将下载的证书nginx文件夹打包上传到 <code>usr/local/nginx</code>目录</p>
<h3 id="六、nginx配置"><a href="#六、nginx配置" class="headerlink" title="六、nginx配置"></a>六、nginx配置</h3><p>先确认<code>nginx</code>安装时已编译http_ssl模块，也就是执行如下命令查看是否存在–with-http_ssl_module参数：</p>
<p>执行<code>/usr/local/nginx/sbin/nginx -V</code>这个命令</p>
<p>在返回的结果中找是否有<code>--with-http_ssl_module</code>参数，没有的话要先激活这个模块。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">nginx version:</span> <span class="string">nginx/1.6.0</span></span><br><span class="line"><span class="string">built</span> <span class="string">by</span> <span class="string">gcc</span> <span class="number">4.4</span><span class="number">.7</span> <span class="number">20120313</span> <span class="string">(Red</span> <span class="string">Hat</span> <span class="number">4.4</span><span class="number">.7</span><span class="number">-4</span><span class="string">)</span> <span class="string">(GCC)</span></span><br><span class="line"><span class="string">TLS</span> <span class="string">SNI</span> <span class="string">support</span> <span class="string">enabled</span></span><br><span class="line"><span class="attr">configure arguments:</span> <span class="string">--prefix=/usr/local/nginx</span> <span class="string">--with-http_ssl_module</span> <span class="string">--with-openssl=/usr/local/src/openssl-1.0.1/</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>usr/local/nginx/conf/nginx.conf</code>中修改配置，配置如下<br>在server中加入以下内容，注意修改一下对应<code>ssl_certificate</code>和<code>ssl_certificate_key</code>文件的位置</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">listen</span> <span class="number">443</span>;</span><br><span class="line">        <span class="attribute">ssl</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">ssl_certificate</span> /usr/local/nginx/ssl/1_xiaomo.info_bundle.crt; <span class="comment">#证书公钥文件路径</span></span><br><span class="line">        <span class="attribute">ssl_certificate_key</span>  /usr/local/nginx/ssl/2_xiaomo.<span class="literal">info</span>.key;   <span class="comment">#证书私钥文件路径</span></span><br><span class="line">        <span class="attribute">ssl_session_timeout</span>  <span class="number">5m</span>;</span><br><span class="line">        <span class="attribute">ssl_protocols</span> SSLv3 TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">        <span class="attribute">ssl_ciphers</span>  HIGH:!ADH:!EXPORT56:RC4+RSA:+MEDIUM;</span><br></pre></td></tr></table></figure>
<p>这一段主要是开启SSL</p>
<p>保存配置之后要确认是否配置正确，执行<code>/usr/local/nginx/sbin/nginx -t</code>命令</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">linux-<span class="keyword">test</span>:~ # /usr/<span class="keyword">local</span>/nginx/sbin/nginx -t</span><br><span class="line">#如下显示则为正确无误：</span><br><span class="line">nginx: the configuration <span class="keyword">file</span> /usr/<span class="keyword">local</span>/nginx/<span class="keyword">conf</span>/nginx.<span class="keyword">conf</span> <span class="keyword">syntax</span> is ok</span><br><span class="line">nginx: configuration <span class="keyword">file</span> /usr/<span class="keyword">local</span>/nginx/<span class="keyword">conf</span>/nginx.<span class="keyword">conf</span> <span class="keyword">test</span> is successful</span><br></pre></td></tr></table></figure>
<p>重定向http到https,加入以下这段，意思是访问http的网站的时候会重定向到https上去。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">             <span class="attribute">if</span> (<span class="variable">$scheme</span> = http) &#123;</span><br><span class="line">                     <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">                     &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<h3 id="七、生效"><a href="#七、生效" class="headerlink" title="七、生效"></a>七、生效</h3><p>执行<code>/usr/local/nginx/sbin/nginx -s reload</code>,如无错误，现在应该可以顺利访问 <a href="https://xiaomo.info" target="_blank" rel="noopener">xiaomo.info</a>这个网站，并且是https的。</p>
<h3 id="八、附录"><a href="#八、附录" class="headerlink" title="八、附录"></a>八、附录</h3><p>nginx配置</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">server</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">443</span>;</span><br><span class="line">        <span class="attribute">ssl</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">ssl_certificate</span> /usr/local/nginx/ssl/1_xiaomo.info_bundle.crt; <span class="comment">#证书公钥文件路径</span></span><br><span class="line">        <span class="attribute">ssl_certificate_key</span>  /usr/local/nginx/ssl/2_xiaomo.<span class="literal">info</span>.key;   <span class="comment">#证书私钥文件路径</span></span><br><span class="line">        <span class="attribute">ssl_session_timeout</span>  <span class="number">5m</span>;</span><br><span class="line">        <span class="attribute">ssl_protocols</span> SSLv3 TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">        <span class="attribute">ssl_ciphers</span>  HIGH:!ADH:!EXPORT56:RC4+RSA:+MEDIUM;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">server_name</span> xiaomo.<span class="literal">info</span>;</span><br><span class="line">        <span class="attribute">index</span> index.html index.htm index.php;</span><br><span class="line">        <span class="attribute">root</span>  /data2/xiaomo.github.io/public;</span><br><span class="line"></span><br><span class="line">         <span class="attribute">location</span> <span class="regexp">~ \.(jpg|png|gif|js|css|swf|flv|ico)$</span> &#123;</span><br><span class="line">                 <span class="attribute">expires</span> <span class="number">12h</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">                <span class="attribute">if</span> (<span class="variable">$scheme</span> = http) &#123;</span><br><span class="line">                        <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~* ^/(doc|logs|app|sys)/</span> &#123;</span><br><span class="line">                <span class="attribute">return</span> <span class="number">403</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~ .*\.(php|php5)?$</span></span><br><span class="line"><span class="regexp"></span>        &#123;</span><br><span class="line">                <span class="attribute">fastcgi_connect_timeout</span> <span class="number">300</span>;</span><br><span class="line">                <span class="attribute">fastcgi_send_timeout</span> <span class="number">300</span>;</span><br><span class="line">                <span class="attribute">fastcgi_read_timeout</span> <span class="number">300</span>;</span><br><span class="line">                <span class="attribute">try_files</span> <span class="variable">$uri</span> =<span class="number">404</span>;</span><br><span class="line">                <span class="attribute">error_page</span> <span class="number">404</span> = /<span class="number">404</span>.html;</span><br><span class="line">                <span class="attribute">fastcgi_pass</span>  unix:/tmp/php-cgi.sock;</span><br><span class="line">                <span class="attribute">include</span> fastcgi.conf;</span><br><span class="line">                <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">                <span class="attribute">include</span> fastcgi.conf;</span><br><span class="line">                <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">                <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">                <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">error_log</span>  /home/wwwlogs/error_log.log;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><h4 id="1-Linux-Nginx-Apache-Tomcat新增SSL证书，开启https访问教程"><a href="#1-Linux-Nginx-Apache-Tomcat新增SSL证书，开启https访问教程" class="headerlink" title="1. Linux+Nginx/Apache/Tomcat新增SSL证书，开启https访问教程"></a>1. <a href="https://zhangge.net/4861.html" target="_blank" rel="noopener">Linux+Nginx/Apache/Tomcat新增SSL证书，开启https访问教程</a></h4><h4 id="2-让你的网站免费支持-HTTPS-及-Nginx-平滑升级"><a href="#2-让你的网站免费支持-HTTPS-及-Nginx-平滑升级" class="headerlink" title="2. 让你的网站免费支持 HTTPS 及 Nginx 平滑升级"></a>2. <a href="http://www.cnblogs.com/mafly/archive/2016/11/16/https_nginx.html" target="_blank" rel="noopener">让你的网站免费支持 HTTPS 及 Nginx 平滑升级</a></h4>]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> technology </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[swagger ui和spring boot集成生成api文档]]></title>
      <url>https://blog.xiaomo.info/2016/JavaSpringBootSwaggerUi/</url>
      <content type="html"><![CDATA[<p>曾经一度我一直想在做前后端分离的时间写api接口是一个痛苦的过程，虽然也在网上找了一些可以填写api的系统，但使用起来总是不尽人意。现在，终于找到一款可以和api完美集成自动生成api文档加测试的工具，真是一件让人高兴的事呢。如果你也需要，那就好好看看这篇文章吧。<br><a id="more"></a></p>
<h3 id="一、环境"><a href="#一、环境" class="headerlink" title="一、环境"></a>一、环境</h3><h4 id="1-JAVA8"><a href="#1-JAVA8" class="headerlink" title="1. JAVA8"></a>1. JAVA8</h4><h4 id="2-MAVEN-3-0-5"><a href="#2-MAVEN-3-0-5" class="headerlink" title="2. MAVEN 3.0.5"></a>2. MAVEN 3.0.5</h4><h4 id="3-IDEA-2016-2-5"><a href="#3-IDEA-2016-2-5" class="headerlink" title="3. IDEA 2016.2.5"></a>3. IDEA 2016.2.5</h4><h4 id="4-spring-boot-1-4-1"><a href="#4-spring-boot-1-4-1" class="headerlink" title="4. spring boot 1.4.1"></a>4. spring boot 1.4.1</h4><h3 id="二、相关依赖"><a href="#二、相关依赖" class="headerlink" title="二、相关依赖"></a>二、相关依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="三、配置"><a href="#三、配置" class="headerlink" title="三、配置"></a>三、配置</h3><p>设置了一些默认显示的api相关信息，最后上截图的时就可以比较清楚的看到。</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@Configuration</span></span><br><span class="line"><span class="variable">@EnableSwagger2</span></span><br><span class="line">public class Swagger2Config &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Bean</span></span><br><span class="line">    public Docket createRestApi() &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">new</span> <span class="selector-tag">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                <span class="selector-class">.apiInfo</span>(apiInfo())</span><br><span class="line">                <span class="selector-class">.select</span>()</span><br><span class="line">                <span class="selector-class">.apis</span>(RequestHandlerSelectors.basePackage(<span class="string">"info.xiaomo.website"</span>))</span><br><span class="line">                <span class="selector-class">.paths</span>(PathSelectors.any())</span><br><span class="line">                <span class="selector-class">.build</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">private</span> <span class="selector-tag">ApiInfo</span> <span class="selector-tag">apiInfo</span>() &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">new</span> <span class="selector-tag">ApiInfoBuilder</span>()</span><br><span class="line">                <span class="selector-class">.title</span>(<span class="string">"Spring Boot中使用Swagger2构建RESTful APIs"</span>)</span><br><span class="line">                <span class="selector-class">.description</span>(<span class="string">"api根地址：http://api.xiaomo.info:8080/"</span>)</span><br><span class="line">                <span class="selector-class">.termsOfServiceUrl</span>(<span class="string">"https://xiaomo.info/"</span>)</span><br><span class="line">                <span class="selector-class">.contact</span>(<span class="string">"小莫"</span>)</span><br><span class="line">                <span class="selector-class">.version</span>(<span class="string">"1.0"</span>)</span><br><span class="line">                <span class="selector-class">.build</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="四、相关注解解读"><a href="#四、相关注解解读" class="headerlink" title="四、相关注解解读"></a>四、相关注解解读</h3><h4 id="1-Api"><a href="#1-Api" class="headerlink" title="1. @Api"></a>1. @Api</h4><p>用在类上，说明该类的作用<br><code>@Api(value = &quot;UserController&quot;, description = &quot;用户相关api&quot;)</code></p>
<h4 id="2-ApiOperation"><a href="#2-ApiOperation" class="headerlink" title="2. @ApiOperation"></a>2. @ApiOperation</h4><p>用在方法上，说明方法的作用<br><code>@ApiOperation(value = &quot;查找用户&quot;, notes = &quot;查找用户&quot;, httpMethod = &quot;GET&quot;, produces = MediaType.APPLICATION_JSON_UTF8_VALUE)</code></p>
<h4 id="3-ApiImplicitParams"><a href="#3-ApiImplicitParams" class="headerlink" title="3 @ApiImplicitParams"></a>3 @ApiImplicitParams</h4><p>用在方法上包含一组参数说明</p>
<h4 id="4-ApiImplicitParam"><a href="#4-ApiImplicitParam" class="headerlink" title="4. @ApiImplicitParam"></a>4. @ApiImplicitParam</h4><p>用在@ApiImplicitParams注解中，指定一个请求参数的各个方面<br>     paramType：参数放在哪个地方<br>     header–&gt;请求参数的获取：@RequestHeader<br>     query–&gt;请求参数的获取：@RequestParam<br>     path（用于restful接口）–&gt;请求参数的获取：@PathVariable<br>     body（不常用）<br>     form（不常用）<br>     name：参数名<br>     dataType：参数类型<br>     required：参数是否必须传<br>     value：参数的意思<br>     defaultValue：参数的默认值</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@ApiImplicitParams</span>(&#123;</span><br><span class="line">        <span class="variable">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"唯一id"</span>, required = true, dataType = <span class="string">"Long"</span>, paramType = <span class="string">"path"</span>),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5-ApiResponses"><a href="#5-ApiResponses" class="headerlink" title="5. @ApiResponses"></a>5. @ApiResponses</h4><p>用于表示一组响应</p>
<h4 id="6-ApiResponse"><a href="#6-ApiResponse" class="headerlink" title="6. @ApiResponse"></a>6. @ApiResponse</h4><p>用在@ApiResponses中，一般用于表达一个错误的响应信息<br>     code：数字，例如400<br>     message：信息，例如”请求参数没填好”<br>     response：抛出异常的类</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@ApiResponses</span>(value = &#123;  </span><br><span class="line">          <span class="variable">@ApiResponse</span>(code = <span class="number">400</span>, message = <span class="string">"No Name Provided"</span>)  </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="7-ApiModel"><a href="#7-ApiModel" class="headerlink" title="7. @ApiModel"></a>7. @ApiModel</h4><p> 描述一个Model的信息（这种一般用在post创建的时候，使用@RequestBody这样的场景，请求参数无法使用@ApiImplicitParam注解进行描述的时候）<br> <code>@ApiModel(value = &quot;用户实体类&quot;)</code></p>
<h4 id="8-ApiModelProperty"><a href="#8-ApiModelProperty" class="headerlink" title="8. @ApiModelProperty"></a>8. @ApiModelProperty</h4><p>描述一个model的属性<br><code>@ApiModelProperty(value = &quot;登录用户&quot;)</code></p>
<h4 id="五、-和Swagger-UI的集成"><a href="#五、-和Swagger-UI的集成" class="headerlink" title="五、 和Swagger UI的集成"></a>五、 和Swagger UI的集成</h4><p>首先，从github <a href="https://github.com/swagger-api/swagger-ui" target="_blank" rel="noopener">swagger-ui</a> 上下载Swagger-UI, 把该项目dist目录下的内容拷贝到项目的resources的目录public下。</p>
<h4 id="六、访问"><a href="#六、访问" class="headerlink" title="六、访问"></a>六、访问</h4><p><a href="http://localhost:8080/swagger-ui.html" target="_blank" rel="noopener">http://localhost:8080/swagger-ui.html</a> 就可以看到效果如下<br><img src="https://image.xiaomo.info/swagger/swagger.png" alt></p>
<h4 id="七、-项目实例"><a href="#七、-项目实例" class="headerlink" title="七、 项目实例"></a>七、 项目实例</h4><p><a href="https://github.com/JavaUsers/xiaomo-info-java/tree/master/website" target="_blank" rel="noopener">https://github.com/JavaUsers/xiaomo-info-java/tree/master/website</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> swagger </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring4免费全套视频教程]]></title>
      <url>https://blog.xiaomo.info/2016/JavaSpringVideo/</url>
      <content type="html"><![CDATA[<p>废话不多说，直接上链接。给自己打个mark,如果你需要学习spring又正好转到这里来了，那么恭喜你。<br><a id="more"></a></p>
<p>废话不多说，直接上链接。给自己打个mark,如果你需要学习spring又正好转到这里来了，那么恭喜你。<br><a href="http://edu.csdn.net/course/detail/852/" target="_blank" rel="noopener">国内第1套_Spring4 视频教程</a></p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[lombok简化java代码注解的使用]]></title>
      <url>https://blog.xiaomo.info/2016/JavaLombok/</url>
      <content type="html"><![CDATA[<p>今天在stackoverflow上回答问题的时候发现了几个不得了的注解，是我从来没有见过的。然后呢，为了回答别人的问题，我就去查资料了。。。觉得挺有用的，记录一下。。<br><a id="more"></a></p>
<h3 id="一、缘由"><a href="#一、缘由" class="headerlink" title="一、缘由"></a>一、缘由</h3><p>在<code>stackoverflow</code>上看到了这个问题。 <a href="https://stackoverflow.com/questions/40169763/spring-boot-restcontroller-not-work-with-lombok/40478142#40478142" target="_blank" rel="noopener">spring boot RestController not work with lombok</a>,然后就有了这篇博客。。</p>
<h3 id="二、lombok是什么鬼"><a href="#二、lombok是什么鬼" class="headerlink" title="二、lombok是什么鬼"></a>二、lombok是什么鬼</h3><h4 id="1-maven引用"><a href="#1-maven引用" class="headerlink" title="1. maven引用"></a>1. maven引用</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-一些api"><a href="#2-一些api" class="headerlink" title="2. 一些api"></a>2. 一些api</h4><p>ombok 注解：<br>lombok 提供的注解不多，可以参考官方视频的讲解和官方文档。<br>Lombok 注解在线帮助文档：<a href="http://projectlombok.org/features/index.html" target="_blank" rel="noopener">http://projectlombok.org/features/index.html</a> .<br>下面介绍几个我常用的 lombok 注解：<br><code>@Data</code>   ：注解在类上；提供类所有属性的 getting 和 setting 方法，此外还提供了equals、canEqual、hashCode、toString 方法<br><code>@Setter</code>：注解在属性上；为属性提供 setting 方法<br><code>@Getter</code>：注解在属性上；为属性提供 getting 方法<br><code>@Log4j</code> ：注解在类上；为类提供一个 属性名为log 的 log4j 日志对象<br><code>@NoArgsConstructor</code>：注解在类上；为类提供一个无参的构造方法<br><code>@AllArgsConstructor</code>：注解在类上；为类提供一个全参的构造方法</p>
<p>下面是简单示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span>                   <span class="comment">// 生成 getter/setter/equals/canEqual/hashCode/toString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span>      <span class="comment">// 为类提供一个无参的构造方法</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span>     <span class="comment">// 为类提供一个全参的构造方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> String id;</span><br><span class="line"> <span class="keyword">private</span> String name;</span><br><span class="line"> <span class="keyword">private</span> String identity;</span><br><span class="line"> <span class="keyword">private</span> Logger log = Logger.getLogger(Person<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不使用 lombok 的方案</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">String</span> identity;</span><br><span class="line"> <span class="keyword">private</span> Logger <span class="built_in">log</span> = Logger.getLogger(Person.class);</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(<span class="keyword">String</span> id, <span class="keyword">String</span> name, <span class="keyword">String</span> identity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id              = id;</span><br><span class="line">    <span class="keyword">this</span>.name       = name;</span><br><span class="line">    <span class="keyword">this</span>.identity  = identity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getIdentity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> identity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">String</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdentity</span><span class="params">(<span class="keyword">String</span> identity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.identity = identity;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、实践结果"><a href="#二、实践结果" class="headerlink" title="二、实践结果"></a>二、实践结果</h3><p>我发现<code>stackoverflow</code>的那个伙计代码写的并没有问题，我把他的代码粘到我本地运行没有一点卡壳。倒不如说他教会了我lombok，在此感谢一下。。嘿嘿</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[日本动漫声优公演,来看看什么叫专业声优]]></title>
      <url>https://blog.xiaomo.info/2016/NihonSeiyou/</url>
      <content type="html"><![CDATA[<p>日本动漫声优公演,来看看什么叫专业声优<br><a id="more"></a></p>
<embed src="https://imgcache.qq.com/tencentvideo_v1/playerv3/TPout.swf?max_age=86400&v=20161117&vid=v0337gd2b1m&auto=0" allowfullscreen="true" quality="high" width="480" height="400" align="middle" allowscriptaccess="always" type="application/x-shockwave-flash">
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> alime </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring boot做前后分离时间格式化]]></title>
      <url>https://blog.xiaomo.info/2016/JavaSpringBootDataFormat/</url>
      <content type="html"><![CDATA[<p>最近在用spring boot 做数据接口时难免遇到时间这类的问题，接口原则：能服务端处理的别留给客户端。客户端的职责就是把服务端的数据完美的展现出来就好了。所以在返回时间的时候最好先进行一下格式化处理，不要返回时间戳格式。<br><a id="more"></a></p>
<h3 id="一、写一个Serializer"><a href="#一、写一个Serializer" class="headerlink" title="一、写一个Serializer"></a>一、写一个<code>Serializer</code></h3><p>然后做一个时间格式化的处理</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> info.xiaomo.core.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.<span class="type">JsonGenerator</span>;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.<span class="type">JsonSerializer</span>;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.<span class="type">SerializerProvider</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">IOException</span>;</span><br><span class="line"><span class="keyword">import</span> java.text.<span class="type">SimpleDateFormat</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">Date</span>;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomDateSerializer</span> <span class="keyword">extends</span> <span class="title">JsonSerializer&lt;Date&gt;</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void serialize(<span class="type">Date</span> value, <span class="type">JsonGenerator</span> jsonGenerator, <span class="type">SerializerProvider</span> provider) <span class="keyword">throws</span> <span class="type">IOException</span> &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> sdf = <span class="keyword">new</span> <span class="type">SimpleDateFormat</span>(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        jsonGenerator.writeString(sdf.format(value));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、-使用"><a href="#二、-使用" class="headerlink" title="二、 使用"></a>二、 使用</h3><p>在需要转换的时间的Model中加上这个类,仔细观察下面代码中类型为<code>Date</code>的属性</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> info.xiaomo.core.model.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.annotation.JsonSerialize;</span><br><span class="line"><span class="keyword">import</span> info.xiaomo.core.filter.CustomDateSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把今天最好的表现当作明天最新的起点．．～</span></span><br><span class="line"><span class="comment"> * いま 最高の表現 として 明日最新の始発．．～</span></span><br><span class="line"><span class="comment"> * Today the best performance  as tomorrow newest starter!</span></span><br><span class="line"><span class="comment"> * Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: xiaomo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@github</span>: https://github.com/houko</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@email</span>: hupengbest@163.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@QQ</span>_NO: 83387856</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2016/4/1 20:37</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: model基类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Copyright</span>(©) 2015 by xiaomo.</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@MappedSuperclass</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.AUTO)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"Id"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Version</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"Version"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> version;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonSerialize</span>(using = CustomDateSerializer<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    @<span class="title">Column</span>(<span class="title">name</span> </span>= <span class="string">"CreateTime"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonSerialize</span>(using = CustomDateSerializer<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    @<span class="title">Column</span>(<span class="title">name</span> </span>= <span class="string">"UpdateTime"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getUpdateTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUpdateTime</span><span class="params">(Date updateTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.updateTime = updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> version;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVersion</span><span class="params">(<span class="keyword">long</span> version)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.version = version;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getCreateTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreateTime</span><span class="params">(Date createTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.createTime = createTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring boot做前后分离的跨域问题]]></title>
      <url>https://blog.xiaomo.info/2016/JavaSpringBootCors/</url>
      <content type="html"><![CDATA[<p>最近在用spring boot 做数据接口供客户端调用时发现存在跨域问题，虽然解决问题有很多。比如用nginx处理等等。但是更方便的是服务端设置一下跨域名。<br><a id="more"></a></p>
<h3 id="一、前提"><a href="#一、前提" class="headerlink" title="一、前提"></a>一、前提</h3><h4 id="1-使用spring-boot-maven-构建的项目"><a href="#1-使用spring-boot-maven-构建的项目" class="headerlink" title="1. 使用spring boot + maven 构建的项目"></a>1. 使用spring boot + maven 构建的项目</h4><h3 id="二、设置"><a href="#二、设置" class="headerlink" title="二、设置"></a>二、设置</h3><h4 id="1-写一个过滤器-filter"><a href="#1-写一个过滤器-filter" class="headerlink" title="1. 写一个过滤器(filter)"></a>1. 写一个过滤器(filter)</h4><p>实现Filter接口，然后设置一下响应头。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> info.xiaomo.core.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把今天最好的表现当作明天最新的起点．．～</span></span><br><span class="line"><span class="comment"> * いま 最高の表現 として 明日最新の始発．．～</span></span><br><span class="line"><span class="comment"> * Today the best performance  as tomorrow newest starter!</span></span><br><span class="line"><span class="comment"> * Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: xiaomo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@github</span>: https://github.com/houko</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@email</span>: hupengbest@163.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@QQ</span>_NO: 83387856</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2016/4/1516:25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Copyright</span>(©) 2015 by xiaomo.</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CORSFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filterConfig filterConfig</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CORS 过滤器</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req   rq</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> res   res</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain chin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException      IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Methods"</span>, <span class="string">"POST, GET, OPTIONS, DELETE"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Max-Age"</span>, <span class="string">"3600"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"Origin, Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers, If-Modified-Since"</span>);</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-在启动器中加入过滤器"><a href="#2-在启动器中加入过滤器" class="headerlink" title="2. 在启动器中加入过滤器"></a>2. 在启动器中加入过滤器</h4><p>实质就是加了一个<code>@bean</code>，然后在启动的时候通过过滤器把所有的响应头设置一下。</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">package info.xiaomo.website;</span><br><span class="line"></span><br><span class="line">import info.xiaomo.core.filter.CORSFilter;</span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.EnableAutoConfiguration;</span><br><span class="line">import org.springframework.boot.autoconfigure.domain.EntityScan;</span><br><span class="line">import org.springframework.context.<span class="keyword">annotation</span>.<span class="title">Bean</span>;</span><br><span class="line">import org.springframework.context.<span class="keyword">annotation</span>.<span class="title">ComponentScan</span>;</span><br><span class="line">import org.springframework.context.<span class="keyword">annotation</span>.<span class="title">Configuration</span>;</span><br><span class="line">import org.springframework.data.jpa.repository.config.EnableJpaRepositories;</span><br><span class="line">import org.springframework.transaction.<span class="keyword">annotation</span>.<span class="title">EnableTransactionManagement</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMapping</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RestController</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 把今天最好的表现当作明天最新的起点．．～</span><br><span class="line"> * いま 最高の表現 として 明日最新の始発．．～</span><br><span class="line"> * Today the best performance  <span class="keyword">as</span> tomorrow newest starter!</span><br><span class="line"> * Created by IntelliJ IDEA.</span><br><span class="line"> *</span><br><span class="line"> * @<span class="symbol">author:</span> xiaomo</span><br><span class="line"> * @<span class="symbol">github:</span> <span class="symbol">https:</span>/<span class="regexp">/github.com/houko</span></span><br><span class="line"> * @<span class="symbol">email:</span> hupengbest@<span class="number">163</span>.com</span><br><span class="line"> * @<span class="symbol">QQ_NO:</span> <span class="number">83387856</span></span><br><span class="line"> * @<span class="symbol">Date:</span> <span class="number">2016</span>/<span class="number">4</span>/<span class="number">1</span> <span class="number">15</span>:<span class="number">38</span></span><br><span class="line"> * @<span class="symbol">Description:</span> 后台管理启动器</span><br><span class="line"> * @Copyright(©) <span class="number">2015</span> by xiaomo.</span><br><span class="line"> **<span class="regexp">/</span></span><br><span class="line"><span class="regexp">@Configuration</span></span><br><span class="line"><span class="regexp">@EnableAutoConfiguration</span></span><br><span class="line"><span class="regexp">@ComponentScan("info.xiaomo")</span></span><br><span class="line"><span class="regexp">@EntityScan("info.xiaomo.*.model")</span></span><br><span class="line"><span class="regexp">@EnableTransactionManagement</span></span><br><span class="line"><span class="regexp">@EnableJpaRepositories("info.xiaomo.*.dao")</span></span><br><span class="line"><span class="regexp">@RestController</span></span><br><span class="line"><span class="regexp">public class XiaomoMain &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    public static void main(String[] args) throws Exception &#123;</span></span><br><span class="line"><span class="regexp">        SpringApplication.run(XiaomoMain.class, args);</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @Bean</span></span><br><span class="line"><span class="regexp">    public CORSFilter corsFilter() &#123;</span></span><br><span class="line"><span class="regexp">        return new CORSFilter();</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @RequestMapping("/</span><span class="string">")</span></span><br><span class="line"><span class="string">    String index() &#123;</span></span><br><span class="line"><span class="string">        return "</span>Hello World! this is website index<span class="string">";</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这样一来，客户端就不会存在跨域问题了。</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring boot相关资料]]></title>
      <url>https://blog.xiaomo.info/2016/JavaSpringZiliao/</url>
      <content type="html"><![CDATA[<p>spring真是让人又爱又恨呢，好用但是难学。spring铺的又太大，不知道从哪入手。整理点资料，免得头晕。<br><a id="more"></a></p>
<h3 id="一、spring-boot-配置相关"><a href="#一、spring-boot-配置相关" class="headerlink" title="一、spring boot 配置相关"></a>一、spring boot 配置相关</h3><h4 id="1-配置文件"><a href="#1-配置文件" class="headerlink" title="1. 配置文件"></a>1. 配置文件</h4><p><a href="http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html" target="_blank" rel="noopener">properties</a></p>
<h4 id="2-spring-boot-cli-安装和使用"><a href="#2-spring-boot-cli-安装和使用" class="headerlink" title="2. spring boot cli 安装和使用"></a>2. spring boot cli 安装和使用</h4><ol>
<li>下载zip压缩包并解压  </li>
<li>配置环境变量 <code>SPRING_HONE</code> , path里加 <code>%SPRING_HOME%/bin</code></li>
<li><code>spring --version</code> 测试是否成功</li>
<li>帮助 spring –help</li>
<li>生成项目 spring init project_name</li>
</ol>
<h4 id="3-spring-boot首页"><a href="#3-spring-boot首页" class="headerlink" title="3. spring boot首页"></a>3. <a href="http://projects.spring.io/spring-boot/" target="_blank" rel="noopener">spring boot首页</a></h4><h4 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h4><h3 id="二、spring-boot-常见错误"><a href="#二、spring-boot-常见错误" class="headerlink" title="二、spring boot 常见错误"></a>二、spring boot 常见错误</h3>]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Maven 与 IntelliJ IDEA 的完美结合]]></title>
      <url>https://blog.xiaomo.info/2016/JavaIdeaMaven/</url>
      <content type="html"><![CDATA[<p>你是否正在学习Maven？是否因为Maven难用而又不得不用而苦恼？是否对Eclipse于Maven的冲突而困惑？ 那么我告诉你一个更直接更简单的解决方案: IntelliJ IDEA！<br><a id="more"></a></p>
<h3 id="1-什么是-Maven，为什么要使用-Maven-而不是-Ant"><a href="#1-什么是-Maven，为什么要使用-Maven-而不是-Ant" class="headerlink" title="1. 什么是 Maven，为什么要使用 Maven 而不是 Ant"></a>1. 什么是 Maven，为什么要使用 Maven 而不是 Ant</h3><p>Maven简单来说是一个项目管理工具，被认为是Ant的替代品或者继任者。事实上Maven的功能要远远超出Ant，它不仅仅提供编译的脚本，更是在整 个项目周期中提供测试，发布，文档生成等功能，并且有着独特的依赖性管理方法。但是强大的功能的代价就是复杂的使用方法，第一次使用Maven往往需要将 近半个小时的时间（国内网速）来下载一个本地的依赖库，这无疑会使很多开发人员“知难而退”。虽然广受诟病，一个不争的事实就是Maven逐渐代替了 Ant，使用Maven也成了Java开发人员的一个必要技能。</p>
<h3 id="2-IntelliJ-IDEA-与-Eclipse"><a href="#2-IntelliJ-IDEA-与-Eclipse" class="headerlink" title="2. IntelliJ IDEA 与 Eclipse"></a>2. IntelliJ IDEA 与 Eclipse</h3><p>在Java的世界里，Eclipse毋庸置疑是IDE中的王者，IntelliJ IDEA和NetBeans都只能生活在Eclipse的光环下。Eclipse的强大已经不用我多说了，但其实IntelliJ IDEA也是一个相当优秀的IDE，尤其体现在它的智能上。它的一个针对.Net的Clone产品ReSharper已经被越来越多的C#开发者所接受。 IntelliJ IDEA提供了大量的智能规则来协助开发者，类似代码补全，用法的转换，格式的提示等等，当你习惯以后，你就会对那个小灯泡爱不释手。</p>
<h3 id="3-选择-Maven-IntelliJ-IDEA-的理由"><a href="#3-选择-Maven-IntelliJ-IDEA-的理由" class="headerlink" title="3. 选择 Maven + IntelliJ IDEA 的理由"></a>3. 选择 Maven + IntelliJ IDEA 的理由</h3><p>之所以要选择IntelliJ IDEA，是因为Maven+Eclipse实在太难用了。Eclipse有两个Maven插件 m2eclipse 和 Eclipse IAM。但是由于Eclipse和Maven设计上的矛盾，这两个插件可能都达不到你想要的效果。m2eclipse 会把你所有类型的项目都视为Maven类型项目，这对于一个单纯的Java项目或许可以，对于一个JEE或者WEB项目都是一场灾难。Eclipse IAM 并不会改变你的项目类型，但是他提供的功能也就仅仅限于编辑和运行POM文件了，甚至连依赖性都管理不了。相比之下，如果你非要用Eclipse的话我还 是推荐你使用Eclipse IAM。Eclipse想要完美的支持Maven恐怕需要在底层设计上做一些改变，无论是代码规范，项目结构规范和依赖性管理上，都有着不可调和的矛盾。 显然，在这方面IntelliJ IDEA做的要好的多，以至于你很难说出对它的不满。</p>
<h3 id="4-Maven-IntelliJ-IDEA-的优势"><a href="#4-Maven-IntelliJ-IDEA-的优势" class="headerlink" title="4. Maven + IntelliJ IDEA 的优势"></a>4. Maven + IntelliJ IDEA 的优势</h3><h4 id="一切都是Module："><a href="#一切都是Module：" class="headerlink" title="一切都是Module："></a>一切都是Module：</h4><pre><code>IntelliJ IDEA借鉴的Maven的概念，不在采取Eclipse里Project的概念，一切都是Module。无论是否使用Maven，你的项目都是一个独立 的Module。并且你可以混搭使用Maven Module和普通的Java Module，两者可以和谐共存。
</code></pre><h4 id="支持Multi-module："><a href="#支持Multi-module：" class="headerlink" title="支持Multi-module："></a>支持Multi-module：</h4><pre><code>可以说Maven的项目结构设计是非常严格的，现实应用中你必须用到Parent-Child的模式。Eclipse由于不支持在一个Project上建 立Sub-Project，因此无论如何目前都不能实现。IntelliJ IDEA可以完美的实现这个设计，并且无论是Module属性里，还是彼此的依赖性上都不会出现问题。
</code></pre><h4 id="更方便的生命周期操作："><a href="#更方便的生命周期操作：" class="headerlink" title="更方便的生命周期操作："></a>更方便的生命周期操作：</h4><pre><code>比起Eclipse通通放进右键菜单的行为，IntelliJ IDEA有着单独的窗口可以完成Maven的操作。你可以针对不同Module进行 Clean Compile Package Install等操作，各个Plug-in的操作也一清二楚。
</code></pre><h4 id="完美的依赖性管理："><a href="#完美的依赖性管理：" class="headerlink" title="完美的依赖性管理："></a>完美的依赖性管理：</h4><pre><code>由于Maven会把所有依赖的包放在本机的一个目录下，所以实际上是脱离Project本身存在的。IntelliJ IDEA引入了一个External Library的概念，所有的Maven依赖性都会放在这里，和项目自带的库区分开。并且Module之间会智能的判断，你不需要Maven Install来进行引用代码的更新。
</code></pre><h4 id="动态更新："><a href="#动态更新：" class="headerlink" title="动态更新："></a>动态更新：</h4><pre><code>每当Maven相关的设置更改时，例如修改了pom的依赖性，添加删除Module，IntelliJ IDEA会提示你进行更新。这种更新实际上就是运行了Maven，所以你不许要手动运行Maven Compile来进行更新，也不会像Eclipse里遇到莫名其妙的问题。
</code></pre><h3 id="5-Maven-安装"><a href="#5-Maven-安装" class="headerlink" title="5. Maven 安装"></a>5. Maven 安装</h3><p>到<a href="http://maven.apache.org/download.html" target="_blank" rel="noopener">http://maven.apache.org/download.html</a> 下载最新的Maven版本，我下载的版本为最新的apache-maven-3.0.4。推荐使用最新的Maven 3，因为比以前的Maven 2性能更好，而且完全兼容Maven 2。</p>
<p>下载好以后，解压到一个目录，我的目录为 D:\apache-maven-3.0.4，接着配置Maven环境变量M2_HOME为你解压的目录，如下图新建M2_HOME变量并追加到Path后面：</p>
<p>如果要在CMD控制台运行Maven命令的话，还需要配置Jdk环境变量，因为我接下来的操作都是基于IntelliJ IDEA，所以就不用配置JDK环境变量。</p>
<h3 id="6-Maven-与IntelliJ-IDEA完美使用（基于IntelliJ-IDEA-12）"><a href="#6-Maven-与IntelliJ-IDEA完美使用（基于IntelliJ-IDEA-12）" class="headerlink" title="6. Maven 与IntelliJ IDEA完美使用（基于IntelliJ IDEA 12）"></a>6. Maven 与IntelliJ IDEA完美使用（基于IntelliJ IDEA 12）</h3><p>打开IntelliJ IDEA，新建一个Maven项目，如下图，项目名称为mymaven</p>
<p>选择Maven模版</p>
<p>创建过程中，配置Maven主目录</p>
<p>创建好后的目录结构如下图，IDEA创建了src/main/resources（自动创建）、src/main/java（手动创建）、src/main/test（手动创建）、以及pom.xml文件（自动创建）</p>
<p>按照Maven约定，项目的主目录位于src/main/resources、src/main/java中，测试目录位于src/main/test 中，所以我们在最终打包项目的时候，只包含主目录代码，不会包含测试目录里的代码，而测试目录里的代码只会在测试时候用到。</p>
<p>最后pom.xml这个文件是我们Maven项目的核心文件，POM(Project Object Model，项目对象模型)定义了项目的基本信息，用于描述项目如何构建，声明项目依赖。</p>
<p>project：是xml文件的根元素，我们主要关心根元素下的子元素<br>modelVersion：定义了当前POM模型的版本，Maven 2 或Maven 3 只能是4.0.0<br>groupId：定义了项目属于哪个组，一般来说这个网网和公司或组织关联，比如说，你所在的公司为mycom.那就应该定义为com.mycom.mymaven，mymaven为项目名称<br>artifactId：定 义了当前Maven项目在组中的唯一id，例如HelloMaven这个项目，我则把他定义为hello-maven，还例如spring项目，他的 groupId为org.springframework，对于content项目来说artifactId则为spring-content，web项 目则为spring-web</p>
<p>最后我们使用IntelliJ IDEA来用Maven编译我们的代码，打开Maven Projects菜单，如图，选中clean、compile并右键点击Run ‘hello-maven[clean,compile]’按钮即可。</p>
<p>根据输出结果我们看到，clean命令让Maven先清理target目录，Maven一般认为项目的输出目录为target，然后执行resource任务，现在为定义项目资源，所以暂时略过，最后执行编译任务！ </p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用Servlet做简单的上传功能]]></title>
      <url>https://blog.xiaomo.info/2016/JavaServletUpload/</url>
      <content type="html"><![CDATA[<p>这篇文章主要为大家详细介绍了java基于servlet实现上传功能，后台使用java实现，前端主要是jsp，感兴趣的小伙伴们可以参考一下<br><a id="more"></a></p>
<h3 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h3><h4 id="1-1-jar包"><a href="#1-1-jar包" class="headerlink" title="1.1 jar包"></a>1.1 jar包</h4><p><code>servlet-api</code> 是servlet的核心api包<br><code>commons-fileupload</code> 上传功能的通用工具包<br><code>fastjson</code> 阿里的json工具包</p>
<h3 id="1-2-pom文件"><a href="#1-2-pom文件" class="headerlink" title="1.2 pom文件"></a>1.2 pom文件</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="二、项目介绍"><a href="#二、项目介绍" class="headerlink" title="二、项目介绍"></a>二、项目介绍</h3><h4 id="1-1-web-xml配置"><a href="#1-1-web-xml配置" class="headerlink" title="1.1 web.xml配置"></a>1.1 web.xml配置</h4><p>此项目是采用maven构建的java web项目，传统的jsp作为页面交互。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span></span><br><span class="line">            org.apache.commons.fileupload.servlet.FileCleanerCleanup</span><br><span class="line">        <span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FileUploadServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>FileUploadServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>FileUploadServlet<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.ghj.servlet.FileUploadServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FileUploadServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/FileUploadServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>配置的servlet的位置，那么我们就要去写代码了。</p>
<h4 id="1-2-上传功能"><a href="#1-2-上传功能" class="headerlink" title="1.2 上传功能"></a>1.2 上传功能</h4><p>新建一个class文件<code>com.ghj.servlet.FileUploadServlet</code>，继承自<code>HttpServlet</code>。重写它的<code>init()</code>和<code>doPost()</code>方法。</p>
<p>代码</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ghj.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileItem;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.disk.DiskFileItemFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.servlet.FileCleanerCleanup;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.servlet.ServletFileUpload;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileCleaningTracker;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把今天最好的表现当作明天最新的起点．．～</span></span><br><span class="line"><span class="comment"> * いま 最高の表現 として 明日最新の始発．．～</span></span><br><span class="line"><span class="comment"> * Today the best performance  as tomorrow newest starter!</span></span><br><span class="line"><span class="comment"> * Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @author: xiaomo</span></span><br><span class="line"><span class="comment"> * @github: https://github.com/soubaku</span></span><br><span class="line"><span class="comment"> * @email: hupengbest@163.com</span></span><br><span class="line"><span class="comment"> * @QQ_NO: 83387856</span></span><br><span class="line"><span class="comment"> * @Date: 2016/10/24 9:15.</span></span><br><span class="line"><span class="comment"> * @Description:</span></span><br><span class="line"><span class="comment"> * @Copyright(©) 2016 by xiaomo.</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> FileUploadServlet <span class="keyword">extends</span> HttpServlet &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1</span>L;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">File</span> fileUploadPath;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String fileDirectory = <span class="string">"/data"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置文件存储位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> init() &#123;</span><br><span class="line">        String realPath = <span class="keyword">this</span>.getServletConfig().getServletContext().getRealPath(<span class="string">"/"</span>);</span><br><span class="line">        fileUploadPath = <span class="keyword">new</span> <span class="keyword">File</span>(realPath + fileDirectory);</span><br><span class="line">        <span class="keyword">if</span> (!fileUploadPath.exists()) &#123;</span><br><span class="line">            <span class="keyword">boolean</span> isCreate = fileUploadPath.mkdirs();</span><br><span class="line">            <span class="keyword">if</span> (isCreate) &#123;</span><br><span class="line">                System.out.<span class="keyword">println</span>(<span class="string">"文件夹己被创建"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * post请求(文件上传的操作)</span></span><br><span class="line"><span class="comment">     * 说明：该方法支持同时上传多个文件（在index.jsp中添加文件上传的控件）</span></span><br><span class="line"><span class="comment">     * 注意：文件名只能为英文</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param request  request</span></span><br><span class="line"><span class="comment">     * @param response response</span></span><br><span class="line"><span class="comment">     * @throws ServletException ServletException</span></span><br><span class="line"><span class="comment">     * @throws IOException      IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> doPost(HttpServletRequest request, HttpServletResponse response) <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="keyword">boolean</span> isMultipart = ServletFileUpload.isMultipartContent(request);</span><br><span class="line">        <span class="keyword">if</span> (isMultipart) &#123;</span><br><span class="line">            ServletContext servletContext = <span class="keyword">this</span>.getServletConfig().getServletContext();</span><br><span class="line">            <span class="keyword">File</span> repository = (<span class="keyword">File</span>) servletContext.getAttribute(<span class="string">"javax.servlet.context.tempdir"</span>);</span><br><span class="line">            DiskFileItemFactory factory = newDiskFileItemFactory(servletContext, repository);</span><br><span class="line"></span><br><span class="line">            ServletFileUpload upload = <span class="keyword">new</span> ServletFileUpload(factory);</span><br><span class="line">            upload.setHeaderEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line"></span><br><span class="line">            PrintWriter printWriter = response.getWriter();</span><br><span class="line">            response.setContentType(<span class="string">"application/json"</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">            JSONArray files = <span class="keyword">new</span> JSONArray();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                List&lt;FileItem&gt; items = upload.parseRequest(request);</span><br><span class="line">                <span class="keyword">for</span> (FileItem item : items) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (item.isFormField()) &#123; <span class="comment">//表单输入域</span></span><br><span class="line">                        System.out.<span class="keyword">println</span>(item.getFieldName());</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123; <span class="comment">// 文件上传域</span></span><br><span class="line">                        String name = item.getName();</span><br><span class="line">                        <span class="keyword">if</span> (!name.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                            <span class="keyword">int</span> index = name.indexOf(<span class="string">"\\"</span>);</span><br><span class="line">                            <span class="keyword">File</span> uploadedFile;</span><br><span class="line">                            <span class="keyword">if</span> (index == -<span class="number">1</span>) &#123;</span><br><span class="line">                                uploadedFile = <span class="keyword">new</span> <span class="keyword">File</span>(fileUploadPath,</span><br><span class="line">                                        <span class="keyword">File</span>.separator + name);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                uploadedFile = <span class="keyword">new</span> <span class="keyword">File</span>(fileUploadPath, <span class="keyword">File</span>.separator + name.substring(name.lastIndexOf(<span class="keyword">File</span>.separator) + <span class="number">1</span>));</span><br><span class="line">                            &#125;</span><br><span class="line">                            item.<span class="keyword">write</span>(uploadedFile);</span><br><span class="line">                            JSONObject <span class="keyword">file</span> = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                            <span class="keyword">file</span>.put(<span class="string">"name"</span>, name);</span><br><span class="line">                            <span class="keyword">file</span>.put(<span class="string">"size"</span>, item.getSize());</span><br><span class="line">                            <span class="keyword">file</span>.put(<span class="string">"url"</span>, fileUploadPath + <span class="string">"/"</span> + name);</span><br><span class="line">                            <span class="keyword">file</span>.put(<span class="string">"deleteType"</span>, <span class="string">"post"</span>);</span><br><span class="line">                            files.add(<span class="keyword">file</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            JSONObject <span class="keyword">file</span> = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                            <span class="keyword">file</span>.put(<span class="string">"result"</span>, <span class="string">"please choose a file"</span>);</span><br><span class="line">                            files.add(<span class="keyword">file</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                JSONObject result = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                result.put(<span class="string">"files"</span>, files);</span><br><span class="line">                printWriter.<span class="keyword">write</span>(result.toString());</span><br><span class="line">                printWriter.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将请求的每个项目封装成单独的文件项目</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param context    context</span></span><br><span class="line"><span class="comment">     * @param repository repository</span></span><br><span class="line"><span class="comment">     * @return DiskFileItemFactory</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> DiskFileItemFactory newDiskFileItemFactory(ServletContext context, <span class="keyword">File</span> repository) &#123;</span><br><span class="line">        FileCleaningTracker fileCleaningTracker = FileCleanerCleanup.getFileCleaningTracker(context);</span><br><span class="line">        DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory(DiskFileItemFactory.DEFAULT_SIZE_THRESHOLD, repository);</span><br><span class="line">        factory.setFileCleaningTracker(fileCleaningTracker);</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-3-页面"><a href="#2-3-页面" class="headerlink" title="2.3 页面"></a>2.3 页面</h4><figure class="highlight erb"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@page pageEncoding=<span class="string">"UTF-8"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>文件上传<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"FileUploadServlet"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file1"</span>"&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"submit"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>看起来清新简单，就不加那么style的修饰了。</p>
<h3 id="三、效果图"><a href="#三、效果图" class="headerlink" title="三、效果图"></a>三、效果图</h3><p><img src="https://image.xiaomo.info/java/java_upload.gif" alt="效果图"></p>
<h3 id="四、源代码"><a href="#四、源代码" class="headerlink" title="四、源代码"></a>四、源代码</h3><p><a href="https://github.com/java-user/ServletFileUploadDemo" target="_blank" rel="noopener">https://github.com/java-user/ServletFileUploadDemo</a>  需要的朋友自取，随意使用不用客气</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[喜欢的动漫]]></title>
      <url>https://blog.xiaomo.info/2016/NihonAnime/</url>
      <content type="html"><![CDATA[<p>二次元为我们描绘了一个不一样的世界，一群有着精彩故事的人，还有视觉听觉上的双重享受。不是很美妙吗？我们还能从二次元里获得力量、勇气、热情、梦想，懂得坚持、友爱、乐观、努力。二次元正是人类的伟大创造。<br><a id="more"></a></p>
<h3 id="一、アニメ"><a href="#一、アニメ" class="headerlink" title="一、アニメ"></a>一、<a href="https://zh.moegirl.org" target="_blank" rel="noopener">アニメ</a></h3><table>
<thead>
<tr>
<th style="text-align:center">名前</th>
<th style="text-align:center">コメント</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">东离剑游记</td>
<td style="text-align:center">東离剣の遊記</td>
</tr>
<tr>
<td style="text-align:center">NEW GAME！</td>
<td style="text-align:center">NEW GAME！</td>
</tr>
<tr>
<td style="text-align:center">刀剑神域</td>
<td style="text-align:center">ソードアート・オンライン</td>
</tr>
<tr>
<td style="text-align:center">全职猎人</td>
<td style="text-align:center">ハンター×ハンター</td>
</tr>
<tr>
<td style="text-align:center">寄生兽</td>
<td style="text-align:center">寄生獣</td>
</tr>
<tr>
<td style="text-align:center">星之梦</td>
<td style="text-align:center">星の夢</td>
</tr>
<tr>
<td style="text-align:center">Fate/Zero</td>
<td style="text-align:center">フェイト/ゼロ</td>
</tr>
<tr>
<td style="text-align:center">妖精的尾巴</td>
<td style="text-align:center">フェアリーテイル</td>
</tr>
<tr>
<td style="text-align:center">命运石之门</td>
<td style="text-align:center">シュタインズゲート</td>
</tr>
<tr>
<td style="text-align:center">線上遊戲的老婆不可能是女生？</td>
<td style="text-align:center">ネトゲの嫁は女の子じゃないと思った？</td>
</tr>
<tr>
<td style="text-align:center">Re:从零开始的异世界生活</td>
<td style="text-align:center">Re:ゼロから始める異世界生活</td>
</tr>
<tr>
<td style="text-align:center">干物妹小埋</td>
<td style="text-align:center">干物妹！うまるちゃん</td>
</tr>
<tr>
<td style="text-align:center">遊戲人生</td>
<td style="text-align:center">ノーゲーム・ノーライフ</td>
</tr>
<tr>
<td style="text-align:center">夏目友人帐</td>
<td style="text-align:center">なつめ　ゆうじんちょう</td>
</tr>
<tr>
<td style="text-align:center">寒蝉鸣泣之时</td>
<td style="text-align:center">ひぐらしのなく頃に</td>
</tr>
<tr>
<td style="text-align:center">未来日记</td>
<td style="text-align:center">未来日记</td>
</tr>
<tr>
<td style="text-align:center">加速世界</td>
<td style="text-align:center">アクセル・ワールド</td>
</tr>
<tr>
<td style="text-align:center">Charlotte</td>
<td style="text-align:center">Charlotte</td>
</tr>
<tr>
<td style="text-align:center">笨蛋测验召唤兽</td>
<td style="text-align:center">バカとテストと召喚獣</td>
</tr>
<tr>
<td style="text-align:center">心理测量者</td>
<td style="text-align:center">サイコパス</td>
</tr>
<tr>
<td style="text-align:center">CLANNAD</td>
<td style="text-align:center">CLANNAD</td>
</tr>
<tr>
<td style="text-align:center">AIR</td>
<td style="text-align:center">AIR</td>
</tr>
<tr>
<td style="text-align:center">KANON</td>
<td style="text-align:center">KANON</td>
</tr>
</tbody>
</table>
<h3 id="二、ドラマ"><a href="#二、ドラマ" class="headerlink" title="二、ドラマ"></a>二、ドラマ</h3><table>
<thead>
<tr>
<th style="text-align:center">名前</th>
<th style="text-align:center">コメント</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">孝忠八犬</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">成濑巳喜男</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">小栗康平的泥之河</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">小津安二郎</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">娄烨是才子</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">彗星来的那一夜</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">堂吉诃德</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">对不起青春</td>
<td style="text-align:center">なし</td>
</tr>
<tr>
<td style="text-align:center">nana</td>
<td style="text-align:center">なし</td>
</tr>
</tbody>
</table>
<h3 id="三、映画"><a href="#三、映画" class="headerlink" title="三、映画"></a>三、映画</h3><table>
<thead>
<tr>
<th style="text-align:center">名前</th>
<th style="text-align:center">コメント</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">千与千寻</td>
<td style="text-align:center">千と千尋の神隠し</td>
</tr>
<tr>
<td style="text-align:center">となりのトトロ</td>
<td style="text-align:center">となりのトトロ</td>
</tr>
<tr>
<td style="text-align:center">你的名字</td>
<td style="text-align:center">君のなまえは？</td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[生活习惯的不同，造就了丰富多彩的世界]]></title>
      <url>https://blog.xiaomo.info/2016/NihonSekaku/</url>
      <content type="html"><![CDATA[<p>にほんのライフスタイルに<br><a id="more"></a></p>
<ul>
<li>不喜欢用蓝色圆珠笔。蓝色圆珠笔只在作标记的场合使用。</li>
<li>香烟吸一半就扔掉。有的人烟瘾大，吸两个半支烟，而不是吸一个整支。</li>
<li>日本人不太在意姓的意思。在中国人看来日本人的姓稀奇古怪。一次我去开会签到，抬头一看接待小姐的姓是“我孙子”。还有人姓厕所（御手洗）。很多姓是地名，“大阪”“名古屋”“涩谷”都见过。还有四个字的姓，如最近的丑闻作曲家姓“佐村河内”。</li>
<li>日本人不忌讳鬼、地狱、幽灵。含“鬼”字的地名有很多，叫“地狱”的拉面店也见到过。</li>
<li>不把跪着视为低人一等。因为跪着比蹲着省力，经常看到日本人跪着工作。例如，在没有椅子的时候，跪着操作电脑，高度正好。</li>
<li>如果第二天下午开会，日本人前一天晚上就不吃韭菜了。</li>
<li>如果感冒了，一定带口罩，即使不是流行性感冒也怕别人忌讳。</li>
<li>不使用非常浓的香水。无香料的化妆品很受欢迎。</li>
<li>不会打听别人的衣服、物品多少钱买的。</li>
<li>不会和别人勾肩搭背，即使是好朋友。</li>
<li>女士吃面包点心时，用手掰下一块放到嘴里，不会直接咬。（可能认为这样吃比较体面。）</li>
<li>吸烟时不劝烟，聚餐时不劝酒，更不会把人灌醉。</li>
<li>不轻易把谁称为自己的朋友，交往了几十年还把对方称为“知人”。对自来熟，刚见面就称朋友的人不喜欢。</li>
<li>不会轻易触摸别人的肌肤，即使是同性。对拉拉手的亲热和拍拍肩的关心不接受。</li>
<li>不打听别人的家事，更不要说隐私。在一起工作十几年，不知道对方有几个兄弟姐妹。福原爱在接受日本媒体的采访时说，中国记者什么都问，问得直想哭。</li>
<li>不轻易交换电话号码。我们公司的部长课长之间，甚至也有不知道对方电话号码的人。</li>
<li>日本人的胃口很小，初到日本的中国留学生（男生）在学校食堂一份定食大部分吃不饱。</li>
<li>在工作场合绝不穿张扬的服装。一般60岁以上的人开始穿红色的花的衣服。</li>
<li>工作场合不可吃东西，但可以吃水果糖。</li>
<li>工作时间不可接私人电话。个人不能使用公家电话打出去，也不能打进来。</li>
<li>私人的信件和物品不能寄到公司。</li>
<li>在家里高声说话，邻居会到家中提出警告。</li>
<li>泡温泉以前要先洗净身子。</li>
<li>如果你送给日本人点心，对方说真好吃。千万不要信以为真。是真是假得在其他的场合验证。</li>
<li>日本的绿茶泡一分钟就可以喝。</li>
<li>把手插到衣服裤子口袋里，被认为是对对方不尊敬。张艺谋拍的《千里走单骑》电影里的女日语翻译，很多场面把手放在口袋里，感觉不舒服。</li>
<li>日本人没有抱肘的习惯，认为这个姿势显示傲慢。</li>
<li>行人过马路遇到红灯必停，即使绿灯侧没有车。本人这种情况走过，被旁边的车“嘀”过。日本人说，这样做的目的是，告诉孩子，有法必依。</li>
<li>开车时，后灯双闪，是表示对后车的感谢。常在别人给让路后使用。</li>
<li>对面的车前灯瞬闪，表示给你让路。</li>
<li>公司业务关系新年拜年，带的礼品基本就是两条毛巾。</li>
<li>公司来两伙客人，一方是得到工作的上家，一方是外协的下家，在一个接待室谈话。只给上家上茶，下家没有。</li>
<li>公司来客，不管是什么工作关系，到吃饭时间基本都不提供午饭。</li>
<li>工作中出现差错，再好的朋友都不会说一句同情的话。有再多的客观原因也没人体谅。如果争辩解释，被认为错上加错。</li>
<li>企业一般都有自己的日历，根据客户的日历制定，国家法定假日常常有不休息的时候。</li>
<li>企业的年假，日本人一般不休，很少利用年假去旅游。</li>
<li>日本人工作比较配合，部门之间扯皮的事很少。</li>
<li>日本人的习惯是报忧不报喜，看电视听领导讲话，没有大好形势。</li>
<li>日本的电视广告很好看，没有太长时间的广告，幽默让人不厌倦。例，一个美女到动物店说想买一条狗，两只老虎，三头狮子。旁边的顾客惊得把手包都掉到了地上。店主问为什么，她说，单身女子在家害怕，每个房间都要有猛兽守卫。这时画外音，有比这还安全的，“家用电子警备系统”。</li>
<li>日本不光小孩看漫画，动画片，大人也很爱看。</li>
<li>店铺开业，门前摆放的祝贺物品，简直就可以说是中国追悼会上的花圈。</li>
<li>传统文化节，很多人穿的衣服上印着“祭”字。在日本，“祭”字的意思是文化节。</li>
<li>日本的医院对消炎药的使用严格控制，但相对而言，对激素的使用比较放松。</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《东离剑游记》]]></title>
      <url>https://blog.xiaomo.info/2016/BangumiDongli/</url>
      <content type="html"><![CDATA[<p>这两天看了一部神奇的动漫，具有强烈的武侠风。现在循环听练听力。然而你一定想不到这部动漫是多么的让人惊喜。<br><a id="more"></a></p>
<h1 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h1><p>这是一次打破当前布袋戏模式的局限的冒险和挑战。关键的变化主要在三点：</p>
<p>第一剧本作者由日本的虚渊玄担任，虚的创作水平有目共睹，保守的说，当不在目前布袋戏圈内最出色的编剧三弦之下，甚至只会更高，这实际上有效的补完了霹雳近年来剧本疲弱的短板，把最弱点变成了最强点。</p>
<p>但水平是一方面，文化属性则是另一方面，从东离的第一集看，比如一些人物特质，就明显少了几分霹雳和金光的中国侠客味道，而多了几分日本武士的感觉，这种改变实际上让东离剑在文化意识领域有些脱离了承载着传统文化的布袋戏，而接近了日本动画的范畴。</p>
<p>第二是配音从单人中文口白变成了日语声优配音，但霹雳似乎也同时提供了台语配音版？这就如同当年的可口可乐的营销手法一样，新老同出，这在创新的同时很大程度上减少了风险，应是一个很明智的选择。</p>
<p>第三是东离的单集时长从过往的六十分钟以上变成了日本动画的二十三分钟，它在能让编剧和制作人员更有效的凝练和提升质量的同时，却也可能带来一些节奏的变化，让旧观众产生一定的不适应感，比如我至今仍对东离的木偶与台词的配合，木偶动作和战斗画面的结合有点不适。</p>
<p>总而言之，东离比较像一个嫁接品，有点像是在布袋戏的树干里插入了一个日本动画的灵魂，同时在枝叶上嫁接了日本动画的设计和手法，所以霹雳的“偶动漫”这个说法，正如苹果梨一样，我以为是很贴切的，其味道好不好吃，是不是能在保留苹果的精髓的同时加入梨子的优点，是不是能在让吃苹果的人满意的同时吸引一群喜欢吃梨子的人，还是搞砸了，弄得似是而非，两头都不满意，这个目前下结论为时尚早，但无论如何，仅凭这个剧作本身，它已毫无疑问是布袋戏圈的一大突破性创举，对于勇于探索向前的人和行为，无论其最终成败如何，我以为作为观众，我们都是该有一种开阔的心态，而抱持一份最起码的支持和敬意的。</p>
<h1 id="二、-插画"><a href="#二、-插画" class="headerlink" title="二、 插画"></a>二、 插画</h1><p><img src="https://image.xiaomo.info/dongman/dongli2.jpg" alt="1"><br><img src="https://image.xiaomo.info/dongman/dongli3.jpg" alt="1"></p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 动漫 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[yargs插件的使用，node.js 命令行框架 yargs 和你的程序实现交互]]></title>
      <url>https://blog.xiaomo.info/2016/NpmYargs/</url>
      <content type="html"><![CDATA[<p>如何让你的node.js 应用程序像shell 脚本一样和你交互?没错，就是yargs。<br><a id="more"></a></p>
<h3 id="一、使用场景"><a href="#一、使用场景" class="headerlink" title="一、使用场景"></a>一、使用场景</h3><p>大概有一种情况你需要让你的程序接收一个参数,通过这个参数我们做一系列的定制化功能.</p>
<p>常见的做法是 把一些不同环境不同配置的变量写到 config 配置文件中.</p>
<p>当你的环境变化的时候,你手动去修改你的config 中的变量来达到不同环境显示定制化的东西.<br>更具象的一个例子:</p>
<p>config文件中有一个配置项 langue</p>
<p>当你发布国内站点的时候,你需要配置成 langue=”zh-cn”</p>
<p>当你发布国外站点的时候,你需要配置成 langue=”en”</p>
<p>现在, yargs 的功能就是帮你实现类似上面这种定制化的参数功能.</p>
<p>从此一些简单定制参数可以彻底摆脱 config 配置了.</p>
<p>比如:</p>
<p>你的node.js 启动文件是 app.js</p>
<p>当你部署中文环境站点的时候,就可以这样  node app.js –l zh-cn</p>
<p>英文网站部署时  node app.js –l en</p>
<p>当然上面输入给启动文件的 -l 参数,你是可以在 app.js 文件中获取,然后对应加载你需要定制化的东东即可.</p>
<p>上面我们只是介绍它的作用,以及一个具体的例子让大家明白什么时候使用.下面开始介绍如何使用:</p>
<h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h3><h4 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h4><p><code>npm install --save yargs</code></p>
<h4 id="2-定义命令交互参数"><a href="#2-定义命令交互参数" class="headerlink" title="2. 定义命令交互参数:"></a>2. 定义命令交互参数:</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">'yargs'</span>).argv;</span><br><span class="line"><span class="keyword">if</span> (argv.l == <span class="string">'zh-cn'</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Chinese site!'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(argv.l == <span class="string">'en'</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'English website!'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h4><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">$ <span class="string">./app.js</span> <span class="params">--l=zh-cn</span></span><br><span class="line">Chinese site!</span><br><span class="line"></span><br><span class="line">$ <span class="string">./app.js</span> <span class="params">--l=en</span></span><br><span class="line">English website!</span><br></pre></td></tr></table></figure>
<h4 id="4-接收参数"><a href="#4-接收参数" class="headerlink" title="4. 接收参数"></a>4. 接收参数</h4><figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> argv = <span class="keyword">require</span>(<span class="string">'yargs'</span>).argv;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (argv.l==<span class="string">'zh-cn'</span>) &#123;</span><br><span class="line">    <span class="comment">//获取参数 l 的值</span></span><br><span class="line">    console.<span class="keyword">log</span>(<span class="string">'Chinese website!'</span>);</span><br><span class="line">    <span class="built_in">global</span>.langue=<span class="string">'zh-cn'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(argv.l==<span class="string">'en'</span>)&#123;</span><br><span class="line">    console.<span class="keyword">log</span>(<span class="string">'English website!'</span>);</span><br><span class="line">    <span class="built_in">global</span>.langue=<span class="string">'en'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面我们通过 argv 获取 –l 参数来判断当前要运行哪个环境.</p>
<p>然后使用全局变量 global.langue 来标识当前运行环境.</p>
<p>在后面的所有个性化定制处我们都可以直接使用全局变量 global.langue 来做判断.</p>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> npm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2 api整理之路由模块]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2ApiRouter/</url>
      <content type="html"><![CDATA[<p>不知不觉接触angular2也有半年时间了，但是对于angular2仍然是一知半解。总觉得应该系统的了解一下它的api，正好ng2马上要有稳定版本了。是时候花一些时间整理一下了<br><a id="more"></a></p>
<h3 id="一、常量"><a href="#一、常量" class="headerlink" title="一、常量"></a>一、常量</h3><h4 id="1-PRIMARY-OUTLET"><a href="#1-PRIMARY-OUTLET" class="headerlink" title="1. PRIMARY_OUTLET"></a>1. <a href="https://angular.cn/docs/ts/latest/api/router/index/PRIMARY_OUTLET-let.html" target="_blank" rel="noopener">PRIMARY_OUTLET</a></h4><h4 id="2-ROUTER-DIRECTIVES"><a href="#2-ROUTER-DIRECTIVES" class="headerlink" title="2. ROUTER_DIRECTIVES"></a>2. <a href="https://angular.cn/docs/ts/latest/api/router/index/ROUTER_DIRECTIVES-let.html" target="_blank" rel="noopener">ROUTER_DIRECTIVES</a></h4><p>路由指令集合常量</p>
<h3 id="二、接口"><a href="#二、接口" class="headerlink" title="二、接口"></a>二、接口</h3><h4 id="1-活跃路由ActivatedRoute"><a href="#1-活跃路由ActivatedRoute" class="headerlink" title="1. 活跃路由ActivatedRoute"></a>1. 活跃路由<a href="https://angular.cn/docs/ts/latest/api/router/index/ActivatedRoute-interface.html" target="_blank" rel="noopener">ActivatedRoute</a></h4><p>可以获取当前路由的参数和数据</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> MyComponent &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">route: ActivatedRoute</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> id: Observable&lt;<span class="built_in">string</span>&gt; = route.params.map(<span class="function"><span class="params">p</span> =&gt;</span> p.id);</span><br><span class="line">    <span class="keyword">const</span> data = route.data.map(<span class="function"><span class="params">d</span> =&gt;</span> d.user); <span class="comment">//includes `data` and `resolve`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-活跃路由快照ActivatedRouteSnapshot"><a href="#2-活跃路由快照ActivatedRouteSnapshot" class="headerlink" title="2. 活跃路由快照ActivatedRouteSnapshot"></a>2. 活跃路由快照<a href="https://angular.cn/docs/ts/latest/api/router/index/ActivatedRouteSnapshot-interface.html" target="_blank" rel="noopener">ActivatedRouteSnapshot</a></h4><p>具体功能不明</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(route: ActivatedRoute) &#123;</span><br><span class="line">    <span class="keyword">const</span> id: string = route.snapshot.params.id;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">data</span> = route.snapshot.<span class="keyword">data</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-可激活CanActivate"><a href="#3-可激活CanActivate" class="headerlink" title="3. 可激活CanActivate"></a>3. 可激活<a href="https://angular.cn/docs/ts/latest/api/router/index/CanActivate-interface.html" target="_blank" rel="noopener">CanActivate</a></h4><p>实现此接口并重写<code>canActivate</code>方法。</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CanActivateTeam</span> <span class="keyword">implements</span> <span class="title">CanActivate</span> &#123;</span></span><br><span class="line">  constructor(<span class="keyword">private</span> <span class="string">permissions:</span> Permissions, <span class="keyword">private</span> <span class="string">currentUser:</span> UserToken) &#123;&#125;</span><br><span class="line">  canActivate(<span class="string">route:</span> ActivatedRouteSnapshot, <span class="string">state:</span> RouterStateSnapshot):Observable&lt;<span class="keyword">boolean</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.permissions.canActivate(<span class="keyword">this</span>.currentUser, <span class="keyword">this</span>.route.params.id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">bootstrap(AppComponent, [</span><br><span class="line">  CanActivateTeam,</span><br><span class="line">  provideRouter([&#123;</span><br><span class="line"><span class="symbol">    path:</span> <span class="string">'team/:id'</span>,</span><br><span class="line"><span class="symbol">    component:</span> Team,</span><br><span class="line"><span class="symbol">    canActivate:</span> [CanActivateTeam]</span><br><span class="line">  &#125;])</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="4-CanDeactivate"><a href="#4-CanDeactivate" class="headerlink" title="4. CanDeactivate"></a>4. <a href="https://angular.cn/docs/ts/latest/api/router/index/CanDeactivate-interface.html" target="_blank" rel="noopener">CanDeactivate</a></h4><h4 id="5-其他选项ExtraOptions"><a href="#5-其他选项ExtraOptions" class="headerlink" title="5. 其他选项ExtraOptions"></a>5. 其他选项<a href="https://angular.cn/docs/ts/latest/api/router/index/ExtraOptions-interface.html" target="_blank" rel="noopener">ExtraOptions</a></h4><h4 id="6-解决-Resolve"><a href="#6-解决-Resolve" class="headerlink" title="6. 解决 Resolve"></a>6. 解决 <a href="https://angular.cn/docs/ts/latest/api/router/index/Resolve-interface.html" target="_blank" rel="noopener">Resolve</a></h4><p>实现此接口并重写<code>Resolve</code>方法。</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TeamResolver</span> <span class="keyword">implements</span> <span class="title">Resolve</span> &#123;</span></span><br><span class="line">  constructor(<span class="keyword">private</span> <span class="string">backend:</span> Backend) &#123;&#125;</span><br><span class="line">  resolve(<span class="string">route:</span> ActivatedRouteSnapshot, <span class="string">state:</span> RouterStateSnapshot):Observable&lt;any&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.backend.fetchTeam(<span class="keyword">this</span>.route.params.id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">bootstrap(AppComponent, [</span><br><span class="line">  TeamResolver,</span><br><span class="line">  provideRouter([&#123;</span><br><span class="line"><span class="symbol">    path:</span> <span class="string">'team/:id'</span>,</span><br><span class="line"><span class="symbol">    component:</span> TeamCmp,</span><br><span class="line"><span class="symbol">    resolve:</span> &#123;</span><br><span class="line"><span class="symbol">      team:</span> TeamResolver</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;])</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="7-路由-Route"><a href="#7-路由-Route" class="headerlink" title="7. 路由 Route"></a>7. 路由 <a href="https://angular.cn/docs/ts/latest/api/router/index/Route-interface.html" target="_blank" rel="noopener">Route</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> &#123;</span></span><br><span class="line"><span class="string">path :</span> string</span><br><span class="line"><span class="string">terminal :</span> <span class="keyword">boolean</span></span><br><span class="line"><span class="string">pathMatch :</span> <span class="string">'full'</span>|<span class="string">'prefix'</span></span><br><span class="line"><span class="string">component :</span> Type|string</span><br><span class="line"><span class="string">redirectTo :</span> string</span><br><span class="line"><span class="string">outlet :</span> string</span><br><span class="line"><span class="string">canActivate :</span> any[]</span><br><span class="line"><span class="string">canDeactivate :</span> any[]</span><br><span class="line"><span class="string">data :</span> Data</span><br><span class="line"><span class="string">resolve :</span> ResolveData</span><br><span class="line"><span class="string">children :</span> Route[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-路由状态-RouterState"><a href="#8-路由状态-RouterState" class="headerlink" title="8. 路由状态 RouterState"></a>8. 路由状态 <a href="https://angular.cn/docs/ts/latest/api/router/index/RouterState-interface.html" target="_blank" rel="noopener">RouterState</a></h4><figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">class MyComponent &#123;</span><br><span class="line">  constructor(router: Router) &#123;</span><br><span class="line">    const <span class="keyword">state</span> = router.routerState;</span><br><span class="line">    const id: Observable<span class="variable">&lt;string&gt;</span> = <span class="keyword">state</span>.firstChild(<span class="keyword">state</span>.root).params.map(p =&gt; p.id);</span><br><span class="line">    const isDebug: Observable<span class="variable">&lt;string&gt;</span> = <span class="keyword">state</span>.queryParams.map(q =&gt; q.<span class="keyword">debug</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-路由状态快照RouterStateSnapshot"><a href="#9-路由状态快照RouterStateSnapshot" class="headerlink" title="9. 路由状态快照RouterStateSnapshot"></a>9. 路由状态快照<a href="https://angular.cn/docs/ts/latest/api/router/index/RouterStateSnapshot-interface.html" target="_blank" rel="noopener">RouterStateSnapshot</a></h4><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(router: Router)</span> <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  const snapshot = router.routerState.snapshot;</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="10-路径树-UrlTree"><a href="#10-路径树-UrlTree" class="headerlink" title="10. 路径树 UrlTree"></a>10. 路径树 <a href="https://angular.cn/docs/ts/latest/api/router/index/UrlTree-interface.html" target="_blank" rel="noopener">UrlTree</a></h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">UrlTree</span> &#123;</span><br><span class="line">root : UrlSegment</span><br><span class="line">queryParams : &#123;[key: <span class="keyword">string</span>]: <span class="keyword">string</span>&#125;</span><br><span class="line">fragment : <span class="keyword">string</span></span><br><span class="line">toString() : <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="三、类"><a href="#三、类" class="headerlink" title="三、类"></a>三、类</h3><h4 id="1-默认路径初始化-DefaultUrlSerializer"><a href="#1-默认路径初始化-DefaultUrlSerializer" class="headerlink" title="1. 默认路径初始化 DefaultUrlSerializer"></a>1. 默认路径初始化 <a href="https://angular.cn/docs/ts/latest/api/router/index/DefaultUrlSerializer-class.html" target="_blank" rel="noopener">DefaultUrlSerializer</a></h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">class DefaultUrlSerializer &#123;</span><br><span class="line"><span class="function"><span class="title">parse</span><span class="params">(url: string)</span></span> : UrlTree</span><br><span class="line"><span class="function"><span class="title">serialize</span><span class="params">(tree: UrlTree)</span></span> : string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-取消导航NavigationCancel"><a href="#2-取消导航NavigationCancel" class="headerlink" title="2. 取消导航NavigationCancel"></a>2. 取消导航<a href="https://angular.cn/docs/ts/latest/api/router/index/NavigationCancel-class.html" target="_blank" rel="noopener">NavigationCancel</a></h4><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(id: number, url: <span class="keyword">string</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">id</span> :</span> number</span><br><span class="line">url : <span class="keyword">string</span></span><br><span class="line">toString() : <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-结束导航-NavigationEnd"><a href="#3-结束导航-NavigationEnd" class="headerlink" title="3. 结束导航 NavigationEnd"></a>3. 结束导航 <a href="https://angular.cn/docs/ts/latest/api/router/index/NavigationEnd-class.html" target="_blank" rel="noopener">NavigationEnd</a></h4><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">class</span> NavigationEnd &#123;</span><br><span class="line">constructor(<span class="built_in">id</span>: <span class="built_in">number</span>, url: <span class="built_in">string</span>, urlAfterRedirects: <span class="built_in">string</span>)</span><br><span class="line"><span class="built_in">id</span> : <span class="built_in">number</span></span><br><span class="line">url : <span class="built_in">string</span></span><br><span class="line">urlAfterRedirects : <span class="built_in">string</span></span><br><span class="line">toString() : <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-导航错误NavigationError"><a href="#4-导航错误NavigationError" class="headerlink" title="4. 导航错误NavigationError"></a>4. 导航错误<a href="https://angular.cn/docs/ts/latest/api/router/index/NavigationError-class.html" target="_blank" rel="noopener">NavigationError</a></h4><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">class</span> NavigationError &#123;</span><br><span class="line">constructor(<span class="built_in">id</span>: <span class="built_in">number</span>, url: <span class="built_in">string</span>, <span class="keyword">error</span>: any)</span><br><span class="line"><span class="built_in">id</span> : <span class="built_in">number</span></span><br><span class="line">url : <span class="built_in">string</span></span><br><span class="line"><span class="keyword">error</span> : any</span><br><span class="line">toString() : <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-根路由-RootRouter"><a href="#5-根路由-RootRouter" class="headerlink" title="5. 根路由 RootRouter"></a>5. 根路由 <a href="https://angular.cn/docs/ts/latest/api/router-deprecated/index/RootRouter-class.html" target="_blank" rel="noopener">RootRouter</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RootRouter</span> &#123;</span></span><br><span class="line">constructor(<span class="string">registry:</span> RouteRegistry, <span class="string">location:</span> Location, <span class="string">primaryComponent:</span> Type)</span><br><span class="line">commit(<span class="string">instruction:</span> Instruction, _skipLocationChange?: <span class="keyword">boolean</span>) : Promise&lt;any&gt;</span><br><span class="line">dispose() : <span class="keyword">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-路由数据-RouteData"><a href="#6-路由数据-RouteData" class="headerlink" title="6. 路由数据 RouteData"></a>6. 路由数据 <a href="https://angular.cn/docs/ts/latest/api/router-deprecated/index/RouteData-class.html" target="_blank" rel="noopener">RouteData</a></h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> RouteData &#123;</span><br><span class="line"><span class="keyword">constructor</span>(<span class="params">data?: &#123;[key: <span class="built_in">string</span>]: <span class="built_in">any</span>&#125;</span>)</span><br><span class="line">data : &#123;[key: <span class="built_in">string</span>]: <span class="built_in">any</span>&#125;</span><br><span class="line"><span class="keyword">get</span>(key: <span class="built_in">string</span>) : <span class="built_in">any</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-路由参数-RouteParams"><a href="#7-路由参数-RouteParams" class="headerlink" title="7. 路由参数 RouteParams"></a>7. 路由参数 <a href="https://angular.cn/docs/ts/latest/api/router-deprecated/index/RouteParams-class.html" target="_blank" rel="noopener">RouteParams</a></h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">RouteParams</span> &#123;</span><br><span class="line">constructor(<span class="keyword">params</span>: &#123;[key: <span class="keyword">string</span>]: <span class="keyword">string</span>&#125;)</span><br><span class="line"><span class="keyword">params</span> : &#123;[key: <span class="keyword">string</span>]: <span class="keyword">string</span>&#125;</span><br><span class="line"><span class="keyword">get</span>(param: <span class="keyword">string</span>) : <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-注册路由-RouteRegistry"><a href="#8-注册路由-RouteRegistry" class="headerlink" title="8. 注册路由 RouteRegistry"></a>8. 注册路由 <a href="https://angular.cn/docs/ts/latest/api/router-deprecated/index/RouteRegistry-class.html" target="_blank" rel="noopener">RouteRegistry</a></h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">class RouteRegistry &#123;</span><br><span class="line"><span class="function"><span class="title">constructor</span><span class="params">(_rootComponent: Type)</span></span></span><br><span class="line"><span class="function"><span class="title">config</span><span class="params">(parentComponent: any, config: RouteDefinition)</span></span> : void</span><br><span class="line"><span class="function"><span class="title">configFromComponent</span><span class="params">(component: any)</span></span> : void</span><br><span class="line"><span class="function"><span class="title">recognize</span><span class="params">(url: string, ancestorInstructions: Instruction[])</span></span> : Promise&lt;Instruction&gt;</span><br><span class="line"><span class="function"><span class="title">generate</span><span class="params">(linkParams: any[], ancestorInstructions: Instruction[], _aux?: any)</span></span> : Instruction</span><br><span class="line"><span class="function"><span class="title">hasRoute</span><span class="params">(name: string, parentComponent: any)</span></span> : boolean</span><br><span class="line"><span class="function"><span class="title">generateDefault</span><span class="params">(componentCursor: Type)</span></span> : Instruction</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-路由-Router"><a href="#9-路由-Router" class="headerlink" title="9. 路由 Router"></a>9. 路由 <a href="https://angular.cn/docs/ts/latest/api/router-deprecated/index/Router-class.html" target="_blank" rel="noopener">Router</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Router</span> &#123;</span></span><br><span class="line">constructor(<span class="string">registry:</span> RouteRegistry, <span class="string">parent:</span> Router, <span class="string">hostComponent:</span> any, root?: Router)</span><br><span class="line"><span class="string">navigating :</span> <span class="keyword">boolean</span></span><br><span class="line"><span class="string">lastNavigationAttempt :</span> string</span><br><span class="line"><span class="string">currentInstruction :</span> Instruction</span><br><span class="line"><span class="string">registry :</span> RouteRegistry</span><br><span class="line"><span class="string">parent :</span> Router</span><br><span class="line"><span class="string">hostComponent :</span> any</span><br><span class="line"><span class="string">root :</span> Router</span><br><span class="line">childRouter(<span class="string">hostComponent:</span> any) : Router</span><br><span class="line">auxRouter(<span class="string">hostComponent:</span> any) : Router</span><br><span class="line">registerPrimaryOutlet(<span class="string">outlet:</span> RouterOutlet) : Promise&lt;any&gt;</span><br><span class="line">unregisterPrimaryOutlet(<span class="string">outlet:</span> RouterOutlet) : <span class="keyword">void</span></span><br><span class="line">registerAuxOutlet(<span class="string">outlet:</span> RouterOutlet) : Promise&lt;any&gt;</span><br><span class="line">isRouteActive(<span class="string">instruction:</span> Instruction) : <span class="keyword">boolean</span></span><br><span class="line">config(<span class="string">definitions:</span> RouteDefinition[]) : Promise&lt;any&gt;</span><br><span class="line">navigate(<span class="string">linkParams:</span> any[]) : Promise&lt;any&gt;</span><br><span class="line">navigateByUrl(<span class="string">url:</span> string, _skipLocationChange?: <span class="keyword">boolean</span>) : Promise&lt;any&gt;</span><br><span class="line">navigateByInstruction(<span class="string">instruction:</span> Instruction, _skipLocationChange?: <span class="keyword">boolean</span>) : Promise&lt;any&gt;</span><br><span class="line">commit(<span class="string">instruction:</span> Instruction, _skipLocationChange?: <span class="keyword">boolean</span>) : Promise&lt;any&gt;</span><br><span class="line">subscribe(<span class="string">onNext:</span> (<span class="string">value:</span> any) =&gt; <span class="keyword">void</span>, onError?: (<span class="string">value:</span> any) =&gt; <span class="keyword">void</span>) : Object</span><br><span class="line">deactivate(<span class="string">instruction:</span> Instruction) : Promise&lt;any&gt;</span><br><span class="line">recognize(<span class="string">url:</span> string) : Promise&lt;Instruction&gt;</span><br><span class="line">renavigate() : Promise&lt;any&gt;</span><br><span class="line">generate(<span class="string">linkParams:</span> any[]) : Instruction</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="四、-指令"><a href="#四、-指令" class="headerlink" title="四、 指令"></a>四、 指令</h3><h4 id="1-RouterLink"><a href="#1-RouterLink" class="headerlink" title="1. RouterLink"></a>1. <a href="https://angular.cn/docs/ts/latest/api/router/index/RouterLink-directive.html" target="_blank" rel="noopener">RouterLink</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RouterLink</span> &#123;</span></span><br><span class="line"><span class="string">commands :</span> any[]</span><br><span class="line"><span class="string">queryParams :</span> &#123;[<span class="string">k:</span> string]: any&#125;</span><br><span class="line"><span class="string">fragment :</span> string</span><br><span class="line"><span class="string">urlTree :</span> UrlTree</span><br><span class="line"><span class="string">router :</span> Router</span><br><span class="line"><span class="string">route :</span> ActivatedRoute</span><br><span class="line"><span class="string">locationStrategy :</span> LocationStrategy</span><br><span class="line">routerLink</span><br><span class="line">onClick(<span class="string">button:</span> number, <span class="string">ctrlKey:</span> <span class="keyword">boolean</span>, <span class="string">metaKey:</span> <span class="keyword">boolean</span>) : <span class="keyword">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-RouterLinkActive"><a href="#2-RouterLinkActive" class="headerlink" title="2. RouterLinkActive"></a>2. <a href="https://angular.cn/docs/ts/latest/api/router/index/RouterLinkActive-directive.html" target="_blank" rel="noopener">RouterLinkActive</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RouterLinkActive</span> &#123;</span></span><br><span class="line"><span class="string">links :</span> QueryList&lt;RouterLink&gt;</span><br><span class="line"><span class="string">linksWithHrefs :</span> QueryList&lt;RouterLinkWithHref&gt;</span><br><span class="line"><span class="string">classes :</span> string[]</span><br><span class="line"><span class="string">subscription :</span> Subscription</span><br><span class="line"><span class="string">routerLinkActiveOptions :</span> &#123;<span class="string">exact:</span> <span class="keyword">boolean</span>&#125;</span><br><span class="line"><span class="string">router :</span> Router</span><br><span class="line"><span class="string">element :</span> ElementRef</span><br><span class="line"><span class="string">renderer :</span> Renderer</span><br><span class="line">ngAfterContentInit() : <span class="keyword">void</span></span><br><span class="line">routerLinkActive</span><br><span class="line">ngOnChanges(<span class="string">changes:</span> &#123;&#125;) : any</span><br><span class="line">ngOnDestroy() : any</span><br><span class="line">update() : <span class="keyword">void</span></span><br><span class="line">reduceList(<span class="string">currentUrlTree:</span> UrlTree, <span class="string">q:</span> QueryList&lt;any&gt;) : <span class="keyword">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-RouterLinkWithHref"><a href="#3-RouterLinkWithHref" class="headerlink" title="3. RouterLinkWithHref"></a>3. <a href="https://angular.cn/docs/ts/latest/api/router/index/RouterLinkWithHref-directive.html" target="_blank" rel="noopener">RouterLinkWithHref</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RouterLinkWithHref</span> &#123;</span></span><br><span class="line"><span class="string">target :</span> string</span><br><span class="line"><span class="string">commands :</span> any[]</span><br><span class="line"><span class="string">queryParams :</span> &#123;[<span class="string">k:</span> string]: any&#125;</span><br><span class="line"><span class="string">fragment :</span> string</span><br><span class="line"><span class="string">href :</span> string</span><br><span class="line"><span class="string">urlTree :</span> UrlTree</span><br><span class="line"><span class="string">router :</span> Router</span><br><span class="line"><span class="string">route :</span> ActivatedRoute</span><br><span class="line"><span class="string">locationStrategy :</span> LocationStrategy</span><br><span class="line">routerLink</span><br><span class="line">ngOnChanges(<span class="string">changes:</span> &#123;&#125;) : any</span><br><span class="line">onClick(<span class="string">button:</span> number, <span class="string">ctrlKey:</span> <span class="keyword">boolean</span>, <span class="string">metaKey:</span> <span class="keyword">boolean</span>) : <span class="keyword">boolean</span></span><br><span class="line">updateTargetUrlAndHref() : <span class="keyword">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-RouterOutlet"><a href="#4-RouterOutlet" class="headerlink" title="4. RouterOutlet"></a>4. <a href="https://angular.cn/docs/ts/latest/api/router/index/RouterOutlet-directive.html" target="_blank" rel="noopener">RouterOutlet</a></h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RouterOutlet</span> &#123;</span></span><br><span class="line"><span class="string">activated :</span> ComponentRef&lt;any&gt;</span><br><span class="line"><span class="string">outletMap :</span> RouterOutletMap</span><br><span class="line"><span class="string">location :</span> ViewContainerRef</span><br><span class="line"><span class="string">componentFactoryResolver :</span> ComponentFactoryResolver</span><br><span class="line"><span class="string">isActivated :</span> <span class="keyword">boolean</span></span><br><span class="line"><span class="string">component :</span> Object</span><br><span class="line"><span class="string">activatedRoute :</span> ActivatedRoute</span><br><span class="line">deactivate() : <span class="keyword">void</span></span><br><span class="line">activate(<span class="string">activatedRoute:</span> ActivatedRoute, <span class="string">providers:</span> ResolvedReflectiveProvider[], <span class="string">outletMap:</span> RouterOutletMap) : <span class="keyword">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2 api整理之通用模块]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2ApiCommon/</url>
      <content type="html"><![CDATA[<p>不知不觉接触angular2也有半年时间了，但是对于angular2仍然是一知半解。总觉得应该系统的了解一下它的api，正好ng2马上要有稳定版本了。是时候花一些时间整理一下了<br><a id="more"></a></p>
<h3 id="一、通用包"><a href="#一、通用包" class="headerlink" title="一、通用包"></a>一、通用包</h3><h4 id="1-常量类"><a href="#1-常量类" class="headerlink" title="1. 常量类"></a>1. 常量类</h4><h4 id="1-1-根路径-APP-BASE-HREF"><a href="#1-1-根路径-APP-BASE-HREF" class="headerlink" title="1.1 根路径 APP_BASE_HREF"></a>1.1 根路径 <a href="https://angular.cn/docs/js/latest/api/common/index/APP_BASE_HREF-let.html" target="_blank" rel="noopener">APP_BASE_HREF</a></h4><p>主要作用：在顶层组件中使用bootstrap启动整个app的时候设置根url,格式如下</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">bootstrap(AppCmp, [</span><br><span class="line">  ROUTER_PROVIDERS,</span><br><span class="line">  &#123;<span class="string">provide:</span> APP_BASE_HREF, <span class="string">useValue:</span> <span class="string">'/my/app'</span>&#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<h4 id="1-2-指令常量-COMMON-DIRECTIVES"><a href="#1-2-指令常量-COMMON-DIRECTIVES" class="headerlink" title="1.2 指令常量 COMMON_DIRECTIVES"></a>1.2 指令常量 <a href="https://angular.cn/docs/js/latest/api/common/index/COMMON_DIRECTIVES-let.html" target="_blank" rel="noopener">COMMON_DIRECTIVES</a></h4><p>主要作用：所有核心内置指令的集合：包含NgClass, NgIf, NgFor, NgSwitch, NgSwitchWhen, NgSwitchDefault, NgModel, NgForm等。<br>CORE_DIRECTIVES少了NgModel和NgForm，不过它是稳定的。COMMON_DIRECTIVES还是试验性阶段。<br>单个引入</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;NgClass, NgIf, NgFor, NgSwitch, NgSwitchWhen, NgSwitchDefault, NgModel, NgForm&#125; <span class="keyword">from</span></span><br><span class="line"><span class="string">'@angular/common'</span>;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">'my-component'</span>,</span><br><span class="line">  templateUrl: <span class="string">'myComponent.html'</span>,</span><br><span class="line">  directives: [NgClass, NgIf, NgFor, NgSwitch, NgSwitchWhen, NgSwitchDefault, NgModel, NgForm,</span><br><span class="line">OtherDirective]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>使用常量引入</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;COMMON_DIRECTIVES&#125; <span class="keyword">from</span> <span class="string">'@angular/common'</span>;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">'my-component'</span>,</span><br><span class="line">  templateUrl: <span class="string">'myComponent.html'</span>,</span><br><span class="line">  directives: [COMMON_DIRECTIVES, OtherDirective]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="1-3-管道常量-COMMON-PIPES"><a href="#1-3-管道常量-COMMON-PIPES" class="headerlink" title="1.3 管道常量 COMMON_PIPES"></a>1.3 管道常量 <a href="https://angular.cn/docs/js/latest/api/common/index/COMMON_PIPES-let.html" target="_blank" rel="noopener">COMMON_PIPES</a></h4><p>目前还是试验性的。功能同上，是所有 管道的合集 包含 AsyncPipe、I18nPluralPipe、I18nSelectPipe、SlicePipe等</p>
<h4 id="1-4-表单指令常量-FORM-DIRECTIVES"><a href="#1-4-表单指令常量-FORM-DIRECTIVES" class="headerlink" title="1.4 表单指令常量 FORM_DIRECTIVES"></a>1.4 表单指令常量 <a href="https://angular.cn/docs/js/latest/api/common/index/FORM_DIRECTIVES-let.html" target="_blank" rel="noopener">FORM_DIRECTIVES</a></h4><p>试验阶段。所有有关表常的指令礼盒</p>
<h4 id="1-5-表单提供者常量-FORM-PROVIDERS"><a href="#1-5-表单提供者常量-FORM-PROVIDERS" class="headerlink" title="1.5 表单提供者常量 FORM_PROVIDERS"></a>1.5 表单提供者常量 <a href="https://angular.cn/docs/js/latest/api/common/index/FORM_PROVIDERS-let.html" target="_blank" rel="noopener">FORM_PROVIDERS</a></h4><p>在bootsrap的时候注入进去</p>
<h4 id="1-6-异步验证常量-NG-ASYNC-VALIDATORS"><a href="#1-6-异步验证常量-NG-ASYNC-VALIDATORS" class="headerlink" title="1.6 异步验证常量 NG_ASYNC_VALIDATORS"></a>1.6 异步验证常量 <a href="https://angular.cn/docs/js/latest/api/common/index/NG_ASYNC_VALIDATORS-let.html" target="_blank" rel="noopener">NG_ASYNC_VALIDATORS</a></h4><p>为了控制一个表单的异步验证，要在验证中添加  <code>multi: true</code>,当然也少不了<code>NG_VALIDATORS</code></p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">bootstrap(MyApp, [&#123;<span class="string">provide:</span> NG_VALIDATORS, <span class="string">useValue:</span> myValidator, <span class="string">multi:</span> <span class="literal">true</span>&#125;]);</span><br></pre></td></tr></table></figure>
<h4 id="1-7-值存储器常量-NG-VALUE-ACCESSOR"><a href="#1-7-值存储器常量-NG-VALUE-ACCESSOR" class="headerlink" title="1.7 值存储器常量 NG_VALUE_ACCESSOR"></a>1.7 值存储器常量 <a href="https://angular.cn/docs/js/latest/api/common/index/NG_VALUE_ACCESSOR-let.html" target="_blank" rel="noopener">NG_VALUE_ACCESSOR</a></h4><p>具体作用和使用方法不明确</p>
<h3 id="2、-接口"><a href="#2、-接口" class="headerlink" title="2、 接口"></a>2、 接口</h3><h4 id="2-1-控制值存储器ControlValueAccessor"><a href="#2-1-控制值存储器ControlValueAccessor" class="headerlink" title="2.1 控制值存储器ControlValueAccessor"></a>2.1 控制值存储器<a href="https://angular.cn/docs/js/latest/api/common/index/ControlValueAccessor-interface.html" target="_blank" rel="noopener">ControlValueAccessor</a></h4><p>具体作用和使用方法不明确</p>
<h4 id="2-2-表单-Form"><a href="#2-2-表单-Form" class="headerlink" title="2.2 表单 Form"></a>2.2 表单 <a href="https://angular.cn/docs/js/latest/api/common/index/Form-interface.html" target="_blank" rel="noopener">Form</a></h4><p> NgFormModel 和 NgForm实现在这个接口，只在form模块使用</p>
<h4 id="2-3-路径变化事件-UrlChangeEvent"><a href="#2-3-路径变化事件-UrlChangeEvent" class="headerlink" title="2.3 路径变化事件 UrlChangeEvent"></a>2.3 路径变化事件 <a href="https://angular.cn/docs/js/latest/api/common/index/UrlChangeEvent-interface.html" target="_blank" rel="noopener">UrlChangeEvent</a></h4><p>当监听到URL变化的时候触发此事件</p>
<h4 id="2-4-路径变化监听器-UrlChangeListener"><a href="#2-4-路径变化监听器-UrlChangeListener" class="headerlink" title="2.4 路径变化监听器 UrlChangeListener"></a>2.4 路径变化监听器 <a href="https://angular.cn/docs/js/latest/api/common/index/UrlChangeListener-interface.html" target="_blank" rel="noopener">UrlChangeListener</a></h4><p>监听URL的变化</p>
<h4 id="2-5-验证Validator"><a href="#2-5-验证Validator" class="headerlink" title="2.5 验证Validator"></a>2.5 验证<a href="https://angular.cn/docs/js/latest/api/common/index/Validator-interface.html" target="_blank" rel="noopener">Validator</a></h4><p>在写验证指令的时候实现这个接口</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line"><span class="symbol">  selector:</span> <span class="string">'[custom-validator]'</span>,</span><br><span class="line"><span class="symbol">  providers:</span> [&#123;<span class="string">provide:</span> NG_VALIDATORS, <span class="string">useExisting:</span> CustomValidatorDirective, <span class="string">multi:</span> <span class="literal">true</span>&#125;]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomValidatorDirective</span> <span class="keyword">implements</span> <span class="title">Validator</span> &#123;</span></span><br><span class="line">  validate(<span class="string">c:</span> Control): &#123;[<span class="string">key:</span> string]: any&#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">"custom"</span>: <span class="literal">true</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-类"><a href="#3-类" class="headerlink" title="3. 类"></a>3. 类</h3><h4 id="3-1-抽象控制-AbstractControl"><a href="#3-1-抽象控制-AbstractControl" class="headerlink" title="3.1 抽象控制 AbstractControl"></a>3.1 抽象控制 <a href="https://angular.cn/docs/js/latest/api/common/index/AbstractControl-class.html" target="_blank" rel="noopener">AbstractControl</a></h4>]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[rxjs全接触]]></title>
      <url>https://blog.xiaomo.info/2016/JavascriptRxjsStudy/</url>
      <content type="html"><![CDATA[<p>RxJS是用于通过使用观察序列构成异步和基于事件的程序库。它提供了一个核心类型——<a href="http://reactivex.io/rxjs/manual/overview.html#observable" target="_blank" rel="noopener">Observable</a>（Observer, Schedulers, Subjects）和数组＃其他（map, filter, reduce, every, etc），以允许处理异步事件集合。<br><a id="more"></a></p>
<h3 id="一、rxjs内容"><a href="#一、rxjs内容" class="headerlink" title="一、rxjs内容"></a>一、rxjs内容</h3><p>ReactiveX结合观察者模式与迭代器模式和函数式编程与收藏，以填补管理事件序列的理想方法的需要。</p>
<p>在RxJS其中解决异步事件管理的基本概念是：</p>
<h4 id="1-Observable"><a href="#1-Observable" class="headerlink" title="1. Observable"></a>1. Observable</h4><p>可观察对象，代表未来值或事件的可调用集合的想法.<br>observer是一个由回调函数组成的对象，键名分别为<code>next</code>、<code>error</code> 和 <code>complete</code>，以此接受Observable推送的不同类型的通知。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> observer = &#123;</span><br><span class="line">  next: <span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'Observer got a next value: '</span> + x),</span><br><span class="line">  error: <span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(<span class="string">'Observer got an error: '</span> + err),</span><br><span class="line">  complete: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'Observer got a complete notification'</span>),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>调用Observer逻辑，只需在subscribe（订阅）Observable后将Observer传入：<code>observable.subscribe(observer);</code></p>
<h4 id="2-Observer"><a href="#2-Observer" class="headerlink" title="2. Observer"></a>2. Observer</h4><p>观察者，也被称为称为消费者，是回调的集合，它知道如何监听由观测交付价值</p>
<h4 id="3-Subscription"><a href="#3-Subscription" class="headerlink" title="3. Subscription"></a>3. Subscription</h4><p>Subscription是一个代表可以终止资源的对象，表示一个Observable的执行过程。Subscription有一个重要的方法：unsubscribe。这个方法不需要传入参数，调用后便会终止相应的资源。</p>
<h4 id="4-Operators"><a href="#4-Operators" class="headerlink" title="4. Operators"></a>4. Operators</h4><p>操作者，是一种纯函数，能够使用函数式编程风格处理集合，具体操作有map, filter, concat, flatMap,等</p>
<h4 id="5-Subject"><a href="#5-Subject" class="headerlink" title="5. Subject"></a>5. Subject</h4><p>在RxJS中，Subject是一类特殊的Observable，它可以向多个Observer多路推送数值。普通的Observable并不具备多路推送的能力（每一个Observer都有自己独立的执行环境），而Subject可以共享一个执行环境。Subject是一种可以多路推送的可观察对象。与EventEmitter类似，Subject维护着自己的Observer。<br>每一个Subject都是一个Observable（可观察对象） 对于一个Subject，你可以订阅（subscribe）它，Observer会和往常一样接收到数据。从Observer的视角看，它并不能区分自己的执行环境是普通Observable的单路推送还是基于Subject的多路推送。<br>每一个Subject也可以作为Observer（观察者） Subject同样也是一个由next(v)，error(e)，和 complete()这些方法组成的对象。调用next(theValue)方法后，Subject会向所有已经在其上注册的Observer多路推送theValue。</p>
<h4 id="6-Schedulers"><a href="#6-Schedulers" class="headerlink" title="6. Schedulers"></a>6. Schedulers</h4><p>调度器，是用于控制并发的中心分发器，当计算发生在setTimeout or requestAnimationFrame 时，允许我们来进行协调。</p>
<h4 id="7、推和拉"><a href="#7、推和拉" class="headerlink" title="7、推和拉"></a>7、推和拉</h4><p>拉和推是两个不同的协议如何数据生产者可以与数据消费者。</p>
<p>拉<br>数据消费者可以决定什么时候去接收数据提供者的数据。数据提供者自身并不知道什么时候把数据交给数据消费者。<br>每个JavaScript函数是一个拉式系统。该功能是数据的生产者，而调用该函数的代码由“揪”出了消费它单从它调用的返回值。</p>
<p>推<br>在推送系统，生产者确定何时发送数据到消费者。消费者是不知道什么时候会收到的数据。<br>在JavaScript中目前Promises是最常用的推系统类型。 一个Promises(提供者)传递了一个处理好的值然后注册一个回调(消费者)。但是跟方法不同，它是应许，负责确定正是当值被“推”到了回调。</p>
<h3 id="二、相关api"><a href="#二、相关api" class="headerlink" title="二、相关api"></a>二、相关api</h3><h4 id="1-scan"><a href="#1-scan" class="headerlink" title="1. scan()"></a>1. scan()</h4><p>使用RxJS您隔离的状态。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">var button = document . querySelector ( <span class="string">'button'</span> );</span><br><span class="line">Rx . Observable . fromEvent ( button ,  <span class="string">'click'</span> )</span><br><span class="line">  . scan ( count =&gt; count +  1 ,  0 )</span><br><span class="line">  . subscribe ( count =&gt;<span class="built_in"> console </span>. log ( <span class="string">'Clicked &#123;$ count&#125;次'</span> ））;</span><br></pre></td></tr></table></figure>
<h4 id="2-subscribe"><a href="#2-subscribe" class="headerlink" title="2. subscribe()"></a>2. subscribe()</h4><p>异步函数，可以使用一个回调</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">var button = document . querySelector ( <span class="string">'button'</span> );</span><br><span class="line">Rx . Observable . fromEvent ( button ,  <span class="string">'click'</span> )</span><br><span class="line">  . subscribe (()  =&gt;<span class="built_in"> console </span>. log ( <span class="string">'Clicked!'</span> ));</span><br></pre></td></tr></table></figure>
<h4 id="3-throttle"><a href="#3-throttle" class="headerlink" title="3. throttle()"></a>3. throttle()</h4><h4 id="4-map"><a href="#4-map" class="headerlink" title="4. map()"></a>4. map()</h4><p>每秒最多点击次数</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">var button = document . querySelector ( <span class="string">'button'</span> );</span><br><span class="line">Rx . Observable . fromEvent ( button ,  <span class="string">'click'</span> )</span><br><span class="line">  . throttle ( 1000 )</span><br><span class="line">  . map ( event  =&gt;  event . clientX )</span><br><span class="line">  . scan (( count , clientX )  =&gt; count + clientX ,  0 )</span><br><span class="line">  . subscribe ( count =&gt;<span class="built_in"> console </span>. log ( count ));</span><br></pre></td></tr></table></figure>
<h3 id="三、具体使用"><a href="#三、具体使用" class="headerlink" title="三、具体使用"></a>三、具体使用</h3><h4 id="1-Observable-1"><a href="#1-Observable-1" class="headerlink" title="1. Observable"></a>1. Observable</h4><p>我们定义一个observable，前3个是步同执行。第四个是1秒后执行(异步)，执行完4之后整个observable才算完成。<br><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">var observable =  Rx . Observable . <span class="built_in">create</span> ( <span class="function"><span class="keyword">function</span>  <span class="params">( observer )</span></span>  &#123;</span><br><span class="line">  observer . <span class="built_in">next</span> ( <span class="number">1</span> );</span><br><span class="line">  observer . <span class="built_in">next</span> ( <span class="number">2</span> );</span><br><span class="line">  observer . <span class="built_in">next</span> ( <span class="number">3</span> );</span><br><span class="line">  setTimeout (()  =&gt;  &#123;</span><br><span class="line">    observer . <span class="built_in">next</span> ( <span class="number">4</span> );</span><br><span class="line">    observer . complete ();</span><br><span class="line">  &#125;,  <span class="number">1000</span> );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="2-subscribe-1"><a href="#2-subscribe-1" class="headerlink" title="2.subscribe"></a>2.subscribe</h4><p>为了能够看到这些值，我们需要订阅(subscribe)它。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'just before subscribe'</span>);</span><br><span class="line">observable.subscribe(&#123;</span><br><span class="line">  next: <span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'got value '</span> + x),</span><br><span class="line">  error: <span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(<span class="string">'something wrong occurred: '</span> + err),</span><br><span class="line">  complete: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'done'</span>),</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'just after subscribe'</span>);</span><br></pre></td></tr></table></figure>
<p>结果如下</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">just <span class="keyword">before</span> subscribe</span><br><span class="line">got <span class="built_in">value</span> <span class="number">1</span></span><br><span class="line">got <span class="built_in">value</span> <span class="number">2</span></span><br><span class="line">got <span class="built_in">value</span> <span class="number">3</span></span><br><span class="line">just <span class="keyword">after</span> subscribe</span><br><span class="line">got <span class="built_in">value</span> <span class="number">4</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>通过结果我们可以观察到，前三个执行之后就直接跳出订阅范围，等1秒钟之后才执行4，然后才完成。</p>
<h4 id="3、amb方法"><a href="#3、amb方法" class="headerlink" title="3、amb方法"></a>3、amb方法</h4><p><code>方法定义</code><br><code>[Rx.Observable.amb(...args)]</code><br><code>作用</code><br>从一系列流中，订阅最先发射的值的可观察对象并忽略其他的可观察对象。<br><code>参数</code><br>args (Array|arguments)：方法参数为多个可观察对象（流），或者是Promise对象，对象间存在竞争关系。<br><code>返回值</code><br>(Observable) ：方法返回呈竞争态的多个可观察对象中，首先发射的可观察对象。<br><code>总结</code><br>简单的说，<code>amb()</code>像一个多路电闸，一次仅能构建一条通路：</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">A B C D E F G H</span><br><span class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">     \</span><br><span class="line">      \   开关臂</span><br><span class="line">       \   </span><br><span class="line">       |</span><br><span class="line"><span class="string">      主线</span></span><br><span class="line"><span class="string">       </span>|</span><br></pre></td></tr></table></figure>
<p>实例</p>
<p>HTML<br><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="symbol">&lt;body&gt;</span></span><br><span class="line">  &lt;<span class="built_in">input</span> id=<span class="string">"input1"</span> <span class="built_in">type</span>=<span class="string">"text"</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">input</span> id=<span class="string">"input2"</span> <span class="built_in">type</span>=<span class="string">"text"</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>
<p>JS<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 取元素</span></span><br><span class="line"><span class="keyword">var</span> input1 = $(<span class="string">'#input1'</span>);</span><br><span class="line"><span class="keyword">var</span> input2 = $(<span class="string">'#input2'</span>);</span><br><span class="line"><span class="comment">// 定义事件流</span></span><br><span class="line"><span class="keyword">var</span> event1 = Rx.Observable.fromEvent(input1, <span class="string">'click'</span>).map(<span class="function"><span class="params">()</span>=&gt;</span><span class="string">'one'</span>)</span><br><span class="line"><span class="keyword">var</span> event2 = Rx.Observable.fromEvent(input2, <span class="string">'click'</span>).map(<span class="function"><span class="params">()</span>=&gt;</span><span class="string">'two'</span>);</span><br><span class="line"><span class="comment">//传入事件流</span></span><br><span class="line"><span class="keyword">var</span> source = Rx.Observable.amb(event1,event2);</span><br></pre></td></tr></table></figure></p>
<p>上面例子中<br><code>amb()</code>中传入了两个点击事件流。<br>事件流1，会在点击后发射字符串one；<br>事件流2，会在点击后发射字符串two；<br>初始情况下，产生事件流1之后，事件流2不会再被输出；<br>反之亦然，我们可以订阅<code>amb()</code>产生的结果流：<a href="http://jsbin.com/pitayi/edit?html,js,console,output" target="_blank" rel="noopener">amb()操作符演示</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> subscription = source.subscribe(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(x);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Error: '</span> + err);   </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Completed'</span>);   </span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>使用场景 1：秒杀</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Observable.amb(</span><br><span class="line">    用户A的拍下请求,</span><br><span class="line">    用户B的拍下请求,</span><br><span class="line">    用户C的拍下请求,</span><br><span class="line">    ...</span><br><span class="line">).subscribe(<span class="function"><span class="keyword">function</span><span class="params">(user)</span> </span>&#123;</span><br><span class="line">    执行购买逻辑，创建订单，打开支付工具</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>使用场景 1：通话</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Observable.amb(</span><br><span class="line">    A来电,</span><br><span class="line">    B来电,</span><br><span class="line">    C来电,</span><br><span class="line">    ...</span><br><span class="line">).subscribe(<span class="function"><span class="keyword">function</span><span class="params">(call)</span> </span>&#123;</span><br><span class="line">    通话</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="4-case方法"><a href="#4-case方法" class="headerlink" title="4. case方法"></a>4. case方法</h4><p><code>方法定义</code><br><code>[Rx.Observable.case(selector, sources, [elseSource|scheduler])]</code></p>
<p><code>作用</code><br>选择序列中特定可观察对象进行订阅，在特定可观察对象不存在的情况下，返回传入的默认可观察对象。</p>
<p><code>参数</code><br><code>selector (Function)</code>: 返回键的字符串的函数，键用以与sources中的键名进行比较。<br><code>sources (Object)</code>: 一个包含可观察对象的Javascript对象。<br><code>[elseSource|scheduler] (Observable | Scheduler)</code>:当selector无法匹配sources时，该对象被默认返回。 如果没有明确指定，将返回附加了指定scheduler的<code>Rx.Observabe.empty</code> 对象。</p>
<p><code>返回值</code><br>(Observable): 返回值为经过选择后的Observable（可观察对象）。</p>
<p><code>实例</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sources = &#123;</span><br><span class="line">  hello: Rx.Observable.just(<span class="string">'clx'</span>),</span><br><span class="line">  world: Rx.Observable.just(<span class="string">'wxq'</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> subscription = Rx.Observable.case(<span class="function"><span class="params">()</span>=&gt;</span><span class="string">"hello"</span>, sources, Rx.Observable.empty())</span><br><span class="line"></span><br><span class="line">subscription.subscribe(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>实例中，匿名函数()=&gt;”hello”指定需要在sources中返回的可观察对象的键名为”hello”，命令行最终输出”clx”，<a href="https://jsbin.com/kodije/edit?js,console,output" target="_blank" rel="noopener">点击进入case()实例</a>。</p>
<p>适用场景<br>针对表单进行校验，校验用户的<code>手机号</code>和<code>邮箱</code>是否和服务器记录重复，将所有校验封装在validate对象中结构更为合理：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> validate = &#123;</span><br><span class="line">    <span class="string">"mobile"</span>: Observable.<span class="keyword">return</span>(<span class="string">'123-566-789-01'</span>),</span><br><span class="line">    <span class="string">"email"</span>: Observable.<span class="keyword">return</span>(<span class="string">'JonSnow@company.com'</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> emptyObserable = Observable.<span class="keyword">empty</span>();</span><br><span class="line">validate.<span class="keyword">case</span>(()=&gt;<span class="string">'mobile'</span>, validate, <span class="keyword">empty</span>)</span><br><span class="line">    .subscribe(<span class="function"><span class="keyword">function</span><span class="params">(mobile)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 验证手机号码是否重复</span></span><br><span class="line">    &#125;)</span><br><span class="line">validate.<span class="keyword">case</span>(()=&gt;<span class="string">'email'</span>, validate, <span class="keyword">empty</span>)</span><br><span class="line">    .subscribe(<span class="function"><span class="keyword">function</span><span class="params">(email)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 验证用户邮箱是否重复</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="4-catch-方法"><a href="#4-catch-方法" class="headerlink" title="4. catch()方法"></a>4. catch()方法</h4><p><code>方法定义</code><br>Rx.Observable.catch(…args)</p>
<p><code>作用</code><br>序列中可观察对象因为异常而被终止后，继续订阅序列中的其他可观察对象。</p>
<p><code>参数</code><br>args (Array | arguments): 可观察对象序列。</p>
<p><code>返回值</code><br>(Observable): 可观察对象序列中能够正确终止，不抛出异常的第一个可观察对象。</p>
<p>实例</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obs1 = Rx.Observable.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error'</span>));</span><br><span class="line"><span class="keyword">var</span> obs2 = Rx.Observable.return(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> source = Rx.Observable.catch(obs1, obs2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> subscription = source.subscribe(</span><br><span class="line">  x =&gt; <span class="built_in">console</span>.log(<span class="string">`onNext: <span class="subst">$&#123;x&#125;</span>`</span>),</span><br><span class="line">  e =&gt; <span class="built_in">console</span>.log(<span class="string">`onError: <span class="subst">$&#123;e&#125;</span>`</span>),</span><br><span class="line">  () =&gt; <span class="built_in">console</span>.log(<span class="string">'onCompleted'</span>));</span><br></pre></td></tr></table></figure>
<p>手机验证码实例<br>这样，用户能够收到验证码并成功验证的几率大大增加。</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> service1 = Observable.create(<span class="string">"服务提供商#1"</span>);</span><br><span class="line"><span class="keyword">var</span> service2 = Observable.create(<span class="string">"服务提供商#1"</span>);</span><br><span class="line"></span><br><span class="line">Observable.<span class="keyword">catch</span>(service1, service2).subscribe(&#123;</span><br><span class="line">    ()=&gt;<span class="built_in">console</span>.log(<span class="string">'succeed'</span>),</span><br><span class="line">    ()=&gt;<span class="built_in">console</span>.log(<span class="string">'所有验证服务均不可用'</span>)</span><br><span class="line">    ()=&gt;<span class="built_in">console</span>.log(<span class="string">'completed'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5-combineLatest方法"><a href="#5-combineLatest方法" class="headerlink" title="5. combineLatest方法"></a>5. combineLatest方法</h4><p><code>方法定义</code><br>Rx.Observable.combineLatest(…args, [resultSelector])</p>
<p><code>作用</code><br>通过处理函数总是将指定的可观察对象序列中最新发射的值合并为一个可观察对象。</p>
<p><code>参数</code><br><code>args (arguments | Array)</code>: 一系列可观察对象或可观察对象的数组。<br><code>[resultSelector] (Function)</code>: 在所有可观察对象都发射值后调用的处理函数。</p>
<p><code>返回值</code><br>(Observable): 由传入的可观察序列经过处理函数合并后的结果组成的可观察序列。</p>
<p>实例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="string">"紫色"</span>,<span class="string">"黄色"</span>,<span class="string">"蓝色"</span>,<span class="string">"黑色"</span>];</span><br><span class="line"><span class="keyword">var</span> shapes = [<span class="string">"小星星"</span>,<span class="string">"圆形"</span>,<span class="string">"三角形"</span>,<span class="string">"正方形"</span>,<span class="string">"心形"</span>,<span class="string">"五边形"</span>];</span><br><span class="line"><span class="keyword">var</span> source1 = Rx.Observable.interval(<span class="number">3000</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">()</span>=&gt;</span>colors.pop());</span><br><span class="line"><span class="keyword">var</span> source2 = Rx.Observable.interval(<span class="number">2000</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">()</span>=&gt;</span>shapes.pop());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> combined = Rx.Observable.combineLatest(source1, source2, <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + <span class="string">"的"</span> + y;</span><br><span class="line">&#125;).take(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">combined.subscribe(<span class="function">(<span class="params">shaped</span>)=&gt;</span><span class="built_in">console</span>.log(shaped));</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> rxjs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript设计模式]]></title>
      <url>https://blog.xiaomo.info/2016/JavascriptDesignPattern/</url>
      <content type="html"><![CDATA[<p>设计模式是一套反复使用的、思想成熟、经过分类和无数实战总结出来的。使用设计模式是为了让代码可重用、可扩展、可解藕、更容易让人理解并且有保证代码的可靠性。设计模式能够真正工程化，设计模式是软件工程的基石脉络，如同大厦的结构一样。只有夯实基础结构，才能盖好健壮的大楼。 也是我们迈向高级开发人员必经的一步。<br><a id="more"></a></p>
<h3 id="一、设计原则"><a href="#一、设计原则" class="headerlink" title="一、设计原则"></a>一、设计原则</h3><h4 id="1-开闭原则"><a href="#1-开闭原则" class="headerlink" title="1. 开闭原则"></a>1. 开闭原则</h4><p>对扩展开发，对修改关闭。</p>
<h4 id="2-里氏替换原则"><a href="#2-里氏替换原则" class="headerlink" title="2.  里氏替换原则"></a>2.  里氏替换原则</h4><p>子类继承父类，但单独调用完全可以运行。</p>
<h4 id="3-依赖倒转原则"><a href="#3-依赖倒转原则" class="headerlink" title="3. 依赖倒转原则"></a>3. 依赖倒转原则</h4><p>引用一个对象，如果这个对象有低层类型，直接引用低层。</p>
<h4 id="4-接口隔离原则"><a href="#4-接口隔离原则" class="headerlink" title="4. 接口隔离原则"></a>4. 接口隔离原则</h4><p>每一个接口应该是一种角色。</p>
<h4 id="5-合成-聚合复用原则"><a href="#5-合成-聚合复用原则" class="headerlink" title="5. 合成/聚合复用原则"></a>5. 合成/聚合复用原则</h4><p>新的对象应使用一些己有的对象，使之成为新对象的一部分。</p>
<h4 id="6-迪米特原则"><a href="#6-迪米特原则" class="headerlink" title="6. 迪米特原则"></a>6. 迪米特原则</h4><p>一个对象在对其他对象尽可能少的了解。</p>
<h3 id="二、-设计模式"><a href="#二、-设计模式" class="headerlink" title="二、 设计模式"></a>二、 设计模式</h3><h4 id="1-原型模式"><a href="#1-原型模式" class="headerlink" title="1. 原型模式"></a>1. 原型模式</h4><p>概念：和javascript的prototype不同<br>prototype是指原型实例(new)指向创建对象的种类，并且通过拷贝这些原型创建新的对象。如克隆</p>
<p>作用：<br>原型对象本身就是有效的利用了每个构造器创建的对象</p>
<p>注意事项：<br>注意深拷贝和浅拷贝，以免出现引用问题。</p>
<p>代码实战和总结：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//声明一个对象</span></span><br><span class="line">  <span class="keyword">var</span> myObj = &#123;</span><br><span class="line">    str:<span class="string">'myStr'</span>,</span><br><span class="line">    num:<span class="number">1</span>,</span><br><span class="line">    myArr:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br><span class="line">    myObj:&#123;</span><br><span class="line">      innerObj:&#123;</span><br><span class="line">        test:<span class="number">25</span></span><br><span class="line">      &#125;,</span><br><span class="line">      innerStr:<span class="string">'innerStr'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//拷贝对象的方法（浅拷贝）会影响原型</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">clone</span> (<span class="params">obj</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = &#123;&#125;;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> obj)&#123;</span><br><span class="line">        ret[k]= obj[k];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//深拷贝  使用Object.create</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">result</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">  result.prototype = <span class="built_in">Object</span>.create(myObj);</span><br><span class="line">  <span class="keyword">var</span> _result = <span class="keyword">new</span> result();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//执行</span></span><br><span class="line">  <span class="keyword">var</span> result = clone(myObj);</span><br><span class="line">  result.myObj.innerStr = <span class="string">'outStr'</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br></pre></td></tr></table></figure>
<p>Object.create(prototype,optionalDescriptorObjects)</p>
<h4 id="2-策略模式"><a href="#2-策略模式" class="headerlink" title="2. 策略模式"></a>2. 策略模式</h4><p>概念：<br>策略模式定义了算法家族，分别封装起来，让它们之间可以相互替换，此模式让算法的变化不会影响到使用算法的客户。（目标一致，顺序不同，例如：田忌赛马）</p>
<p>作用：<br>所有的这些算法都是做相同的事情，只是实现不同。<br>以相同的方法调用所有的方法，减少了各种算法在和使用算法类之间的耦合。<br>单独定义了算法类，也方便单元测试。</p>
<p>注意事项：<br>不仅可以封装算法，也可以封装几乎任何类型的规则，是要在分析过程中需要在不同时间应用不同的规则， 可以考虑使用策略模式</p>
<p>代码实战和总结</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">  <span class="comment">//普通的验证</span></span><br><span class="line">  <span class="keyword">var</span> $input = $(<span class="string">'input'</span>).val();</span><br><span class="line">  <span class="keyword">var</span> val = &#123;</span><br><span class="line">    isEmpty:<span class="function"><span class="keyword">function</span><span class="params">(argument)</span></span>&#123;</span><br><span class="line">      <span class="comment">// code</span></span><br><span class="line">    &#125;</span><br><span class="line">    isTel:<span class="function"><span class="keyword">function</span><span class="params">(argument)</span></span>&#123;</span><br><span class="line">      <span class="comment">// code</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> ise = val.isEmpty($input);</span><br><span class="line">  <span class="keyword">var</span> isTel = val.isTel($input)</span><br><span class="line">  <span class="keyword">if</span>(ise &amp;&amp; isTel)&#123;</span><br><span class="line">    alert(<span class="string">'ok'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载到$fn.val上   典型的策略模式验证</span></span><br><span class="line">  $input(&#123;</span><br><span class="line">    isEmpty:<span class="keyword">false</span>,</span><br><span class="line">    isTel:<span class="keyword">True</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="3-组合模式"><a href="#3-组合模式" class="headerlink" title="3. 组合模式"></a>3. 组合模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结：</p>
<h4 id="4-外观模式"><a href="#4-外观模式" class="headerlink" title="4. 外观模式"></a>4. 外观模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="5-迭代器模式"><a href="#5-迭代器模式" class="headerlink" title="5. 迭代器模式"></a>5. 迭代器模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="6-命令模式"><a href="#6-命令模式" class="headerlink" title="6. 命令模式"></a>6. 命令模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="7-代理模式"><a href="#7-代理模式" class="headerlink" title="7. 代理模式"></a>7. 代理模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="8-适配器模式"><a href="#8-适配器模式" class="headerlink" title="8. 适配器模式"></a>8. 适配器模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="9-责任链模式"><a href="#9-责任链模式" class="headerlink" title="9. 责任链模式"></a>9. 责任链模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="10-工厂模式"><a href="#10-工厂模式" class="headerlink" title="10. 工厂模式"></a>10. 工厂模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="11-单例模式"><a href="#11-单例模式" class="headerlink" title="11. 单例模式"></a>11. 单例模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="12-观察者模式"><a href="#12-观察者模式" class="headerlink" title="12. 观察者模式"></a>12. 观察者模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="13-中介者模式"><a href="#13-中介者模式" class="headerlink" title="13. 中介者模式"></a>13. 中介者模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="14-装饰者模式"><a href="#14-装饰者模式" class="headerlink" title="14. 装饰者模式"></a>14. 装饰者模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="15-建造者模式"><a href="#15-建造者模式" class="headerlink" title="15. 建造者模式"></a>15. 建造者模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
<h4 id="16-构造函数模式"><a href="#16-构造函数模式" class="headerlink" title="16. 构造函数模式"></a>16. 构造函数模式</h4><p>概念：</p>
<p>作用：</p>
<p>注意事项：</p>
<p>代码实战和总结</p>
]]></content>
      
        <categories>
            
            <category> javascript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[5年学习计划]]></title>
      <url>https://blog.xiaomo.info/2016/2016StudyPlan/</url>
      <content type="html"><![CDATA[<p>2015年，软件开发界发生了很多变化。有很多流行的新语言发布了，也有很多重要的框架和工具发布了新版本。下面有一个我们觉得最重要的简短清单，同时也有我们觉得值得你在2016年花时间精力去学习的新事物的一些建议。<br><a id="more"></a></p>
<h3 id="一、开发工具"><a href="#一、开发工具" class="headerlink" title="一、开发工具"></a>一、开发工具</h3><h4 id="1-atom"><a href="#1-atom" class="headerlink" title="1. atom"></a>1. atom</h4><p>Atom 代码编辑器支持 Windows、Mac、Linux 三大桌面平台，完全免费，并且已经在 GitHub 上开放了全部的源代码。在经过一段长时间的迭代开发和不断改进后，Atom 终于从早期的测试版达到了 1.0 正式版了！相比之前的版本，在性能和稳定性方面都有着显著的改善。</p>
<h4 id="2-idea"><a href="#2-idea" class="headerlink" title="2. idea"></a>2. idea</h4><p>IDEA 全称IntelliJ IDEA，是java语言开发的集成环境，IntelliJ在业界被公认为最好的java开发工具之一，尤其在智能代码助手、代码自动提示、重构、J2EE支持、Ant、JUnit、CVS整合、代码审查、 创新的GUI设计等方面的功能可以说是超常的。IDEA是JetBrains公司的产品，这家公司总部位于捷克共和国的首都布拉格，开发人员以严谨著称的东欧程序员为主。</p>
<h4 id="3-eclipse"><a href="#3-eclipse" class="headerlink" title="3. eclipse"></a>3. eclipse</h4><p>虽然用上了IDEA之后再也不想回到eclipse。虽然它恶心，但是它毕竟伴随了很多程序员大部分时间，给点最起码的尊重。</p>
<h4 id="4-lodash"><a href="#4-lodash" class="headerlink" title="4. lodash"></a>4. lodash</h4><p>lodash一开始是Underscore.js库的一个fork，因为和其他(Underscore.js的)贡献者意见相左。John-David Dalton的最初目标，是提供更多“一致的跨浏览器行为……，并改善性能”。之后，该项目在现有成功的基础之上取得了更大的成果。最近lodash也发布了3.5版，成为了npm包仓库中依赖最多的库。它正在摆脱屌丝身份，成为开发者的常规的选择之一。</p>
<h4 id="5-fetch"><a href="#5-fetch" class="headerlink" title="5. fetch"></a>5. fetch</h4><p>对于 AJAX，现在一般都是使用各种框架实现，其本质是 XMLHttpRequest。使用过原生XMLHttpRequest的人都知道，这种方法实现起来不太方便。现在，我们有了新的选择：Fetch API。</p>
<h4 id="6-Electron"><a href="#6-Electron" class="headerlink" title="6. Electron"></a>6. Electron</h4><p>Electron 框架的前身是 Atom Shell，可以让你写使用 JavaScript，HTML 和 CSS 构建跨平台的桌面应用程序。它是基于io.js 和 Chromium 开源项目，并用于在 Atom 编辑器中。Electron 是开源的，由 GitHub 维护，有一个活跃的社区。最重要的是，Electron 应用服务构建和运行在 Mac，Windows 和 Linux。</p>
<h3 id="二、javascript框架"><a href="#二、javascript框架" class="headerlink" title="二、javascript框架"></a>二、javascript框架</h3><h4 id="1-angular2"><a href="#1-angular2" class="headerlink" title="1. angular2"></a>1. angular2</h4><h5 id="跨平台开发"><a href="#跨平台开发" class="headerlink" title="跨平台开发"></a>跨平台开发</h5><p>学习如何基于 Angular 构建应用程序，并复用代码和技能来构建适用于所有平台的应用。比如： Web 应用、移动 Web 应用、原生移动应用和原生桌面应用等。</p>
<h5 id="速度与性能"><a href="#速度与性能" class="headerlink" title="速度与性能"></a>速度与性能</h5><p>通过 Web Worker 和服务端渲染，达到在如今 ( 以及未来）的 Web 平台上所能达到的最高速度。<br>Angular 让你有效掌控可伸缩性。基于 RxJS 、 Immutable.js 和其它推送模型，能适应海量数据需求。</p>
<h5 id="美妙的工具"><a href="#美妙的工具" class="headerlink" title="美妙的工具"></a>美妙的工具</h5><p>使用简单的声明式模板，快速实现各种特性。使用自定义组件和大量现有组件，扩展模板语言。在几乎所有的 IDE 中获得针对 Angular 的即时帮助和反馈。所有这一切，都是为了帮助你编写漂亮的应用，而不是绞尽脑汁的让代码“能用”。</p>
<h4 id="2-react-redux"><a href="#2-react-redux" class="headerlink" title="2. react+redux"></a>2. react+redux</h4><p>React+Redux非常精炼，良好运用将发挥出极强劲的生产力。但最大的挑战来自于函数式编程（FP）范式。在工程化过程中，架构（顶层）设计将是一个巨大的挑战。要不然做出来的东西可能是一团乱麻。说到底，传统框架与react+redux就是OO与FP编程范式的对决。</p>
<h4 id="3-jquery"><a href="#3-jquery" class="headerlink" title="3. jquery"></a>3. jquery</h4><p>JQuery是继prototype之后又一个优秀的Javascript库。它是轻量级的js库 ，它兼容CSS3，还兼容各种浏览器（IE 6.0+, FF 1.5+, Safari 2.0+, Opera 9.0+），jQuery2.0及后续版本将不再支持IE6/7/8浏览器。</p>
<h3 id="三、node相关技术"><a href="#三、node相关技术" class="headerlink" title="三、node相关技术"></a>三、node相关技术</h3><h4 id="1-npm"><a href="#1-npm" class="headerlink" title="1. npm"></a>1. npm</h4><p>NPM（node package manager），通常称为node包管理器。顾名思义，它的主要功能就是管理node包，包括：安装、卸载、更新、查看、搜索、发布等。</p>
<h4 id="2-koa2"><a href="#2-koa2" class="headerlink" title="2. koa2"></a>2. koa2</h4><p>koa 是由 Express 原班人马打造的，致力于成为一个更小、更富有表现力、更健壮的 Web 框架。使用 koa 编写 web 应用，通过组合不同的 generator，可以免除重复繁琐的回调函数嵌套，并极大地提升错误处理的效率。koa 不在内核方法中绑定任何中间件，它仅仅提供了一个轻量优雅的函数库，使得编写 Web 应用变得得心应手。</p>
<h4 id="3-rxjs"><a href="#3-rxjs" class="headerlink" title="3. rxjs"></a>3. rxjs</h4><p>是一组库使用可观察到的集合和阵列、演员风格组成，组成异步和基于事件的程序。</p>
<h4 id="4-zonejs"><a href="#4-zonejs" class="headerlink" title="4. zonejs"></a>4. zonejs</h4><p>在ng2的开发过程中，Angular团队为我们带来了一个新的库 – zone.js。zone.js的设计灵感来源于Dart语言，它描述JavaScript执行过程的上下文，可以在异步任务之间进行持久性传递，它类似于Java中的TLS（thread-local storage: 线程本地存储）技术，zone.js则是将TLS引入到JavaScript语言中的实现框架。</p>
<h3 id="四、设计模式"><a href="#四、设计模式" class="headerlink" title="四、设计模式"></a>四、设计模式</h3><h4 id="1-javascript设计模式"><a href="#1-javascript设计模式" class="headerlink" title="1. javascript设计模式"></a>1. <a href="https://xiaomo.info/2016/07/02/javascript_design_pattern/" target="_blank" rel="noopener">javascript设计模式</a></h4><h4 id="2-java设计模式"><a href="#2-java设计模式" class="headerlink" title="2. java设计模式"></a>2. java设计模式</h4><h3 id="五、编程语言"><a href="#五、编程语言" class="headerlink" title="五、编程语言"></a>五、编程语言</h3><h4 id="1-javascript"><a href="#1-javascript" class="headerlink" title="1. javascript"></a>1. javascript</h4><p>JavaScript一种直译式脚本语言，是一种动态类型、弱类型、基于原型的语言，内置支持类型。它的解释器被称为JavaScript引擎，为浏览器的一部分，广泛用于客户端的脚本语言，最早是在HTML（标准通用标记语言下的一个应用）网页上使用，用来给HTML网页增加动态功能。</p>
<h4 id="2-ecmscript6"><a href="#2-ecmscript6" class="headerlink" title="2. ecmscript6"></a>2. ecmscript6</h4><p>ES6是继ES5之后的一次主要改进，语言规范由ES5.1时代的245页扩充至600页。ES6增添了许多必要的特性，例如：模块和类，以及一些实用特性，例如Maps、Sets、Promises、生成器（Generators）等。尽管ES6做了大量的更新，但是它依旧完全向后兼容以前的版本，标准化委员会决定避免由不兼容版本语言导致的“web体验破碎”。结果是，所有老代码都可以正常运行，整个过渡也显得更为平滑，但随之而来的问题是，开发者们抱怨了多年的老问题依然存在。</p>
<h4 id="3-typesript"><a href="#3-typesript" class="headerlink" title="3. typesript"></a>3. typesript</h4><p>typescript是JavaScript的超集。TypeScript是JavaScript类型的超集，它可以编译成纯JavaScript。TypeScript可以在任何浏览器、任何计算机和任何操作系统上运行，并且是开源的。</p>
<h4 id="4-java"><a href="#4-java" class="headerlink" title="4. java"></a>4. java</h4><p>java是继c/c++使用最广泛的开发语言，写java真的是越写越觉得舒服。java生态环境十分良好，有大量优秀的开源框架以供选择。</p>
<h5 id="1-spring"><a href="#1-spring" class="headerlink" title="1. spring"></a>1. spring</h5><p>Spring 是一个开源框架，是为了解决企业应用程序开发复杂性而创建的。框架的主要优势之一就是其分层架构，分层架构允许您选择使用哪一个组件，同时为 J2EE 应用程序开发提供集成的框架。 </p>
<h5 id="2-struts2"><a href="#2-struts2" class="headerlink" title="2. struts2"></a>2. struts2</h5><p>Struts2框架是一个轻量级的MVC流程框架，轻量级是指程序的代码不是很多，运行时占用的资源不是很多，MVC流程框架就是说它是支持分层开发，控制数据的流程，从哪里来，到那里去，怎么来，怎么去的这样一个框架</p>
<h5 id="3-hibernate"><a href="#3-hibernate" class="headerlink" title="3. hibernate"></a>3. hibernate</h5><p>hibernate是轻量级JavaEE应用的一个持久层框架。它的作用在于管理Java实体类到数据库表之间的映射关系，并且提供数据查询和获取数据的方法，可以大幅度的缩短使用JDBC处理数据持久化的时间。</p>
<h5 id="4-mybatis"><a href="#4-mybatis" class="headerlink" title="4. mybatis"></a>4. mybatis</h5><p>一个基于Java的持久层框架。iBATIS提供的持久层框架包括SQL Maps和Data Access Objects（DAO），同时还提供一个利用这个框架开发的 JPetStore实例</p>
<h5 id="5-springMVC"><a href="#5-springMVC" class="headerlink" title="5. springMVC"></a>5. springMVC</h5><p>Spring MVC框架是有一个MVC框架，通过实现Model-View-Controller模式来很好地将数据、业务与展现进行分离。从这样一个角度来说，Spring MVC和Struts、Struts2非常类似。Spring MVC的设计是围绕DispatcherServlet展开的，DispatcherServlet负责将请求派发到特定的handler</p>
<h5 id="6-Play-Framework"><a href="#6-Play-Framework" class="headerlink" title="6. Play Framework"></a>6. Play Framework</h5><p>有别于其他臃肿的企业级 Java 框架，简洁的 Play 框架提供另外一种选择，它关注于开发者的效率和 RESTful 风格的架构。Play 是 敏捷软件开发的完美伴侣。</p>
<h3 id="六、数据存储"><a href="#六、数据存储" class="headerlink" title="六、数据存储"></a>六、数据存储</h3><h4 id="1-mysql"><a href="#1-mysql" class="headerlink" title="1. mysql"></a>1. mysql</h4><p>MySQL是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下公司。MySQL 最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的 RDBMS (Relational Database Management System，关系数据库管理系统) 应用软件之一。</p>
<h4 id="2-mongodb"><a href="#2-mongodb" class="headerlink" title="2. mongodb"></a>2. mongodb</h4><p>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p>
<h4 id="3-redis"><a href="#3-redis" class="headerlink" title="3. redis"></a>3. redis</h4><p>Redis是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<h4 id="4-cookie"><a href="#4-cookie" class="headerlink" title="4. cookie"></a>4. cookie</h4><p>Cookie，有时也用其复数形式Cookies，指某些网站为了辨别用户身份、进行session跟踪而储存在用户本地终端上的数据（通常经过加密）</p>
<h4 id="5-access-token"><a href="#5-access-token" class="headerlink" title="5. access token"></a>5. access token</h4><p>Windows操作系统安全性的一个概念。一个访问令牌包含了此登陆会话的安全信息。当用户登陆时，系统创建一个访问令牌，然后以该用户身份运行的的所有进程都拥有该令牌的一个拷贝。该令牌唯一表示该用户、用户的组和用户的特权。系统使用令牌控制用户可以访问哪些安全对象，并控制用户执行相关系统操作的能力。有两种令牌：主令牌和模拟的令牌。主令牌是与进程相关的；模拟的令牌是与模拟令牌的线程相关的。</p>
<h3 id="七、html5-css3"><a href="#七、html5-css3" class="headerlink" title="七、html5+css3"></a>七、html5+css3</h3><h4 id="1-html5"><a href="#1-html5" class="headerlink" title="1. html5"></a>1. html5</h4><p>HTML5是HTML最新的修订版本，2014年10月由万维网联盟（W3C）完成标准制定。<br>HTML5的设计目的是为了在移动设备上支持多媒体。<br>HTML5 简单易学。</p>
<h4 id="2-canvas"><a href="#2-canvas" class="headerlink" title="2. canvas"></a>2. canvas</h4><p>html5中<code>&lt;canvas&gt;</code>标签用于绘制图像（通过脚本，通常是 JavaScript）。不过，<canvas> 元素本身并没有绘制能力（它仅仅是图形的容器） - 您必须使用脚本来完成实际的绘图任务。getContext() 方法可返回一个对象，该对象提供了用于在画布上绘图的方法和属性。</canvas></p>
<h4 id="3-css3"><a href="#3-css3" class="headerlink" title="3. css3"></a>3. css3</h4><p>CSS3是CSS技术的一个升级版本，是由Adobe、Systems、Apple、Google、HP、IBM、Microsoft、Mozilla、Opera、Sun Microsystems 等许多WEB界的巨头联合组织的一个名为 “CSS Working Group” 的组织共同协商策划的。虽然目前很多细节还在讨论之中，但它还是不断地朝前发展着。2010年在HTML5成为IT界人士关注的焦点的同时，它也开始慢慢地普及开来。</p>
<h4 id="4-sass"><a href="#4-sass" class="headerlink" title="4. sass"></a>4. sass</h4><p>SASS是一种CSS的开发工具，提供了许多便利的写法，大大节省了设计者的时间，使得CSS的开发，变得简单和可维护。</p>
<h4 id="5-白鹭引擎"><a href="#5-白鹭引擎" class="headerlink" title="5. 白鹭引擎"></a>5. 白鹭引擎</h4><p>白鹭引擎是一个开源的、跨平台的手机游戏开发引擎,你可以快速地创建HTML5类型的移动游戏,也可以将游戏项目编译输出成为目标移动平台的原生游戏应用。</p>
<h3 id="八、算法和数据结构"><a href="#八、算法和数据结构" class="headerlink" title="八、算法和数据结构"></a>八、算法和数据结构</h3><h4 id="1-线型查找"><a href="#1-线型查找" class="headerlink" title="1. 线型查找"></a>1. 线型查找</h4><p>在一列给定的值中进行搜索，从一端开始逐一检查每个元素，直到找到所需元素的过程。线性查找又称为顺序查找·如果查找池是某种类型的一个表，比如一个数组，简单的查找方法是从表头开始，一次将每一个值与目标元素进行比较，最后，或者查找到目标，或者达到表尾，而目标不存在于组中，这个方法称为线性查找。</p>
<h4 id="2-二分查找"><a href="#2-二分查找" class="headerlink" title="2. 二分查找"></a>2. 二分查找</h4><p>二分查找又称折半查找，优点是比较次数少，查找速度快，平均性能好；其缺点是要求待查表为有序表，且插入删除困难。因此，折半查找方法适用于不经常变动而查找频繁的有序列表。首先，假设表中元素是按升序排列，将表中间位置记录的关键字与查找关键字比较，如果两者相等，则查找成功；否则利用中间位置记录将表分成前、后两个子表，如果中间位置记录的关键字大于查找关键字，则进一步查找前一子表，否则进一步查找后一子表。重复以上过程，直到找到满足条件的记录，使查找成功，或直到子表不存在为止，此时查找不成功。</p>
<h4 id="3-冒泡排序"><a href="#3-冒泡排序" class="headerlink" title="3. 冒泡排序"></a>3. 冒泡排序</h4><p>冒泡排序（Bubble Sort），是一种计算机科学领域的较简单的排序算法。它重复地走访过要排序的数列，一次比较两个元素，如果他们的顺序错误就把他们交换过来。走访数列的工作是重复地进行直到没有再需要交换，也就是说该数列已经排序完成。</p>
<h4 id="4-选择排序"><a href="#4-选择排序" class="headerlink" title="4. 选择排序"></a>4. 选择排序</h4><p>选择排序（Selection sort）是一种简单直观的排序算法。它的工作原理是每一次从待排序的数据元素中选出最小（或最大）的一个元素，存放在序列的起始位置，直到全部待排序的数据元素排完。 选择排序是不稳定的排序方法（比如序列[5， 5， 3]第一次就将第一个[5]与[3]交换，导致第一个5挪动到第二个5后面）。</p>
<h4 id="5-插入排序"><a href="#5-插入排序" class="headerlink" title="5. 插入排序"></a>5. 插入排序</h4><p>插入排序的基本思想是：每步将一个待排序的纪录，按其关键码值的大小插入前面已经排序的文件中适当位置上，直到全部插入完为止。</p>
<h4 id="6-字符串反转"><a href="#6-字符串反转" class="headerlink" title="6. 字符串反转"></a>6. 字符串反转</h4><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'123'</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">Str</span> = str.split(<span class="string">""</span>).reverse().join(<span class="string">""</span>);</span><br><span class="line">alert(<span class="keyword">new</span><span class="type">Str</span>);</span><br></pre></td></tr></table></figure>
<h4 id="7-搜索算法"><a href="#7-搜索算法" class="headerlink" title="7. 搜索算法"></a>7. 搜索算法</h4><p>搜索算法是利用计算机的高性能来有目的的穷举一个问题解空间的部分或所有的可能情况，从而求出问题的解的一种方法。搜索算法实际上是根据初始条件和扩展规则构造一棵“解答树”并寻找符合目标状态的节点的过程。</p>
<h4 id="8-贪心算法"><a href="#8-贪心算法" class="headerlink" title="8. 贪心算法"></a>8. 贪心算法</h4><p>贪心算法（又称贪婪算法）是指，在对问题求解时，总是做出在当前看来是最好的选择。也就是说，不从整体最优上加以考虑，他所做出的是在某种意义上的局部最优解。贪心算法不是对所有问题都能得到整体最优解，关键是贪心策略的选择，选择的贪心策略必须具备无后效性，即某个状态以前的过程不会影响以后的状态，只与当前状态有关。</p>
<h4 id="9-tween算法"><a href="#9-tween算法" class="headerlink" title="9. tween算法"></a>9. tween算法</h4><p>Flash做动画时会用到Tween类，利用它可以做很多动画效果，例如缓动、弹簧等等。</p>
<h4 id="10-javascript算法库"><a href="#10-javascript算法库" class="headerlink" title="10. javascript算法库"></a>10. javascript算法库</h4><ul>
<li><a href="https://github.com/sjkaliski/numbers.js/" target="_blank" rel="noopener">numbers.js</a></li>
<li><a href="http://www.numericjs.com/" target="_blank" rel="noopener">Numeric Javascript </a></li>
<li><a href="http://worrydream.com/Tangle/" target="_blank" rel="noopener">Tangle</a></li>
<li><a href="http://josscrowcroft.github.io/accounting.js/" target="_blank" rel="noopener">accounting.js</a><h3 id="九、测试框架"><a href="#九、测试框架" class="headerlink" title="九、测试框架"></a>九、测试框架</h3><h4 id="1-mocha"><a href="#1-mocha" class="headerlink" title="1. mocha"></a>1. mocha</h4>mocha 是一个简单、灵活有趣的 JavaScript 测试框架，用于 Node.js 和浏览器上的 JavaScript 应用测试。Mocha 是具有丰富特性的 JavaScript 测试框架，可以运行在 Node.js 和浏览器中，使得异步测试更简单更有趣。Mocha 可以持续运行测试，支持灵活又准确的报告，当映射到未捕获异常时转到正确的测试示例。<h4 id="2-karma"><a href="#2-karma" class="headerlink" title="2. karma"></a>2. karma</h4>Karma是Testacular的新名字，在2012年google开源了Testacular，2013年Testacular改名为Karma。Karma是一个让人感到非常神秘的名字，表示佛教中的缘分，因果报应，比Cassandra这种名字更让人猜不透！Karma是一个基于Node.js的JavaScript测试执行过程管理工具（Test Runner）。该工具可用于测试所有主流Web浏览器，也可集成到CI（Continuous integration）工具，也可和其他代码编辑器一起使用。这个测试工具的一个强大特性就是，它可以监控(Watch)文件的变化，然后自行执行，通过console.log显示测试结果。<h4 id="3-jasmine"><a href="#3-jasmine" class="headerlink" title="3. jasmine"></a>3. jasmine</h4>Jasmine （茉莉）是一款 JavaScript BDD（行为驱动开发）测试框架，它不依赖于其他任何 JavaScript 组件。它有干净清晰的语法，让您可以很简单的写出测试代码。对基于 JavaScript 的开发来说，它是一款不错的测试框架选择。<h4 id="4-chai"><a href="#4-chai" class="headerlink" title="4. chai"></a>4. chai</h4>Chai 是一个针对 Node.js 和浏览器的行为驱动测试和测试驱动测试的诊断库，可与任何 JavaScript 测试框架集成。<h4 id="5-Qunit"><a href="#5-Qunit" class="headerlink" title="5.Qunit"></a>5.Qunit</h4>该框架诞生之初是为了jquery的单元测试，后来独立出来不再依赖于jquery本身，但是其身上还是脱离不开jquery的影子<h4 id="6-should-js"><a href="#6-should-js" class="headerlink" title="6. should.js:"></a>6. should.js:</h4>TJ的另外一个开源贡献<h4 id="7-expect-js"><a href="#7-expect-js" class="headerlink" title="7. expect.js"></a>7. expect.js</h4>BDD风格的另外一个断言库，基于should.js,是mini版的BDD库<h4 id="8-assert"><a href="#8-assert" class="headerlink" title="8. assert"></a>8. assert</h4>node自带核心模块: 可以在node中使用的断言模块</li>
</ul>
<h3 id="十、重构"><a href="#十、重构" class="headerlink" title="十、重构"></a>十、<a href="http://www.raychase.net/138" target="_blank" rel="noopener">重构</a></h3><h4 id="1-命名"><a href="#1-命名" class="headerlink" title="1. 命名"></a>1. 命名</h4><p> 模块划分和命名空间</p>
<h4 id="2-加载"><a href="#2-加载" class="headerlink" title="2. 加载"></a>2. 加载</h4><p>js的动态加载</p>
<h4 id="3-测试"><a href="#3-测试" class="headerlink" title="3. 测试"></a>3. 测试</h4><p>Javascript的测试</p>
<h4 id="4-编码"><a href="#4-编码" class="headerlink" title="4. 编码"></a>4. 编码</h4><p> Javascript编码规则</p>
<h4 id="5-闭包"><a href="#5-闭包" class="headerlink" title="5. 闭包"></a>5. 闭包</h4><p> 利用原型/闭包开发组件</p>
<h4 id="6-继承"><a href="#6-继承" class="headerlink" title="6. 继承"></a>6. 继承</h4><p> 利用继承来做事</p>
<h4 id="7-重用"><a href="#7-重用" class="headerlink" title="7. 重用"></a>7. 重用</h4><p> 重用老代码</p>
<h4 id="8-检测"><a href="#8-检测" class="headerlink" title="8. 检测"></a>8. 检测</h4><p> JSDoc和JSLint</p>
<h4 id="9-框架"><a href="#9-框架" class="headerlink" title="9.  框架"></a>9.  框架</h4><p>自定义JavaScript产品框架</p>
<h4 id="10-强化"><a href="#10-强化" class="headerlink" title="10.  强化"></a>10.  强化</h4><p>强化对象封装和模块封装</p>
]]></content>
      
        <categories>
            
            <category> 生活 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> technology </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之动画效果]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2studyAnimate/</url>
      <content type="html"><![CDATA[<p>动画是现代 Web 应用设计中一个很重要的方面。我们希望用户界面能在不同的状态之间更平滑的转场。如果需要，还可以用适当的动画来吸引注意力。 设计良好的动画不但会让 UI 更有趣，还会让它更容易使用。Angular 的动画系统赋予了制作各种动画效果的能力，以构建出与原生 CSS 动画性能相同的动画。 我们也获得了额外的让动画逻辑与其它应用代码紧紧集成在一起的能力，这让动画可以被更容易的触发与控制。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="一、在两个状态间转场"><a href="#一、在两个状态间转场" class="headerlink" title="一、在两个状态间转场"></a>一、在两个状态间转场</h3><h4 id="1-构建一个动画"><a href="#1-构建一个动画" class="headerlink" title="1. 构建一个动画"></a>1. 构建一个动画</h4><p>它会让一个元素用模型驱动的方式在两个状态之间转场。动画会被定义在 <code>@Component</code> 元数据中。在添加动画之前，先引入一些与动画有关的函数</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  Component,</span><br><span class="line">  Input,</span><br><span class="line">  trigger,</span><br><span class="line">  state,</span><br><span class="line">  style,</span><br><span class="line">  transition,</span><br><span class="line">  animate</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="regexp">//</span>通过这些，可以在组件元数据中定义一个名叫 heroState 的 动画触发器 。它在两个状态 active 和 inactive 之间进行转场。 当英雄处于激活状态时，它会把该元素显示得稍微大一点、亮一点。</span><br><span class="line"><span class="keyword">import</span> &#123; Heroes &#125; <span class="keyword">from</span> <span class="string">'./hero.service'</span>;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  moduleId: <span class="built_in">module</span>.id,</span><br><span class="line">  selector: <span class="string">'hero-list-basic'</span>,</span><br><span class="line">  template: `</span><br><span class="line"><span class="javascript">    &lt;ul&gt;</span></span><br><span class="line"><span class="javascript">      &lt;li *ngFor=<span class="string">"let hero of heroes"</span></span></span><br><span class="line"><span class="javascript">          @heroState=<span class="string">"hero.state"</span></span></span><br><span class="line"><span class="javascript">          (click)=<span class="string">"hero.toggleState()"</span>&gt;</span></span><br><span class="line"><span class="javascript">        &#123;&#123;hero.name&#125;&#125;</span></span><br><span class="line"><span class="javascript">      &lt;<span class="regexp">/li&gt;</span></span></span><br><span class="line"><span class="javascript">    &lt;<span class="regexp">/ul&gt;</span></span></span><br><span class="line"><span class="javascript">  </span>`,</span><br><span class="line">  styleUrls: [<span class="string">'hero-list.component.css'</span>],</span><br><span class="line">  animations: [</span><br><span class="line">    trigger(<span class="string">'heroState'</span>, [</span><br><span class="line">      state(<span class="string">'inactive'</span>, style(&#123;</span><br><span class="line">        backgroundColor: <span class="string">'#eee'</span>,</span><br><span class="line">        transform: <span class="string">'scale(1)'</span></span><br><span class="line">      &#125;)),</span><br><span class="line">      state(<span class="string">'active'</span>,   style(&#123;</span><br><span class="line">        backgroundColor: <span class="string">'#cfd8dc'</span>,</span><br><span class="line">        transform: <span class="string">'scale(1.1)'</span></span><br><span class="line">      &#125;)),</span><br><span class="line">      transition(<span class="string">'inactive =&gt; active'</span>, animate(<span class="string">'100ms ease-in'</span>)),</span><br><span class="line">      transition(<span class="string">'active =&gt; inactive'</span>, animate(<span class="string">'100ms ease-out'</span>))</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroListBasicComponent</span> &#123;</span></span><br><span class="line">  @Input() heroes: Heroes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span>我们刚刚定义了一个动画，但它还没有被用到任何地方。要想使用它，可以在模板中用 @triggerName 语法来把它附加到一个或多个元素上。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之服务和http]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2StudyServiceHttp/</url>
      <content type="html"><![CDATA[<p>现在应用开发多为spa的前后分离,前后端通讯则使用http的接口通过json进行交互。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="一、-效果图"><a href="#一、-效果图" class="headerlink" title="一、 效果图"></a>一、 效果图</h3><h4 id="1-展现出来的效果"><a href="#1-展现出来的效果" class="headerlink" title="1. 展现出来的效果"></a>1. 展现出来的效果</h4><p><img src="https://image.xiaomo.info/banner/httpService.png" alt></p>
<h4 id="2-mysql的数据"><a href="#2-mysql的数据" class="headerlink" title="2. mysql的数据"></a>2. mysql的数据</h4><p><img src="https://image.xiaomo.info/angular/mysql.png" alt></p>
<h3 id="二、代码实例"><a href="#二、代码实例" class="headerlink" title="二、代码实例"></a>二、代码实例</h3><h4 id="1-服务-service"><a href="#1-服务-service" class="headerlink" title="1. 服务 service"></a>1. 服务 <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/service/UserService.ts" target="_blank" rel="noopener">service</a></h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Injectable&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Http &#125;<span class="keyword">from</span> <span class="string">'@angular/http'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> api <span class="keyword">from</span> <span class="string">'./../api/Api'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Observable&#125; <span class="keyword">from</span> <span class="string">'rxjs/Rx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> UserService &#123;</span><br><span class="line">    data:<span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> http:Http</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.http = http;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    findAll():Observable&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.http.get(api.findAll).map(<span class="function">(<span class="params">res:<span class="built_in">any</span></span>)=&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.json();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-组件-HttpService"><a href="#2-组件-HttpService" class="headerlink" title="2.组件 HttpService"></a>2.组件 <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/httpService/HttpService.ts" target="_blank" rel="noopener">HttpService</a></h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Component,OnInit&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserService &#125; <span class="keyword">from</span> <span class="string">'./../../service/UserService'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector: <span class="string">'http-service'</span>,</span><br><span class="line">    styles:[<span class="built_in">require</span>(<span class="string">'./HttpService.scss'</span>)],</span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'./HttpService.html'</span>),</span><br><span class="line">    providers: [UserService]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HttpServiceComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line"></span><br><span class="line">    admins:<span class="built_in">Object</span>;</span><br><span class="line">    data:<span class="built_in">Object</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> userService:UserService</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.userService = userService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ngOnInit():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userService.findAll().subscribe(<span class="function">(<span class="params">data:<span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.admins = data.adminUsers.content;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'in component : '</span>,<span class="keyword">this</span>.admins);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">' HttpServiceComponent ngOnInit :'</span>, <span class="string">'enter'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-模板-HttpService-html"><a href="#3-模板-HttpService-html" class="headerlink" title="3. 模板 HttpService.html"></a>3. 模板 <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/httpService/HttpService.html" target="_blank" rel="noopener">HttpService.html</a></h4><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span> *<span class="attr">ngFor</span>=<span class="string">"let item of admins;let i = index"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><span class="template-variable">&#123;&#123;i+1&#125;&#125;</span><span class="xml">.</span><span class="template-variable">&#123;&#123;item.userName&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之小技巧]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2StudyNoteOther/</url>
      <content type="html"><![CDATA[<p>在angular2的开发中经常会遇到各种各样的问题，我们可以采用一些小技巧来解决这些问题。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><h4 id="1-组件"><a href="#1-组件" class="headerlink" title="1. 组件"></a>1. 组件</h4><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"> <span class="meta">@Component(&#123;</span></span><br><span class="line"><span class="meta"> selector: <span class="meta-string">'reddit-article'</span>,</span></span><br><span class="line"><span class="meta"> inputs: [<span class="meta-string">'article'</span>],</span></span><br><span class="line"><span class="meta"> template:require(<span class="meta-string">'reddit-article.html'</span>)</span>;</span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArticleComponent</span> </span>&#123;</span><br><span class="line"> article: Article;</span><br><span class="line"></span><br><span class="line"> voteUp(): boolean &#123;</span><br><span class="line"> <span class="keyword">this</span>.article.voteUp();</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> voteDown(): boolean &#123;</span><br><span class="line"> <span class="keyword">this</span>.article.voteDown();</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-模型"><a href="#2-模型" class="headerlink" title="2. 模型"></a>2. 模型</h4><p>类似javabean，可以把api封装在模型中</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Article &#123;</span><br><span class="line"> title: <span class="built_in">string</span>;</span><br><span class="line"> link: <span class="built_in">string</span>;</span><br><span class="line"> votes: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params">title: <span class="built_in">string</span>, link: <span class="built_in">string</span>, votes?: <span class="built_in">number</span></span>) &#123;</span><br><span class="line"> <span class="keyword">this</span>.title = title;</span><br><span class="line"> <span class="keyword">this</span>.link = link;</span><br><span class="line"> <span class="keyword">this</span>.votes = votes || <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> voteUp(): <span class="built_in">void</span> &#123;</span><br><span class="line"> <span class="keyword">this</span>.votes += <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> voteDown(): <span class="built_in">void</span> &#123;</span><br><span class="line"> <span class="keyword">this</span>.votes -= <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> sortedArticles(): Article[] &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.articles.sort(<span class="function">(<span class="params">a: Article, b: Article</span>) =&gt;</span> b.votes - a.votes);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>使用排序</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"ui grid posts"</span>&gt;</span><br><span class="line"> &lt;reddit-article</span><br><span class="line"> *ngFor=<span class="string">"let article of sortedArticles()"</span></span><br><span class="line"> [article]=<span class="string">"article"</span>&gt;</span><br><span class="line"> &lt;<span class="regexp">/reddit-article&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>div</span><br></pre></td></tr></table></figure>
<h4 id="3-模板"><a href="#3-模板" class="headerlink" title="3.模板"></a>3.模板</h4><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"four wide column center aligned votes"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui statistic"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"value"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> </span><span class="template-variable">&#123;&#123; article.votes &#125;&#125;</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">writing your First Angular 2 Web Application</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> Points</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"twelve wide column"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"ui large header"</span> <span class="attr">href</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123; article.link &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> </span><span class="template-variable">&#123;&#123; article.title &#125;&#125;</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"ui big horizontal list voters"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> (<span class="attr">click</span>)=<span class="string">"voteUp()"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"arrow up icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml"> upvote</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> (<span class="attr">click</span>)=<span class="string">"voteDown()"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"arrow down icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml"> downvote</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="4-服务"><a href="#4-服务" class="headerlink" title="4. 服务"></a>4. 服务</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Injectable&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Http &#125;<span class="keyword">from</span> <span class="string">'@angular/http'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> api <span class="keyword">from</span> <span class="string">'./../api/Api'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Observable&#125; <span class="keyword">from</span> <span class="string">'rxjs/Rx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> UserService &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> http:Http</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.http = http;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    findAll():Observable&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.http.get(api.findAll).map(<span class="function">(<span class="params">res:<span class="built_in">any</span></span>)=&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.json();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-管道"><a href="#5-管道" class="headerlink" title="5. 管道"></a>5. 管道</h4><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; from <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123; name: <span class="string">'trim'</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TrimPipe</span> <span class="keyword">implements</span> <span class="title">PipeTransform</span> </span>&#123;</span><br><span class="line">  transform(value, args) &#123;</span><br><span class="line">    <span class="keyword">return</span> value.trim();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="一、-防止页面刷新"><a href="#一、-防止页面刷新" class="headerlink" title="一、 防止页面刷新"></a>一、 防止页面刷新</h3><p>如果想阻止页面刷新,在方法的返回值为false。</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">voteUp(): boolean &#123;</span><br><span class="line">  <span class="keyword">this</span>.article.votes += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">voteDown(): boolean &#123;</span><br><span class="line">  <span class="keyword">this</span>.article.votes -= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、-不让ng进行解析"><a href="#二、-不让ng进行解析" class="headerlink" title="二、 不让ng进行解析"></a>二、 不让ng进行解析</h3><p><code>ngNonBindable</code></p>
<p>告诉angular 在这个页面上我们不绑定或者不编译的特殊部分。比如我们要展示代码源码的时候不希望它进行编译</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bordered"</span>&gt;</span></span><span class="template-variable">&#123;&#123; content &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"pre"</span> <span class="attr">ngNonBindable</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="symbol">&amp;larr;</span> This is what </span><span class="template-variable">&#123;&#123; content &#125;&#125;</span><span class="xml"> rendered</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="三、-预处理"><a href="#三、-预处理" class="headerlink" title="三、 预处理"></a>三、 预处理</h3><p>在没有编译之前进行处理</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@Component</span>(&#123;</span><br><span class="line">  <span class="attribute">selector</span>: <span class="string">'hello'</span>,</span><br><span class="line"> <span class="attribute">host</span>: &#123;</span><br><span class="line"> <span class="attribute">class</span>: <span class="string">'row'</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>具体表现为 <code>&lt;hello class=&quot;row&quot;&gt;</code></p>
<h3 id="四-组件传参"><a href="#四-组件传参" class="headerlink" title="四. 组件传参"></a>四. 组件传参</h3><h4 id="1-组件-1"><a href="#1-组件-1" class="headerlink" title="1. 组件"></a>1. 组件</h4><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(&#123;</span></span><br><span class="line"><span class="meta"> selector: <span class="meta-string">'reddit-article'</span>,</span></span><br><span class="line"><span class="meta"> inputs: [<span class="meta-string">'article'</span>],</span></span><br><span class="line"><span class="meta"> &#125;)</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ArticleComponent</span> </span>&#123;</span><br><span class="line"> article: Article;</span><br></pre></td></tr></table></figure>
<h4 id="2-使用"><a href="#2-使用" class="headerlink" title="2. 使用"></a>2. 使用</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">reddit-article</span> [<span class="attr">article</span>]=<span class="string">"article1"</span>&gt;</span><span class="tag">&lt;/<span class="name">reddit-article</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们可以在Component中得到</p>
<h3 id="五-输出-自定义事件"><a href="#五-输出-自定义事件" class="headerlink" title="五. 输出(自定义事件)"></a>五. 输出(自定义事件)</h3><p>在class中 定义一个 <code>@Output</code>(EventEmitter)然后在构造函数中实例化<br>在class中 定义一个 <code>@Intput</code> 输入</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line"> selector: <span class="string">'single-component'</span>,</span><br><span class="line">  inputs:[<span class="string">'titles'</span>]</span><br><span class="line"> outputs: [<span class="string">'putRingOnIt'</span>],</span><br><span class="line"> template: <span class="string">`</span></span><br><span class="line"><span class="string"> &lt;button (click)="liked()"&gt;Like it?&lt;/button&gt;</span></span><br><span class="line"><span class="string"> `</span></span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="comment">// 自定义一个事件</span></span><br><span class="line"> <span class="keyword">class</span> SingleComponent &#123;</span><br><span class="line"> putRingOnIt: EventEmitter&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">this</span>.putRingOnIt = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> liked(): <span class="built_in">void</span> &#123;</span><br><span class="line"> <span class="keyword">this</span>.putRingOnIt.emit(<span class="string">"oh oh oh"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>[] 输入 inputs  参数<br>() 输出 outputs 事件</p>
<h3 id="六、-打印日志"><a href="#六、-打印日志" class="headerlink" title="六、 打印日志"></a>六、 打印日志</h3><p>可以使用 <code>${value}</code>来替换参数</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">addArticle(<span class="string">title:</span> HTMLInputElement, <span class="string">link:</span> HTMLInputElement): <span class="keyword">void</span> &#123;</span><br><span class="line"> console.log(`Adding article <span class="string">title:</span> $&#123;title.value&#125; and <span class="string">link:</span> $&#123;link.value&#125;`\</span><br><span class="line"> );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="七、双向绑定"><a href="#七、双向绑定" class="headerlink" title="七、双向绑定"></a>七、双向绑定</h3><h4 id="1-模型到视图"><a href="#1-模型到视图" class="headerlink" title="1. 模型到视图"></a>1. 模型到视图</h4><p>[]  例如 [style.color]</p>
<h4 id="2-视图到模型"><a href="#2-视图到模型" class="headerlink" title="2. 视图到模型"></a>2. 视图到模型</h4><p>()  例如 (click)</p>
<h4 id="3-双向绑定"><a href="#3-双向绑定" class="headerlink" title="3. 双向绑定"></a>3. 双向绑定</h4><p>[()] 例如 [(ngModel)]</p>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之ng2标签]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2StudyNoteNgTag/</url>
      <content type="html"><![CDATA[<p>angular2的内值指令和angular2很类似，所有熟悉angular1的朋友看一眼就会了。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="一、-效果图"><a href="#一、-效果图" class="headerlink" title="一、 效果图"></a>一、 效果图</h3><p><img src="https://image.xiaomo.info/banner/ngTag.png" alt></p>
<h3 id="一、指令解读"><a href="#一、指令解读" class="headerlink" title="一、指令解读"></a>一、<a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag" target="_blank" rel="noopener">指令解读</a></h3><h4 id="0-组件"><a href="#0-组件" class="headerlink" title="0. 组件"></a>0. <a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag//NgTag.ts" target="_blank" rel="noopener">组件</a></h4><p>主要就是定义了一些数据用于测试</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Component&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector: <span class="string">'ng-tag'</span>,</span><br><span class="line">    styles: [<span class="built_in">require</span>(<span class="string">'./NgTag.scss'</span>)],</span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'NgTag.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> NgTagComponent &#123;</span><br><span class="line">    list:<span class="built_in">any</span>;</span><br><span class="line">    ngSwitchList:<span class="built_in">any</span>;</span><br><span class="line">    ngStyleList:<span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list = [&#123;</span><br><span class="line">                <span class="string">'name'</span>: <span class="string">'xiaomo'</span></span><br><span class="line">            &#125;,&#123;</span><br><span class="line">                <span class="string">'name'</span>: <span class="string">'xiaogang'</span></span><br><span class="line"></span><br><span class="line">            &#125;,&#123;</span><br><span class="line">                <span class="string">'name'</span>: <span class="string">'xiaomoxue'</span></span><br><span class="line">            &#125;];</span><br><span class="line">        <span class="keyword">this</span>.ngSwitchList=[</span><br><span class="line">            <span class="string">'xiaomo'</span>,</span><br><span class="line">            <span class="string">'xiaoming'</span></span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">this</span>.ngStyleList=&#123;</span><br><span class="line">            <span class="string">'color'</span>:<span class="string">'blue'</span>,</span><br><span class="line">            <span class="string">'backgroundColor'</span>:<span class="string">'green'</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-ngFor"><a href="#1-ngFor" class="headerlink" title="1. ngFor"></a>1. <a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag/NgTag.html" target="_blank" rel="noopener">ngFor</a></h4><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span> *<span class="attr">ngFor</span>=<span class="string">"let item of list"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span></span><span class="xquery">&#123;&#123;<span class="type">item</span><span class="built_in">.name</span>&#125;</span><span class="xml">&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="https://image.xiaomo.info/banner/ngFor.png" alt></p>
<h4 id="2-ngIf"><a href="#2-ngIf" class="headerlink" title="2. ngIf"></a>2. <a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag/NgTag.html" target="_blank" rel="noopener">ngIf</a></h4><p>我在组件中定义了一个list</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">this.list</span> = [&#123;</span><br><span class="line">        <span class="string">'name'</span>: <span class="string">'xiaomo'</span></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="string">'name'</span>: <span class="string">'xiaogang'</span></span><br><span class="line"></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="string">'name'</span>: <span class="string">'xiaomoxue'</span></span><br><span class="line">    &#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>我在循环这个数组对象的时候去比对item.name 如果是 <code>xiaomo</code>,就 出现 ngIf中的内容</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span> *<span class="attr">ngFor</span>=<span class="string">"let item of list"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">li</span> *<span class="attr">ngIf</span>=<span class="string">"item.name=='xiaomo'"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>哇,我在list列表中找到了 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"label label-info"</span>&gt;</span></span><span class="template-variable">&#123;&#123;item.name&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="https://image.xiaomo.info/banner/ngIf.png" alt></p>
<h4 id="3-ngSwitch"><a href="#3-ngSwitch" class="headerlink" title="3. ngSwitch"></a>3. <a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag/NgTag.html" target="_blank" rel="noopener">ngSwitch</a></h4><p>我在组件中定义了一个方法，可以设置选中的值给myVal</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">myVal:number = <span class="number">0</span>;</span><br><span class="line">changeValue($<span class="keyword">event</span>):<span class="keyword">void</span>&#123;</span><br><span class="line">    console.log($<span class="keyword">event</span>.target.<span class="keyword">value</span>);<span class="comment">// 输出选中的值设给myVal</span></span><br><span class="line">    <span class="keyword">this</span>.myVal = $<span class="keyword">event</span>.target.<span class="keyword">value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有一组单选按钮，选中是<code>myVal</code>会改变，<code>ngSwitch</code>会去循环每个<code>case</code>,如果找到了就显示那条<code>case</code>中的数据，不然显示<code>default</code>中的数据</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ngSwitch<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"myVal"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"1"</span> (<span class="attr">click</span>)=<span class="string">"changeValue($event)"</span>&gt;</span>1</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"myVal"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"2"</span> (<span class="attr">click</span>)=<span class="string">"changeValue($event)"</span>&gt;</span>2</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"myVal"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"3"</span> (<span class="attr">click</span>)=<span class="string">"changeValue($event)"</span>&gt;</span>3</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"myVal"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"4"</span> (<span class="attr">click</span>)=<span class="string">"changeValue($event)"</span>&gt;</span>4</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"myVal"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"5"</span> (<span class="attr">click</span>)=<span class="string">"changeValue($event)"</span>&gt;</span>5</span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span> [<span class="attr">ngSwitch</span>]=<span class="string">"myVal"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchCase</span>=<span class="string">"'1'"</span>&gt;</span>ONE<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchCase</span>=<span class="string">"'2'"</span>&gt;</span>TWO<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchCase</span>=<span class="string">"'3'"</span>&gt;</span>THREE<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchCase</span>=<span class="string">"'4'"</span>&gt;</span>FOUR<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchCase</span>=<span class="string">"'5'"</span>&gt;</span>FIVE<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngSwitchDefault</span>&gt;</span>other<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="https://image.xiaomo.info/banner/NgSwitch.gif" alt></p>
<h4 id="4-ngStyle"><a href="#4-ngStyle" class="headerlink" title="4. ngStyle"></a>4. <a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/ngTag/NgTag.html" target="_blank" rel="noopener">ngStyle</a></h4><p>这里的样式的值都是从组件中取出来的，也就意味着它可以动态，不过建议是封装成class，也就是<code>ngClass</code></p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">ngStyle</span>]=<span class="string">"</span></span></span><span class="template-variable">&#123;'background-color': ngStyleList.backgroundColor,'color':ngStyleList.color&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> [<span class="attr">style.font-size</span>]=<span class="string">"30"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      背景 :</span><span class="template-variable">&#123;&#123;ngStyleList.backgroundColor&#125;</span><span class="xml">&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="xml">      字体颜色: </span><span class="template-variable">&#123;&#123;ngStyleList.color&#125;</span><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="https://image.xiaomo.info/banner/ngStyle.png" alt></p>
<h4 id="5-ngClass"><a href="#5-ngClass" class="headerlink" title="5. ngClass"></a>5. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/ngTag/NgTag.html" target="_blank" rel="noopener">ngClass</a></h4><p>左边是class名[要用<code>‘’</code>包起来]，右边是一个true|false表达式或者是一个方法</p>
<p>在组件中定义了一个fn() 返回封装好的样式</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.ngStyleList=&#123;</span><br><span class="line">     <span class="string">'color'</span>:<span class="string">'blue'</span>,</span><br><span class="line">     <span class="string">'backgroundColor'</span>:<span class="string">'green'</span></span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line">    classes:any=&#123;&#125;;</span><br><span class="line">    fn():any &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.classes =  &#123;</span><br><span class="line">            <span class="string">'btn-primary'</span>:<span class="literal">true</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>模板中有两个button，我们给他加上样式。至于加什么样式 我们可以用函数控制</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span> [<span class="attr">ngClass</span>]=<span class="string">"</span></span></span><span class="template-variable">&#123;'btn-danger': ngStyleList&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span> [<span class="attr">ngClass</span>]=<span class="string">"fn()"</span>&gt;</span>fn<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="https://image.xiaomo.info/banner/ngClass.png" alt></p>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之事件和多组件]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2StudyNoteEvent/</url>
      <content type="html"><![CDATA[<p>组件免不了和用户交互，而交互中使用最频繁的莫过于点击事件的交互。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="一、-点击事件"><a href="#一、-点击事件" class="headerlink" title="一、 点击事件"></a>一、 点击事件</h3><p><img src="https://image.xiaomo.info/banner/ClickEvent.gif" alt></p>
<p><a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/clickEvent" target="_blank" rel="noopener">代码解读</a></p>
<h4 id="1-ClickEvent-ts"><a href="#1-ClickEvent-ts" class="headerlink" title="1. ClickEvent.ts"></a>1. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/clickEvent/ClickEvent.ts" target="_blank" rel="noopener">ClickEvent.ts</a></h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Component&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;BasicComponent&#125; <span class="keyword">from</span> <span class="string">'./../basic/Basic'</span>;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">    selector:<span class="string">'click-event'</span>,</span><br><span class="line">    styles:[<span class="built_in">require</span>(<span class="string">'./ClickEvent.scss'</span>)],</span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'./ClickEvent.html'</span>),</span><br><span class="line">    directives:[BasicComponent] <span class="comment">//需要引用的组件</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ClickEventComponent</span></span>&#123;</span><br><span class="line">    showMsg():<span class="keyword">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'己经触发点击事件'</span>);</span><br><span class="line">        alert(<span class="string">'己经触发点击事件'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-ClickEvent-html"><a href="#2-ClickEvent-html" class="headerlink" title="2. ClickEvent.html"></a>2. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/clickEvent/ClickEvent.html" target="_blank" rel="noopener">ClickEvent.html</a></h4><p>basic 就是引用的另一个组件,这个组件源自于上一篇博客<a href="https://xiaomo.info/2016/06/22/angular2_study_note_component/" target="_blank" rel="noopener">基本组件</a><br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">basic</span>&gt;</span><span class="tag">&lt;/<span class="name">basic</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> (<span class="attr">click</span>)=<span class="string">"showMsg()"</span>&gt;</span>点击事件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="二、键盘按下事件"><a href="#二、键盘按下事件" class="headerlink" title="二、键盘按下事件"></a>二、键盘按下事件</h3><p><img src="https://image.xiaomo.info/banner/ClickEvent.gif" alt></p>
<h4 id="1-KeyupEvent-ts"><a href="#1-KeyupEvent-ts" class="headerlink" title="1. KeyupEvent.ts"></a>1. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/keyupEvent/KeyupEvent.ts" target="_blank" rel="noopener">KeyupEvent.ts</a></h4><p>初始化一个<code>values</code>为空字符串，然后当用户按下键盘的时候把值拼给<code>values</code>，并且以<code>|</code>隔开</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector:<span class="string">'keyup-event'</span>,</span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'./KeyupEvent.html'</span>),</span><br><span class="line">    styles:[<span class="built_in">require</span>(<span class="string">'./KeyupEvent.scss'</span>)]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyupEventComponent &#123;</span><br><span class="line">    values:<span class="built_in">string</span> = <span class="string">''</span>;</span><br><span class="line">    onKey(value:<span class="built_in">any</span>):<span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.values += value + <span class="string">' | '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-KeyupEvent-html"><a href="#2-KeyupEvent-html" class="headerlink" title="2. KeyupEvent.html"></a>2. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/keyupEvent/KeyupEvent.html" target="_blank" rel="noopener">KeyupEvent.html</a></h4><p>当键盘按下的时候调用<code>onKey</code>方法</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> #<span class="attr">box</span> (<span class="attr">keyup</span>)=<span class="string">"onKey(box.value)"</span> <span class="attr">title</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="template-variable">&#123;&#123;values&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="三、-enter事件和失焦事件"><a href="#三、-enter事件和失焦事件" class="headerlink" title="三、 enter事件和失焦事件"></a>三、 enter事件和失焦事件</h3><p><img src="https://image.xiaomo.info/banner/ClickEvent.gif" alt></p>
<h4 id="1-EnterBlurEvent-ts"><a href="#1-EnterBlurEvent-ts" class="headerlink" title="1. EnterBlurEvent.ts"></a>1. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/EnterBlurEvent/EnterBlurEvent.ts" target="_blank" rel="noopener">EnterBlurEvent.ts</a></h4><p>定义一个<code>heroes</code>数组并给几个初始值，添加英雄方法可以增加一个新的英雄到<code>heroes</code>中</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">    selector:<span class="string">'enter-blur-event'</span>,</span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'./EnterBlurEvent.html'</span>),</span><br><span class="line">    styles:[<span class="built_in">require</span>(<span class="string">'./EnterBlurEvent.scss'</span>)]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">EnterBlurEventComponent</span> &#123;</span></span><br><span class="line">    heroes = [<span class="string">'Windstorm'</span>, <span class="string">'Bombasto'</span>, <span class="string">'Magneta'</span>, <span class="string">'Tornado'</span>];</span><br><span class="line">    addHero(newHero: string) &#123;</span><br><span class="line">        <span class="keyword">if</span> (newHero) &#123;</span><br><span class="line">            <span class="keyword">this</span>.heroes.push(newHero);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-EnterBlurEvent-html"><a href="#2-EnterBlurEvent-html" class="headerlink" title="2. EnterBlurEvent.html"></a>2. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/EnterBlurEvent/EnterBlurEvent.html" target="_blank" rel="noopener">EnterBlurEvent.html</a></h4><p>当用户按<code>enter</code>或者<code>Add</code>或者<code>blur</code>失去焦点且不为空的时候调用<code>newHero</code>方法，然后循环输出<code>heroes</code></p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> #<span class="attr">newHero</span></span></span></span><br><span class="line"><span class="xml">       (keyup.enter)="addHero(newHero.value)"</span></span><br><span class="line"><span class="xml">       (blur)="addHero(newHero.value); newHero.value='' "&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">addHero(newHero.value)</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span>&gt;</span>Add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;<span class="name">li</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of heroes"</span>&gt;</span></span><span class="template-variable">&#123;&#123;hero&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angular2学习笔记之基本组件和ngFor]]></title>
      <url>https://blog.xiaomo.info/2016/Angular2StudyNoteComponent/</url>
      <content type="html"><![CDATA[<p>angular2的思想非常先进，摒弃了angular1那种复杂的构建模式，采用了组件化开方的方，那我们一起来看一看，一个基础的组件是什么样子的呢。<a href="https://github.com/houko/angular2-demo" target="_blank" rel="noopener">angular2-demo</a><br><a id="more"></a></p>
<h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><h4 id="1-目录结构"><a href="#1-目录结构" class="headerlink" title="1. 目录结构"></a>1. 目录结构</h4><p><img src="https://image.xiaomo.info/angular/jiegou.png" alt></p>
<ul>
<li><code>.ts</code>   组件代码</li>
<li><code>.scss</code>   样式</li>
<li><code>.png</code>   效果图</li>
<li><code>.html</code>   模板文件</li>
</ul>
<h3 id="2-效果图"><a href="#2-效果图" class="headerlink" title="2. 效果图"></a>2. 效果图</h3><p><img src="https://image.xiaomo.info/banner/Basic.png" alt></p>
<h3 id="二、代码实例"><a href="#二、代码实例" class="headerlink" title="二、代码实例"></a>二、代码实例</h3><p><a href="https://github.com/houko/angular2-demo/tree/master/src/ts/component/basic" target="_blank" rel="noopener">https://github.com/houko/angular2-demo/tree/master/src/ts/component/basic</a></p>
<h3 id="三、-详细解读"><a href="#三、-详细解读" class="headerlink" title="三、 详细解读"></a>三、 详细解读</h3><h4 id="1-Basic-ts"><a href="#1-Basic-ts" class="headerlink" title="1. Basic.ts"></a>1. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/basic/Basic.ts" target="_blank" rel="noopener">Basic.ts</a></h4><p>一个基本的组件就长个样子，并没有那么神秘</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Component&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;UserModel&#125; <span class="keyword">from</span> <span class="string">'./../../model/UserModel'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建模拟数据</span></span><br><span class="line"><span class="keyword">let</span> xiaomo:UserModel = <span class="keyword">new</span> UserModel( <span class="string">'xiaomo'</span>);</span><br><span class="line"><span class="keyword">let</span> xiaoming:UserModel = <span class="keyword">new</span> UserModel(<span class="string">'xiaoming'</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector: <span class="string">'basic'</span>,</span><br><span class="line">    styles:[<span class="built_in">require</span>(<span class="string">'./Basic.scss'</span>)], <span class="comment">//内联样式,注意使用row-loader</span></span><br><span class="line">    template: <span class="built_in">require</span>(<span class="string">'./Basic.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> BasicComponent &#123;</span><br><span class="line"></span><br><span class="line">    users:<span class="built_in">Object</span>;</span><br><span class="line">    <span class="comment">// 在构造函数中赋值</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.users= [ xiaomo,xiaoming];</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-UserModel-ts"><a href="#2-UserModel-ts" class="headerlink" title="2. UserModel.ts"></a>2. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/model/UserModel.ts" target="_blank" rel="noopener">UserModel.ts</a></h4><p>这里使用了uuid来创建一个随机的id作为唯一标识符<br>使用 <code>public</code> 可以不用再 <code>this.name = name</code><br><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; uuid &#125; <span class="keyword">from</span> <span class="string">'./../util/uuid'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> UserModel&#123;</span><br><span class="line">    id :<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> name:<span class="built_in">string</span></span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = uuid();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-Basic-html"><a href="#3-Basic-html" class="headerlink" title="3. Basic.html"></a>3. <a href="https://github.com/houko/angular2-demo/blob/master/src/ts/component/basic/Basic.html" target="_blank" rel="noopener">Basic.html</a></h4><p>使用ngFor 循环,index可以取到索引值(从0开始)</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">ul</span> *<span class="attr">ngFor</span>=<span class="string">"let item of users; let i = index"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><span class="template-variable">&#123;&#123;i+1&#125;&#125;</span><span class="xml"> Hello </span><span class="template-variable">&#123;&#123;item.name&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angular2 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
            <tag> webpack </tag>
            
            <tag> sass </tag>
            
            <tag> typescript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[几个国内专用的公共 DNS]]></title>
      <url>https://blog.xiaomo.info/2016/PublicDns/</url>
      <content type="html"><![CDATA[<p>　　之前 <a href="http://www.bootcdn.cn/" target="_blank" rel="noopener">有个网站</a> 自己经常上不去，查了挺久才发现是 DNS 的问题，更换为公共 DNS 后访问恢复正常。由此可见，挑选一个合适自己网络的 DNS 还是挺有必要的。</p>
<a id="more"></a>
<h3 id="DNS-简介"><a href="#DNS-简介" class="headerlink" title="DNS 简介"></a>DNS 简介</h3><p>DNS 全称 <code>Domain Name System</code>，中文译为 <code>域名系统</code>，是因特网的一项服务，其域名服务器的分布式数据库中存储着因特网上域名和 IP 地址相互映射的关系，经解析器解析，使用户能够通过域名来访问互联网。</p>
<h3 id="114DNS"><a href="#114DNS" class="headerlink" title="114DNS"></a>114DNS</h3><pre><code>114.114.114.114
114.114.115.115
</code></pre><p><strong>官　网</strong>：<a href="http://www.114dns.com/" target="_blank" rel="noopener">http://www.114dns.com/</a><br><strong>关键词</strong>：权威，高速，稳定，可靠，无劫持，防钓鱼，防病毒</p>
<h3 id="阿里公共DNS"><a href="#阿里公共DNS" class="headerlink" title="阿里公共DNS"></a>阿里公共DNS</h3><pre><code>223.5.5.5
223.6.6.6
</code></pre><p><strong>官　网</strong>：<a href="http://www.alidns.com/" target="_blank" rel="noopener">http://www.alidns.com/</a><br><strong>关键词</strong>：快速，稳定，智能</p>
<h3 id="腾讯-Public-DNS"><a href="#腾讯-Public-DNS" class="headerlink" title="腾讯 Public DNS +"></a>腾讯 Public DNS +</h3><pre><code>119.29.29.29
</code></pre><p><strong>官　网</strong>：<a href="https://www.dnspod.cn/Products/Public.DNS" target="_blank" rel="noopener">https://www.dnspod.cn/Products/Public.DNS</a><br><strong>关键词</strong>：快速，准确，稳定</p>
<h2 id="百度公共DNS"><a href="#百度公共DNS" class="headerlink" title="百度公共DNS"></a>百度公共DNS</h2><pre><code>180.76.76.76
</code></pre><p><strong>官　网</strong>：<a href="http://dudns.baidu.com/intro/publicdns/" target="_blank" rel="noopener">http://dudns.baidu.com/intro/publicdns/</a><br><strong>关键词</strong>：云防护，无劫持，更精确</p>
<h3 id="oneDNS"><a href="#oneDNS" class="headerlink" title="oneDNS"></a>oneDNS</h3><pre><code>南方首选：112.124.47.27
北方首选：114.215.126.16
</code></pre><p><strong>官　网</strong>：<a href="http://www.onedns.net/" target="_blank" rel="noopener">http://www.onedns.net/</a><br><strong>关键词</strong>：安全，快速，恶意网站拦截，广告过滤，上网加速</p>
<h3 id="CNNIC-SDNS"><a href="#CNNIC-SDNS" class="headerlink" title="CNNIC SDNS"></a>CNNIC SDNS</h3><pre><code>1.2.4.8
210.2.4.8
</code></pre><p><strong>官　网：</strong><a href="http://public.sdns.cn/" target="_blank" rel="noopener">http://public.sdns.cn/</a><br><strong>关键词：</strong>权威，安全，智能，高速</p>
<h3 id="DNS-选用"><a href="#DNS-选用" class="headerlink" title="DNS 选用"></a>DNS 选用</h3><h4 id="在线查询"><a href="#在线查询" class="headerlink" title="在线查询"></a>在线查询</h4><ul>
<li>可以通过 <a href="http://www.webkaka.com/dns/" target="_blank" rel="noopener">在线小工具</a> 测试一下 DNS 的解析速度，结果可以作为参考<br><img src="https://image.xiaomo.info/dns/dns-tool.png" alt="DNS Tool"></li>
</ul>
<h4 id="本地优选"><a href="#本地优选" class="headerlink" title="本地优选"></a>本地优选</h4><ul>
<li>下载 <a href="http://www.crsky.com/soft/88043.html" target="_blank" rel="noopener">魔方DNS助手</a>，可以方便地检测，选择和修改 DNS</li>
</ul>
<p><img src="https://image.xiaomo.info/dns/dnshelper.png" alt="DNS Helper"></p>
<blockquote>
<p>如果更换 DNS 后网络异常，可以尝试 <a href="http://jingyan.baidu.com/article/6d704a13fb6e1828db51ca3a.html" target="_blank" rel="noopener">刷新本地的DNS缓存</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[linux权限详细解读]]></title>
      <url>https://blog.xiaomo.info/2016/LinuxChmod/</url>
      <content type="html"><![CDATA[<p>话说我接触linux也有近2年的时候了,而且有自己的linux服务器。感觉对linux的操作熟练程度还可以，但是基本知识还是有待提高，linux权限这一块有必要啃一啃了。<br><a id="more"></a></p>
<h3 id="一、理论说明"><a href="#一、理论说明" class="headerlink" title="一、理论说明"></a>一、理论说明</h3><p>Linux系统中的每个文件和目录都有访问许可权限，用它来确定谁可以通过何种方式对文件和目录进行访问和操作。</p>
<h4 id="1-权限说明"><a href="#1-权限说明" class="headerlink" title="1. 权限说明"></a>1. 权限说明</h4><p>文件或目录的访问权限分为只读，只写和可执行三种。<br>以文件为例，只读权限表示只允许读其内容，而禁止对其做任何的更改操作。<br>可执行权限表示允许将该文件作为一个程序执行。<br>文件被创建时，文件所有者自动拥有对该文件的读、写和可执行权限，以便于对文件的阅读和修改。<br>用户也可根据需要把访问权限设置为需要的任何组合。</p>
<h4 id="2-用户组"><a href="#2-用户组" class="headerlink" title="2. 用户组"></a>2. 用户组</h4><p>有三种不同类型的用户可对文件或目录进行访问：</p>
<ul>
<li>文件所有者，</li>
<li>同组用户</li>
<li>其他用户<br>所有者一般是文件的创建者。</li>
</ul>
<p>所有者可以允许同组用户有权访问文件，还可以将文件的访问权限赋予系统中的其他用户。<br>在这种情况下，系统中每一位用户都能访问该用户拥有的文件或目录。</p>
<h4 id="3-文件权限"><a href="#3-文件权限" class="headerlink" title="3. 文件权限"></a>3. 文件权限</h4><p>每一文件或目录的访问权限都有三组，每组用三位表示，分别为</p>
<ul>
<li>文件属主的读、写和执行权限；</li>
<li>与属主同组的用户的读、写和执行权限；</li>
<li>系统中其他用户的读、写和执行权限。<br>当用ls -l命令显示文件或目录的详细信息时，最左边的一列为文件的访问权限。</li>
</ul>
<h4 id="4-实例分析"><a href="#4-实例分析" class="headerlink" title="4.实例分析"></a>4.实例分析</h4><p>随意查看一个目录： <code>ll</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">9</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">17</span> <span class="number">10</span><span class="string">:18</span> <span class="string">.</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">8</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">09</span><span class="string">:08</span> <span class="string">..</span></span><br><span class="line"><span class="string">-rw-r--r--</span>   <span class="number">1</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">1771</span> <span class="string">Jun</span> <span class="number">16</span> <span class="number">23</span><span class="string">:22</span> <span class="string">_config.yml</span></span><br><span class="line"><span class="string">-rw-r--r--</span>   <span class="number">1</span> <span class="string">root</span> <span class="string">root</span> <span class="number">1201148</span> <span class="string">Jun</span> <span class="number">17</span> <span class="number">10</span><span class="string">:18</span> <span class="string">db.json</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">8</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">17</span> <span class="number">10</span><span class="string">:31</span> <span class="string">.git</span></span><br><span class="line"><span class="string">-rw-r--r--</span>   <span class="number">1</span> <span class="string">root</span> <span class="string">root</span>      <span class="number">55</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">09</span><span class="string">:09</span> <span class="string">.gitignore</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">2</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">09</span><span class="string">:09</span> <span class="string">.idea</span></span><br><span class="line"><span class="string">drwxr-xr-x</span> <span class="number">411</span> <span class="string">root</span> <span class="string">root</span>   <span class="number">16384</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">09</span><span class="string">:12</span> <span class="string">node_modules</span></span><br><span class="line"><span class="string">-rw-r--r--</span>   <span class="number">1</span> <span class="string">root</span> <span class="string">root</span>     <span class="number">861</span> <span class="string">Jun</span> <span class="number">16</span> <span class="number">10</span><span class="string">:55</span> <span class="string">package.json</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>  <span class="number">13</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">17</span> <span class="number">10</span><span class="string">:18</span> <span class="string">public</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">2</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">09</span><span class="string">:09</span> <span class="string">scaffolds</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">7</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">12</span><span class="string">:51</span> <span class="string">source</span></span><br><span class="line"><span class="string">drwxr-xr-x</span>   <span class="number">6</span> <span class="string">root</span> <span class="string">root</span>    <span class="number">4096</span> <span class="string">Jun</span> <span class="number">15</span> <span class="number">12</span><span class="string">:51</span> <span class="string">themes</span></span><br></pre></td></tr></table></figure>
<p>解读：<br><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">注意这里共有<span class="number">10</span>个位置,<span class="number">10</span>个位置又可以分为<span class="number">4</span>个部分。</span><br><span class="line">四个部分分别为 <span class="number">1.</span>类型 <span class="number">2.</span>属主权限 <span class="number">2.</span>同组用户权限 <span class="number">3</span> 其他用户权限</span><br><span class="line">第一个字符指定了文件类型。</span><br><span class="line">r代表只读，w代表写，x代表可执行，横线代表空。</span><br><span class="line">在通常意义上，一个目录也是一个文件。</span><br><span class="line">如果第一个字符是横线，表示是一个非目录的文件。</span><br><span class="line">如果是d，表示是一个目录。</span><br></pre></td></tr></table></figure></p>
<p>单个实例</p>
<figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="literal">-</span><span class="comment">rw</span><span class="literal">-</span><span class="comment">r</span>--<span class="comment">r</span>--</span><br></pre></td></tr></table></figure>
<p>详细解读(如果没有看懂建议回头看看理论说明1-3)</p>
<p><img src="https://image.xiaomo.info/linux/chmod.png" alt></p>
<h3 id="二、命令使用说明"><a href="#二、命令使用说明" class="headerlink" title="二、命令使用说明"></a>二、命令使用说明</h3><h4 id="1-格式-参数设定"><a href="#1-格式-参数设定" class="headerlink" title="1.格式(参数设定)"></a>1.格式(参数设定)</h4><p><code>chmod ［who］ ［+ | - | =］ ［mode］ 文件名¼</code></p>
<p>命令解读：</p>
<p>操作对象who可是下述字母中的任一个或者它们的组合：</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">　　u 表示“用户（<span class="keyword">user</span>）”，即文件或目录的所有者。</span><br><span class="line"></span><br><span class="line">　　g 表示“同组（<span class="keyword">group</span>）用户”，即与文件属主有相同组ID的所有用户。</span><br><span class="line"></span><br><span class="line">　　o 表示“其他（others）用户”。</span><br><span class="line"></span><br><span class="line">　　a 表示“所有（<span class="literal">all</span>）用户”。它是系统默认值。</span><br></pre></td></tr></table></figure>
<p>　　操作符号可以是：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">　　+ </span>添加某个权限。</span><br><span class="line"></span><br><span class="line"><span class="bullet">　　- </span>取消某个权限。</span><br><span class="line"></span><br><span class="line">　　= 赋予给定权限并取消其他所有权限（如果有的话）。</span><br></pre></td></tr></table></figure>
<p>　　设置mode所表示的权限可用下述字母的任意组合：</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">　　r 可读。</span><br><span class="line"></span><br><span class="line">　　w 可写。</span><br><span class="line"></span><br><span class="line">　　<span class="keyword">x</span> 可执行。</span><br><span class="line"></span><br><span class="line">　　X 只有目标文件对某些用户是可执行的或该目标文件是目录时才追加<span class="keyword">x</span> 属性。</span><br><span class="line"></span><br><span class="line">　　s 在文件执行时把进程的属主或组ID置为该文件的文件属主。方式“u＋s”设置文件的用户ID位，“g＋s”设置组ID位。</span><br><span class="line"></span><br><span class="line">　　t 保存程序的文本到交换设备上。</span><br><span class="line"></span><br><span class="line">　　u 与文件属主拥有一样的权限。</span><br><span class="line"></span><br><span class="line">　　g 与和文件属主同组的用户拥有一样的权限。</span><br><span class="line"></span><br><span class="line">　　o 与其他用户拥有一样的权限。</span><br><span class="line"></span><br><span class="line">　　文件名：以空格分开的要改变权限的文件列表，支持通配符。</span><br><span class="line"></span><br><span class="line">　　在一个命令行中可给出多个权限方式，其间用逗号隔开。例如：chmod g+r，o+r example</span><br><span class="line"></span><br><span class="line">　　使同组和其他用户对文件example 有读权限。</span><br></pre></td></tr></table></figure>
<h4 id="2-权限设置-数字"><a href="#2-权限设置-数字" class="headerlink" title="2.权限设置(数字)"></a>2.权限设置(数字)</h4><p>我们必须首先了解用数字表示的属性的含义：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>表示没有权限，</span><br><span class="line"><span class="number">1</span>表示可执行权限，</span><br><span class="line"><span class="number">2</span>表示可写权限，</span><br><span class="line"><span class="number">4</span>表示可读权限，</span><br><span class="line">然后将其相加。所</span><br><span class="line">以数字属性的格式应为<span class="number">3</span>个从<span class="number">0</span>到<span class="number">7</span>的八进制数，</span><br><span class="line">其顺序是（u）（g）（o）。</span><br></pre></td></tr></table></figure>
<h3 id="三、其他命令"><a href="#三、其他命令" class="headerlink" title="三、其他命令"></a>三、其他命令</h3><h4 id="1-chgrp命令"><a href="#1-chgrp命令" class="headerlink" title="1. chgrp命令"></a>1. <code>chgrp</code>命令</h4><p>功能：改变文件或目录所属的组。</p>
<p>语法：<code>chgrp ［选项］ group filename¼</code></p>
<p>该命令改变指定指定文件所属的用户组。其中<code>group</code>可以是用户组ID，也可以是<code>/etc/group</code>文件中用户组的组名。文件名是以空格分开的要改变属组的文件列表，支持通配符。如果用户不是该文件的属主或超级用户，则不能改变该文件的组。</p>
<p>该命令的各选项含义为：</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>R 递归式地改变指定目录及其下的所有子目录和文件的属组。</span><br></pre></td></tr></table></figure>
<p>　　例1：<code>$ chgrp - R book /opt/local /book</code></p>
<p>　　改变<code></code>/opt/local<code></code>/book/<code>及其子目录下的所有文件的属组为</code>book`。</p>
<h4 id="2-chown命令"><a href="#2-chown命令" class="headerlink" title="2. chown命令"></a>2. <code>chown</code>命令</h4><p>　　功能：更改某个文件或目录的属主和属组。这个命令也很常用。例如root用户把自己的一个文件拷贝给用户xu，为了让用户xu能够存取这个文件，root用户应该把这个文件的属主设为xu，否则，用户xu无法存取这个文件。</p>
<p>　　语法：<code>chown ［选项］ 用户或组 文件</code></p>
<p>　　说明：<code>chown</code>将指定文件的拥有者改为指定的用户或组。用户可以是用户名或用户ID。组可以是组名或组ID。文件是以空格分开的要改变权限的文件列表，支持通配符。</p>
<p>　　该命令的各选项含义如下：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">　　- </span>R 递归式地改变指定目录及其下的所有子目录和文件的拥有者。</span><br><span class="line"><span class="bullet">　　- </span>v 显示chown命令所做的工作。</span><br></pre></td></tr></table></figure>
<p>　　例1：把文件<code>shiyan.c</code>的所有者改为<code>wang</code>。</p>
<p>　　$ <code>chown wang shiyan.c</code></p>
<p>　　例2：把目录/his及其下的所有文件和子目录的属主改成<code>wang</code>，属组改成<code>users</code>。</p>
<p>　　$ <code>chown - R wang.users /his</code></p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[阿里云服务器磁盘挂载]]></title>
      <url>https://blog.xiaomo.info/2016/LinuxDisk/</url>
      <content type="html"><![CDATA[<p>起因在于前段时间在阿里云上购买了一台ECS的云服务器，奈何硬盘20G不够用，所以又买了一块硬块。so,问题来了,磁盘挂载哪家强？最终还要靠自己！！</p>
<a id="more"></a>
<h2 id="一、基本信息"><a href="#一、基本信息" class="headerlink" title="一、基本信息"></a>一、基本信息</h2><p>参考自阿里云服务器使用心得。</p>
<p>云服务器环境：CentOS 6.2 64位</p>
<p>客户端环境：Mac OSX</p>
<p>远程连接方式：运行 Terminal，输入命令 ssh username@ip</p>
<h3 id="二、硬盘分区及挂载操作步骤"><a href="#二、硬盘分区及挂载操作步骤" class="headerlink" title="二、硬盘分区及挂载操作步骤"></a>二、硬盘分区及挂载操作步骤</h3><h4 id="1-查看未挂载的硬盘"><a href="#1-查看未挂载的硬盘" class="headerlink" title="1. 查看未挂载的硬盘"></a>1. 查看未挂载的硬盘</h4><p>（名称为/dev/xvdb）<br><code>fdisk -l</code><br>输出<br><code>Disk /dev/xvdb doesn&#39;t contain a valid partition table</code></p>
<h4 id="2-创建分区"><a href="#2-创建分区" class="headerlink" title="2. 创建分区"></a>2. 创建分区</h4><p><code>fdisk /dev/xvdb</code></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">输入n</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help):n</span><br><span class="line"></span><br><span class="line">输入p</span><br><span class="line"></span><br><span class="line">Command action</span><br><span class="line">e extended</span><br><span class="line">p primary partition (1-4)</span><br><span class="line">p</span><br><span class="line"></span><br><span class="line">输入1</span><br><span class="line"></span><br><span class="line">Partition number (1-4): 1</span><br><span class="line"></span><br><span class="line">回车</span><br><span class="line"></span><br><span class="line">First cylinder (1-2610,<span class="built_in"> default </span>1):</span><br><span class="line">Using<span class="built_in"> default </span>value 1</span><br><span class="line"></span><br><span class="line">回车</span><br><span class="line"></span><br><span class="line">Last cylinder, +cylinders <span class="keyword">or</span> +size&#123;K,M,G&#125; (1-2610,<span class="built_in"> default </span>2610):</span><br><span class="line">Using<span class="built_in"> default </span>value 2610</span><br><span class="line"></span><br><span class="line">输入w</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help): w</span><br><span class="line">The partition table has been altered!</span><br></pre></td></tr></table></figure>
<h4 id="3-格式化分区"><a href="#3-格式化分区" class="headerlink" title="3. 格式化分区"></a>3. 格式化分区</h4><p> 执行命令： <code>mkfs.ext3 /dev/xvdb1</code></p>
<h4 id="4-建立挂载目录"><a href="#4-建立挂载目录" class="headerlink" title="4. 建立挂载目录"></a>4. 建立挂载目录</h4><p>执行命令： <code>mkdir /data</code>  注意名字不要和原有磁盘上的重复  不然原有磁盘上的内容会被覆盖</p>
<h4 id="5-挂载分区"><a href="#5-挂载分区" class="headerlink" title="5. 挂载分区"></a>5. 挂载分区</h4><p>将磁盘挂载到刚建立的<code>data</code>目录中   <code>mount /dev/xvdb1 /data</code></p>
<h4 id="6-设置开机自动挂载"><a href="#6-设置开机自动挂载" class="headerlink" title="6. 设置开机自动挂载"></a>6. 设置开机自动挂载</h4><p><code>vi /etc/fstab</code></p>
<p>在vi中输入i进入INERT模式，将光标移至文件结尾处并回车，将下面的内容复制/粘贴，然后按Esc键，输入:x保存并退出</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">/dev/xvdb1              /<span class="class"><span class="keyword">data</span>                   ext3    defaults        0 0</span></span><br></pre></td></tr></table></figure>
<h4 id="7-确认是否挂载成功"><a href="#7-确认是否挂载成功" class="headerlink" title="7. 确认是否挂载成功"></a>7. 确认是否挂载成功</h4><p>重启服务器: <code>reboot</code><br>查看硬盘分区: <code>df</code></p>
<p>反馈信息</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">/dev/xvdb1            <span class="number">20635700</span>    <span class="number">176196</span>  <span class="number">19411268</span>   <span class="number">1</span>% /data</span><br></pre></td></tr></table></figure>
<p>搞定！Mac 下通过 Terminal 远程操作 Linux 的感觉不错！</p>
<h3 id="四、-原文地址"><a href="#四、-原文地址" class="headerlink" title="四、 原文地址"></a>四、 原文地址</h3><p><a href="http://www.cnblogs.com/dudu/archive/2012/12/07/aliyun-linux-fdisk.html" target="_blank" rel="noopener">aliyun-linux-fdisk</a></p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Markdown 表格样式调整与自适应优化]]></title>
      <url>https://blog.xiaomo.info/2016/MarkdownTableStyle/</url>
      <content type="html"><![CDATA[<p>　　Markdown 写的表格最终会被解析成 HTML 代码，如果使用的编辑器支持自定义 CSS，就能方便的调整样式。如果可以引入 JavaScript，样式自适应也能较好地实现。</p>
<a id="more"></a>
<p></p><p data-height="300" data-theme-id="0" data-slug-hash="ONyKqb" data-default-tab="css" data-user="MOxFIVE" class="codepen">See the Pen <a href="http://codepen.io/MOxFIVE/pen/ONyKqb/" 　rel="external nofollow" target="_blank" rel="noopener">Table style</a> by MOxFIVE (<a href="http://codepen.io/MOxFIVE" 　rel="external nofollow" target="_blank" rel="noopener">@MOxFIVE</a>) on <a href="http://codepen.io" 　rel="external nofollow" target="_blank" rel="noopener">CodePen</a>.</p><p></p>
<script async src="//assets.codepen.io/assets/embed/ei.js"></script>

<h3 id="样式调整"><a href="#样式调整" class="headerlink" title="样式调整"></a>样式调整</h3><h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><pre><code>&lt;table&gt;: 表格
&lt;thead&gt;: table header 表头区
&lt;th&gt;: table headings 表头单元格内容
&lt;tbody&gt;: table body 表格内容区
&lt;tr&gt;: table row 表行
&lt;td&gt;: table data 单元格内容
</code></pre><h4 id="基本样式"><a href="#基本样式" class="headerlink" title="基本样式"></a>基本样式</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/*表格宽度*/</span></span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">65em</span>; <span class="comment">/*表格最大宽度，避免表格过宽*/</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dedede</span>; <span class="comment">/*表格外边框设置*/</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">15px</span> auto; <span class="comment">/*外边距*/</span></span><br><span class="line">    <span class="attribute">border-collapse</span>: collapse; <span class="comment">/*使用单一线条的边框*/</span></span><br><span class="line">    <span class="attribute">empty-cells</span>: show; <span class="comment">/*单元格无内容依旧绘制边框*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">td</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">35px</span>; <span class="comment">/*统一每一行的默认高度*/</span></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dedede</span>; <span class="comment">/*内部边框样式*/</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>; <span class="comment">/*内边距*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="表头样式"><a href="#表头样式" class="headerlink" title="表头样式"></a>表头样式</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">th</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold; <span class="comment">/*加粗*/</span></span><br><span class="line">    <span class="attribute">text-align</span>: center <span class="meta">!important</span>; <span class="comment">/*内容居中，加上 !important 避免被 Markdown 样式覆盖*/</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">158</span>,<span class="number">188</span>,<span class="number">226</span>,<span class="number">0.2</span>); <span class="comment">/*背景色*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="隔行变色"><a href="#隔行变色" class="headerlink" title="隔行变色"></a>隔行变色</h4><ul>
<li>使用选择器选取复数行设置背景色。一般 Markdown 表格编译后都有 <code>&lt;tbody&gt;</code> 包裹内容，那下面就相当于从表格第二行开始计数</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">tbody</span> <span class="selector-tag">tr</span><span class="selector-pseudo">:nth-child(2n)</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">158</span>,<span class="number">188</span>,<span class="number">226</span>,<span class="number">0.12</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="悬浮变色"><a href="#悬浮变色" class="headerlink" title="悬浮变色"></a>悬浮变色</h4><ul>
<li>鼠标悬浮时该行改变背景色</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">tr</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#efefef</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="自适应优化"><a href="#自适应优化" class="headerlink" title="自适应优化"></a>自适应优化</h3><p>表格用 Markdown 书写，编辑器解析，因而只能在已经生成好的代码上进行自适应优化。</p>
<h4 id="表头不换行"><a href="#表头不换行" class="headerlink" title="表头不换行"></a>表头不换行</h4><ul>
<li>设置表头单元格内容不换行，这样可以通过表头控制该列的最小宽度，避免浏览器窗口缩小时内容被压缩得太紧</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">th</span> &#123;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap; <span class="comment">/*表头内容强制在一行显示*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="首列不换行"><a href="#首列不换行" class="headerlink" title="首列不换行"></a>首列不换行</h4><ul>
<li>表格第一列单元格内容不换行，多数情况下表格首列不应该被压缩换行</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span> <span class="selector-tag">td</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="表格滚动条"><a href="#表格滚动条" class="headerlink" title="表格滚动条"></a>表格滚动条</h4><ul>
<li>添加 JavaScript 代码，用一个 <code>&lt;div&gt;</code> 把表格包裹起来，父元素宽度不足时显示横向滚动条，避免表格撑破布局</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[].slice.call(<span class="built_in">document</span>.querySelectorAll(<span class="string">'table'</span>)).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">el</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wrapper = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    wrapper.className = <span class="string">'table-area'</span>;</span><br><span class="line">    el.parentNode.insertBefore(wrapper, el);</span><br><span class="line">    el.parentNode.removeChild(el);</span><br><span class="line">    wrapper.appendChild(el);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>jQuery</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$(<span class="string">"table"</span>).wrap(<span class="string">"&lt;div class='table-area'&gt;&lt;/div&gt;"</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>同时添加如下 CSS</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.table-area</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>To be added</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> markdown </tag>
            
            <tag> JavaScript </tag>
            
            <tag> css </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[gulp构建工具的使用]]></title>
      <url>https://blog.xiaomo.info/2016/GulpUse/</url>
      <content type="html"><![CDATA[<p>先前学习了webpack,但是总是感觉webpack略显复杂，并且现在很多公司gulp工作流用的比较多，因此就入gulp的坑来踩一踩，技多不压身，霍霍霍…。<br><a id="more"></a></p>
<h3 id="一、简介-增强和使你的工作自动化"><a href="#一、简介-增强和使你的工作自动化" class="headerlink" title="一、简介(增强和使你的工作自动化)"></a>一、简介(增强和使你的工作自动化)</h3><h4 id="1-使用简单"><a href="#1-使用简单" class="headerlink" title="1. 使用简单"></a>1. 使用简单</h4><p>没有繁琐的配置，一个任务一个task。通过代码优于配置的策略，Gulp 让简单的任务简单，复杂的任务可管理。  </p>
<h4 id="2-高效"><a href="#2-高效" class="headerlink" title="2. 高效"></a>2. 高效</h4><p>利用node强大的工作流，快速的构建项目并减少频繁的 IO 操作。  </p>
<h4 id="3-高质量"><a href="#3-高质量" class="headerlink" title="3. 高质量"></a>3. 高质量</h4><p>gulp生态圈有相当多优秀的插件以供我们使用，Gulp 严格的插件指南确保插件如你期望的那样简洁高质得工作。</p>
<h4 id="4-易学"><a href="#4-易学" class="headerlink" title="4. 易学"></a>4. 易学</h4><p>通过最少的 API，掌握 Gulp 毫不费力，构建工作尽在掌握：如同一系列流管道。</p>
<h3 id="二、gulp相关api"><a href="#二、gulp相关api" class="headerlink" title="二、gulp相关api"></a>二、gulp相关api</h3><h4 id="1-gulp-src-来源"><a href="#1-gulp-src-来源" class="headerlink" title="1. gulp.src: 来源"></a>1. <code>gulp.src</code>: 来源</h4><h4 id="2-gulp-dest-目标"><a href="#2-gulp-dest-目标" class="headerlink" title="2. gulp.dest: 目标"></a>2. <code>gulp.dest</code>: 目标</h4><h4 id="3-gulp-pipe-管道"><a href="#3-gulp-pipe-管道" class="headerlink" title="3. gulp.pipe: 管道"></a>3. <code>gulp.pipe</code>: 管道</h4><h4 id="4-gulp-watch-热加载"><a href="#4-gulp-watch-热加载" class="headerlink" title="4. gulp.watch: 热加载"></a>4. <code>gulp.watch</code>: 热加载</h4><h4 id="5-gulp-task-任务"><a href="#5-gulp-task-任务" class="headerlink" title="5. gulp.task: 任务"></a>5. <code>gulp.task</code>: 任务</h4><h4 id="6-gulp-task-‘default’"><a href="#6-gulp-task-‘default’" class="headerlink" title="6. gulp.task(‘default’)"></a>6. <code>gulp.task</code>(‘default’)</h4><p> 默认任务,必须存在</p>
<h3 id="三、使用-工作流程"><a href="#三、使用-工作流程" class="headerlink" title="三、使用(工作流程)"></a>三、使用(工作流程)</h3><h4 id="1-全局安装gulp"><a href="#1-全局安装gulp" class="headerlink" title="1. 全局安装gulp"></a>1. 全局安装gulp</h4><p><code>npm install -g gulp</code>  </p>
<h4 id="2-建立项目"><a href="#2-建立项目" class="headerlink" title="2. 建立项目"></a>2. 建立项目</h4><p><code>mkdir gulp-test &amp;&amp; cd gulp-test</code></p>
<h4 id="3-初始化项目"><a href="#3-初始化项目" class="headerlink" title="3. 初始化项目"></a>3. 初始化项目</h4><p><code>npm init -y</code>  (会生成package.json)   </p>
<h4 id="4-安装项目依赖"><a href="#4-安装项目依赖" class="headerlink" title="4. 安装项目依赖"></a>4. 安装项目依赖</h4><p><code>npm install --save-dev gulp</code></p>
<ol start="5">
<li>创建配置文件<br><code>touch gulpfile.js</code><h4 id="6-gulp常用的功能"><a href="#6-gulp常用的功能" class="headerlink" title="6. gulp常用的功能"></a>6. gulp常用的功能</h4>转码（<code>gulp-babel</code> <code>babel-preset-es2015</code> <code>gulp-sass</code> <code>gulp-less</code> <code>gulp-react</code>）、合并（<code>gulp-concat</code>）、压缩（<code>gulp-uglify</code>）、模块化（<code>gulp-browserify</code>）、测试（gulp-jasmine），请依次安装这些依赖。<h4 id="7-小常识"><a href="#7-小常识" class="headerlink" title="7. 小常识"></a>7. 小常识</h4>因为国外的网站比较慢 npm经常会卡住。我们可以设置镜像源或使用<code>cnpm</code>或者设置镜像源<code>npm config set registry https://registry.npm.taobao.org</code><h4 id="8-写配置"><a href="#8-写配置" class="headerlink" title="8. 写配置"></a>8. 写配置</h4>（gulpfile一定有一个default的任务，你可以把每个任务分文件书写然后再require进来，这种方式适合多人同时书写任务时，可以防止多人修改同一文件导致的冲突）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">"gulp"</span>);</span><br><span class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">"gulp-babel"</span>);</span><br><span class="line"><span class="keyword">var</span> react = <span class="built_in">require</span>(<span class="string">"gulp-react"</span>);</span><br><span class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">"gulp-sass"</span>);</span><br><span class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">"gulp-less"</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);</span><br><span class="line"><span class="keyword">var</span> jasmine = <span class="built_in">require</span>(<span class="string">"gulp-jasmine"</span>);</span><br><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">"gulp-concat"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义常量</span></span><br><span class="line"><span class="keyword">const</span> transformJs = <span class="string">"transformJs"</span>;</span><br><span class="line"><span class="keyword">const</span> transformSass = <span class="string">"transformSass"</span>;</span><br><span class="line"><span class="keyword">const</span> transformLess = <span class="string">"transformLess"</span>;</span><br><span class="line"><span class="keyword">const</span> test = <span class="string">'test'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//js</span></span><br><span class="line">gulp.task(transformJs, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"src/*.js"</span>)</span><br><span class="line">        .pipe(react())</span><br><span class="line">        .pipe(babel(</span><br><span class="line">            &#123;</span><br><span class="line">                presets: [<span class="string">"babel-preset-es2015"</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ))</span><br><span class="line">        .pipe(concat(<span class="string">'bundle.min.js'</span>))</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// scss</span></span><br><span class="line">gulp.task(transformSass, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"src/css/*.scss"</span>)</span><br><span class="line">        .pipe(sass())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// less</span></span><br><span class="line">gulp.task(transformLess, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"src/css/*.less"</span>)</span><br><span class="line">        .pipe(less())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// jasmine</span></span><br><span class="line">gulp.task(test, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"./test/*.js"</span>)</span><br><span class="line">        .pipe(jasmine())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">"default"</span>, [transformJs, transformSass, transformLess, test]);</span><br></pre></td></tr></table></figure>
<h3 id="四、配置文件解读"><a href="#四、配置文件解读" class="headerlink" title="四、配置文件解读"></a>四、配置文件解读</h3><h4 id="1-第一部分"><a href="#1-第一部分" class="headerlink" title="1. 第一部分"></a>1. 第一部分</h4><p>一堆<code>reqire</code>,是引用gulp相应的插件。在引用之前要确保己经安装。</p>
<h4 id="2-第二部分"><a href="#2-第二部分" class="headerlink" title="2. 第二部分"></a>2. 第二部分</h4><p>几个<code>const</code>,是定义任务名常量，有多几任务就定义多少常量。</p>
<h4 id="3-第三部分"><a href="#3-第三部分" class="headerlink" title="3. 第三部分"></a>3. 第三部分</h4><p>几个<code>task</code>,每个task对应一个任务，具有不同的功能。可以使用 <code>gulp xxx</code>来启动这个任务。</p>
<h4 id="4-第四部分"><a href="#4-第四部分" class="headerlink" title="4. 第四部分"></a>4. 第四部分</h4><p><code>default</code>,是执行<code>gulp</code>之后就会开始的任务 常用参数(<code>&#39;default&#39;,[task1,task2,...],callback[可选]</code>)。</p>
<h3 id="五、执行"><a href="#五、执行" class="headerlink" title="五、执行"></a>五、执行</h3><ol>
<li>如果要执行<code>default</code>任务，直接<code>gulp</code></li>
</ol>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Using</span> gulpfile e:\oscchina\gulp-start-kit\gulpfile.js</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Starting</span> <span class="string">'transformJs'</span>...</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Starting</span> <span class="string">'transformSass'</span>...</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Starting</span> <span class="string">'transformLess'</span>...</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Starting</span> <span class="string">'test'</span>...</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> spec, <span class="number">0</span> failures</span><br><span class="line"><span class="symbol">Finished</span> in <span class="number">0</span> seconds</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">04</span>] <span class="symbol">Finished</span> <span class="string">'test'</span> after <span class="number">62</span> ms</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">06</span>] <span class="symbol">Finished</span> <span class="string">'transformLess'</span> after <span class="number">2.66</span> s</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">06</span>] <span class="symbol">Finished</span> <span class="string">'transformSass'</span> after <span class="number">2.68</span> s</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">06</span>] <span class="symbol">Finished</span> <span class="string">'transformJs'</span> after <span class="number">2.7</span> s</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">06</span>] <span class="symbol">Finished</span> <span class="string">'default'</span> after <span class="number">32</span> μs</span><br><span class="line"></span><br><span class="line"><span class="symbol">Process</span> finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>如果想要执行单个任务，请输入 <code>gulp taskName</code>,例如<code>gulp test</code></li>
</ol>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">47</span>] Using gulpfile e:\oscchina\gulp-start-kit\gulpfile.js</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">47</span>] Starting <span class="string">'test'</span>...</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> spec, <span class="number">0</span> failures</span><br><span class="line">Finished <span class="keyword">in</span> <span class="number">0</span> seconds</span><br><span class="line">[<span class="number">09</span>:<span class="number">56</span>:<span class="number">47</span>] Finished <span class="string">'test'</span> after <span class="number">77</span> ms</span><br><span class="line"></span><br><span class="line">Process finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="六、gulp常见任务"><a href="#六、gulp常见任务" class="headerlink" title="六、gulp常见任务"></a>六、gulp常见任务</h3><h4 id="1-处理js"><a href="#1-处理js" class="headerlink" title="1. 处理js"></a>1. 处理js</h4><p>（包括转码、合并、压缩）  <a href="https://npm.taobao.org/package/gulp-babel" target="_blank" rel="noopener">gulp-babel</a> <a href="https://npm.taobao.org/package/babel-preset-es2015" target="_blank" rel="noopener">babel-preset-es2015</a> <a href="https://npm.taobao.org/package/gulp-concat" target="_blank" rel="noopener">gulp-concat</a> <a href="https://npm.taobao.org/package/gulp-uglify" target="_blank" rel="noopener">gulp-uglify</a></p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">gulp</span><span class="selector-class">.task</span>(transformJs, function () &#123;</span><br><span class="line">  <span class="selector-tag">return</span> <span class="selector-tag">gulp</span><span class="selector-class">.src</span>(<span class="string">"src/*.js"</span>)</span><br><span class="line">      <span class="selector-class">.pipe</span>(react())</span><br><span class="line">      <span class="selector-class">.pipe</span>(babel(</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="attribute">presets</span>: [<span class="string">"babel-preset-es2015"</span>]</span><br><span class="line">          &#125;</span><br><span class="line">      ))</span><br><span class="line">      <span class="selector-class">.pipe</span>(concat(<span class="string">'bundle.min.js'</span>))</span><br><span class="line">      <span class="selector-class">.pipe</span>(uglify())</span><br><span class="line">      <span class="selector-class">.pipe</span>(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="2-处理scss"><a href="#2-处理scss" class="headerlink" title="2. 处理scss"></a>2. 处理scss</h4><p>(包括转码、合并、压缩)  <a href="https://npm.taobao.org/package/gulp-sass" target="_blank" rel="noopener">gulp-sass</a>  <a href="https://npm.taobao.org/package/gulp-concat" target="_blank" rel="noopener">gulp-concat</a> <a href="https://npm.taobao.org/package/gulp-uglify" target="_blank" rel="noopener">gulp-uglify</a></p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scss</span></span><br><span class="line">gulp.task(transformSass, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"src/css/*.scss"</span>)</span><br><span class="line">        .pipe(sass())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-处理less"><a href="#3-处理less" class="headerlink" title="3. 处理less"></a>3. 处理less</h4><p>(包括转码、合并、压缩)  <a href="https://npm.taobao.org/package/gulp-less" target="_blank" rel="noopener">gulp-less</a>  <a href="https://npm.taobao.org/package/gulp-concat" target="_blank" rel="noopener">gulp-concat</a> <a href="https://npm.taobao.org/package/gulp-uglify" target="_blank" rel="noopener">gulp-uglify</a></p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line">gulp.task(transformLess, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">"src/css/*.less"</span>)</span><br><span class="line">      .pipe(less())</span><br><span class="line">      .pipe(gulp.dest(<span class="string">"./dist"</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="4-测试"><a href="#4-测试" class="headerlink" title="4. 测试"></a>4. 测试</h4><p><a href="https://npm.taobao.org/package/gulp-jasmine" target="_blank" rel="noopener">gulp-jasmine</a>  </p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// jasmine</span></span><br><span class="line">gulp.task(test, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">"./test/*.js"</span>)</span><br><span class="line">        .pipe(jasmine())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试文件 test.spec.js</span></span><br><span class="line">describe(<span class="string">'test one'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    it(<span class="string">'test'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        expect(<span class="literal">true</span>).toBe(<span class="literal">true</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="5-清理"><a href="#5-清理" class="headerlink" title="5. 清理"></a>5. 清理</h4><p> <a href="https://npm.taobao.org/package/gulp-clean" target="_blank" rel="noopener">gulp-clean</a></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="built_in">config</span>.dist + <span class="string">'/*'</span>, &#123;<span class="built_in">read</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">      .pipe(clean());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="6-热加载"><a href="#6-热加载" class="headerlink" title="6. 热加载"></a>6. 热加载</h4><p>  <a href="https://npm.taobao.org/package/gulp-util" target="_blank" rel="noopener">gulp-util</a> <a href="https://npm.taobao.org/package/gulp-watch" target="_blank" rel="noopener">gulp-watch</a></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">var util = <span class="built_in">require</span>(<span class="string">'gulp-util'</span>);</span><br><span class="line">var watch = <span class="built_in">require</span>(<span class="string">'gulp-watch'</span>);</span><br><span class="line">var <span class="built_in">config</span> = &#123;&#125;;</span><br><span class="line"><span class="built_in">config</span>.dist = <span class="string">'dist'</span>;</span><br><span class="line"><span class="built_in">config</span>.static = [</span><br><span class="line">  <span class="string">'bin/**/*'</span>,</span><br><span class="line">  <span class="string">'package.json'</span></span><br><span class="line">];</span><br><span class="line">// sync static resource <span class="keyword">in</span> production mode</span><br><span class="line">gulp.task(<span class="string">'static-sync'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="built_in">config</span>.static, &#123;base: <span class="string">'./'</span>&#125;)</span><br><span class="line">      .pipe(gulp.dest(<span class="built_in">config</span>.dist));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'static-sync:dev'</span>, [<span class="string">'static-sync'</span>], <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">  util.<span class="built_in">log</span>(<span class="string">'[Sync] starting file watch'</span>);</span><br><span class="line">  <span class="keyword">return</span> watch(<span class="built_in">config</span>.static, <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.event === <span class="string">'change'</span> || obj.event === <span class="string">'add'</span>)</span><br><span class="line">      <span class="keyword">return</span> gulp.src(obj.<span class="built_in">path</span>, &#123;base: <span class="string">'./'</span>&#125;)</span><br><span class="line">          .pipe(gulp.dest(<span class="built_in">config</span>.dist))</span><br><span class="line">          .pipe(<span class="built_in">print</span>(<span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'[Sync] file sync success: '</span> + obj.<span class="built_in">path</span>.replace(obj.base, <span class="string">''</span>);</span><br><span class="line">          &#125;));</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (obj.event === <span class="string">'unlink'</span>) &#123;</span><br><span class="line">      var distFilePath = obj.<span class="built_in">path</span>.replace(__dirname, __dirname + <span class="string">'/'</span> + <span class="built_in">config</span>.dist);</span><br><span class="line">      <span class="keyword">return</span> gulp.src(distFilePath)</span><br><span class="line">          .pipe(clean())</span><br><span class="line">          .pipe(<span class="built_in">print</span>(<span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'[Sync] file remove success: '</span> + obj.<span class="built_in">path</span>.replace(obj.base, <span class="string">''</span>);</span><br><span class="line">          &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="7-debug"><a href="#7-debug" class="headerlink" title="7. debug"></a>7. debug</h4><p> <a href="https://npm.taobao.org/package/gulp-print" target="_blank" rel="noopener">gulp-print</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//下载</span></span><br><span class="line">npm install gulp-<span class="keyword">print</span></span><br><span class="line"><span class="comment">//引用</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="keyword">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">print</span> = <span class="keyword">require</span>(<span class="string">'gulp-print'</span>);</span><br><span class="line"><span class="comment">// 注册任务</span></span><br><span class="line">gulp.task(<span class="string">'print'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">'test/*.js'</span>)</span><br><span class="line">    .pipe(<span class="keyword">print</span>())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="8-sourceMap"><a href="#8-sourceMap" class="headerlink" title="8. sourceMap"></a>8. sourceMap</h4><p>  <a href="https://npm.taobao.org/package/gulp-sourcemaps" target="_blank" rel="noopener">gulp-sourcemaps</a></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">var sourcemaps = <span class="built_in">require</span>(<span class="string">'gulp-sourcemaps'</span>);</span><br><span class="line">// compile server script <span class="keyword">in</span> production mode</span><br><span class="line">gulp.task(<span class="string">'compile:server'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">config</span>.babel.sourceMaps)&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'**/*.es6'</span>, &#123;base: <span class="string">'./'</span>&#125;)</span><br><span class="line">        .pipe(sourcemaps.init())</span><br><span class="line">        .pipe(babel(<span class="built_in">config</span>.babel))</span><br><span class="line">        .pipe(sourcemaps.<span class="built_in">write</span>(<span class="string">'.'</span>, &#123;sourceRoot: <span class="string">'/ustar'</span>&#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="built_in">config</span>.dist));</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'**/*.es6'</span>, &#123;base: <span class="string">'./'</span>&#125;)</span><br><span class="line">        .pipe(babel(&#123;</span><br><span class="line">          preset:<span class="string">'babel-preset-es2015'</span></span><br><span class="line">          &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="9-复制静态资源"><a href="#9-复制静态资源" class="headerlink" title="9. 复制静态资源"></a>9. 复制静态资源</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">gulp.task(<span class="string">'static-sync'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/css/*'</span>, &#123;base: <span class="string">'./'</span>&#125;)</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="10-处理css雪碧图"><a href="#10-处理css雪碧图" class="headerlink" title="10. 处理css雪碧图"></a>10. 处理css雪碧图</h4><p> <a href="https://npm.taobao.org/package/gulp-css-spriter" target="_blank" rel="noopener">gulp-css-spriter</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="keyword">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> spriter = <span class="keyword">require</span>(<span class="string">'gulp-css-spriter'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./src/css/styles.css'</span>)</span><br><span class="line">      .pipe(spriter(&#123;</span><br><span class="line">          <span class="comment">// The path and file name of where we will save the sprite sheet</span></span><br><span class="line">          <span class="string">'spriteSheet'</span>: <span class="string">'./dist/images/spritesheet.png'</span>,</span><br><span class="line">          <span class="comment">// Because we don't know where you will end up saving the CSS file at this point in the pipe,</span></span><br><span class="line">          <span class="comment">// we need a litle help identifying where it will be.</span></span><br><span class="line">          <span class="string">'pathToSpriteSheetFromCSS'</span>: <span class="string">'../images/spritesheet.png'</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(gulp.dest(<span class="string">'./dist/css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="11-压缩css"><a href="#11-压缩css" class="headerlink" title="11. 压缩css"></a>11. 压缩css</h4><p><a href="https://npm.taobao.org/package/gulp-minify-css" target="_blank" rel="noopener">gulp-minify-css</a></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">gulp.task(gulp_minify_css,<span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">return</span> gulp.src(<span class="string">'./dist/*.css'</span>)</span><br><span class="line">       .pipe(<span class="built_in">print</span>())</span><br><span class="line">       .pipe(minifycss())</span><br><span class="line">       .pipe(gulp.dest(<span class="built_in">config</span>.dist))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="12-压缩图片"><a href="#12-压缩图片" class="headerlink" title="12. 压缩图片"></a>12. 压缩图片</h4><p><a href="https://npm.taobao.org/package/gulp-imagemin" target="_blank" rel="noopener">gulp-imagemin</a></p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 压缩图片</span></span><br><span class="line">  <span class="selector-tag">gulp</span><span class="selector-class">.task</span>(<span class="string">'img'</span>, function() &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">gulp</span><span class="selector-class">.src</span>(<span class="string">'src/images/*'</span>)</span><br><span class="line">      <span class="selector-class">.pipe</span>(imagemin(&#123;</span><br><span class="line">          <span class="attribute">progressive</span>: true,</span><br><span class="line">          <span class="attribute">svgoPlugins</span>: [&#123;<span class="attribute">removeViewBox</span>: false&#125;],</span><br><span class="line">          <span class="attribute">use</span>: [pngcrush()]</span><br><span class="line">      &#125;))</span><br><span class="line">      <span class="selector-class">.pipe</span>(gulp.dest(<span class="string">'./dest/images/'</span>))</span><br><span class="line">      <span class="selector-class">.pipe</span>(notify(&#123; <span class="attribute">message</span>: <span class="string">'img task ok'</span> &#125;));</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="13-检查js"><a href="#13-检查js" class="headerlink" title="13. 检查js"></a>13. 检查js</h4><p>  <a href="https://npm.taobao.org/package/gulp-jshint" target="_blank" rel="noopener">gulp-jshint</a>  <a href="https://npm.taobao.org/package/jshint" target="_blank" rel="noopener">gulp-jshint</a></p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 检查js</span></span><br><span class="line">  <span class="selector-tag">gulp</span><span class="selector-class">.task</span>(<span class="string">'lint'</span>, function() &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">gulp</span><span class="selector-class">.src</span>(<span class="string">'src/js/*.js'</span>)</span><br><span class="line">      <span class="selector-class">.pipe</span>(jshint())</span><br><span class="line">      <span class="selector-class">.pipe</span>(jshint.reporter(<span class="string">'default'</span>))</span><br><span class="line">      <span class="selector-class">.pipe</span>(notify(&#123; <span class="attribute">message</span>: <span class="string">'lint task ok'</span> &#125;));</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="14-gzip压缩"><a href="#14-gzip压缩" class="headerlink" title="14. gzip压缩"></a>14. gzip压缩</h4><p> <a href="https://npm.taobao.org/package/gulp-gzip" target="_blank" rel="noopener">gulp-gzip</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> gzip = <span class="built_in">require</span>(<span class="string">'gulp-gzip'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'compress'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'./dev/scripts/*.js'</span>)</span><br><span class="line">    .pipe(gzip())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./public/scripts'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="15-处理前缀"><a href="#15-处理前缀" class="headerlink" title="15. 处理前缀"></a>15. 处理前缀</h4><p><a href="https://npm.taobao.org/package/gulp-autoprefixer" target="_blank" rel="noopener">gulp-autoprefixer</a></p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">var gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line">var autoprefixer = <span class="built_in">require</span>(<span class="string">'gulp-autoprefixer'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/app.css'</span>)</span><br><span class="line">    .pipe(sourcemaps.init())</span><br><span class="line">      .pipe(autoprefixer(&#123;</span><br><span class="line">          browsers: [<span class="string">'last 2 versions'</span>],</span><br><span class="line">          cascade: <span class="literal">false</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(<span class="built_in">concat</span>(<span class="string">'all.css'</span>))</span><br><span class="line">      .pipe(sourcemaps.<span class="built_in">write</span>(<span class="string">'.'</span>,&#123;sourceRoot:<span class="built_in">config</span>.dist&#125;))</span><br><span class="line">      .pipe(gulp.dest(<span class="string">'dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="七、项目地址"><a href="#七、项目地址" class="headerlink" title="七、项目地址"></a>七、项目地址</h3><p><a href="https://github.com/houko/gulp-start-kit" target="_blank" rel="noopener">gulp-start-kit</a></p>
]]></content>
      
        <categories>
            
            <category> technology </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> es6 </tag>
            
            <tag> nodejs </tag>
            
            <tag> gulp </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[前端工程化工具初选]]></title>
      <url>https://blog.xiaomo.info/2016/FrontEndTools/</url>
      <content type="html"><![CDATA[<p>　　面对日益纷杂的前端工具，作为新人常感无从下手。经过一番检索和简单对比，再结合自己的喜好，筛选了将要学习和使用的工具，以适应日益工程化、专业化的 Web 前端开发工作。</p>
<a id="more"></a>
<h3 id="库与框架"><a href="#库与框架" class="headerlink" title="库与框架"></a>库与框架</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://jquery.com/" target="_blank" rel="noopener">jQuery</a></li>
<li><a href="http://jqueryui.com/" target="_blank" rel="noopener">jQuery UI</a>: 一个JQuery的UI框架,特点是高效、组件化</li>
<li><a href="http://cn.vuejs.org/" target="_blank" rel="noopener">Vue.js</a>: 数据驱动的组件，为现代化的 Web 界面而生</li>
<li><a href="http://www.apjs.net/" target="_blank" rel="noopener">angularjs</a> 应用最广泛的企业级web开发框架</li>
<li><a href="https://angular.io/" target="_blank" rel="noopener">angular</a>: 新一代angular开发框架</li>
<li><a href="http://facebook.github.io/react/" target="_blank" rel="noopener">React.js</a>: 构建组化件应用的javascript库</li>
<li><a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native</a>: 使用react构建移动app应用</li>
<li><a href="https://flutter.cn/" target="_blank" rel="noopener">Flutter</a>: 新一代跨平台移动框架</li>
</ul>
<h3 id="构建工具-amp-模块化"><a href="#构建工具-amp-模块化" class="headerlink" title="构建工具&amp;模块化"></a>构建工具&amp;模块化</h3><p>一个构建、测试应用的构建工具</p>
<blockquote>
</blockquote>
<ul>
<li><a href="http://gulpjs.com/" target="_blank" rel="noopener">gulp.js</a>: 自动化工作流</li>
<li><a href="https://nodejs.org/" target="_blank" rel="noopener">node</a> 建立在V8引擎上的快速构建平台</li>
</ul>
<h3 id="模块打包器"><a href="#模块打包器" class="headerlink" title="模块打包器"></a>模块打包器</h3><p>将模块打包到一个bundle中</p>
<blockquote>
</blockquote>
<ul>
<li><a href="https://webpack.github.io/" target="_blank" rel="noopener">webpack</a>: 能够将依赖打包、生成的自动构建工具</li>
</ul>
<h3 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h3><p>一个用来管理依赖的包管理器，你可以使用它下载很多模块化的工具</p>
<blockquote>
</blockquote>
<ul>
<li><a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a>: Node 模块化管理工具</li>
</ul>
<h3 id="CSS-处理"><a href="#CSS-处理" class="headerlink" title="CSS 处理"></a>CSS 处理</h3><p>提供一个高效、动态的方法生成css</p>
<blockquote>
</blockquote>
<ul>
<li><a href="https://github.com/stylus/stylus" target="_blank" rel="noopener">Stylus</a>: node社区的css预处理器</li>
<li><a href="https://github.com/postcss/postcss" target="_blank" rel="noopener">PostCSS</a>: 将css转换成js插件</li>
</ul>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://exploringjs.com/es6/ch_modules.html" target="_blank" rel="noopener">ECMAScript 6 Module</a></li>
</ul>
<h3 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h3><p>使用js生成html文件</p>
<blockquote>
</blockquote>
<ul>
<li><a href="http://ejs.co/" target="_blank" rel="noopener">EJS</a></li>
<li><a href="http://jade-lang.com/" target="_blank" rel="noopener">jade</a></li>
</ul>
<h3 id="测试框架"><a href="#测试框架" class="headerlink" title="测试框架"></a>测试框架</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://mochajs.org/" target="_blank" rel="noopener">Mocha</a>: 一个简单、快速的用来测试node和web应用的测试框架</li>
<li><a href="http://chaijs.com/" target="_blank" rel="noopener">Chai</a>: Chai 是一个针对 Node.js 和浏览器的行为驱动测试和测试驱动测试的诊断库，可与任何 JavaScript 测试框架集成。</li>
</ul>
<h3 id="脚手架"><a href="#脚手架" class="headerlink" title="脚手架"></a>脚手架</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://yeoman.io/" target="_blank" rel="noopener">Yeoman</a> Web 应用开发流程与工具   </li>
<li><a href="https://npm.taobao.org/package/koa-generator" target="_blank" rel="noopener">koa-generator</a> koa项目生成器         </li>
</ul>
<h3 id="集成方案"><a href="#集成方案" class="headerlink" title="集成方案"></a>集成方案</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://fis.baidu.com/" target="_blank" rel="noopener">FIS</a>: 解决前端开发中自动化工具、性能优化、模块化框架、开发规范、代码部署、开发流程等问题</li>
</ul>
<h3 id="UI框架"><a href="#UI框架" class="headerlink" title="UI框架"></a>UI框架</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://bootcss.com/" target="_blank" rel="noopener">bootstrap</a> 简洁、直观、强悍的UI框架，让web开发更迅速,后端程序的福音。</li>
<li><a href="http://foundation.zurb.com/" target="_blank" rel="noopener">foundation</a> 最流行的响应式前前端布局框架</li>
<li><a href="http://www.semantic-ui.cn/" target="_blank" rel="noopener">semantic-ui</a> Semantic作为一个开发框架，通过HTML语言帮助创建令人赏心悦目、响应式的布局。</li>
<li><a href="http://callemall.github.io/material-ui/#/" target="_blank" rel="noopener">Material UI</a>  一组反应元件，实现谷歌的材料设计。</li>
<li><a href="http://ant.design/" target="_blank" rel="noopener">ant design</a> Ant Design 是一个 UI 设计语言，是一套提炼和应用于企业级后台产品的交互语言和视觉体系。</li>
</ul>
<h3 id="游戏引擎"><a href="#游戏引擎" class="headerlink" title="游戏引擎"></a>游戏引擎</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://createjs.com/" target="_blank" rel="noopener">CreateJS</a>  基于HTML5的一套模块化的库和工具共同工作或独立使丰富的交互式内容的开放式Web技术。</li>
<li><a href="http://phaser.io/" target="_blank" rel="noopener">PhaserJS</a>  PC端和移动端HTML5游戏框架 。</li>
<li><a href="http://threejs.org/" target="_blank" rel="noopener">ThreeJS</a> 制作HTML5的3D游戏引擎 。</li>
<li><a href="http://www.egret.com/" target="_blank" rel="noopener">白鹭</a> Egret是一套HTML5游戏开发解决方案</li>
<li><a href="http://www.cocos.com/" target="_blank" rel="noopener">Cocos2d-JS</a> 开发者可以通过cocos游戏开发引擎快速编辑界面和动画、编写和调试代码等，最终导出适合于各平台、各渠道发布的游戏安装包。<h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><blockquote>
<ul>
<li><a href="http://www.docker.com/" target="_blank" rel="noopener">Docker</a>: Build, Ship, and Run Any App, Anywhere</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="社区"><a href="#社区" class="headerlink" title="社区"></a>社区</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://stackoverflow.com/" target="_blank" rel="noopener">stackoverflow</a> 技术大牛多，素质好，质量高</li>
<li><a href="https://segmentfault.com/" target="_blank" rel="noopener">segmentfault</a> 自动生成目录，博客UI看起来相对漂亮</li>
<li><a href="http://www.oschina.net/" target="_blank" rel="noopener">开源中国</a> 支持开源文化</li>
</ul>
<h3 id="学习网站"><a href="#学习网站" class="headerlink" title="学习网站"></a>学习网站</h3><blockquote>
</blockquote>
<ul>
<li><a href="http://www.hubwiz.com/course/?type=free" target="_blank" rel="noopener">汇智网</a> 涉及面比较广,免费收费课程都有</li>
<li><a href="http://www.jikexueyuan.com/" target="_blank" rel="noopener">极客学院</a>  学习资源多,但比较泡面化</li>
<li><a href="http://www.imooc.com/" target="_blank" rel="noopener">慕课网</a>  质量高，但很多课程开始收费了  </li>
<li><a href="http://www.huachuanxueyuan.com/" target="_blank" rel="noopener">花川学院</a> 学习swift的好去处</li>
<li><a href="http://www.maiziedu.com/" target="_blank" rel="noopener">麦子学院</a> 后起之秀</li>
<li><a href="http://www.runoob.com/" target="_blank" rel="noopener">W3C菜鸟</a> 新手程序员的天堂</li>
<li><a href="http://www.yun.lu/student/homepage" target="_blank" rel="noopener">云路课堂</a> 极客风</li>
<li><a href="https://time.geekbang.org/" target="_blank" rel="noopener">极客时间</a> 基本上都是收费课程,接受知识付费的用户应该会觉得很有收货</li>
</ul>
<h3 id="其他常用网站"><a href="#其他常用网站" class="headerlink" title="其他常用网站"></a>其他常用网站</h3><blockquote>
</blockquote>
<ul>
<li><a href="https://github.com" target="_blank" rel="noopener">github</a> 程序员的QQ,面试的门面</li>
<li><a href="https://git.oschina.net" target="_blank" rel="noopener">码云</a> 和马云同名，给个面子</li>
<li><a href="https://npm.taobao.org/" target="_blank" rel="noopener">淘宝同步npm</a> 访问快，10分钟同步一次，查资料必备</li>
<li><a href="http://www.bootcdn.cn/" target="_blank" rel="noopener">bootCDN</a> 使用最普遍的CDN</li>
<li><a href="http://fontawesome.dashgame.com/" target="_blank" rel="noopener">font-awesome</a> 最好用的图标库</li>
<li><a href="http://json.cn/#" target="_blank" rel="noopener">JSON格式化</a>  这个时代的开发者谁离得了JSON呢</li>
<li><a href="http://fenav.com/#/p11" target="_blank" rel="noopener">开发工具</a> 全面省心</li>
</ul>
]]></content>
      
        <categories>
            
            <category> technology </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Anki 记忆库之 Excel 快捷键大全]]></title>
      <url>https://blog.xiaomo.info/2016/AnkiExcelShortcuts/</url>
      <content type="html"><![CDATA[<p></p><h2 id="intro">前言</h2>如果微软 Office 系列套件里只能保留一个，我会选择保留 Excel。只需要学一点基础的 Excel 知识，就能直观地感受到信息技术所带来的高效生产力。有些软件，掌握了它的快捷键，不仅能较全面地了解它的功能，也能极大地提升使用效率。Excel 就属于这类软件。<p></p>
<a id="more"></a>
<h3 id="记忆库使用"><a href="#记忆库使用" class="headerlink" title="记忆库使用"></a>记忆库使用</h3><p>所有快捷键已整理为 Anki 记忆库，下载后导入即可开始使用。</p>
<blockquote>
<p>下载: <a href="/resources/Excel-Shortcut-keys.apkg">Excel 快捷键大全 (Windows) for Anki</a></p>
</blockquote>
<p>释义默认中英对照显示，可按需隐藏。<br><img src="http://moxfive.xyz/resources/Anki-a1.png" alt="Anki-a1"></p>
<h3 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h3><p>列出自己平时使用最频繁的10个 Excel 快捷键。</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>快捷键</th>
<th>　　　　说明　　　　</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td>CTRL+D</td>
<td>使用“向下填充”命令将选定范围内最顶层单元格的内容和格式复制到下面的单元格中。</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>CTRL+ENTER</td>
<td>使用当前输入的条目填充选定的单元格区域。</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>F2</td>
<td>编辑活动单元格并将插入点放在单元格内容的结尾。如果禁止在单元格中进行编辑，它也会将插入点移到编辑栏中。</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td>CTRL+1</td>
<td>显示“单元格格式”对话框。</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td>CTRL+SHIFT+~</td>
<td>应用“常规”数字格式。</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td>CTRL+G</td>
<td>显示“定位”对话框。</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td>CTRL+`</td>
<td>在工作表中切换显示单元格值和公式。</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td>CTRL+’</td>
<td>将公式从活动单元格上方的单元格复制到单元格或编辑栏中。</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td>F4</td>
<td>重复上一个命令或操作（如有可能）。<br>编辑公式时，在绝对引用和相对引用间切换</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td>ALT+ENTER</td>
<td>在同一单元格中另起一个新行。</td>
</tr>
</tbody>
</table>
<h3 id="快捷键大全"><a href="#快捷键大全" class="headerlink" title="快捷键大全"></a>快捷键大全</h3><h4 id="Ctrl-组合快捷键"><a href="#Ctrl-组合快捷键" class="headerlink" title="Ctrl 组合快捷键"></a>Ctrl 组合快捷键</h4><table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>快捷键</th>
<th>　　　　说明　　　　</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td>CTRL+PgUp</td>
<td>向左切换工作表</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>CTRL+PgDn</td>
<td>向右切换工作表</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>CTRL+SHIFT+&amp;</td>
<td>将外框应用于选定单元格。</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td>CTRL+SHIFT_</td>
<td>从选定单元格删除外框。</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td>CTRL+SHIFT+~</td>
<td>应用“常规”数字格式。</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td>CTRL+SHIFT+$</td>
<td>应用带有两位小数的“货币”格式（负数放在括号中）。</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td>CTRL+SHIFT+%</td>
<td>应用不带小数位的“百分比”格式。</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td>CTRL+SHIFT+^</td>
<td>应用带有两位小数的“指数”格式。</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td>CTRL+SHIFT+#</td>
<td>应用带有日、月和年的“日期”格式。</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td>CTRL+SHIFT+@</td>
<td>应用带有小时和分钟以及 AM 或 PM 的“时间”格式。</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td>CTRL+SHIFT+!</td>
<td>应用带有两位小数、千位分隔符和减号 (-)（用于负值）的“数值”格式。</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td>CTRL+SHIFT+*</td>
<td>选择环绕活动单元格的当前区域（由空白行和空白列围起的数据区域）。<br>在数据透视表中，它将选择整个数据透视表。</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td>CTRL+SHIFT+:</td>
<td>输入当前时间。</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td>CTRL+SHIFT+”</td>
<td>将值从活动单元格上方的单元格复制到单元格或编辑栏中。</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td>CTRL+SHIFT+Plus (+)</td>
<td>显示用于插入空白单元格的“插入”对话框。</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td>CTRL+Minus (-)</td>
<td>显示用于删除选定单元格的“删除”对话框。</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td>CTRL+;</td>
<td>输入当前日期。</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td>CTRL+`</td>
<td>在工作表中切换显示单元格值和公式。</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td>CTRL+’</td>
<td>将公式从活动单元格上方的单元格复制到单元格或编辑栏中。</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td>CTRL+1</td>
<td>显示“单元格格式”对话框。</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td>CTRL+2</td>
<td>应用或取消加粗格式设置。</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td>CTRL+3</td>
<td>应用或取消倾斜格式设置。</td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td>CTRL+4</td>
<td>应用或取消下划线。</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td>CTRL+5</td>
<td>应用或取消删除线。</td>
</tr>
<tr>
<td style="text-align:center">25</td>
<td>CTRL+6</td>
<td>在隐藏对象、显示对象和显示对象占位符之间切换。</td>
</tr>
<tr>
<td style="text-align:center">26</td>
<td>CTRL+8</td>
<td>显示或隐藏大纲符号。</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td>CTRL+9</td>
<td>隐藏选定的行。</td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td>CTRL+0</td>
<td>隐藏选定的列。</td>
</tr>
<tr>
<td style="text-align:center">29</td>
<td>CTRL+A</td>
<td>☆选择整个工作表。<br>☆如果工作表包含数据，则按 Ctrl+A 将选择当前区域，再次按 Ctrl+A 将选择当前区域及其汇总行，第三次按 Ctrl+A 将选择整个工作表。<br>☆当插入点位于公式中某个函数名称的右边时，则会显示“函数参数”对话框。<br>☆当插入点位于公式中某个函数名称的右边时，按 Ctrl+Shift+A 将会插入参数名称和括号。</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td>CTRL+B</td>
<td>应用或取消加粗格式设置。</td>
</tr>
<tr>
<td style="text-align:center">31</td>
<td>CTRL+C</td>
<td>复制选定的单元格。<br>如果连续按两次 Ctrl+C，则会显示剪贴板。</td>
</tr>
<tr>
<td style="text-align:center">32</td>
<td>CTRL+D</td>
<td>使用“向下填充”命令将选定范围内最顶层单元格的内容和格式复制到下面的单元格中。</td>
</tr>
<tr>
<td style="text-align:center">33</td>
<td>CTRL+F</td>
<td>显示“查找和替换”对话框，其中的“查找”选项卡处于选中状态。<br>按 Shift+F5 也会显示此选项卡。</td>
</tr>
<tr>
<td style="text-align:center">34</td>
<td>SHIFT+F4</td>
<td>重复上一次“查找”操作。</td>
</tr>
<tr>
<td style="text-align:center">35</td>
<td>CTRL+SHIFT+F<br>CTRL+SHIFT+P</td>
<td>打开“设置单元格格式”对话框，且其中的“字体”选项卡处于选中状态。</td>
</tr>
<tr>
<td style="text-align:center">36</td>
<td>CTRL+G<br>F5</td>
<td>显示“定位”对话框。</td>
</tr>
<tr>
<td style="text-align:center">37</td>
<td>CTRL+H</td>
<td>显示“查找和替换”对话框，其中的“替换”选项卡处于选中状态。</td>
</tr>
<tr>
<td style="text-align:center">38</td>
<td>CTRL+I</td>
<td>应用或取消倾斜格式设置。</td>
</tr>
<tr>
<td style="text-align:center">39</td>
<td>CTRL+K</td>
<td>为新的超链接显示“插入超链接”对话框，或为选定的现有超链接显示“编辑超链接”对话框。</td>
</tr>
<tr>
<td style="text-align:center">40</td>
<td>CTRL+N</td>
<td>创建一个新的空白工作簿。</td>
</tr>
<tr>
<td style="text-align:center">41</td>
<td>CTRL+O</td>
<td>显示“打开”对话框以打开或查找文件。</td>
</tr>
<tr>
<td style="text-align:center">42</td>
<td>CTRL+SHIFT+O</td>
<td>选择所有包含批注的单元格。</td>
</tr>
<tr>
<td style="text-align:center">43</td>
<td>CTRL+P</td>
<td>显示“打印”对话框。</td>
</tr>
<tr>
<td style="text-align:center">44</td>
<td>CTRL+R</td>
<td>使用“向右填充”命令将选定范围最左边单元格的内容和格式复制到右边的单元格中。</td>
</tr>
<tr>
<td style="text-align:center">45</td>
<td>CTRL+S</td>
<td>使用其当前文件名、位置和文件格式保存活动文件。</td>
</tr>
<tr>
<td style="text-align:center">46</td>
<td>CTRL+T</td>
<td>显示“创建表”对话框。</td>
</tr>
<tr>
<td style="text-align:center">47</td>
<td>CTRL+U</td>
<td>应用或取消下划线。</td>
</tr>
<tr>
<td style="text-align:center">48</td>
<td>CTRL+SHIFT+U</td>
<td>在展开和折叠编辑栏之间切换。</td>
</tr>
<tr>
<td style="text-align:center">49</td>
<td>CTRL+V</td>
<td>在插入点处插入剪贴板的内容，并替换任何所选内容。只有在剪切或复制了对象、文本或单元格内容之后，才能使用此快捷键。</td>
</tr>
<tr>
<td style="text-align:center">50</td>
<td>CTRL+ALT+V</td>
<td>显示“选择性粘贴”对话框。只有在剪切或复制了工作表或其他程序中的对象、文本或单元格内容后此快捷键才可用。</td>
</tr>
<tr>
<td style="text-align:center">51</td>
<td>CTRL+W</td>
<td>关闭选定的工作簿窗口。</td>
</tr>
<tr>
<td style="text-align:center">52</td>
<td>CTRL+X</td>
<td>剪切选定的单元格。</td>
</tr>
<tr>
<td style="text-align:center">53</td>
<td>CTRL+Y</td>
<td>重复上一个命令或操作（如有可能）。</td>
</tr>
<tr>
<td style="text-align:center">54</td>
<td>CTRL+Z</td>
<td>使用“撤消”命令来撤消上一个命令或删除最后键入的内容。</td>
</tr>
<tr>
<td style="text-align:center">55</td>
<td>CTRL+SHIFT+Z</td>
<td>显示了自动更正智能标记时，可撤消或恢复上一次自动更正操作。</td>
</tr>
</tbody>
</table>
<h4 id="功能键"><a href="#功能键" class="headerlink" title="功能键"></a>功能键</h4><table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>快捷键</th>
<th>　　　　说明　　　　</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td>F1</td>
<td>显示“Microsoft Office Excel 帮助”任务窗格。</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>ALT+F1</td>
<td>创建当前范围中数据的图表。</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>ALT+SHIFT+F1</td>
<td>插入新的工作表。</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td>F2</td>
<td>编辑活动单元格并将插入点放在单元格内容的结尾。如果禁止在单元格中进行编辑，它也会将插入点移到编辑栏中。</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td>SHIFT+F2</td>
<td>添加或编辑单元格批注。</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td>CTRL+F2</td>
<td>显示“打印预览”窗口。</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td>F3</td>
<td>显示“粘贴名称”对话框。</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td>SHIFT+F3</td>
<td>显示“插入函数”对话框。</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td>F4</td>
<td>“重复上一个命令或操作（如有可能）。<br>编辑公式时，在绝对引用和相对引用间切换”</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td>Ctrl+F4</td>
<td>关闭选定的工作簿窗口。</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td>Ctrl+F5</td>
<td>从最大化中恢复选定工作簿窗口的窗口大小。</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td>F6</td>
<td>在工作表、功能区、任务窗格和缩放控件之间切换。在已拆分（通过依次单击“视图”菜单、“管理此窗口”、“冻结窗格”、“拆分窗口”命令来进行拆分）的工作表中，在窗格和功能区区域之间切换时，按 F6 可包括已拆分的窗格。</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td>SHIFT+F6</td>
<td>在工作表、缩放控件、任务窗格和功能区之间切换。</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td>CTRL+F6</td>
<td>如果打开了多个工作簿窗口，则可切换到下一个工作簿窗口。</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td>F7</td>
<td>显示“拼写检查”对话框，以检查活动工作表或选定范围中的拼写。</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td>CTRL+F7</td>
<td>如果工作簿窗口未最大化，则可对该窗口执行“移动”命令。使用箭头键移动窗口，并在完成时按 Enter，或按 Esc 取消。</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td>F8</td>
<td>打开或关闭扩展模式。在扩展模式中，“扩展选定区域”将出现在状态行中，并且按箭头键可扩展选定范围。</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td>SHIFT+F8</td>
<td>使用箭头键将非邻近单元格或区域添加到单元格的选定范围中。</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td>CTRL+F8</td>
<td>当工作簿未最大化时，可执行“大小”命令（在工作簿窗口的“控制”菜单上）。</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td>ALT+F8</td>
<td>显示用于创建、运行、编辑或删除宏的“宏”对话框。</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td>F9</td>
<td>计算所有打开的工作簿中的所有工作表。</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td>SHIFT+F9</td>
<td>按 Shift+F9 可计算活动工作表。</td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td>CTRL+ALT+F9</td>
<td>计算所有打开的工作簿中的所有工作表，不管它们自上次计算以来是否已更改。</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td>CTRL+ALT+SHIFT+F9</td>
<td>重新检查相关公式，然后计算所有打开的工作簿中的所有单元格，其中包括未标记为需要计算的单元格。</td>
</tr>
<tr>
<td style="text-align:center">25</td>
<td>CTRL+F9</td>
<td>将工作簿窗口最小化为图标。</td>
</tr>
<tr>
<td style="text-align:center">26</td>
<td>F10</td>
<td>“打开或关闭键盘操作提示。<br>当打开提示时箭头键可用于导航。”</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td>SHIFT+F10</td>
<td>按 Shift+F10 可显示选定项目的快捷菜单。</td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td>ALT+SHIFT+F10</td>
<td>显示智能标记的菜单或消息。如果存在多个智能标记，按该组合键可切换到下一个智能标记并显示其菜单或消息。</td>
</tr>
<tr>
<td style="text-align:center">29</td>
<td>CTRL+F10</td>
<td>最大化或还原选定的工作簿窗口。</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td>F11</td>
<td>创建当前范围内数据的图表。</td>
</tr>
<tr>
<td style="text-align:center">31</td>
<td>SHIFT+F11</td>
<td>按 Shift+F11 可插入一个新工作表。</td>
</tr>
<tr>
<td style="text-align:center">32</td>
<td>ALT+F11</td>
<td>打开 Microsoft Visual Basic 编辑器，您可以在其中通过使用 Visual Basic for Applications (VBA) 来创建宏。</td>
</tr>
<tr>
<td style="text-align:center">33</td>
<td>F12</td>
<td>显示“另存为”对话框。</td>
</tr>
</tbody>
</table>
<h4 id="其他实用快捷键"><a href="#其他实用快捷键" class="headerlink" title="其他实用快捷键"></a>其他实用快捷键</h4><table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>快捷键</th>
<th>　　　　说明　　　　</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td>ARROW KEYS</td>
<td>在工作表中上移、下移、左移或右移一个单元格。</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>CTRL+ARROW KEY</td>
<td>移动到工作表中当前数据区域的边缘。</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>SHIFT+ARROW KEY</td>
<td>将单元格的选定范围扩大一个单元格。</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td>CTRL+SHIFT+ARROW KEY</td>
<td>按 Ctrl+Shift+箭头键可将单元格的选定范围扩展到活动单元格所在列或行中的最后一个非空单元格，或者如果下一个单元格为空，则将选定范围扩展到下一个非空单元格。</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td>BACKSPACE</td>
<td>在编辑栏中删除左边的一个字符。<br>也可清除活动单元格的内容。<br>在单元格编辑模式下，按该键将会删除插入点左边的字符。</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td>DELETE</td>
<td>从选定单元格中删除单元格内容（数据和公式），而不会影响单元格格式或批注。<br>在单元格编辑模式下，按该键将会删除插入点右边的字符。</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td>END</td>
<td>当 Scroll Lock 处于开启状态时，移动到窗口右下角的单元格。<br>当菜单或子菜单处于可见状态时，也可选择菜单上的最后一个命令。</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td>CTRL+END</td>
<td>移动到工作表上的最后一个单元格，即所使用的最下面一行与所使用的最右边一列的交汇单元格。如果光标位于编辑栏中，它会将光标移到文本的末尾。</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td>CTRL+SHIFT+END</td>
<td>按 Ctrl+Shift+End 可将单元格选定区域扩展到工作表上所使用的最后一个单元格（位于右下角）。如果光标位于编辑栏中，则按 Ctrl+Shift+End 可选择编辑栏中从光标所在位置到末尾处的所有文本，这不会影响编辑栏的高度。</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td>ENTER</td>
<td>从单元格或编辑栏中完成单元格输入，并（默认）选择下面的单元格。<br>打开选定的菜单（按 F10 激活菜单栏），或执行选定命令的操作。<br>在数据表单中，按该键可移动到下一条记录中的第一个字段。<br>在对话框中，按该键可执行对话框中默认命令按钮（带有突出轮廓的按钮，通常为“确定”按钮）的操作。</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td>ALT+ENTER</td>
<td>在同一单元格中另起一个新行。</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td>CTRL+ENTER</td>
<td>使用当前输入的条目填充选定的单元格区域。</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td>SHIFT+ENTER</td>
<td>完成单元格输入并选择上面的单元格。</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td>ESC</td>
<td>取消单元格或编辑栏中的输入。<br>关闭打开的菜单或子菜单、对话框或消息窗口。<br>在应用全屏模式时，按该键还可关闭此模式，返回到普通屏幕模式，再次显示功能区和状态栏。</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td>HOME</td>
<td>移到工作表中某一行的开头。<br>当 Scroll Lock 处于开启状态时，移到窗口左上角的单元格。<br>当菜单或子菜单处于可见状态时，选择菜单上的第一个命令。</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td>CTRL+HOME</td>
<td>移到工作表的开头。</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td>CTRL+SHIFT+HOME</td>
<td>将单元格的选定范围扩展到工作表的开头。</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td>PAGE DOWN</td>
<td>在工作表中下移一个屏幕。</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td>ALT+PAGE DOWN</td>
<td>在工作表中向右移动一个屏幕。</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td>CTRL+SHIFT+PAGE DOWN</td>
<td>选择工作簿中的当前和下一个工作表。</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td>PAGE UP</td>
<td>在工作表中上移一个屏幕。</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td>ALT+PAGE UP</td>
<td>在工作表中向左移动一个屏幕。</td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td>CTRL+SHIFT+PAGE UP</td>
<td>选择工作簿中的当前和上一个工作表。</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td>SPACEBAR</td>
<td>在对话框中，执行选定按钮的操作，或者选中或清除复选框。</td>
</tr>
<tr>
<td style="text-align:center">25</td>
<td>CTRL+SPACEBAR</td>
<td>选择工作表中的整列。</td>
</tr>
<tr>
<td style="text-align:center">26</td>
<td>SHIFT+SPACEBAR</td>
<td>选择工作表中的整行。</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td>CTRL+SHIFT+SPACEBAR</td>
<td>按 Ctrl+Shift+空格键可选择整个工作表。<br>如果工作表中包含数据，则按 Ctrl+Shift+空格键将选择当前区域，再按一次 Ctrl+Shift+空格键将选择当前区域及其汇总行，第三次按 Ctrl+Shift+空格键将选择整个工作表。<br>当某个对象处于选定状态时，按 Ctrl+Shift+空格键可选择工作表上的所有对象。</td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td>ALT+SPACEBAR</td>
<td>显示 Microsoft Office Excel 窗口的“控制”菜单。</td>
</tr>
<tr>
<td style="text-align:center">29</td>
<td>TAB</td>
<td>在工作表中向右移动一个单元格。<br>在受保护的工作表中，可在未锁定的单元格之间移动。<br>在对话框中，移到下一个选项或选项组。</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td>SHIFT+TAB</td>
<td>移到前一个单元格（在工作表中）或前一个选项（在对话框中）。</td>
</tr>
<tr>
<td style="text-align:center">31</td>
<td>CTRL+TAB</td>
<td>在对话框中，按 Ctrl+Tab 可切换到下一个选项卡。</td>
</tr>
<tr>
<td style="text-align:center">32</td>
<td>CTRL+SHIFT+TAB</td>
<td>在对话框中，按 Ctrl+Shift+Tab 可切换到前一个选项卡。</td>
</tr>
</tbody>
</table>
<h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><ol>
<li>微软 Office 帮助中心: <a href="https://support.office.com/zh-cn/article/Excel-%e5%bf%ab%e6%8d%b7%e9%94%ae%e5%92%8c%e5%8a%9f%e8%83%bd%e9%94%ae-1798d9d5-842a-42b8-9c99-9b7213f0040f?ui=zh-CN&amp;rs=zh-CN&amp;ad=CN" target="_blank" rel="noopener">Excel 快捷键和功能键</a></li>
<li>Microsoft Office Support: <a href="https://support.office.com/en-ca/article/Excel-shortcut-and-function-keys-1798d9d5-842a-42b8-9c99-9b7213f0040f" target="_blank" rel="noopener">Excel shortcut and function keys</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS font-family 网页字体使用小结]]></title>
      <url>https://blog.xiaomo.info/2016/CssFontFamily/</url>
      <content type="html"><![CDATA[<p></p><h2 id="intro">前言</h2>一直到最近才开始调整博客的字体，之前都是全站微软雅黑了事。慢慢调整后发现 font-family 这个属性相关的知识还是不少的，整理一下常用的部分，分享于此。<p></p>
<a id="more"></a>
<h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><h4 id="使用语法"><a href="#使用语法" class="headerlink" title="使用语法"></a>使用语法</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">font-family</span>: 字体名1, 字体名2, 字体名<span class="selector-tag">n</span>, 字体系列名;</span><br><span class="line"><span class="selector-tag">font-family</span>: <span class="selector-tag">Verdana</span>, <span class="selector-tag">Helvetica</span>, "<span class="selector-tag">Microsoft</span> <span class="selector-tag">YaHei</span>", <span class="selector-tag">Arial</span>;</span><br></pre></td></tr></table></figure>
<h4 id="语法说明"><a href="#语法说明" class="headerlink" title="语法说明"></a>语法说明</h4><blockquote>
<ol>
<li>系统将选择列表中最先可用的字体来显示文字;</li>
<li>因为规则1，通常在最末添加一个 generic-family 字体系列名，保证文字获得相似的显示效果;</li>
<li>因为规则1，西文字体名应该写在中文字体前，这样才能中英文同时使用不同字体;</li>
<li>字体名为中文或包含空格等时，需要加双引号””才能正确识别;</li>
<li>中文字体建议也是用其对应英文字体名，如”微软雅黑”为”Microsoft YaHei”，以提高编码兼容性。</li>
</ol>
</blockquote>
<h3 id="常见字体系列"><a href="#常见字体系列" class="headerlink" title="常见字体系列"></a>常见字体系列</h3><h4 id="Serif-衬线字体"><a href="#Serif-衬线字体" class="headerlink" title="Serif 衬线字体"></a>Serif 衬线字体</h4><ul>
<li>Times New Roman, Georgia 和宋体都是很常见的衬线字体；</li>
<li>特征: 文字笔划的开始或结束处有额外的装饰，笔划有粗细之分。</li>
</ul>
<p><img src="http://moxfive.xyz/resources/serif.png" alt="serif"></p>
<h4 id="Sans-serif-无衬线字体"><a href="#Sans-serif-无衬线字体" class="headerlink" title="Sans-serif 无衬线字体"></a>Sans-serif 无衬线字体</h4><ul>
<li>Arial, Verdana, Tahoma, 微软雅黑都是很常见的无衬线字体;</li>
<li>说明: <code>sans-</code>源于法语前缀，意思为<code>没有</code>。Sans-serif 也就是指无衬线字体。</li>
<li>特征: 字体比较圆滑，笔划较为均匀。</li>
</ul>
<p><img src="http://moxfive.xyz/resources/sans-serif.png" alt="sans-serif"></p>
<ul>
<li>字体选用: 有种说法是正文多用衬线字体，易于区分；标题多用无衬线字体。不过这个也看个人喜好，我更习惯正文用无衬线字体。如果实在不知道怎么选，随便找一个自己看着舒服的网站，套用它的字体样式好了。</li>
</ul>
<h4 id="Monospace-等宽字体"><a href="#Monospace-等宽字体" class="headerlink" title="Monospace 等宽字体"></a>Monospace 等宽字体</h4><ul>
<li>Courier New, Consolas, Menlo 都是比较常见的等宽字体;</li>
<li>特征: 字母、数字、空格以及其他符号所占宽度都一致。识别度高，易于对齐和定位，通常用于显示代码。</li>
</ul>
<p><img src="http://moxfive.xyz/resources/Monospace.png" alt="Monospace"></p>
<ul>
<li>一个优秀的代码字体除了等宽外，还应该能较好地区分出<code>0 o O i l 1 I &quot;&quot; &#39;&#39; [] () {}</code> 等字符。</li>
</ul>
<h4 id="Cursive-手写体"><a href="#Cursive-手写体" class="headerlink" title="Cursive 手写体"></a>Cursive 手写体</h4><ul>
<li>Comic Sans, Author, 华文行楷都是比较常见的仿手写体;</li>
<li>特征: 模仿人的手写体，笔划圆滑或者有连笔等装饰。英文的花体，中文的行书草书等都属于此类。</li>
</ul>
<p><img src="http://moxfive.xyz/resources/cursive.png" alt="cursive"></p>
<h3 id="获取字体名称"><a href="#获取字体名称" class="headerlink" title="获取字体名称"></a>获取字体名称</h3><p>同一个字体在不同系统和应用中可能会显示为不同名字，但其内部一般有一个不变的英文名字。CSS font-family 需要引用的就是字体的内部名字。</p>
<h4 id="本地字体"><a href="#本地字体" class="headerlink" title="本地字体"></a>本地字体</h4><ul>
<li>Win 上通过搜索或控制面板进入字体文件夹，然后双击字体查看字体名称;</li>
<li>通过软件，如记事本、Office 等也可以查看字体名字:</li>
</ul>
<p><img src="http://moxfive.xyz/resources/font-a1.png" alt="font-a1"></p>
<ul>
<li>Mac 上搜索打开字体册即可，中间一栏显示的就是字体名称:</li>
</ul>
<p><img src="http://moxfive.xyz/resources/font-a2.png" alt="font-a2"></p>
<h4 id="网页字体"><a href="#网页字体" class="headerlink" title="网页字体"></a>网页字体</h4><ul>
<li>审查元素，查看生效的 font-family:</li>
</ul>
<p><img src="http://moxfive.xyz/resources/font-a3.png" alt="font-a3"></p>
<ul>
<li>通过 Chrome 插件 <a href="http://chengyinliu.com/whatfont.html" target="_blank" rel="noopener">WhatFont</a>:</li>
</ul>
<p><img src="http://moxfive.xyz/resources/font-a4.png" alt="font-a4"></p>
<h3 id="字体图标"><a href="#字体图标" class="headerlink" title="字体图标"></a>字体图标</h3><p>使用<code>@font-face</code>引入字体后，可以像使用文字那样，无损的控制图标的大小，颜色等样式。常见的有 Webdings，Wingdings, <a href="http://fontawesome.io/" target="_blank" rel="noopener">Font Awesome</a>.</p>
<p><img src="http://moxfive.xyz/resources/font-icon.png" alt="font-icon"></p>
<h3 id="备用记录"><a href="#备用记录" class="headerlink" title="备用记录"></a>备用记录</h3><h4 id="字体配置"><a href="#字体配置" class="headerlink" title="字体配置"></a>字体配置</h4><ul>
<li>下面是自己目前比较常用的字体配置，通常按系列设置为 CSS 预处理器的变量，方便调用。</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">//中文</span></span><br><span class="line"><span class="attribute">font</span>-chs = <span class="string">"Microsoft YaHei"</span>, <span class="string">"Hiragino Sans GB"</span>, <span class="string">"WenQuanYi Micro Hei"</span></span><br><span class="line"><span class="comment">//无衬线字体 sans-serif</span></span><br><span class="line"><span class="attribute">font</span>-sans = Verdana, <span class="string">"Helvetica Neue"</span>, Helvetica, Tahoma, Arial</span><br><span class="line"><span class="comment">//衬线字体 serif</span></span><br><span class="line"><span class="attribute">font</span>-serif = Times, Georgia</span><br><span class="line"><span class="comment">//等宽字体 monospace</span></span><br><span class="line"><span class="attribute">font</span>-mono = Menlo, Consolas, <span class="string">"Source Code Pro"</span>, Inconsolata, Monaco, <span class="string">"Courier New"</span></span><br></pre></td></tr></table></figure>
<h3 id="字体英文名"><a href="#字体英文名" class="headerlink" title="字体英文名"></a>字体英文名</h3><ul>
<li>一些常见中文字体的对应英文名。</li>
</ul>
<style>
    .fa-apple {
        color: #9d9e9d;
    }
    .fa-windows {
        color: #4ca6e7;
    }
</style>

<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>中文名</th>
<th>英文名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td><i class="fa fa-apple"></i> 苹方</td>
<td>PingFang SC</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td><i class="fa fa-apple"></i> 冬青黑/苹果丽黑</td>
<td>Hiragino Sans GB</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td><i class="fa fa-apple"></i> 思源黑体</td>
<td>Source Han Sans CN</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td><i class="fa fa-apple"></i> 华文细黑</td>
<td>STHeiti Light [STXihei]</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td><i class="fa fa-apple"></i> 华文黑体</td>
<td>ST Heiti</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td><i class="fa fa-apple"></i> 华文楷体</td>
<td>STKaiti</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td><i class="fa fa-apple"></i> 华文宋体</td>
<td>STSong</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td><i class="fa fa-apple"></i> 华文仿宋</td>
<td>STFangsong</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td><i class="fa fa-apple"></i> 丽黑 Pro</td>
<td>LiHei Pro Medium</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td><i class="fa fa-apple"></i> 丽宋 Pro</td>
<td>LiSong Pro Light</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td><i class="fa fa-apple"></i> 标楷体</td>
<td>BiauKai</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td><i class="fa fa-apple"></i> 苹果丽中黑</td>
<td>Apple LiGothic Medium</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td><i class="fa fa-apple"></i> 苹果丽细宋</td>
<td>Apple LiSung Light</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td><i class="fa fa-windows"></i> 新细明体</td>
<td>PMingLiU</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td><i class="fa fa-windows"></i> 细明体</td>
<td>MingLiU</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td><i class="fa fa-windows"></i> 标楷体</td>
<td>DFKai-SB</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td><i class="fa fa-windows"></i> (中易)黑体</td>
<td>SimHei</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td><i class="fa fa-windows"></i> 宋体</td>
<td>SimSun</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td><i class="fa fa-windows"></i> 新宋体</td>
<td>NSimSun</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td><i class="fa fa-windows"></i> 仿宋</td>
<td>FangSong</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td><i class="fa fa-windows"></i> 楷体</td>
<td>KaiTi</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td><i class="fa fa-windows"></i> 仿宋_GB2312</td>
<td>FangSong_GB2312</td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td><i class="fa fa-windows"></i> 楷体_GB2312</td>
<td>KaiTi_GB2312</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td><i class="fa fa-windows"></i> 微软正黑体</td>
<td>Microsoft JhengHei</td>
</tr>
<tr>
<td style="text-align:center">25</td>
<td><i class="fa fa-windows"></i> 微软雅黑</td>
<td>Microsoft YaHei</td>
</tr>
<tr>
<td style="text-align:center">26</td>
<td><i class="fa fa-file-word-o"></i>  隶书</td>
<td>LiSu</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td><i class="fa fa-file-word-o"></i>  幼圆</td>
<td>YouYuan</td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td><i class="fa fa-file-word-o"></i>  华文中宋</td>
<td>STZhongsong</td>
</tr>
<tr>
<td style="text-align:center">29</td>
<td><i class="fa fa-file-word-o"></i>  方正舒体</td>
<td>FZShuTi</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td><i class="fa fa-file-word-o"></i>  方正姚体</td>
<td>FZYaoti</td>
</tr>
<tr>
<td style="text-align:center">31</td>
<td><i class="fa fa-file-word-o"></i>  华文彩云</td>
<td>STCaiyun</td>
</tr>
<tr>
<td style="text-align:center">32</td>
<td><i class="fa fa-file-word-o"></i>  华文琥珀</td>
<td>STHupo</td>
</tr>
<tr>
<td style="text-align:center">33</td>
<td><i class="fa fa-file-word-o"></i>  华文隶书</td>
<td>STLiti</td>
</tr>
<tr>
<td style="text-align:center">34</td>
<td><i class="fa fa-file-word-o"></i>  华文行楷</td>
<td>STXingkai</td>
</tr>
<tr>
<td style="text-align:center">35</td>
<td><i class="fa fa-file-word-o"></i>  华文新魏</td>
<td>STXinwei</td>
</tr>
<tr>
<td style="text-align:center">36</td>
<td><i class="fa fa-linux"></i> 文泉驿微米黑</td>
<td>Wenquanyi Micro Hei</td>
</tr>
<tr>
<td style="text-align:center">37</td>
<td><i class="fa fa-linux"></i> 文泉驿正黑</td>
<td>WenQuanYi Zen Hei</td>
</tr>
<tr>
<td style="text-align:center">38</td>
<td><i class="fa fa-linux"></i> 文泉驿点阵正黑</td>
<td>WenQuanYi Zen Hei Sharp</td>
</tr>
</tbody>
</table>
<h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><ol>
<li><strong>Font Awesome</strong>: <a href="http://fontawesome.io/" target="_blank" rel="noopener">http://fontawesome.io/</a></li>
<li><strong>Webdings和Wingdings字符码对应表</strong>: <a href="http://dwz.cn/2jOjYi" target="_blank" rel="noopener">http://dwz.cn/2jOjYi</a></li>
<li><strong><em>CSS魔法堂：再次认识 font</em></strong> by <strong>肥仔John</strong> on <code>2015/3/3</code>: <a href="http://www.cnblogs.com/fsjohnhuang/p/4310533.html" target="_blank" rel="noopener">http://www.cnblogs.com/fsjohnhuang/p/4310533.html</a></li>
<li><strong>有字库-中文在线字体</strong>: <a href="http://www.youziku.com/" target="_blank" rel="noopener">http://www.youziku.com/</a></li>
<li><strong><em>谈谈网页设计中的字体应用 (2) serif 和 sans-serif</em></strong> by <strong>棕熊</strong> on <code>2008/5/6</code>: <a href="http://www.cnblogs.com/ruxpinsp1/archive/2008/05/06/font-in-front-end-development-2.html" target="_blank" rel="noopener">http://www.cnblogs.com/ruxpinsp1/archive/2008/05/06/font-in-front-end-development-2.html</a></li>
<li><strong><em>Serif 和 Sans Serif 字体的区别</em></strong> by <strong>冰火九九</strong> on <code>2013/11/4</code>: <a href="http://blog.jobbole.com/50828/" target="_blank" rel="noopener">http://blog.jobbole.com/50828/</a></li>
<li><strong><em>Chinese Web Font Guide</em></strong> by <strong>Kendra Schaefer</strong> on <code>2012/6/11</code>: <a href="http://www.kendraschaefer.com/2012/06/chinese-standard-web-fonts-the-ultimate-guide-to-css-font-family-declarations-for-web-design-in-simplified-chinese/" target="_blank" rel="noopener">http://www.kendraschaefer.com/2012/06/chinese-standard-web-fonts-the-ultimate-guide-to-css-font-family-declarations-for-web-design-in-simplified-chinese/</a></li>
<li><strong>Fonts.css – 跨平台中文字体解决方案</strong>: <a href="http://zenozeng.github.io/fonts.css/" target="_blank" rel="noopener">http://zenozeng.github.io/fonts.css/</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 字体 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[nodejs爬虫项目实战]]></title>
      <url>https://blog.xiaomo.info/2016/NodeSpider/</url>
      <content type="html"><![CDATA[<p>这篇文章主要介绍了NodeJS制作爬虫的全过程，包括项目建立，目标网站分析、使用superagent获取源数据、使用cheerio解析、使用eventproxy来并发抓取每个主题的内容等方面，有需要的小伙伴参考下吧。<br><a id="more"></a></p>
<h3 id="一、-依赖"><a href="#一、-依赖" class="headerlink" title="一、 依赖"></a>一、 依赖</h3><h4 id="1-DOM操作-cheerio"><a href="#1-DOM操作-cheerio" class="headerlink" title="1. DOM操作  cheerio"></a>1. DOM操作  <a href="https://npm.taobao.org/package/cheerio" target="_blank" rel="noopener">cheerio</a></h4><h4 id="2-请求插件-request"><a href="#2-请求插件-request" class="headerlink" title="2. 请求插件  request"></a>2. 请求插件  <a href="https://npm.taobao.org/package/request" target="_blank" rel="noopener">request</a></h4><h4 id="3-http库-superagent"><a href="#3-http库-superagent" class="headerlink" title="3. http库  superagent"></a>3. http库  <a href="https://npm.taobao.org/package/superagent" target="_blank" rel="noopener">superagent</a></h4><h4 id="4-代理-eventproxy"><a href="#4-代理-eventproxy" class="headerlink" title="4. 代理  eventproxy"></a>4. 代理  <a href="https://npm.taobao.org/package/eventproxy" target="_blank" rel="noopener">eventproxy</a></h4><h3 id="二、建立项目node-spider"><a href="#二、建立项目node-spider" class="headerlink" title="二、建立项目node-spider"></a>二、建立项目node-spider</h3><h4 id="1-建立一个Koa2项目"><a href="#1-建立一个Koa2项目" class="headerlink" title="1. 建立一个Koa2项目"></a>1. 建立一个Koa2项目</h4><p> <code>npm install -g koa-generator</code></p>
<h4 id="2-生成一个koa2的项目"><a href="#2-生成一个koa2的项目" class="headerlink" title="2. 生成一个koa2的项目"></a>2. 生成一个koa2的项目</h4><p> <code>koa2 -e node-spider</code>   -e表示使用ejs模板，具体参照<a href="http://localhost:4000/2016/05/26/2016-5-26-koa_generator/" target="_blank" rel="noopener">koa生成器,一键生成koa和koa2项目</a>   </p>
<h3 id="三、目标网站分析"><a href="#三、目标网站分析" class="headerlink" title="三、目标网站分析"></a>三、目标网站分析</h3><p>如图，这是CNode首页一部分div标签，我们就是通过这一系列的id、class来定位我们需要的信息。<br><img src="https://image.xiaomo.info/nodeSpider/0.png" alt></p>
<h3 id="四、爬虫功能制作"><a href="#四、爬虫功能制作" class="headerlink" title="四、爬虫功能制作"></a>四、爬虫功能制作</h3><h4 id="1-superagent"><a href="#1-superagent" class="headerlink" title="1. superagent"></a>1. superagent</h4><p>是ajax API来使用的Http库，它的使用方法与jQuery差不多，我们通过它发起get请求，在回调函数中输出结果。</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">var</span> router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">url</span> = <span class="built_in">require</span>(<span class="string">'url'</span>); <span class="comment">//解析操作url</span></span><br><span class="line"><span class="keyword">var</span> superagent = <span class="built_in">require</span>(<span class="string">'superagent'</span>); <span class="comment">//这三个外部依赖不要忘记npm install</span></span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"><span class="keyword">var</span> eventproxy = <span class="built_in">require</span>(<span class="string">'eventproxy'</span>);</span><br><span class="line"><span class="keyword">var</span> targetUrl = <span class="string">'https://cnodejs.org/'</span>;</span><br><span class="line">superagent.get(targetUrl)</span><br><span class="line">  .end(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>它的res结果为一个包含目标url信息的对象，网站内容主要在其text(string)里。</p>
<p><img src="https://image.xiaomo.info/nodeSpider/1.png" alt></p>
<h4 id="2-使用cheerio解析"><a href="#2-使用cheerio解析" class="headerlink" title="2. 使用cheerio解析"></a>2. 使用cheerio解析</h4><p>cheerio充当服务器端的jQuery功能，我们先使用它的.load()来载入HTML，再通过CSS selector来筛选元素。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = cheerio.load(res.text);</span><br><span class="line"><span class="comment">//通过CSS selector来筛选数据</span></span><br><span class="line">$(<span class="string">'#topic_list .topic_title'</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">idx, element</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(element);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>其结果为一个个对象，调用 <code>.each(function(index, element))</code>函数来遍历每一个对象，返回的是HTML DOM Elements。</p>
<p><img src="https://image.xiaomo.info/nodeSpider/2.png" alt></p>
<p>输出 <code>console.log($element.attr(&#39;title&#39;));</code>的结果为<br> <code>广州2014年12月06日 NodeParty 之 UC 场之类的标题</code><br>输出 <code>console.log($element.attr(&#39;href&#39;));</code>的结果为<br><code>/topic/545c395becbcb78265856eb2之类的url</code>。<br>再用<code>NodeJS1的url.resolve()</code>函数来补全完整的url。  </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">superagent.get(tUrl)</span><br><span class="line">    .end(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> topicUrls = [];</span><br><span class="line">        <span class="keyword">var</span> $ = cheerio.load(res.text);</span><br><span class="line">        <span class="comment">// 获取首页所有的链接</span></span><br><span class="line">        $(<span class="string">'#topic_list .topic_title'</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">idx, element</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> $element = $(element);</span><br><span class="line">            <span class="keyword">var</span> href = url.resolve(tUrl, $element.attr(<span class="string">'href'</span>));</span><br><span class="line">            <span class="built_in">console</span>.log(href);</span><br><span class="line">            <span class="comment">//topicUrls.push(href);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-使用eventproxy来并发抓取"><a href="#3-使用eventproxy来并发抓取" class="headerlink" title="3.使用eventproxy来并发抓取"></a>3.使用eventproxy来并发抓取</h4><p>教程上展示了深度嵌套(串行)方法和计数器方法的例子，eventproxy就是使用事件(并行)方法来解决这个问题。当所有的抓取完成后，eventproxy接收到事件消息自动帮你调用处理函数。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第一步：得到一个 eventproxy 的实例</span></span><br><span class="line"><span class="keyword">var</span> ep = <span class="keyword">new</span> eventproxy();</span><br><span class="line"><span class="comment">//第二步：定义监听事件的回调函数。</span></span><br><span class="line"><span class="comment">//after方法为重复监听</span></span><br><span class="line"><span class="comment">//params: eventname(String) 事件名,times(Number) 监听次数, callback 回调函数</span></span><br><span class="line">ep.after(<span class="string">'topic_html'</span>, topicUrls.length, <span class="function"><span class="keyword">function</span>(<span class="params">topics</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// topics 是个数组，包含了 40 次 ep.emit('topic_html', pair) 中的那 40 个 pair</span></span><br><span class="line">    <span class="comment">//.map</span></span><br><span class="line">    topics = topics.map(<span class="function"><span class="keyword">function</span>(<span class="params">topicPair</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//use cheerio</span></span><br><span class="line">        <span class="keyword">var</span> topicUrl = topicPair[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">var</span> topicHtml = topicPair[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> $ = cheerio.load(topicHtml);</span><br><span class="line">        <span class="keyword">return</span> (&#123;</span><br><span class="line">            title: $(<span class="string">'.topic_full_title'</span>).text().trim(),</span><br><span class="line">            href: topicUrl,</span><br><span class="line">            comment1: $(<span class="string">'.reply_content'</span>).eq(<span class="number">0</span>).text().trim()</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//outcome</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'outcome:'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(topics);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//第三步：确定放出事件消息的</span></span><br><span class="line">topicUrls.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">topicUrl</span>) </span>&#123;</span><br><span class="line">    superagent.get(topicUrl)</span><br><span class="line">        .end(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'fetch '</span> + topicUrl + <span class="string">' successful'</span>);</span><br><span class="line">            ep.emit(<span class="string">'topic_html'</span>, [topicUrl, res.text]);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>结果如下  </p>
<p><img src="https://image.xiaomo.info/nodeSpider/3.png" alt></p>
<p>获取留言用户名和积分  </p>
<p><img src="https://image.xiaomo.info/nodeSpider/4.png" alt></p>
<p>在文章页面的源码找到评论的用户class名，classname为reply_author。console.log第一个元素 $(‘.reply_author’).get(0)可以看到，我们需要获取东西都在这里头。</p>
<p><img src="https://image.xiaomo.info/nodeSpider/5.png" alt></p>
<p>首先，我们先对一篇文章进行抓取，一次性把需要的都得到即可。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> userHref = url.resolve(tUrl, $(<span class="string">'.reply_author'</span>).get(<span class="number">0</span>).attribs.href);</span><br><span class="line"><span class="built_in">console</span>.log(userHref);</span><br><span class="line"><span class="built_in">console</span>.log($(<span class="string">'.reply_author'</span>).get(<span class="number">0</span>).children[<span class="number">0</span>].data);</span><br></pre></td></tr></table></figure>
<p>我们可以通过<code>https://cnodejs.org/user/username</code>抓取积分信息</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">'.reply_author'</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">idx, element</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> $element = $(element);</span><br><span class="line"><span class="built_in">console</span>.log($element.attr(<span class="string">'href'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在用户信息页面 <code>$(&#39;.big&#39;).text().trim()</code>即为积分信息。<br>使用cheerio的函数.get(0)为获取第一个元素。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> userHref = url.resolve(tUrl, $(<span class="string">'.reply_author'</span>).get(<span class="number">0</span>).attribs.href);</span><br><span class="line"><span class="built_in">console</span>.log(userHref);</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> es6 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[package.json常用script]]></title>
      <url>https://blog.xiaomo.info/2016/Package.jsonScripts/</url>
      <content type="html"><![CDATA[<p>好的script能够大大减少我们对命令行的操作，直接使用npm run xxx 就可以执行。<br><a id="more"></a></p>
<h3 id="一、git相关"><a href="#一、git相关" class="headerlink" title="一、git相关"></a>一、git相关</h3><h4 id="1-查看分支"><a href="#1-查看分支" class="headerlink" title="1. 查看分支"></a>1. 查看分支</h4><p>  <code>branch:git branch -a</code>,    </p>
<h4 id="2-查看标签"><a href="#2-查看标签" class="headerlink" title="2. 查看标签"></a>2. 查看标签</h4><p>  <code>tag:git tag</code>,    </p>
<h4 id="3-创建标签"><a href="#3-创建标签" class="headerlink" title="3. 创建标签"></a>3. 创建标签</h4><p>  <code>createtag:git tag -a 0.1.2 -m Release^-^</code>,    </p>
<h4 id="4-推送标签"><a href="#4-推送标签" class="headerlink" title="4. 推送标签"></a>4. 推送标签</h4><p>  <code>pushtag:npm run createtag &amp;&amp; git push origin --tags</code>,        </p>
<h4 id="5-删除分支"><a href="#5-删除分支" class="headerlink" title="5. 删除分支"></a>5. 删除分支</h4><p>  <code>delbranch:git push origin --delete</code>,             </p>
<h4 id="6-同步git"><a href="#6-同步git" class="headerlink" title="6. 同步git"></a>6. 同步git</h4><p>  <code>fetch</code>:<code>git fetch -p</code>,                  </p>
<h4 id="7-推送更新"><a href="#7-推送更新" class="headerlink" title="7. 推送更新"></a>7. 推送更新</h4><p>  <code>push</code>:<code>git push origin master</code>,            </p>
<h4 id="8-提交代码"><a href="#8-提交代码" class="headerlink" title="8. 提交代码"></a>8. 提交代码</h4><p> <code>commit</code>:<code>git commit -a</code>,             </p>
<h4 id="9-检出代码"><a href="#9-检出代码" class="headerlink" title="9. 检出代码"></a>9. 检出代码</h4><p>  <code>checkout</code>:<code>git checkout</code>,            </p>
<h4 id="10-删除标签"><a href="#10-删除标签" class="headerlink" title="10. 删除标签"></a>10. 删除标签</h4><p>  <code>deltag:git push origin --delete tag</code>,             </p>
<h4 id="11-删除己合并分支"><a href="#11-删除己合并分支" class="headerlink" title="11. 删除己合并分支"></a>11. 删除己合并分支</h4><p>   <code>delbranck:git branch -d</code>,          </p>
<h4 id="12-删除所分支"><a href="#12-删除所分支" class="headerlink" title="12. 删除所分支"></a>12. 删除所分支</h4><p> <code>delbranchall:git branch -D</code>,                 </p>
<h4 id="13-重命名分支"><a href="#13-重命名分支" class="headerlink" title="13. 重命名分支"></a>13. 重命名分支</h4><p>  <code>renamebranch:git branch -m</code>,   </p>
<h3 id="二、webpack相关"><a href="#二、webpack相关" class="headerlink" title="二、webpack相关"></a>二、webpack相关</h3><h4 id="1-清空目录"><a href="#1-清空目录" class="headerlink" title="1. 清空目录"></a>1. 清空目录</h4><p>  <code>clean:rimraf dist</code>,</p>
<h4 id="2-构建项目"><a href="#2-构建项目" class="headerlink" title="2. 构建项目"></a>2. 构建项目</h4><p>  <code>build:npm run clean &amp;&amp; webpack --progress --colors --profile</code>,</p>
<h4 id="3-启动项目"><a href="#3-启动项目" class="headerlink" title="3. 启动项目"></a>3. 启动项目</h4><p>  <code>start:webpack-dev-server --progress --colors --profile</code>,</p>
<h4 id="4-测试代码"><a href="#4-测试代码" class="headerlink" title="4. 测试代码"></a>4. 测试代码</h4><p>  <code>test:karma start</code>,</p>
<h4 id="5-检测测试"><a href="#5-检测测试" class="headerlink" title="5. 检测测试"></a>5. 检测测试</h4><p>  <code>test-watch:karma start --auto-watch --no-single-run</code></p>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
            <tag> nodejs </tag>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[npm模块分享]]></title>
      <url>https://blog.xiaomo.info/2016/NpmModulesShare/</url>
      <content type="html"><![CDATA[<p>平时自己用的npm模块也不算少了，其实网上有很多牛人开发的npm模块都很好，希望不要被埋没了。<br><a id="more"></a></p>
<h3 id="一、-实用的模块"><a href="#一、-实用的模块" class="headerlink" title="一、 实用的模块"></a>一、 实用的模块</h3><h4 id="1-thunder-vip"><a href="#1-thunder-vip" class="headerlink" title="1.thunder-vip"></a>1.<a href="https://github.com/nswbmw/thunder-vip" target="_blank" rel="noopener">thunder-vip</a></h4><p>作用：获取最新可用的迅雷 vip 账号。<br>解决什么：不用每次打开网站去找号。。<br>用法： <code>$ thunder</code>  or</p>
  <figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">var thunderVip = require('thunder-vip')<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">thunderVip(<span class="name">function</span> (<span class="name">err</span>, accounts) &#123;</span><br><span class="line">console.log(<span class="name">accounts</span>)<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>  截图  </p>
<p>  <img src="https://dn-cnode.qbox.me/FskKgd_Epv4IYYh0waATFFHoD7g9" alt="1"></p>
<h4 id="2-npm-user-downloads"><a href="#2-npm-user-downloads" class="headerlink" title="2. npm-user-downloads"></a>2. npm-user-downloads</h4><p><a href="https://github.com/nswbmw/npm-user-downloads" target="_blank" rel="noopener">npm-user-downloads</a>  </p>
<p>  查看 npm 用户某个时间段内所有模块的下载量，按从高到低排名。</p>
<p>  解决什么：起初是想看自己的那些模块下载量多，好重点维护。。</p>
<p>  用法： <code>$ nud hupengbest last-month --limit=20</code></p>
<p>  截图：</p>
<p>  <img src="https://dn-cnode.qbox.me/FhJDMWtAwWxgkXsEMWsfIz4XZ3Jl" alt="1"></p>
<h3 id="二、koa开发模块"><a href="#二、koa开发模块" class="headerlink" title="二、koa开发模块"></a>二、koa开发模块</h3><h4 id="1-co"><a href="#1-co" class="headerlink" title="1. co"></a>1. <a href="https://npm.taobao.org/package/co" target="_blank" rel="noopener">co</a></h4><p>作用：异步控制  </p>
<p>1 栗子</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">co(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> <span class="built_in">Promise</span>.resolve(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.error(err.stack);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>2 如果你想把一个 co-generator-function 转成真实的functionu并返回一个promise 可以使用<code>co.wrap(fn*)</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = co.wrap(<span class="function"><span class="keyword">function</span>* (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">yield</span> <span class="built_in">Promise</span>.resolve(val);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">fn(<span class="literal">true</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>3 完整的example  </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</span><br><span class="line"></span><br><span class="line">co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// yield any promise</span></span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> <span class="built_in">Promise</span>.resolve(<span class="literal">true</span>);</span><br><span class="line">&#125;).catch(onerror);</span><br><span class="line"></span><br><span class="line">co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// resolve multiple promises in parallel</span></span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">Promise</span>.resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">var</span> b = <span class="built_in">Promise</span>.resolve(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">var</span> c = <span class="built_in">Promise</span>.resolve(<span class="number">3</span>);</span><br><span class="line">  <span class="keyword">var</span> res = <span class="keyword">yield</span> [a, b, c];</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">  <span class="comment">// =&gt; [1, 2, 3]</span></span><br><span class="line">&#125;).catch(onerror);</span><br><span class="line"></span><br><span class="line"><span class="comment">// errors can be try/catched</span></span><br><span class="line">co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'boom'</span>));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err.message); <span class="comment">// "boom"</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;).catch(onerror);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onerror</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// log any uncaught errors</span></span><br><span class="line">  <span class="comment">// co will not throw any errors you do not handle!!!</span></span><br><span class="line">  <span class="comment">// HANDLE ALL YOUR ERRORS!!!</span></span><br><span class="line">  <span class="built_in">console</span>.error(err.stack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4 api  </p>
<p><code>co(fn*).then( val =&gt; )</code><br>解决一个generator然后返回一个promise</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">co(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">yield</span> <span class="built_in">Promise</span>.resolve(<span class="literal">true</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(val);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.error(err.stack);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>var fn = co.wrap(fn*)</code><br>将一个generator转成普通的function并返回一个promise  </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = co.wrap(<span class="function"><span class="keyword">function</span>* (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">yield</span> <span class="built_in">Promise</span>.resolve(val);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">fn(<span class="literal">true</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="2、debug"><a href="#2、debug" class="headerlink" title="2、debug"></a>2、<a href="https://npm.taobao.org/package/debug" target="_blank" rel="noopener">debug</a></h4><p><code>npm install debug</code>  </p>
<ol>
<li>使用方法  </li>
</ol>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"> //Example app.js</span><br><span class="line">var <span class="built_in">debug</span> = <span class="built_in">require</span>(<span class="string">'debug'</span>)(<span class="string">'http'</span>)</span><br><span class="line">  , http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line">  , name = <span class="string">'My App'</span>;</span><br><span class="line"></span><br><span class="line">// fake app</span><br><span class="line"></span><br><span class="line"><span class="built_in">debug</span>(<span class="string">'booting %s'</span>, name);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span><span class="params">(req, res)</span></span>&#123;</span><br><span class="line">  <span class="built_in">debug</span>(req.method + <span class="string">' '</span> + req.url);</span><br><span class="line">  res.<span class="keyword">end</span>(<span class="string">'hello\n'</span>);</span><br><span class="line">&#125;).listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">debug</span>(<span class="string">'listening'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// fake worker of some kind</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./worker'</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Example worker.js:</span></span><br><span class="line"><span class="keyword">var</span> debug = <span class="built_in">require</span>(<span class="string">'debug'</span>)(<span class="string">'worker'</span>);</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  debug(<span class="string">'doing some work'</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>效果图<br><img src="http://f.cl.ly/items/18471z1H402O24072r1J/Screenshot.png" alt="1"></p>
<p>在windows环境下需要设置环境变量<code>set DEBUG=*,-not_this</code> 我这里使用的是idea的debug调试<br><img src="https://image.xiaomo.info/node/debug.png" alt="1"></p>
<p>windows 下启动方式<br><img src="http://f.cl.ly/items/2i3h1d3t121M2Z1A3Q0N/Screenshot.png" alt="1"></p>
<p>将debug日志转存到文件中<br><code>DEBUG_FD=3 node your-app.js 3&gt; whatever.log</code>   </p>
<h4 id="3、koa-bodyparser"><a href="#3、koa-bodyparser" class="headerlink" title="3、koa-bodyparser"></a>3、<a href="https://npm.taobao.org/package/koa-bodyparser" target="_blank" rel="noopener">koa-bodyparser</a></h4><p>使用方法  </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = koa();</span><br><span class="line">app.use(bodyParser());</span><br><span class="line"></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.body = <span class="keyword">this</span>.request.body;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在koa2中使用   </p>
<p><code>npm install koa-bodyparser@next --save</code></p>
<h4 id="4-koa-json"><a href="#4-koa-json" class="headerlink" title="4. koa-json"></a>4. <a href="https://npm.taobao.org/package/koa-json" target="_blank" rel="noopener">koa-json</a></h4><p><code>npm install koa-json --save</code>  </p>
<p>使用方法   </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> json = <span class="keyword">require</span>(<span class="string">'koa-json'</span>);</span><br><span class="line"><span class="keyword">var</span> Koa = <span class="keyword">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">use</span>(<span class="title">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">use</span>((<span class="title">ctx</span>) =&gt; &#123;</span><br><span class="line">  <span class="title">ctx</span>.<span class="title">body</span> = &#123; <span class="title">foo</span>: '<span class="title">bar</span>' &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="4-koa-webpack-dev-middleware"><a href="#4-koa-webpack-dev-middleware" class="headerlink" title="4. koa-webpack-dev-middleware"></a>4. <a href="https://npm.taobao.org/package/koa-webpack-dev-middleware" target="_blank" rel="noopener">koa-webpack-dev-middleware</a></h4><p>使用方法   </p>
<p><code>npm install --save-dev koa-webpack-dev-middleware</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">var app = require('koa')();</span><br><span class="line">var webpackMiddleware = require("koa-webpack-dev-middleware");</span><br><span class="line">app.use(webpackMiddleware(webpack(&#123;</span><br><span class="line">  // webpack options</span><br><span class="line">  // webpackMiddleware takes a Compiler <span class="keyword">object</span> <span class="keyword">as</span> <span class="keyword">first</span> parameter</span><br><span class="line">  // which <span class="keyword">is</span> returned <span class="keyword">by</span> webpack(...) <span class="keyword">without</span> callback.</span><br><span class="line">  entry: <span class="string">"..."</span>,</span><br><span class="line">  <span class="keyword">output</span>: &#123;</span><br><span class="line">      <span class="keyword">path</span>: <span class="string">"/"</span></span><br><span class="line">      // <span class="keyword">no</span> <span class="built_in">real</span> <span class="keyword">path</span> <span class="keyword">is</span> <span class="keyword">required</span>, just pass <span class="string">"/"</span></span><br><span class="line">      // but it will <span class="keyword">work</span> <span class="keyword">with</span> other paths too.</span><br><span class="line">  &#125;</span><br><span class="line">&#125;), &#123;</span><br><span class="line">  // <span class="keyword">all</span> options optional</span><br><span class="line"></span><br><span class="line">  noInfo: <span class="literal">false</span>,</span><br><span class="line">  // display <span class="keyword">no</span> info <span class="keyword">to</span> console (<span class="keyword">only</span> <span class="keyword">warnings</span> <span class="keyword">and</span> <span class="keyword">errors</span>)</span><br><span class="line"></span><br><span class="line">  quiet: <span class="literal">false</span>,</span><br><span class="line">  // display <span class="keyword">nothing</span> <span class="keyword">to</span> the console</span><br><span class="line"></span><br><span class="line">  lazy: <span class="literal">true</span>,</span><br><span class="line">  // <span class="keyword">switch</span> <span class="keyword">into</span> lazy <span class="keyword">mode</span></span><br><span class="line">  // that means <span class="keyword">no</span> watching, but recompilation <span class="keyword">on</span> every request</span><br><span class="line"></span><br><span class="line">  watchDelay: <span class="number">300</span>,</span><br><span class="line">  // delay <span class="keyword">after</span> <span class="keyword">change</span> (<span class="keyword">only</span> lazy: <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  publicPath: <span class="string">"/assets/"</span>,</span><br><span class="line">  // <span class="keyword">public</span> <span class="keyword">path</span> <span class="keyword">to</span> bind the middleware <span class="keyword">to</span></span><br><span class="line">  // <span class="keyword">use</span> the same <span class="keyword">as</span> <span class="keyword">in</span> webpack</span><br><span class="line"></span><br><span class="line">  headers: &#123; <span class="string">"X-Custom-Header"</span>: <span class="string">"yes"</span> &#125;,</span><br><span class="line">  // custom headers</span><br><span class="line"></span><br><span class="line">  stats: &#123;</span><br><span class="line">      colors: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  // options <span class="keyword">for</span> formating the <span class="keyword">statistics</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> node </tag>
            
            <tag> koa </tag>
            
            <tag> npm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mongodb数据库的使用]]></title>
      <url>https://blog.xiaomo.info/2016/MongodbUse/</url>
      <content type="html"><![CDATA[<p>最近在学习node，听说node和mongodb更配哦。。所以我就来学习mongodb了<br><a id="more"></a></p>
<h3 id="一、mongodb的开启和关闭"><a href="#一、mongodb的开启和关闭" class="headerlink" title="一、mongodb的开启和关闭"></a>一、mongodb的开启和关闭</h3><h4 id="1-查找mongod是否可用"><a href="#1-查找mongod是否可用" class="headerlink" title="1. 查找mongod是否可用"></a>1. 查找mongod是否可用</h4><p><code>which mongod</code></p>
<h4 id="2-启动mongodb"><a href="#2-启动mongodb" class="headerlink" title="2. 启动mongodb"></a>2. 启动mongodb</h4><p> 指定path 和log日志<br><code>mongod --dbpath /data2/db --port=27017 --fork /data2/db/log/mongod.log</code></p>
<h4 id="3-关闭数据库"><a href="#3-关闭数据库" class="headerlink" title="3. 关闭数据库"></a>3. 关闭数据库</h4><p><code>mongod --shutdown</code></p>
<h3 id="二、mongodb的操作"><a href="#二、mongodb的操作" class="headerlink" title="二、mongodb的操作"></a>二、mongodb的操作</h3><h4 id="1-连接服务器"><a href="#1-连接服务器" class="headerlink" title="1. 连接服务器"></a>1. 连接服务器</h4><p><code>mongod 115.29.137.34:27017</code>  </p>
<h4 id="2-使用数据库"><a href="#2-使用数据库" class="headerlink" title="2. 使用数据库"></a>2. 使用数据库</h4><p>(不存在的数据库也可以使用,插入数据之后会自动保存)<br><code>use mydb</code>  </p>
<h4 id="3-权限登陆"><a href="#3-权限登陆" class="headerlink" title="3. 权限登陆"></a>3. 权限登陆</h4><p><code>db.auth(&#39;username&#39;,&#39;password&#39;)</code></p>
<h4 id="4-展示数据库列表"><a href="#4-展示数据库列表" class="headerlink" title="4. 展示数据库列表"></a>4. 展示数据库列表</h4><p><code>show dbs</code></p>
<h4 id="5-插入数据"><a href="#5-插入数据" class="headerlink" title="5. 插入数据"></a>5. 插入数据</h4><p>(类似于mysql的表)<br><code>db.users.insert({&#39;name&#39;:&#39;xiaomo&#39;})</code><br><code>db.users.insert({&#39;name&#39;:&#39;xiaoming&#39;,&#39;age&#39;:25})</code><br><code>db.users.insert({&#39;name&#39;:&#39;xiaoming&#39;,&#39;age&#39;:24,&#39;sex&#39;:&#39;女&#39;})</code></p>
<h4 id="6-查询集合"><a href="#6-查询集合" class="headerlink" title="6. 查询集合"></a>6. 查询集合</h4><p>(前提是use了一个数据库)<br>有一个System.indexes 是索引<br><code>show collections</code></p>
<h4 id="7-不带条件查询"><a href="#7-不带条件查询" class="headerlink" title="7. 不带条件查询"></a>7. 不带条件查询</h4><p><code>db.users.find()</code>  </p>
<h4 id="8-带条件查询"><a href="#8-带条件查询" class="headerlink" title="8. 带条件查询"></a>8. 带条件查询</h4><p>(参数是一个对象)<br><code>db.users.find({&#39;name&#39;:&#39;xiaomo&#39;})</code>  </p>
<h4 id="9-更新数据"><a href="#9-更新数据" class="headerlink" title="9. 更新数据"></a>9. 更新数据</h4><p>(有三个参数,1:查询条件,2:更新的内容 3：更新的配置)<br><code>db.users.update({&#39;name&#39;:&#39;xiaomo&#39;,{$set:{&#39;name:&#39;xm}})</code>   修改满足条件的第一条数据<br><code>db.users.update({&#39;name&#39;:&#39;xiaomo&#39;,{$set:{&#39;name:&#39;xm}},{multi:true})</code>    修改所有满足条件的数据  </p>
<h4 id="10-保存数据"><a href="#10-保存数据" class="headerlink" title="10. 保存数据"></a>10. 保存数据</h4><p>(只有一个参数，必须要传id，后面是要修改的数据)<br><code>db.users.save({&#39;id&#39;:&#39;objectId(574710a97a3afd63cde56a49)&#39;,&#39;age&#39;:30})</code>  </p>
<h4 id="11-删除数据"><a href="#11-删除数据" class="headerlink" title="11. 删除数据"></a>11. 删除数据</h4><p>(1:条件 2 是否删除所有符合条件的)<br><code>db.users.remove({&#39;name&#39;:&#39;xiaomoing&#39;},true)</code>  </p>
<h4 id="12-删除集合"><a href="#12-删除集合" class="headerlink" title="12. 删除集合"></a>12. 删除集合</h4><p><code>db.users.drop()</code>  </p>
<h3 id="三、使用mongoose操作数据库"><a href="#三、使用mongoose操作数据库" class="headerlink" title="三、使用mongoose操作数据库"></a>三、使用mongoose操作数据库</h3><h4 id="1-模块的介绍"><a href="#1-模块的介绍" class="headerlink" title="1. 模块的介绍"></a>1. 模块的介绍</h4><p>连接mongdodb的驱动</p>
<h4 id="2-配置和链接"><a href="#2-配置和链接" class="headerlink" title="2. 配置和链接"></a>2. 配置和链接</h4><p><code>npm install --save mongoose</code>  </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">var mongoose = require('mongoose');</span><br><span class="line"><span class="comment">&lt;!-- var uri = 'mongodb://username:password@hostname:port/databasename'; --&gt;</span></span><br><span class="line">var uri = 'mongodb://xiaomo:xiaomo@115.29.137.34:27017/admin';</span><br><span class="line">mongoose.connect(uri);</span><br></pre></td></tr></table></figure>
<h4 id="3-Model-和Shema"><a href="#3-Model-和Shema" class="headerlink" title="3. Model 和Shema"></a>3. Model 和Shema</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// model.js</span></span><br><span class="line"><span class="keyword">var</span> Schema = mongoose.Schema,</span><br><span class="line">    ObjectId = Schema.ObjectId;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> BlogPost = <span class="keyword">new</span> Schema(&#123;</span><br><span class="line">    author    : ObjectId,</span><br><span class="line">    title     : <span class="built_in">String</span>,</span><br><span class="line">    body      : <span class="built_in">String</span>,</span><br><span class="line">    date      : <span class="built_in">Date</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Model</span></span><br><span class="line">mongoose.model(<span class="string">'blog'</span>,Schema);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Comment = <span class="keyword">new</span> Schema(&#123;</span><br><span class="line">  name: &#123; <span class="keyword">type</span>: <span class="built_in">String</span>, <span class="keyword">default</span>: <span class="string">'hahaha'</span> &#125;,</span><br><span class="line">  age: &#123; <span class="keyword">type</span>: <span class="built_in">Number</span>, min: <span class="number">18</span>, index: <span class="literal">true</span> &#125;,</span><br><span class="line">  bio: &#123; <span class="keyword">type</span>: <span class="built_in">String</span>, match: <span class="regexp">/[a-z]/</span> &#125;,</span><br><span class="line">  date: &#123; <span class="keyword">type</span>: <span class="built_in">Date</span>, <span class="keyword">default</span>: <span class="built_in">Date</span>.now &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// a setter</span></span><br><span class="line">Comment.path(<span class="string">'name'</span>).set(<span class="function"><span class="keyword">function</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> capitalize(v);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// middleware</span></span><br><span class="line">Comment.pre(<span class="string">'save'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">next</span>) </span>&#123;</span><br><span class="line">  notify(<span class="keyword">this</span>.get(<span class="string">'email'</span>));</span><br><span class="line">  next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="4-创建文档"><a href="#4-创建文档" class="headerlink" title="4. 创建文档"></a>4. 创建文档</h4><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="comment">//insert.js</span></span><br><span class="line"><span class="keyword">var</span> mongoose ＝ require(<span class="string">'mongoose'</span>);</span><br><span class="line">require(<span class="string">'./model.js'</span>); <span class="comment">//执行</span></span><br><span class="line"><span class="keyword">var</span> Blog = mongoose.model(<span class="string">'blog'</span>);</span><br><span class="line"><span class="keyword">var</span> blog = <span class="keyword">new</span> <span class="type">Blog</span>(&#123;</span><br><span class="line">    name:<span class="type"></span>'xiaomo<span class="string">',</span></span><br><span class="line"><span class="string">    age:25,</span></span><br><span class="line"><span class="string">    bio:'</span>don<span class="string">'t know'</span>,</span><br><span class="line">    date:<span class="type">new Date</span></span><br><span class="line"><span class="type">  </span>&#125;);</span><br><span class="line"></span><br><span class="line">book.save(<span class="function"><span class="keyword">function</span></span>(err)&#123;</span><br><span class="line">    console.log(<span class="string">'save status:'</span>+err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="5-删除文档"><a href="#5-删除文档" class="headerlink" title="5. 删除文档"></a>5. 删除文档</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./model.js'</span>);</span><br><span class="line"><span class="keyword">var</span> Blog = mongoose.model(<span class="string">'blog'</span>);</span><br><span class="line">Blog.findOne(&#123;<span class="string">'name'</span>:<span class="string">'xiaomo'</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,doc</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(doc)&#123;</span><br><span class="line">  doc.reomove();</span><br><span class="line">&#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="6-简单查询"><a href="#6-简单查询" class="headerlink" title="6. 简单查询"></a>6. 简单查询</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./model.js'</span>);</span><br><span class="line"><span class="keyword">var</span> Blog = mongoose.model(<span class="string">'blog'</span>);</span><br><span class="line">Blog.find(&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,doc</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'result'</span>,doc)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<p>第一个满足条件的结果</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./model.js'</span>);</span><br><span class="line"><span class="keyword">var</span> Blog = mongoose.model(<span class="string">'blog'</span>);</span><br><span class="line">Blog.findOne(&#123;<span class="string">'name'</span>:<span class="string">'xiaomo'</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,doc</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'result'</span>,doc)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="7-条件语句"><a href="#7-条件语句" class="headerlink" title="7. 条件语句"></a>7. 条件语句</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// condation.js</span></span><br><span class="line"> <span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"> <span class="built_in">require</span>(<span class="string">'./model.js'</span>);</span><br><span class="line"> <span class="keyword">var</span> Blog = mongoose.model(<span class="string">'blog'</span>);</span><br><span class="line"> <span class="comment">//名字是xiaomo或者xiaoming 可以用$or和$and</span></span><br><span class="line"> <span class="keyword">var</span> condation = &#123;</span><br><span class="line">   $or  $and:[</span><br><span class="line">   &#123;<span class="string">'name'</span>:<span class="string">'xiaomo'</span>&#125;,</span><br><span class="line">   &#123;<span class="string">'name'</span>:<span class="string">'xiaoming'</span>&#125;</span><br><span class="line">   ]</span><br><span class="line"> &#125;</span><br><span class="line"> Blog.find(condation,<span class="function"><span class="keyword">function</span>(<span class="params">err,doc</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(err)&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(err)</span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'result'</span>,doc)</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="三、在项目中使用mongoose"><a href="#三、在项目中使用mongoose" class="headerlink" title="三、在项目中使用mongoose"></a>三、在项目中使用mongoose</h3><h4 id="1-生成项目"><a href="#1-生成项目" class="headerlink" title="1. 生成项目"></a>1. 生成项目</h4><p><code>koa koatest -e koatest</code>  </p>
<h4 id="2-安装依赖"><a href="#2-安装依赖" class="headerlink" title="2. 安装依赖"></a>2. 安装依赖</h4><p><code>cd koatest &amp;&amp; npm install</code></p>
<h4 id="3-安装mongoose"><a href="#3-安装mongoose" class="headerlink" title="3. 安装mongoose"></a>3. 安装mongoose</h4><p><code>npm install --save mongoose</code>  </p>
<h4 id="4-创建模型"><a href="#4-创建模型" class="headerlink" title="4. 创建模型"></a>4. 创建模型</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// models/users.server.model.js</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">var</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    uid:<span class="built_in">Number</span>,</span><br><span class="line">    username:<span class="built_in">String</span>,</span><br><span class="line">    createTime:<span class="built_in">Date</span>,</span><br><span class="line">    lastLogin:<span class="built_in">Date</span></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">'User'</span>,UserSchema);</span><br></pre></td></tr></table></figure>
<h4 id="5-创建配置文件"><a href="#5-创建配置文件" class="headerlink" title="5. 创建配置文件"></a>5. 创建配置文件</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// config/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">  mongodb:<span class="string">'mongodb://xiaomo:xiaomo@115.29.137.34:27017/admin'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//config/mongoose.js</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./config.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> db = mongoose.connect(config.mongodb);</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'./../models/users.server.model.js'</span>);</span><br><span class="line">  <span class="keyword">return</span> db;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-操作mongdodb-代码"><a href="#6-操作mongdodb-代码" class="headerlink" title="6. 操作mongdodb 代码"></a>6. 操作mongdodb 代码</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//routers/users.js</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)();</span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">var</span> User = mongoose.model(<span class="string">'User'</span>);</span><br><span class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> *(<span class="params">next</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//add</span></span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">new</span> User(&#123;</span><br><span class="line">      uid:</span><br><span class="line">      &#125;)</span><br><span class="line">    <span class="keyword">this</span>.body = <span class="keyword">yield</span> User.find(&#123;&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> database </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> koa </tag>
            
            <tag> mongodb </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[koa生成器,一键生成koa和koa2项目]]></title>
      <url>https://blog.xiaomo.info/2016/KoaGenerator/</url>
      <content type="html"><![CDATA[<p>最近在学koa,想着exrpess有生成器,那么koa应该也有。不出所料，经过我仔细上网排查,果然也有koa生成器。这对于想学koa，且规范的使用koa的朋友来说是一件多么让人开心的事情。<br><a id="more"></a></p>
<h3 id="一、一键生成koa项目特性"><a href="#一、一键生成koa项目特性" class="headerlink" title="一、一键生成koa项目特性"></a>一、一键生成koa项目特性</h3><ol>
<li>Express-style</li>
<li>Support koa 1.x（已支持）</li>
<li>Support koa 2.x（已支持所有的koa中间件写法，依赖runkoa，不需要了解babel）</li>
</ol>
<h3 id="二、使用说明"><a href="#二、使用说明" class="headerlink" title="二、使用说明"></a>二、使用说明</h3><h4 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h4><p> 一定要全局安装(koa1.2和koa2都己经支持)<br><code>npm install koa-generator -g</code><br>koa1.2  生成一个test项目,切到test目录并下载依赖<br><code>koa test &amp;&amp; cd test &amp;&amp; npm install</code><br>koa2    生成一个test项目,切到test目录并下载依赖<br><code>koa2 test &amp;&amp; cd test &amp;&amp; npm install</code></p>
<h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><p><code>npm start</code><br>  访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> 就可以看到项目效果   </p>
<h3 id="三、参数"><a href="#三、参数" class="headerlink" title="三、参数"></a>三、参数</h3><p>当然koa生成器功能没有这么弱啦,可以定制你想要的东西  </p>
<pre><code>-h, --help          帮助
-V, --version       版本号
-e, --ejs           添加ejs模板引擎支持(默认是jade)
    --hbs           添加hbs模板引擎支持(默认是hbs)
-H, --hogan         添加hogan.js支持
-c, --css &lt;engine&gt;  添加css样式 支持 less sass styus css(默认是css)
    --git           添加 .gitignore
-f, --force         force on non-empty directory
</code></pre><h3 id="四、项目地址"><a href="#四、项目地址" class="headerlink" title="四、项目地址"></a>四、项目地址</h3><p><a href="https://github.com/houko/node-koa" target="_blank" rel="noopener">https://github.com/houko/node-koa</a></p>
<h2 id="五、国际惯例-项目演示"><a href="#五、国际惯例-项目演示" class="headerlink" title="五、国际惯例-项目演示"></a>五、国际惯例-项目演示</h2><ol>
<li>安装koa-generator  </li>
<li>新建项目   </li>
<li>运行项目  </li>
<li>演示结束<br><img src="https://image.xiaomo.info/node/koa-generator.gif" alt="koa生成器"></li>
</ol>
<p>查看大图 <a href="https://image.xiaomo.info/node/koa-generator.gif" target="_blank" rel="noopener">koa生成器</a></p>
<h2 id="我的github地址"><a href="#我的github地址" class="headerlink" title="我的github地址"></a>我的github地址</h2><p><a href="https://github.com/houko" target="_blank" rel="noopener">https://github.com/houko</a></p>
]]></content>
      
        <categories>
            
            <category> javascript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> es6 </tag>
            
            <tag> koa </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[nodejs框架koa学习]]></title>
      <url>https://blog.xiaomo.info/2016/NodeKoa/</url>
      <content type="html"><![CDATA[<p>Koa 是一个类似于 Express 的Web开发框架，创始人也都是TJ。Koa 的主要特点是，使用了 ES6 的 Generator 函数，进行了架构的重新设计。Koa 的原理和内部结构很像 Express，但是语法和内部结构进行了升级。<br><a id="more"></a></p>
<h3 id="一、国际惯例-hello-world"><a href="#一、国际惯例-hello-world" class="headerlink" title="一、国际惯例 hello world"></a>一、国际惯例 hello world</h3><h4 id="1-当前版本1-2"><a href="#1-当前版本1-2" class="headerlink" title="1. 当前版本1.2"></a>1. 当前版本1.2</h4><p><code>npm install --save koa</code>   </p>
<h4 id="2-代码撸起来"><a href="#2-代码撸起来" class="headerlink" title="2. 代码撸起来"></a>2. 代码撸起来</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">let</span> app = koa();</span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.body = <span class="string">"hello xiaomo"</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">app.listen(<span class="number">8080</span>);</span><br></pre></td></tr></table></figure>
<p>如此这般我们就创建了一个简单的http服务器。这段程序的作用是监听 8080 端口，当收到 GET 请求的时候，答复 hello xiaomo<br>你应该注意到了，我没有只用 var 关键词。我使用了 let 代替。在 ES6 中这基本上就是新的 var。这改变了变量的作用域，但是我不想在这里多说。  </p>
<p>另一件事情有些奇怪，就是我们使用关键词 function*。这个星号表示这个函数是一个生成器函数。这意味着这个函数可以在运行的时候跳出然后再跳回来。这个概念很难去表述，所以我给你举个栗子。</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">inc</span> () &#123;</span></span><br><span class="line"> let <span class="built_in">number</span> = <span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line"> yield <span class="built_in">number</span>++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let test = inc()</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(test.next().<span class="built_in">value</span>)<span class="comment"> // -&gt; 0</span></span><br><span class="line">console.<span class="built_in">log</span>(test.next().<span class="built_in">value</span>)<span class="comment"> // -&gt; 1</span></span><br><span class="line">console.<span class="built_in">log</span>(test.next().<span class="built_in">value</span>)<span class="comment"> // -&gt; 2</span></span><br></pre></td></tr></table></figure>
<p>我分解一下这个程序：</p>
<p>inc 函数定义了一个生成器函数，在每一次 while 循环中，产出 number 变量然后 number 变量加 1<br>inc 函数被指派给了变量 test<br>inc 函数被迭代了 3 次，第一次的时候，number 变量在函数中被初始化了。然后，这个函数进入到了一个 while 循环，在之后的迭代中这个循环也不会退出。然后 number 0 被产出，所以这个可以用 .value 方法接收。在后来的迭代中这个变量 number 自增了两次。<br>我希望这可以帮助理解一点生成器的工作原理。这只是非常复杂的 ES6 中的一小部分。</p>
<p>但是无论如何，让我们回到 koa。koa 非常简单，甚至不包含一个路由。你需要在中间件生成器函数中手动做路由匹配：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = koa()</span><br><span class="line"></span><br><span class="line"><span class="comment">// normal route</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>* (<span class="params">next</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.path !== <span class="string">'/'</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">yield</span> next</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.body = <span class="string">'hello world'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// /404 route</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>* (<span class="params">next</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.path !== <span class="string">'/404'</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">yield</span> next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.body = <span class="string">'page not found'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// /500 route</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>* (<span class="params">next</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.path !== <span class="string">'/500'</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">yield</span> next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.body = <span class="string">'internal server error'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>
<p>你可以看到，我们只要用 if 就可以做路由匹配了。你是不是很疑惑在这个上下文中的 this 是什么，express 中的 req 和 res 去哪里了。其实 this 绑定了大部分的 req 和 res 的函数和属性。如果你想知道更多关于 this 的详情，<a href="http://koajs.com/#context" target="_blank" rel="noopener">请点这里</a>。</p>
<p>让我们写一个将请求中的内容大写的中间件：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = koa()</span><br><span class="line"></span><br><span class="line">app.use(upcaser())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upcaser</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>* (<span class="params">next</span>) </span>&#123;</span><br><span class="line"><span class="keyword">yield</span> next</span><br><span class="line"><span class="keyword">this</span>.body = <span class="keyword">this</span>.body.toUpperCase()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>
<h3 id="我的github地址"><a href="#我的github地址" class="headerlink" title="我的github地址"></a>我的github地址</h3><p><a href="https://github.com/houko" target="_blank" rel="noopener">https://github.com/houko</a></p>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> es6 </tag>
            
            <tag> koa </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript学习笔记]]></title>
      <url>https://blog.xiaomo.info/2016/JavascriptSyntax/</url>
      <content type="html"><![CDATA[<p>一直对javscript抱有敬畏的态度，也没有一直深入学习。当学到各种js框架的时候才发现力不从心，感觉到了javascript基础的重要性，重新认真的系统的学习一下。<br><a id="more"></a></p>
<h3 id="一、一些不同"><a href="#一、一些不同" class="headerlink" title="一、一些不同"></a>一、一些不同</h3><h4 id="1-javscript没有块级作用域"><a href="#1-javscript没有块级作用域" class="headerlink" title="1. javscript没有块级作用域"></a>1. javscript没有块级作用域</h4><p>于是es6中有了let和var<br>模拟js的块级作用域    </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outputNumbers</span>(<span class="params">count</span>)</span>&#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;count;i++)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i) <span class="comment">//会报错</span></span><br></pre></td></tr></table></figure>
<h4 id="2-javascipt中this用法不同"><a href="#2-javascipt中this用法不同" class="headerlink" title="2. javascipt中this用法不同"></a>2. javascipt中this用法不同</h4><p>它指向调用它的那个对象</p>
<h4 id="3-闭包是指有权访问另一个函数作用域中的变量的函数。"><a href="#3-闭包是指有权访问另一个函数作用域中的变量的函数。" class="headerlink" title="3. 闭包是指有权访问另一个函数作用域中的变量的函数。"></a>3. 闭包是指有权访问另一个函数作用域中的变量的函数。</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createAFunction</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'这是一个闭包'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、基本数据类型"><a href="#二、基本数据类型" class="headerlink" title="二、基本数据类型"></a>二、基本数据类型</h3><p><code>undefined</code>、<code>null</code>、<code>boolean</code>、<code>string</code>、<code>number</code> 、<code>object</code>、<code>function</code><br>它们有对应的方法<br><code>Boolean()</code>、<code>String()</code>、<code>Number()</code> 、<code>Object()</code>  </p>
<h4 id="1-undefined"><a href="#1-undefined" class="headerlink" title="1. undefined"></a>1. <code>undefined</code></h4><p>没有被定义就会返回<code>undefined</code>,是<code>null</code>衍生出来的,因些<code>undefined==null</code> 返回true</p>
<h4 id="2-null"><a href="#2-null" class="headerlink" title="2. null"></a>2. <code>null</code></h4><p>由于历史原因 <code>typeof null</code>返回<code>object</code></p>
<h4 id="3-boolean"><a href="#3-boolean" class="headerlink" title="3. boolean"></a>3. <code>boolean</code></h4><p><code>Boolean()</code><br>非0返回true<br>0、null、undefined返回false</p>
<h4 id="4-string"><a href="#4-string" class="headerlink" title="4. string"></a>4. <code>string</code></h4><p><code>String()</code><br>不管传入什么都会原样返回,但如果是<code>function</code>,会执行该方法并返回<code>undefined</code><br><code>toString(参数,进制)</code><br><code>toUpperCase()</code><br><code>toLowerCase()</code><br><code>substring(parm1,parm2)</code><br><code>substr()</code><br><code>charAt(1)</code><br><code>charCodeAt(2)</code><br><code>concat()</code><br><code>slice()</code><br><code>indexof()</code><br><code>lastIndexOf</code><br><code>trim()</code><br><code>search(pattern)</code>  //返回索引<br><code>replcae(&#39;原&#39;,&#39;新&#39;)</code> //第一个参数支持正则    第二个参数也可以是一个function<br><code>splice(&#39;,&#39;)</code>    //支持正则，支持指定长度<br>它只有length属性   </p>
<h4 id="5-number"><a href="#5-number" class="headerlink" title="5. number"></a>5. <code>number</code></h4><p><code>Number()</code>          true=&gt;1 false=&gt;0   null=&gt;0 undefined=&gt;NaN<br><code>Number.MAX_VALUE</code>  最大值<br><code>Number.MIN_VALUE</code>  最小值<br><code>NaN</code>  它是一个特例，不与任何值相等包括自己<br><code>parseInt()</code> //可以查找字符串中的数字并转换<br><code>parseFloat()</code> //可以查找字符串中的数字并转换<br><code>inFinite()</code> //是否在最大值和最小值之间<br><code>toFixed(小数点位数)</code><br>说明：它能够识别科学计数法 比如 2.15e5 =&gt; 215000   </p>
<h4 id="6-object"><a href="#6-object" class="headerlink" title="6. object"></a>6. <code>object</code></h4><p><code>constructor</code>  构造函数<br><code>obj.hasOwnProperty()</code> 是否具有自己的方法<br><code>obj.isProtoTypeOf(object)</code>  检查传入的对象是否是另一个对象的原型<br><code>ob.propertyIsEnumerable(propetyName)</code>  检查给定的属性能否使用for-in<br><code>obj.toLocaleString()</code> 返回执行地区对应的对象的字符串 =&gt;[‘Object’]<br><code>obj.toString()</code>    返回执行对象的字符串 =&gt;[‘Object’]<br><code>obj.valueOf()</code>   返回对象序列化之后的结果</p>
<h3 id="三、运算符"><a href="#三、运算符" class="headerlink" title="三、运算符"></a>三、运算符</h3><h4 id="1-大于和小于"><a href="#1-大于和小于" class="headerlink" title="1. 大于和小于"></a>1. 大于和小于</h4><p><code>&#39;23&#39;&lt;&#39;3&#39;</code>  //true,字符串的比较跟数字的比较不同<br><code>&#39;a&#39;&lt;3</code>   //false a会被转成NaN<br><code>特别注意</code>:NaN和任何数比都是false<br><code>NaN&gt;3</code> //false<br><code>NaN&lt;3</code> //false<br><code>&#39;23&#39;&lt;3</code> //false  ‘23’会被转成23再与3比较</p>
<h4 id="2-全等和不全等"><a href="#2-全等和不全等" class="headerlink" title="2. 全等和不全等"></a>2. 全等和不全等</h4><p><code>&#39;55&#39;==55</code> //true 不全等只判断值不判断类型<br><code>&#39;55&#39;===55</code> //false  全等不仅判断值还判断类型  </p>
<h3 id="四、条件控制语句"><a href="#四、条件控制语句" class="headerlink" title="四、条件控制语句"></a>四、条件控制语句</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">for</span><span class="params">(proertyName in global)</span></span>&#123;</span><br><span class="line">  console.log(proertyName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五、方法"><a href="#五、方法" class="headerlink" title="五、方法"></a>五、方法</h3><p>注意：javascript和java不同，它没有重载,定义两个方法名相同的方法后面一个会覆盖前面一个。</p>
<h3 id="六、检测类型"><a href="#六、检测类型" class="headerlink" title="六、检测类型"></a>六、检测类型</h3><p><code>typeof xxx</code><br>// 返回数据类型</p>
<h3 id="七、引用类型"><a href="#七、引用类型" class="headerlink" title="七、引用类型"></a>七、引用类型</h3><h4 id="1-object"><a href="#1-object" class="headerlink" title="1. object"></a>1. <code>object</code></h4><p>声明对象的方法<br><code>var obj = new Object();</code><br><code>var obj = {};</code></p>
<p>赋值<br><code>obj.name=&#39;xiaomo&#39;;</code>   </p>
<p>使用对象的属性<br><code>obj.name</code><br><code>obj[&#39;name&#39;]</code>  </p>
<h4 id="2-Array"><a href="#2-Array" class="headerlink" title="2. Array"></a>2. <code>Array</code></h4><p>可以存任何类型    </p>
<p>声明<br><code>var arr = new Array();</code><br><code>var arr = new Array(3);</code><br><code>var arr = [];</code>  </p>
<p>添加对象<br><code>arr.push(&#39;a&#39;,b&#39;,1,3,4,true)</code><br>操作对象(删除、插入、替换)     </p>
<p><code>删除</code>：起始位置，要删除的个数<br><code>arr.splice(起始位置,删除的个数)</code><br>例子：<code>arr.splice(2,1)</code> //返回[1] 返回删除的那个数   </p>
<p><code>插入</code>：起始位置、要删除的个数(0)、要插入的数,可以是多个,返回空数组<br><code>arr.splice(起始位置,删除的个数,参数1,参数2,参数n)</code><br>例子:<code>arr.splice(1,0,&#39;插入的值1&#39;,&#39;插入的值2&#39;,&#39;插入的值n&#39;)</code>  </p>
<p><code>替换</code>：起始位置、要删除的项目、要插入的任意项，可以是多个,返回被替换的值<br><code>arr.splice(起始位置,删除的个数,参数1,参数2,参数n)</code><br>例子:<code>arr.splice(0,2,&#39;test1&#39;,&#39;test2&#39;)</code>   </p>
<p>其他数组操作<br><code>arr.push(&#39;test&#39;)</code> 插入到数组的最后面<br><code>arr.unshift(&#39;xiaomo&#39;)</code> 插入到数组的最前面<br><code>arr.pop()</code>   //删除数组的最后一个值<br><code>arr.shift()</code> //删除数组第一个值</p>
<p>使用对象<br><code>arr[1]</code>   </p>
<p>数组自带的方法<br><code>arr.reverse();</code>   反转数组<br><code>arr.sort()</code>   默认升序排列<br><code>arr.sort((a,b)=&gt;{reutrn b-a})</code>  传入排序方法会按照自定义排序<br><code>arr.concat(另一个数组或者单个参数)</code>  如果传入数组也会被展开拿出来,不会影响原数组<br><code>arr.slice(0,3)</code>  会把选定的部分截取出来生成一个新的数组，不会影响原数组<br><code>arr.indexOf(4)</code>   返回该值存在的下标,不存在返回-1<br><code>arr.lastIndexOf(4)</code> 从倒数开始查找,返回该值存在的下标,不存在返回-1<br><code>arr.every(fn)</code>   对每个参数进行处理，全部符合返回true<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(item,index,array)&#123;<span class="comment">//当前值、索引、该数组</span></span><br><span class="line">  <span class="keyword">return</span> item&gt;<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arr.some(fn)</code>   对每个参数进行处理，有一个符合就返回true<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(item,index,array)&#123;<span class="comment">//当前值、索引、该数组</span></span><br><span class="line">  <span class="keyword">return</span> item&gt;<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arr.filter(fn)</code> 对每个参数进行处理，返回过滤后的数组<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(item,index,array)&#123;<span class="comment">//当前值、索引、该数组</span></span><br><span class="line">  <span class="keyword">return</span> item&gt;<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arr.map(fn)</code>    对每个参数进行处理，返回处理后的数组<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(item,index,array)&#123;<span class="comment">//当前值、索引、该数组</span></span><br><span class="line">  <span class="keyword">return</span> item*<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arr.forEach(fn)</code>  对每个参数进行处理，没有返回值<br><code>arr.reduce(fn)</code>    对每个参数进行处理，迭代返回最终结果<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(prev,cur,index,array)&#123;<span class="comment">//前一个值、当前值、索引、数组</span></span><br><span class="line">  <span class="keyword">return</span> prev+cur</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arr.reduceRight(fn)</code>  从右边对每个参数进行处理，迭代返回最终结果<br><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span></span>=(prev,cur,index,array)&#123;<span class="comment">//前一个值、当前值、索引、数组</span></span><br><span class="line">  <span class="keyword">return</span> prev+cur</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-Date类型"><a href="#3-Date类型" class="headerlink" title="3. Date类型"></a>3. Date类型</h4><p>声明:<br><code>var date = new Date();</code>  创建当前时间 也可以接收参数<br><code>Date.parse(pattern)</code>    //   6/13/2016  May 25,2016  或者 yyyy-MM-dd hh:mm:ss格式的  返回时间戳<br><code>new Date(Date.parse(pattern))</code>   //   将时间戳格式化为正常的时间<br><code>new Date(2016,5,19,20,49,15)</code>  //也可以用逗号 2016-05-19 20:49:15<br><code>Date.now()</code>  //当前时间的时间戳<br><code>toDateString()</code> //返回时间的字符串 星期、日、月、年<br><code>toTimeString()</code> //时、分、秒、时区<br><code>toLocaleDateString()</code>   特定时区的星期、日、月、年<br><code>toLocaleTimeString()</code>   特定时区的时、分、秒、时间    </p>
<p>时间格式<br><figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> <span class="built_in">date</span> = <span class="literal">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="built_in">var</span> time = <span class="built_in">date</span>.getTime() <span class="comment">//当前时间的时间戳</span></span><br><span class="line"><span class="built_in">var</span> fullYear = <span class="built_in">date</span>.getFullYear(); <span class="comment">//2016</span></span><br><span class="line"><span class="built_in">var</span> year = <span class="built_in">date</span>.getYear();   <span class="comment">//116  </span></span><br><span class="line"><span class="built_in">var</span> month = <span class="built_in">date</span>.getMonth(); <span class="comment">//04 从0开始</span></span><br><span class="line"><span class="built_in">var</span> d = <span class="built_in">date</span>.getDate(); <span class="comment">//日  19</span></span><br><span class="line"><span class="built_in">var</span> day = <span class="built_in">date</span>.getDay();  <span class="comment">//4 返回星期几</span></span><br><span class="line"><span class="built_in">var</span> <span class="keyword">min</span> = <span class="built_in">date</span>.getMinitues(); <span class="comment">//0</span></span><br><span class="line"><span class="built_in">var</span> sec = <span class="built_in">date</span>.getSeconds() <span class="comment">//秒</span></span><br><span class="line"><span class="built_in">var</span> mill = <span class="built_in">date</span>.getMilliSeconds() <span class="comment">//毫秒</span></span><br></pre></td></tr></table></figure></p>
<h4 id="4-正则-RegExp类型"><a href="#4-正则-RegExp类型" class="headerlink" title="4. 正则 RegExp类型"></a>4. 正则 RegExp类型</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'pattern'</span>);</span><br><span class="line">re.test(parm);</span><br><span class="line"></span><br><span class="line"><span class="comment">// exec 返回匹配的结果</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="string">'abcdef.js'</span>;</span><br><span class="line"><span class="keyword">var</span> pattern = <span class="regexp">/\.js$/</span></span><br><span class="line"><span class="keyword">var</span> matches = parrten.exec(test);</span><br><span class="line"><span class="built_in">console</span>.log(matches); <span class="comment">// '.js' ,index:6 input:'abcdef.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//test 返回true/false</span></span><br><span class="line"><span class="keyword">var</span> text = <span class="string">'abcdef.js'</span>;</span><br><span class="line"><span class="keyword">var</span> pattern = <span class="regexp">/\.js$/</span></span><br><span class="line">pattern.test(text); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h4 id="5-方法-function"><a href="#5-方法-function" class="headerlink" title="5. 方法　function"></a>5. 方法　function</h4><p>方法没有重载,如果是同名,不管参数个数是不是相同,后面定义的方法都会覆盖前面的方法<br>每个方法都包含两个属性:<code>length</code>(参数个数)和<code>protoType</code>(原型链)<br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(a,b)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(a)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">1</span>)    <span class="comment">//1</span></span><br><span class="line">test(<span class="number">1</span>,<span class="number">2</span>)  <span class="comment">//1</span></span><br></pre></td></tr></table></figure></p>
<p>你可以不按正常顺序执行方法,因为在执行的时候 function都会被提前<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">test();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'这是一个方法'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>但如果是立即执行的函数则不行</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(</span><br><span class="line">  function test()&#123;</span><br><span class="line"></span><br><span class="line">  &#125;()</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<p>方法有两个特殊的内部属性和两个非继承来的方法 <code>call()</code>、<code>apply()</code>,以及其他方法 <code>toString()、valueOf()</code><br><code>arguments</code>和<code>this</code><br><code>arguments</code>是类数组,保存着参数。它有<code>arguments.callee()</code>方法<br><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">function <span class="built_in">factorial</span>(<span class="built_in">num</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">num</span>&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">      <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">return</span> <span class="built_in">num</span> * arguments.callee(<span class="built_in">num</span>-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">factorial</span>(<span class="number">5</span>); // <span class="number">5</span>! <span class="number">1</span>*<span class="number">2</span>*<span class="number">3</span>*<span class="number">4</span>*<span class="number">5</span></span><br></pre></td></tr></table></figure></p>
<p><code>this</code>在javascript中用法比较特殊,它指向它的调用者</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">color</span>=<span class="string">'green'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.color);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  <span class="built_in">color</span>=<span class="string">'pink'</span>;</span><br><span class="line">&#125;</span><br><span class="line">o.sayColor(); <span class="comment">//pink</span></span><br><span class="line">sayColor(); <span class="comment">//green</span></span><br></pre></td></tr></table></figure>
<p><code>protoType</code> 原型链    </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span> (<span class="params">num1,num2</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> num1+num2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// call 参数1:运行函数的作用域 参数2 agruments或者Array</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum1</span>(<span class="params">num1,num2</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sum.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum2</span>(<span class="params">num1,num2</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sum.apply(<span class="keyword">this</span>,[num1,num2])</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// apply 参数1：运行函数的作用域 其他参数:就是把apply中的数组拆开</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum2</span>(<span class="params">num1,num2</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sum.apply(<span class="keyword">this</span>,num1,num2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>encodeURIComponent()</code> //encode字符串<br><code>decodeURICopmonent()</code> //decode字符串<br><code>eval(express)</code> //解析字符串表达式<br><code>eval(&quot;console.log(&#39;我是被解析的表达式&#39;)&quot;)</code>   </p>
<h4 id="6-Math"><a href="#6-Math" class="headerlink" title="6. Math"></a>6. <code>Math</code></h4><p><code>Math.E</code> //e<br><code>Math.LN10</code> //10的自然对数<br><code>Math.LOG10E</code> //以10为底e的对数<br><code>Math.PI</code>  //PI<br><code>Math.SQRT2</code> //2的平方根<br><code>Math.SQRT1_2</code>  // 1/2的平方根   </p>
<p>方法：<br><code>Math.min(Array)</code><br><code>Math.max(Array)</code><br><code>Math.ceil(parm)</code> //向上取整<br><code>Math.floor(parm)</code> //向下取整<br><code>Math.round(parm)</code> //标准的四舍五入<br><code>Math.random()</code>  // 0-1之间的数<br><code>Math.abs(parm)</code> //绝对值</p>
<h3 id="八、面向对象的编程方法"><a href="#八、面向对象的编程方法" class="headerlink" title="八、面向对象的编程方法"></a>八、面向对象的编程方法</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name:<span class="string">'xiaomo'</span>,</span><br><span class="line">  age:<span class="number">25</span>，</span><br><span class="line">  sayHello:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>工厂模式</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name,age,job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">    o.name = name;</span><br><span class="line">    o.age= age;</span><br><span class="line">    o.job =job;</span><br><span class="line">    o.sayName=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = createPerson(<span class="string">'xiaomo'</span>,<span class="number">25</span>,<span class="string">'programer'</span>);</span><br><span class="line"><span class="keyword">var</span> person2 = createPerson(<span class="string">'xiaoming'</span>,<span class="number">20</span>,<span class="string">'it'</span>);</span><br></pre></td></tr></table></figure>
<p>构造函数(不用显式的创建对象，不用返回值，直接把属性赋给this)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age,</span><br><span class="line">    <span class="keyword">this</span>.job = job;</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">'xiaomo'</span>,<span class="number">25</span>,<span class="string">'programer'</span>);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">'xiaoming'</span>,<span class="number">20</span>,<span class="string">'it'</span>);</span><br></pre></td></tr></table></figure>
<p>判断类型 <code>instanceof</code>  </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">person1 <span class="keyword">instanceof</span> <span class="built_in">Object</span> <span class="comment">//true</span></span><br><span class="line">person1 <span class="keyword">instanceof</span> Person <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>原型模式    </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//实际上隐式的创建一个构造函数constructor</span></span><br><span class="line">Person.prototype.name=<span class="string">'xiaomo'</span>;</span><br><span class="line">Person.prototype.age=<span class="number">25</span>;</span><br><span class="line">Person.prototype.job=<span class="string">'programmer'</span>;</span><br><span class="line">Person.prototype.sayName=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当前也可以这样</span></span><br><span class="line">Person.prototype=&#123;</span><br><span class="line">  name=<span class="string">'xiaomo'</span>;</span><br><span class="line">  age=<span class="number">25</span>;</span><br><span class="line">  job=<span class="string">'programmer'</span>;</span><br><span class="line">  sayName=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line">Person.prototype.isPrototypeOf(person1); <span class="comment">//true</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person1.name); <span class="comment">//xiaomo</span></span><br><span class="line">person1.hasOwnProperty(<span class="string">'name'</span>) <span class="comment">//false 存在于protoType中，不存在于实例中</span></span><br><span class="line"><span class="string">'name'</span> <span class="keyword">in</span> person1 <span class="comment">//true  虽然实例中没有,但是它的原型链有,所以返回true</span></span><br><span class="line"><span class="built_in">Object</span>.keys(person1) <span class="comment">//会枚举出实例中所有的属性</span></span><br></pre></td></tr></table></figure>
<h3 id="九、定时器和延迟执行"><a href="#九、定时器和延迟执行" class="headerlink" title="九、定时器和延迟执行"></a>九、定时器和延迟执行</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//延迟一秒执行fn函数，只执行一次</span></span><br><span class="line">  <span class="keyword">let</span> timeout = <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> timeoutId = setTimeout(fn,timeout)</span><br><span class="line">  <span class="comment">//清除间歇执行函数</span></span><br><span class="line">  clearTimeout(timeoutId);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//定时器，每秒执行fn函数，直到清除定时器</span></span><br><span class="line">  <span class="keyword">var</span> timeout = <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'定时器'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> intervalId = setInterval(fn,timout)</span><br><span class="line">  <span class="comment">//清除定时器</span></span><br><span class="line">  clearInterval(itervalId);</span><br></pre></td></tr></table></figure>
<h3 id="十、BOM-浏览器相关"><a href="#十、BOM-浏览器相关" class="headerlink" title="十、BOM(浏览器相关)"></a>十、BOM(浏览器相关)</h3><h4 id="1-系统对话框"><a href="#1-系统对话框" class="headerlink" title="1. 系统对话框"></a>1. 系统对话框</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">alert(); <span class="comment">//弹出框</span></span><br><span class="line"></span><br><span class="line">confirm();<span class="comment">//确认框</span></span><br><span class="line"><span class="keyword">if</span>(confirm(<span class="string">'are you sure?'</span>))&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'sure'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'I am not sure!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">prompt();<span class="comment">//交互框</span></span><br><span class="line"><span class="keyword">var</span> result = promot(<span class="string">"what's up?"</span>，<span class="string">'默认值'</span>);</span><br><span class="line"><span class="keyword">if</span>(result!=<span class="literal">null</span>)&#123;</span><br><span class="line">  alert(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-location对象"><a href="#2-location对象" class="headerlink" title="2. location对象"></a>2. location对象</h4><p>参数</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">location</span>.hash <span class="comment">//#contents url的hash值</span></span><br><span class="line"><span class="keyword">location</span>.host <span class="comment">// ip</span></span><br><span class="line"><span class="keyword">location</span>.hostname <span class="comment">//域名</span></span><br><span class="line"><span class="keyword">location</span>.href <span class="comment">//http域名</span></span><br><span class="line"><span class="keyword">location</span>.pathname <span class="comment">//url的目录</span></span><br><span class="line"><span class="keyword">location</span>.port <span class="comment">//8080</span></span><br><span class="line"><span class="keyword">location</span>.protocool <span class="comment">//协议</span></span><br><span class="line"><span class="keyword">location</span>.search <span class="comment">//?q=search</span></span><br><span class="line"><span class="keyword">location</span>.reload() <span class="comment">//可能从缓存加载</span></span><br><span class="line"><span class="keyword">location</span>.reload(<span class="literal">true</span>) <span class="comment">//重新加载</span></span><br></pre></td></tr></table></figure>
<h4 id="3-navigator对象"><a href="#3-navigator对象" class="headerlink" title="3. navigator对象"></a>3. navigator对象</h4><p> 检测浏览器属性    </p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">navigator.appCodeName <span class="comment">//浏览器的名字</span></span><br><span class="line">navigator.appName <span class="comment">//完整的浏览器名称</span></span><br><span class="line">navigator.appVersion <span class="comment">//浏览器的版本</span></span><br><span class="line">navigator.cookieEnabled <span class="comment">//cookie是否启用</span></span><br><span class="line">navigator.javaEnabled() <span class="comment">//java是否启用</span></span><br><span class="line">navigator.language <span class="comment">//主语言 zh-CH</span></span><br><span class="line">navigator.languages <span class="comment">//支持的语言</span></span><br><span class="line">navigator.onLine <span class="comment">//浏览器是否连接到了internet</span></span><br><span class="line">navigator.platofrm <span class="comment">//浏览器的平台 "Win32"</span></span><br><span class="line">navigator.plugins <span class="comment">//返回浏览器安装的插件的数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPlugin</span><span class="params">(name)</span></span>&#123;</span><br><span class="line">  name  = name.toLowerCase();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;navigator.plugins.length;i++)&#123;</span><br><span class="line">    <span class="comment">// &gt;-1表示找到了</span></span><br><span class="line">    <span class="keyword">var</span> isTrue = navigator.plugins[i].name.toLowerCase().indexOf(name)&gt;<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(isTrue)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-history对象"><a href="#4-history对象" class="headerlink" title="4. history对象"></a>4. history对象</h4><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">history</span>.go<span class="params">(-1)</span>;<span class="string">//</span>后退一页</span><br><span class="line"><span class="keyword">history</span>.back<span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">history</span>.go<span class="params">(1)</span>;<span class="string">//</span>前进一页</span><br><span class="line"><span class="keyword">history</span>.forward<span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">history</span>.go<span class="params">('xiaomo.info')</span><span class="string">//</span>跳转到最近访问过的该页面</span><br><span class="line"><span class="keyword">history</span>.length==0 <span class="string">//</span>表示这是用户打开浏览器的第一个页面</span><br></pre></td></tr></table></figure>
<h3 id="十一、表单"><a href="#十一、表单" class="headerlink" title="十一、表单"></a>十一、表单</h3><h4 id="1-表单属性"><a href="#1-表单属性" class="headerlink" title="1. 表单属性"></a>1. 表单属性</h4><figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">acceptCharset 服务器能够处理的字符集</span><br><span class="line">action 接受请求的url</span><br><span class="line">elements 表单所有控件的集合</span><br><span class="line">enctype 请求的编码类型</span><br><span class="line">length 表单中控件的数量</span><br><span class="line"><span class="function"><span class="keyword">method</span> <span class="title">get</span>/<span class="title">post</span></span></span><br><span class="line"><span class="function"><span class="title">name</span> 表单的名字</span></span><br><span class="line"><span class="function"><span class="title">reset</span><span class="params">()</span> 重置</span></span><br><span class="line"><span class="function"><span class="title">submit</span><span class="params">()</span> 提交</span></span><br><span class="line"><span class="function"><span class="title">target</span></span></span><br></pre></td></tr></table></figure>
<p><code>document.forms</code> 可以取到表单的所有控件    </p>
<h4 id="2-控件"><a href="#2-控件" class="headerlink" title="2. 控件"></a>2. 控件</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">disabled 当前字段是否禁用</span><br><span class="line">form 指向当前字段所属表单的指针:只读</span><br><span class="line">name 当前字段的名字</span><br><span class="line">readOnly 当前字段只读</span><br><span class="line">tabIndex tab切换的序号</span><br><span class="line">type 当前字段的类型</span><br><span class="line">value 当前字段提交给服务器的值</span><br></pre></td></tr></table></figure>
<p>修改控件的值</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> input = document.getElementById(<span class="string">'name'</span>);</span><br><span class="line"><span class="keyword">name</span>.value=<span class="string">'xiaomo'</span></span><br><span class="line"><span class="keyword">name</span>.focus(); <span class="comment">//把焦点设置到当前字段</span></span><br><span class="line"><span class="comment">//在控件中加入 autofocus="focus" 是一样的效果</span></span><br></pre></td></tr></table></figure>
<p>选择文本<br><code>element.select()</code>     </p>
<p>取得选中的文本<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">alertText</span>(<span class="params">username</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> username = <span class="built_in">document</span>.getElementById(<span class="string">'username'</span>);</span><br><span class="line">    alert(getSelectText(username));</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getSelectText</span>(<span class="params">textbox</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> textbox.value.substring(textbox.selectionStart,textbox.selectionEnd);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// html</span></span><br><span class="line">&lt;input type=<span class="string">"input"</span> id=<span class="string">"username"</span> value=<span class="string">"我是测试文本，看一下能不能被选中"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"button"</span> value=<span class="string">"确定"</span> onclick=<span class="string">"alertText()"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-剪贴板事件"><a href="#3-剪贴板事件" class="headerlink" title="3. 剪贴板事件"></a>3. 剪贴板事件</h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">beforecopy</span><br><span class="line">copy</span><br><span class="line">cut</span><br><span class="line">beforepaste</span><br><span class="line">paste</span><br><span class="line"></span><br><span class="line"><span class="comment">//写一个公用方</span></span><br><span class="line"><span class="keyword">var</span> EventUtil = &#123;</span><br><span class="line"></span><br><span class="line">  getClipboardText:function(<span class="keyword">event</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clipboardData  = (<span class="keyword">event</span>.clipboardData || window.clipboardData);</span><br><span class="line">    <span class="keyword">return</span> clipboardData.getData(<span class="string">'text'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  setClipboardText:function(<span class="keyword">event</span>,<span class="keyword">value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">event</span>.clipboardData)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">event</span>.clipboardData.setData(<span class="string">"text/plain"</span>,<span class="keyword">value</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (window.clipboardData)&#123;</span><br><span class="line">      <span class="keyword">return</span> window.clipboardData.setData(<span class="string">"txt"</span>,<span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">EventUtil.addHander(txtbox,<span class="string">"paste"</span>,function(<span class="keyword">event</span>))&#123;</span><br><span class="line">  <span class="keyword">event</span>  = EventUtil.getEvent(<span class="keyword">event</span>);</span><br><span class="line">  <span class="keyword">var</span> text = EventUtil.getClipboardText(<span class="keyword">event</span>);</span><br><span class="line">  <span class="keyword">if</span>(!/^\d*$/.test(text))&#123;</span><br><span class="line">    EventUtil.preventDefault(<span class="keyword">event</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://www.cnblogs.com/hykun/p/EventUtil.html" target="_blank" rel="noopener">EventUtil</a></p>
<p>自动切换焦点</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line">(<span class="name">function</span>()&#123;</span><br><span class="line">  function tabForward(<span class="name">event</span>)&#123;</span><br><span class="line">    event = EventUtil.getEvent(<span class="name">event</span>)<span class="comment">;</span></span><br><span class="line">    var target = EventUtil.getTarget(<span class="name">event</span>)<span class="comment">;</span></span><br><span class="line">    if(<span class="name">target.value.length</span> = target.maxLength)&#123;</span><br><span class="line">      var form = target.form<span class="comment">;</span></span><br><span class="line">      for( var i =0<span class="comment">; len = form.elements.length;i&lt;len;i++)&#123;</span></span><br><span class="line">        if(<span class="name">form.elements</span>[<span class="name">i</span>]==target)&#123;</span><br><span class="line">          if(<span class="name">form.elements</span>[<span class="name">i+1</span>])&#123;</span><br><span class="line">            form.elements[<span class="name">i+1</span>].focus()<span class="comment">;</span></span><br><span class="line">          &#125;</span><br><span class="line">          return<span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  var text1 = document.getElementById(<span class="symbol">'text1</span>')<span class="comment">;</span></span><br><span class="line">  var text2 = document.getElementById(<span class="symbol">'text2</span>')<span class="comment">;</span></span><br><span class="line">  var text3 = document.getElementById(<span class="symbol">'text3</span>')<span class="comment">;</span></span><br><span class="line">  EventUtil.addHander(<span class="name">text1</span>,<span class="symbol">'keyup</span>',tabForward)<span class="comment">;</span></span><br><span class="line">  EventUtil.addHander(<span class="name">text2</span>,<span class="symbol">'keyup</span>',tabForward</span><br><span class="line">  EventUtil.addHander(<span class="name">text3</span>,<span class="symbol">'keyup</span>',tabForward</span><br><span class="line">  &#125;)()</span><br></pre></td></tr></table></figure>
<h4 id="4-下拉框-select"><a href="#4-下拉框-select" class="headerlink" title="4. 下拉框 select"></a>4. 下拉框 select</h4><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">add(<span class="keyword">new</span><span class="type">Option</span>,relOption) 插入一个option</span><br><span class="line"><span class="comment">//最佳做法(在列表最后插入一个option)</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">Option</span> = <span class="keyword">new</span> <span class="type">Option</span>(<span class="string">"text"</span>,<span class="string">"value"</span>);</span><br><span class="line">selectBox.add(<span class="keyword">new</span><span class="type">Option</span>,undefined);</span><br><span class="line"></span><br><span class="line">multiple 是否允许多选</span><br><span class="line">options 控件中所有options的HTMLCollection</span><br><span class="line">remove(index) 移除指定位置的选项</span><br><span class="line"><span class="comment">//移除指定的选项(这里移除的是第一项)</span></span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span></span><br><span class="line">selectBox.remove(selectBox.options[index])</span><br><span class="line">selectedIndex 基于<span class="number">0</span>的选中项的索引,没有选中项<span class="number">-1</span></span><br><span class="line">size 选择框中可见的行数</span><br><span class="line">text 选中项的文本内容</span><br><span class="line">value 选项的值</span><br><span class="line"><span class="comment">//移动一个选项到特定位置(将第2个选项移动到最后一个选项)</span></span><br><span class="line"><span class="keyword">var</span> optionToMove = selectBox.options[<span class="number">1</span>];</span><br><span class="line">selectBox.insertBefore(optionToMove,selectBox.options[optionToMove.index<span class="number">-1</span>])</span><br><span class="line">/添加一个选项(把当前列表中的第一个选项添加到当前列表的最后)</span><br><span class="line">selectBox.appendChind(selectBox.options[<span class="number">0</span>]);</span><br></pre></td></tr></table></figure>
<h4 id="5-表单序列化"><a href="#5-表单序列化" class="headerlink" title="5. 表单序列化"></a>5. 表单序列化</h4><p>原则：<br>对表单字段的名字和值进行url编码,使用&amp;分割<br>不发送禁用的表单字段<br>只发送勾选的单选按钮和复选框<br>不发送type为reset和button的按钮<br>多选框中的每选中的值单独一个条目<br>submit的时候,本按钮也会被提交<br>select发送的时候如果有value就发value的值 没有就发text内容  </p>
<p><code>form.serialize()</code>  </p>
<h4 id="6-富文本编辑器"><a href="#6-富文本编辑器" class="headerlink" title="6. 富文本编辑器"></a>6. 富文本编辑器</h4><p>只要加上<code>contenteditable</code>就可以让div可以编辑<br><code>&lt;div id=&quot;richedit&quot; contenteditable&gt;&lt;/div&gt;</code><br>也可以用js控制</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">var richedit = <span class="built_in">document</span>.getElementById(<span class="string">'richedit'</span>);</span><br><span class="line">richedit.contenteditable=<span class="string">"true"</span>;</span><br><span class="line"><span class="regexp">//</span> <span class="literal">true</span> <span class="literal">false</span> inherit</span><br><span class="line"><span class="built_in">document</span>.exexCommand(命令,<span class="literal">false</span>,值);</span><br><span class="line">//<span class="built_in">document</span>.exexCommand(<span class="string">'bold'</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<h3 id="十二、canvas"><a href="#十二、canvas" class="headerlink" title="十二、canvas"></a>十二、canvas</h3><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">//定义一个canvas   </span></span><br><span class="line">&lt;canvas id=<span class="string">"drawing"</span> width=<span class="string">"200"</span> height=<span class="string">"200"</span>&gt;</span><br><span class="line">    您的浏览器不支持canvas</span><br><span class="line">&lt;/canvas&gt;</span><br><span class="line"><span class="comment">//获取canvas</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'drawing'</span>);</span><br><span class="line"><span class="keyword">if</span>(drawing.getContext)&#123;</span><br><span class="line">  <span class="keyword">var</span> context = drawing.getContext(<span class="string">'2d'</span>);</span><br><span class="line">  context.fillReact(<span class="number">30</span>,<span class="number">30</span>,<span class="number">30</span>,<span class="number">30</span>); <span class="comment">//画了一个正方形</span></span><br><span class="line">  context.fillStyle=<span class="string">'#fff'</span>; <span class="comment">//填充</span></span><br><span class="line">  context.strokeStyle=<span class="string">'red'</span>; <span class="comment">//描边</span></span><br><span class="line">  <span class="comment">// todo</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="十三、html5脚本编程"><a href="#十三、html5脚本编程" class="headerlink" title="十三、html5脚本编程"></a>十三、html5脚本编程</h3><figure class="highlight mel"><table><tr><td class="code"><pre><span class="line"><span class="comment">//跨文档消息传送</span></span><br><span class="line">EventUtil.addHander(<span class="keyword">window</span>,<span class="string">"message"</span>,function(<span class="keyword">event</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">event</span>.origin=<span class="string">"http://www.wrox.com"</span>)&#123;<span class="comment">//发送消息的文档所在的域</span></span><br><span class="line">      <span class="comment">//接受参数</span></span><br><span class="line">      processMessage(<span class="keyword">event</span>.data);</span><br><span class="line">      <span class="comment">//可选:向窗口来源发送回执</span></span><br><span class="line">      <span class="keyword">event</span>.<span class="keyword">source</span>.postMessage(<span class="string">"Receiived"</span>,<span class="string">"http://xiaomo.info"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="十四、本地存储"><a href="#十四、本地存储" class="headerlink" title="十四、本地存储"></a>十四、本地存储</h3><h4 id="1-cookie"><a href="#1-cookie" class="headerlink" title="1. cookie"></a>1. cookie</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> CookieUtil = &#123;</span><br><span class="line"><span class="comment">//根据key读取cookie</span></span><br><span class="line">    <span class="keyword">get</span>: function (name)&#123;</span><br><span class="line">         <span class="comment">//注意对键编码</span></span><br><span class="line">        <span class="keyword">var</span> cookieName = <span class="built_in">encodeURIComponent</span>(name) + <span class="string">"="</span>,</span><br><span class="line">            cookieStart = <span class="built_in">document</span>.cookie.indexOf(cookieName),</span><br><span class="line">            cookieValue = <span class="literal">null</span>,</span><br><span class="line">            cookieEnd;</span><br><span class="line">        <span class="comment">//找到cookie键</span></span><br><span class="line">        <span class="keyword">if</span> (cookieStart &gt; <span class="number">-1</span>)&#123;</span><br><span class="line">             <span class="comment">//键后面第一个分号位置</span></span><br><span class="line">            cookieEnd = <span class="built_in">document</span>.cookie.indexOf(<span class="string">";"</span>, cookieStart);</span><br><span class="line">            <span class="keyword">if</span> (cookieEnd == <span class="number">-1</span>)&#123;</span><br><span class="line">                cookieEnd = <span class="built_in">document</span>.cookie.length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//cookie值解码</span></span><br><span class="line">            cookieValue = <span class="built_in">decodeURIComponent</span>(<span class="built_in">document</span>.cookie.substring(cookieStart + cookieName.length, cookieEnd));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cookieValue;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//设置cookie</span></span><br><span class="line">    <span class="keyword">set</span>: function (name, value, expires, path, domain, secure) &#123;</span><br><span class="line">        <span class="keyword">var</span> cookieText = <span class="built_in">encodeURIComponent</span>(name) + <span class="string">"="</span> + <span class="built_in">encodeURIComponent</span>(value);</span><br><span class="line">        <span class="comment">//失效时间，GMT时间格式</span></span><br><span class="line">        <span class="keyword">if</span> (expires <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</span><br><span class="line">            cookieText += <span class="string">"; expires="</span> + expires.toGMTString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (path) &#123;</span><br><span class="line">            cookieText += <span class="string">"; path="</span> + path;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (domain) &#123;</span><br><span class="line">            cookieText += <span class="string">"; domain="</span> + domain;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (secure) &#123;</span><br><span class="line">            cookieText += <span class="string">"; secure"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">document</span>.cookie = cookieText;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//删除cookie，保持相同的键、域、路径、安全选项，然后设置失效时间即可</span></span><br><span class="line">    unset: <span class="function"><span class="keyword">function</span> (<span class="params">name, path, domain, secure</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.set(name, <span class="string">""</span>, <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>), path, domain, secure);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>使用util方法   </p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">CookieUtil.<span class="builtin-name">set</span>(<span class="string">'name'</span>,<span class="string">'xiaomo'</span>);</span><br><span class="line">CookieUtil.<span class="builtin-name">set</span>(<span class="string">'age'</span>,26);</span><br><span class="line"></span><br><span class="line">console.log(CookieUtil.<span class="builtin-name">get</span>(<span class="string">'name'</span>));</span><br><span class="line">console.log(CookieUtil.<span class="builtin-name">get</span>(<span class="string">'age'</span>));</span><br><span class="line"></span><br><span class="line">CookieUtil.unset(<span class="string">'name'</span>);</span><br><span class="line">CookieUtil.unset(<span class="string">'age'</span>);</span><br></pre></td></tr></table></figure>
<h4 id="2-localStorage"><a href="#2-localStorage" class="headerlink" title="2. localStorage"></a>2. localStorage</h4><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">Window.localStorage.<span class="built_in">setItem</span>(<span class="built_in">key</span>,value);<span class="comment">//存储数据</span></span><br><span class="line">Window.localStorage.<span class="built_in">getItem</span>(<span class="built_in">key</span>);<span class="comment">//读取数据</span></span><br><span class="line">Window.localStorage.<span class="built_in">removeItem</span>(<span class="built_in">key</span>);<span class="comment">//删除数据项</span></span><br><span class="line">Window.localStorage.<span class="keyword">clear</span>();<span class="comment">//删除所有数据</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> javascript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> es5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[es6语法快速上手]]></title>
      <url>https://blog.xiaomo.info/2016/Es6Syntax/</url>
      <content type="html"><![CDATA[<p>随着google和firfox以及node6.0对es6的支持，es6语法的定稿使它越来越受到关注，尤其是react项目基本上都是用es6来写的。是时候从es5到es6转变了<br><a id="more"></a></p>
<h3 id="一、相关背景介绍"><a href="#一、相关背景介绍" class="headerlink" title="一、相关背景介绍"></a>一、相关背景介绍</h3><p>我们现在大多数人用的语法javascript 其实版本是ecmscript5,也是就es5。这个版本己经很多年了，且完美被各大浏览器所支持。所以很多学js的朋友可以一直分不清楚es5和javascript的关系。javascript是一门编程语言，那么它就会有版本，es5还是es6 就就是它的版本号。最新版es7己经在紧锣密布的进行中，它最新的语法会让我们写代码更新的行云流水。</p>
<h3 id="二、babel-一个es6的解析器"><a href="#二、babel-一个es6的解析器" class="headerlink" title="二、babel 一个es6的解析器"></a>二、babel 一个es6的解析器</h3><p>在我们正式讲解ES6语法之前，我们得先了解下<a href="https://babeljs.io/" target="_blank" rel="noopener">Babel。</a></p>
<p>Babel是一个广泛使用的ES6转码器，可以将ES6代码转为ES5代码，从而在现有环境执行。大家可以选择自己习惯的工具来使用使用Babel,我最喜欢的构建工具就是webpack。具体过程可直接在Babel官网查看：</p>
<h3 id="三、语法"><a href="#三、语法" class="headerlink" title="三、语法"></a>三、语法</h3><p>最常用的ES6特性</p>
<p><code>let</code>, <code>const</code>, <code>class</code>, <code>extends</code>, <code>super</code>, <code>arrow functions</code>, <code>template string</code>, <code>destructuring</code>, <code>default</code>, <code>rest arguments</code><br>这些是ES6最常用的几个语法，基本上学会它们，我们就可以走遍天下都不怕啦！我会用最通俗易懂的语言和例子来讲解它们，保证一看就懂，一学就会。</p>
<h4 id="1-let-const"><a href="#1-let-const" class="headerlink" title="1. let, const"></a>1. <code>let, const</code></h4><p>这两个的用途与<code>var</code>类似，都是用来声明变量的，但在实际运用中他俩都有各自的特殊用途。<br>首先来看下面这个例子：</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">var <span class="built_in">name</span> = <span class="string">'zach'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    var <span class="built_in">name</span> = <span class="string">'obama'</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="built_in">name</span>)  <span class="comment">//obama</span></span><br><span class="line">    break</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">name</span>)  <span class="comment">//obama</span></span><br></pre></td></tr></table></figure>
<p>使用<code>var</code> 两次输出都是obama，这是因为ES5只有全局作用域和函数作用域，没有块级作用域，这带来很多不合理的场景。第一种场景就是你现在看到的内层变量覆盖外层变量。而<code>let</code>则实际上为<code>JavaScript</code>新增了块级作用域。用它所声明的变量，只在<code>let</code>命令所在的代码块内有效。</p>
<p>另外一个<code>var</code>带来的不合理场景就是用来计数的循环变量泄露为全局变量，看下面的例子：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">6</span>](); <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，变量i是var声明的，在全局范围内都有效。所以每一次循环，新的i值都会覆盖旧值，导致最后输出的是最后一轮的i的值。而使用let则不会出现这个问题。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">6</span>](); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
<p>再来看一个更常见的例子，了解下如果不用ES6，而用闭包如何解决这个问题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">var clickBoxs = document.querySelectorAll(<span class="string">'.clickBox'</span>)</span><br><span class="line"><span class="keyword">for</span> (var <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt; clickBoxs.<span class="built_in">length</span>; <span class="built_in">i</span>++)&#123;</span><br><span class="line">    clickBoxs[<span class="built_in">i</span>].onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></span><br><span class="line">        console.<span class="built_in">log</span>(<span class="built_in">i</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们本来希望的是点击不同的clickBox，显示不同的i，但事实是无论我们点击哪个clickBox，输出的都是5。下面我们来看下，如何用闭包搞定它。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iteratorFactory</span><span class="params">(i)</span>&#123;</span></span><br><span class="line">    var onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span>&#123;</span></span><br><span class="line">        console.<span class="built_in">log</span>(<span class="built_in">i</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> onclick;</span><br><span class="line">&#125;</span><br><span class="line">var clickBoxs = document.querySelectorAll(<span class="string">'.clickBox'</span>)</span><br><span class="line"><span class="keyword">for</span> (var <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt; clickBoxs.<span class="built_in">length</span>; <span class="built_in">i</span>++)&#123;</span><br><span class="line">    clickBoxs[<span class="built_in">i</span>].onclick = iteratorFactory(<span class="built_in">i</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>const</code>也用来声明变量，但是声明的是常量。一旦声明，常量的值就不能改变。</p>
<figure class="highlight monkey"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">PI</span> = Math.<span class="built_in">PI</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PI</span> = <span class="number">23</span> //<span class="keyword">Module</span> build failed: SyntaxError: /es6/app.js: <span class="string">"PI"</span> is read-only</span><br></pre></td></tr></table></figure>
<p>当我们尝试去改变用const声明的常量时，浏览器就会报错。<br>const有一个很好的应用场景，就是当我们引用第三方库的时声明的变量，用const来声明可以避免未来不小心重命名而导致出现bug：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> monent = <span class="built_in">require</span>(<span class="string">'moment'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-class-extends-super"><a href="#2-class-extends-super" class="headerlink" title="2. class, extends, super"></a>2. <code>class</code>, <code>extends</code>, <code>super</code></h4><p>这三个特性涉及了ES5中最令人头疼的的几个部分：原型、构造函数，继承…你还在为它们复杂难懂的语法而烦恼吗？你还在为指针到底指向哪里而纠结万分吗？</p>
<p>有了ES6我们不再烦恼！</p>
<p>ES6提供了更接近传统语言的写法，引入了Class（类）这个概念。新的class写法让对象原型的写法更加清晰、更像面向对象编程的语法，也更加通俗易懂。</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        <span class="keyword">this</span><span class="class">.<span class="keyword">type</span> </span>= <span class="symbol">'anima</span>l'</span><br><span class="line">    &#125;</span><br><span class="line">    says(say)&#123;</span><br><span class="line">        console.log(<span class="keyword">this</span><span class="class">.<span class="keyword">type</span> <span class="title">+</span> ' <span class="title">says</span> ' <span class="title">+</span> <span class="title">say</span>)</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">let</span> <span class="title">animal</span> </span>= <span class="keyword">new</span> <span class="type">Animal</span>()</span><br><span class="line">animal.says(<span class="symbol">'hell</span>o') <span class="comment">//animal says hello</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span><span class="class">.<span class="keyword">type</span> </span>= <span class="symbol">'ca</span>t'</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let cat = <span class="keyword">new</span> <span class="type">Cat</span>()</span><br><span class="line">cat.says(<span class="symbol">'hell</span>o') <span class="comment">//cat says hello</span></span><br></pre></td></tr></table></figure>
<p>上面代码首先用<code>class</code>定义了一个“类”，可以看到里面有一个constructor方法，这就是构造方法，而this关键字则代表实例对象。简单地说，constructor内定义的方法和属性是实例对象自己的，而constructor外定义的方法和属性则是所有实例对象可以共享的。</p>
<p><code>Class</code>之间可以通过<code>extends</code>关键字实现继承，这比ES5的通过修改原型链实现继承，要清晰和方便很多。上面定义了一个Cat类，该类通过extends关键字，继承了Animal类的所有属性和方法。</p>
<p><code>super</code>关键字，它指代父类的实例（即父类的this对象）。子类必须在<code>constructor</code>方法中调用<code>super</code>方法，否则新建实例时会报错。这是因为子类没有自己的<code>this</code>对象，而是继承父类的this对象，然后对其进行加工。如果不调用super方法，子类就得不到this对象。</p>
<p><code>ES6</code>的继承机制，实质是先创造父类的实例对象<code>this</code>（所以必须先调用s<code>uper</code>方法），然后再用子类的构造函数修改<code>this</code>。</p>
<p>P.S 如果你写react的话，就会发现以上三个东西在最新版<code>React</code>中出现得很多。创建的每个component都是一个继承<code>React.Component</code>的类。<a href="https://facebook.github.io/react/docs/reusable-components.html" target="_blank" rel="noopener">详见react文档</a></p>
<h4 id="3-arrow-function"><a href="#3-arrow-function" class="headerlink" title="3. arrow function"></a>3. <code>arrow function</code></h4><p>这个恐怕是ES6最最常用的一个新特性了，用它来写function比原来的写法要简洁清晰很多:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(i)</span></span>&#123; <span class="keyword">return</span> i + <span class="number">1</span>; &#125; <span class="comment">//ES5</span></span><br><span class="line">(i) =&gt; i + <span class="number">1</span> <span class="comment">//ES6</span></span><br></pre></td></tr></table></figure>
<p>简直是简单的不像话对吧…<br>如果方程比较复杂，则需要用<code>{}</code>把代码包起来：</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(x, y)</span></span> &#123;</span><br><span class="line">    x++;</span><br><span class="line">    y<span class="comment">--;</span></span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line">(x, y) =&gt; &#123;x++; y<span class="comment">--; return x+y&#125;</span></span><br></pre></td></tr></table></figure>
<p>除了看上去更简洁以外，<code>arrow function</code>还有一项超级无敌的功能！<br>长期以来，<code>JavaScript</code>语言的<code>this</code>对象一直是一个令人头痛的问题，在对象方法中使用<code>this</code>，必须非常小心。例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = <span class="string">'animal'</span></span><br><span class="line">    &#125;</span><br><span class="line">    says(say)&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.type + <span class="string">' says '</span> + say)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> animal = <span class="keyword">new</span> Animal()</span><br><span class="line"> animal.says(<span class="string">'hi'</span>)  <span class="comment">//undefined says hi</span></span><br></pre></td></tr></table></figure>
<p>运行上面的代码会报错，这是因为<code>setTimeout</code>中的<code>this</code>指向的是全局对象。所以为了让它能够正确的运行，传统的解决方法有两种：</p>
<ol>
<li>第一种是将this传给self,再用self来指代this</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">says(say)&#123;</span><br><span class="line">      <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(self.type + <span class="string">' says '</span> + say)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>第二种方法是用bind(this),即</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">says(say)&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.type + <span class="string">' says '</span> + say)</span><br><span class="line">    &#125;.bind(<span class="keyword">this</span>), <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>但现在我们有了箭头函数，就不需要这么麻烦了：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = <span class="string">'animal'</span></span><br><span class="line">    &#125;</span><br><span class="line">    says(say)&#123;</span><br><span class="line">        setTimeout( <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.type + <span class="string">' says '</span> + say)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">var</span> animal = <span class="keyword">new</span> Animal()</span><br><span class="line"> animal.says(<span class="string">'hi'</span>)  <span class="comment">//animal says hi</span></span><br></pre></td></tr></table></figure>
<p>当我们使用箭头函数时，函数体内的this对象，就是定义时所在的对象，而不是使用时所在的对象。<br>并不是因为箭头函数内部有绑定this的机制，实际原因是箭头函数根本没有自己的this，它的this是继承外面的，因此内部的this就是外层代码块的this。</p>
<h3 id="4-template-string"><a href="#4-template-string" class="headerlink" title="4. template string"></a>4. <code>template string</code></h3><p>这个东西也是非常有用，当我们要插入大段的html内容到文档中时，传统的写法非常麻烦，所以之前我们通常会引用一些模板工具库，比如mustache等等。</p>
<p>大家可以先看下面一段代码：</p>
<figure class="highlight smalltalk"><table><tr><td class="code"><pre><span class="line"><span class="string">$(</span><span class="comment">"#result"</span>).append(</span><br><span class="line">  <span class="comment">"There are &lt;b&gt;"</span> + basket.count + <span class="comment">"&lt;/b&gt; "</span> +</span><br><span class="line">  <span class="comment">"items in your basket, "</span> +</span><br><span class="line">  <span class="comment">"&lt;em&gt;"</span> + basket.onSale +</span><br><span class="line">  <span class="comment">"&lt;/em&gt; are on sale!"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>我们要用一堆的’+’号来连接文本与变量，而使用ES6的新特性模板字符串<code></code>后，我们可以直接这么来写：</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">$("#result").append(`</span></span><br><span class="line"><span class="xml">  There are <span class="tag">&lt;<span class="name">b</span>&gt;</span>$</span><span class="template-variable">&#123;basket.count&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span> items</span></span><br><span class="line"><span class="xml">   in your basket, <span class="tag">&lt;<span class="name">em</span>&gt;</span>$</span><span class="template-variable">&#123;basket.onSale&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">em</span>&gt;</span></span></span><br><span class="line"><span class="xml">  are on sale!</span></span><br><span class="line"><span class="xml">`);</span></span><br></pre></td></tr></table></figure>
<p>用反引号（\）来标识起始，用${}`来引用变量，而且所有的空格和缩进都会被保留在输出之中，是不是非常爽？！</p>
<p>  <a href="https://github.com/reactjs/react-router/blob/latest/examples/passing-props-to-children/app.js" target="_blank" rel="noopener">React Router</a>从第1.0.3版开始也使用ES6语法了，比如这个例子：</p>
<p><code>&lt;Link to={&#39;/taco/${taco.name}&#39;}&gt;{taco.name}&lt;/Link&gt;</code></p>
<h3 id="5-destructuring"><a href="#5-destructuring" class="headerlink" title="5. destructuring"></a>5. <code>destructuring</code></h3><p>  ES6允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）。</p>
<p>看下面的例子：</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">cat</span> = <span class="string">'ken'</span></span><br><span class="line"><span class="keyword">let</span> dog = <span class="string">'lili'</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;<span class="keyword">ca</span><span class="variable">t:</span> <span class="keyword">cat</span>, <span class="keyword">do</span><span class="variable">g:</span> dog&#125;</span><br><span class="line">console.<span class="built_in">log</span>(zoo)  //Object &#123;<span class="keyword">ca</span><span class="variable">t:</span> <span class="string">"ken"</span>, <span class="keyword">do</span><span class="variable">g:</span> <span class="string">"lili"</span>&#125;</span><br></pre></td></tr></table></figure>
<p>用ES6完全可以像下面这么写：</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">cat</span> = <span class="string">'ken'</span></span><br><span class="line"><span class="keyword">let</span> dog = <span class="string">'lili'</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;<span class="keyword">cat</span>, dog&#125;</span><br><span class="line">console.<span class="built_in">log</span>(zoo)  //Object &#123;<span class="keyword">ca</span><span class="variable">t:</span> <span class="string">"ken"</span>, <span class="keyword">do</span><span class="variable">g:</span> <span class="string">"lili"</span>&#125;</span><br></pre></td></tr></table></figure>
<p>反过来可以这么写：</p>
<figure class="highlight fsharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> dog = &#123;<span class="class"><span class="keyword">type</span>: '<span class="title">animal</span>', <span class="title">many</span>: 2&#125;</span></span><br><span class="line"><span class="keyword">let</span> &#123; <span class="class"><span class="keyword">type</span>, <span class="title">many</span>&#125; </span>= dog</span><br><span class="line">console.log(<span class="class"><span class="keyword">type</span>, <span class="title">many</span>)   //<span class="title">animal</span> 2</span></span><br></pre></td></tr></table></figure>
<h3 id="6-default-rest"><a href="#6-default-rest" class="headerlink" title="6. default, rest"></a>6. <code>default</code>, <code>rest</code></h3><p>default很简单，意思就是默认值。大家可以看下面的例子，调用animal()方法时忘了传参数，传统的做法就是加上这一句type = type || ‘cat’ 来指定默认值。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">function animal(type)&#123;</span><br><span class="line">   <span class="built_in"> type </span>=<span class="built_in"> type </span>|| <span class="string">'cat'</span>  </span><br><span class="line">    console.log(type)</span><br><span class="line">&#125;</span><br><span class="line">animal()</span><br></pre></td></tr></table></figure>
<p>如果用ES6我们而已直接这么写：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">animal</span><span class="params">(<span class="keyword">type</span> = <span class="string">'cat'</span>)</span><span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">    console.log(type)</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span></span></span><br><span class="line"><span class="function"><span class="title">animal</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>最后一个rest语法也很简单，直接看例子：</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">animals</span><span class="params">(<span class="rest_arg">...types</span>)</span></span>&#123;</span><br><span class="line">    console.log(types)</span><br><span class="line">&#125;</span><br><span class="line">animals(<span class="string">'cat'</span>, <span class="string">'dog'</span>, <span class="string">'fish'</span>) <span class="comment">//["cat", "dog", "fish"]</span></span><br></pre></td></tr></table></figure>
<p>而如果不用ES6的话，我们则得使用ES5的<code>arguments</code>。</p>
<h3 id="7-import-export"><a href="#7-import-export" class="headerlink" title="7. import export"></a>7. <code>import export</code></h3><p>这两个家伙对应的就是<code>es6</code>自己的<code>module</code>功能。</p>
<p>我们之前写的<code>Javascript</code>一直都没有模块化的体系，无法将一个庞大的js工程拆分成一个个功能相对独立但相互依赖的小工程，再用一种简单的方法把这些小工程连接在一起。</p>
<p>这有可能导致两个问题：</p>
<ol>
<li>一方面js代码变得很臃肿，难以维护;</li>
<li>另一方面我们常常得很注意每个script标签在html中的位置，因为它们通常有依赖关系，顺序错了可能就会出bug;<br>在es6之前为解决上面提到的问题，我们得利用第三方提供的一些方案，主要有两种CommonJS(服务器端)和AMD（浏览器端，如require.js）。</li>
</ol>
<p>如果想了解更多AMD，尤其是require.js，可以参看这个教程<br><a href="http://requirejs.org/docs/why.html" target="_blank" rel="noopener">why modules on the web are useful and the mechanisms that can be used on the web today to enable them</a></p>
<p>而现在我们有了es6的module功能，它实现非常简单，可以成为服务器和浏览器通用的模块解决方案。</p>
<blockquote>
<p>ES6模块的设计思想，是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS和AMD模块，都只能在运行时确定这些东西。</p>
</blockquote>
<p>上面的设计思想看不懂也没关系，咱先学会怎么用，等以后用多了、熟练了再去研究它背后的设计思想也不迟！好，那我们就上代码…</p>
<p> 传统的写法<br>首先我们回顾下require.js的写法。假设我们有两个js文件: index.js和content.js,现在我们想要在index.js中使用content.js返回的结果，我们要怎么做呢？</p>
<p>首先定义:</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//content.js</span></span><br><span class="line">define(<span class="string">'content.js'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'A cat'</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>然后require:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'./content.js'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">animal</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(animal);   <span class="comment">//A cat</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>那CommonJS是怎么写的呢？</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">var</span> animal = require(<span class="string">'./content.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//content.js</span></span><br><span class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = <span class="string">'A cat'</span></span><br></pre></td></tr></table></figure>
<p> ES6的写法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> animal <span class="keyword">from</span> <span class="string">'./content'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//content.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'A cat'</span></span><br></pre></td></tr></table></figure>
<p>以上我把三者都列出来了，妈妈再也不用担心我写混淆了…</p>
<h3 id="8-ES6-module的其他高级用法"><a href="#8-ES6-module的其他高级用法" class="headerlink" title="8. ES6 module的其他高级用法"></a>8. ES6 module的其他高级用法</h3><p>输出\输入多个变量</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//content.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'A cat'</span>    </span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello!'</span></span><br><span class="line">&#125;    </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> type = <span class="string">'dog'</span></span><br></pre></td></tr></table></figure>
<p>上面可以看出，export命令除了输出变量，还可以输出函数，甚至是类（react的模块基本都是输出类）</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; say, <span class="keyword">type</span> &#125; <span class="keyword">from</span> <span class="string">'./content'</span>  </span><br><span class="line"><span class="keyword">let</span> says = say()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`The <span class="subst">$&#123;<span class="keyword">type</span>&#125;</span> says <span class="subst">$&#123;says&#125;</span>`</span>)  <span class="comment">//The dog says Hello</span></span><br></pre></td></tr></table></figure>
<p>这里输入的时候要注意：大括号里面的变量名，必须与被导入模块（content.js）对外接口的名称相同。</p>
<p>如果还希望输入content.js中输出的默认值(default), 可以写在大括号外面。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> animal, &#123; say, <span class="keyword">type</span> &#125; <span class="keyword">from</span> <span class="string">'./content'</span>  </span><br><span class="line"><span class="keyword">let</span> says = say()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`The <span class="subst">$&#123;<span class="keyword">type</span>&#125;</span> says <span class="subst">$&#123;says&#125;</span> to <span class="subst">$&#123;animal&#125;</span>`</span>)  </span><br><span class="line"><span class="comment">//The dog says Hello to A cat</span></span><br></pre></td></tr></table></figure>
<h3 id="9-修改变量名"><a href="#9-修改变量名" class="headerlink" title="9. 修改变量名"></a>9. 修改变量名</h3><p>此时我们不喜欢type这个变量名，因为它有可能重名，所以我们需要修改一下它的变量名。在es6中可以用as实现一键换名。</p>
<p>//index.js<br><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> animal, &#123; say, <span class="keyword">type</span> <span class="keyword">as</span> animalType &#125; <span class="keyword">from</span> <span class="string">'./content'</span>  </span><br><span class="line"><span class="keyword">let</span> says = say()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`The <span class="subst">$&#123;animalType&#125;</span> says <span class="subst">$&#123;says&#125;</span> to <span class="subst">$&#123;animal&#125;</span>`</span>)  </span><br><span class="line"><span class="comment">//The dog says Hello to A cat</span></span><br></pre></td></tr></table></figure></p>
<h3 id="10-模块的整体加载"><a href="#10-模块的整体加载" class="headerlink" title="10. 模块的整体加载"></a>10. 模块的整体加载</h3><p>除了指定加载某个输出值，还可以使用整体加载，即用星号（*）指定一个对象，所有输出值都加载在这个对象上面。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> animal, * <span class="keyword">as</span> content <span class="keyword">from</span> <span class="string">'./content'</span>  </span><br><span class="line"><span class="keyword">let</span> says = content.say()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`The <span class="subst">$&#123;content.<span class="keyword">type</span>&#125;</span> says <span class="subst">$&#123;says&#125;</span> to <span class="subst">$&#123;animal&#125;</span>`</span>)  </span><br><span class="line"><span class="comment">//The dog says Hello to A cat</span></span><br></pre></td></tr></table></figure>
<p>通常星号*结合as一起使用比较合适。</p>
<ol start="11">
<li>终极秘籍</li>
</ol>
<p>考虑下面的场景：<br>上面的content.js一共输出了三个变量（default, say, type）,假如我们的实际项目当中只需要用到type这一个变量，其余两个我们暂时不需要。我们可以只输入一个变量：</p>
<p><code>import { type } from &#39;./content&#39;</code></p>
<p>由于其他两个变量没有被使用，我们希望代码打包的时候也忽略它们，抛弃它们，这样在大项目中可以显著减少文件的体积。</p>
<p>ES6帮我们实现了！</p>
<p>不过，目前无论是webpack还是browserify都还不支持这一功能…</p>
<p>如果你现在就想实现这一功能的话，可以尝试使用rollup.js</p>
<p>他们把这个功能叫做Tree-shaking，哈哈哈，意思就是打包前让整个文档树抖一抖，把那些并未被依赖或使用的东西统统抖落下去。。。</p>
<p>看看他们官方的解释吧：</p>
<blockquote>
<p>Normally if you require a module, you import the whole thing. ES2015 lets you just import the bits you need, without mucking around with custom builds. It’s a revolution in how we use libraries in JavaScript, and it’s happening right now.</p>
</blockquote>
<p>希望更全面了解es6伙伴们可以去看阮一峰所著的电子书<a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ECMAScript 6入门</a></p>
]]></content>
      
        <categories>
            
            <category> javascript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> es6 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack进阶之插件篇]]></title>
      <url>https://blog.xiaomo.info/2016/WebpackPlugins/</url>
      <content type="html"><![CDATA[<p>上一篇博客讲解了webpack环境的基本，这一篇讲解一些更深入的内容和开发技巧。基本环境搭建就不展开讲了<br><a id="more"></a></p>
<h3 id="一、插件篇"><a href="#一、插件篇" class="headerlink" title="一、插件篇"></a>一、插件篇</h3><h4 id="1-自动补全css3前缀"><a href="#1-自动补全css3前缀" class="headerlink" title="1. 自动补全css3前缀"></a>1. 自动补全css3前缀</h4><p> autoprefixer  </p>
<blockquote>
<p>官方是这样说的：<code>Parse CSS and add vendor prefixes to CSS rules using values from the Can I Use website</code><br>，也就是说它是一个自动检测兼容性给各个浏览器加个内核前缀的插件。  </p>
</blockquote>
<p>举个栗子：最新的弹性盒模型flux<br>实际代码：<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:fullscreen</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>插件自动补充后<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-flex;</span><br><span class="line">    <span class="attribute">display</span>: -ms-flexbox;</span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>效果显而易见，我们可以更专注于css布局和美化，而不需要花过多的精力都写相同的外码而加上不同的前缀，也减少了冗余代码。</p>
<p>使用方法:</p>
<p><code>cnpm install --save-dev autoprefixer postcss-loader</code></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">  <span class="comment">//其他配置这里就不写了</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">module</span>:&#123;</span><br><span class="line">    loaders:[</span><br><span class="line">    &#123;</span><br><span class="line">      test:<span class="regexp">/\.css$/</span>,</span><br><span class="line">      <span class="comment">//在原有基础上加上一个postcss的loader就可以了</span></span><br><span class="line">      loaders:[<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'postcss-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      ]</span><br><span class="line">  &#125;,</span><br><span class="line">  postcss:[autoprefixer(&#123;browsers:[<span class="string">'last 2 versions'</span>]&#125;)]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-自动生成html插件"><a href="#2-自动生成html插件" class="headerlink" title="2. 自动生成html插件"></a>2. 自动生成html插件</h4><p>html-webpack-plugin</p>
<p><code>cnpm install html-webpack-plugin --save-dev</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">var</span> HtmlWebpackPlugin = require(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">module</span>.<span class="keyword">exports</span>=&#123;</span><br><span class="line">  entry:<span class="string">'./index.js'</span>,</span><br><span class="line">  output:&#123;</span><br><span class="line">    path:__dirname+<span class="string">'/dist'</span>,</span><br><span class="line">    filename:<span class="string">'bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">  plugins:[</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>作用:它会在dist目录下自动生成一个index.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpack App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其他配置参数:</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attribute">entry</span>: <span class="string">'index.js'</span>,</span><br><span class="line">  <span class="attribute">output</span>: &#123;</span><br><span class="line">    <span class="attribute">path</span>: <span class="string">'dist'</span>,</span><br><span class="line">    <span class="attribute">filename</span>: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attribute">plugins</span>: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      <span class="attribute">title</span>: <span class="string">'My App'</span>,</span><br><span class="line">      <span class="attribute">filename</span>: <span class="string">'admin.html'</span>,</span><br><span class="line">      <span class="attribute">template</span>:<span class="string">'header.html'</span>,</span><br><span class="line">      <span class="attribute">inject</span>: <span class="string">'body'</span>,</span><br><span class="line">      <span class="attribute">favicon</span>:<span class="string">'./images/favico.ico'</span>,</span><br><span class="line">      <span class="attribute">minify</span>:true,</span><br><span class="line">      <span class="attribute">hash</span>:true,</span><br><span class="line">      <span class="attribute">cache</span>:false,</span><br><span class="line">      <span class="attribute">showErrors</span>:false,</span><br><span class="line">      <span class="string">"chunks"</span>: &#123;</span><br><span class="line">      <span class="string">"head"</span>: &#123;</span><br><span class="line">        <span class="string">"entry"</span>: <span class="string">"assets/head_bundle.js"</span>,</span><br><span class="line">        <span class="string">"css"</span>: [ <span class="string">"main.css"</span> ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attribute">xhtml</span>:false</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">--- header.html ---</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">htmlWebpackPlugin.options.title</span> %&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>作用：   </p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">title:</span> 设置title的名字   </span><br><span class="line"><span class="string">filename:</span> 设置这个html的文件名   </span><br><span class="line"><span class="string">template:</span>要使用的模块的路径  </span><br><span class="line"><span class="string">inject:</span> 把模板注入到哪个标签后 <span class="string">'body'</span>,   </span><br><span class="line"><span class="string">favicon:</span> 给html添加一个favicon  <span class="string">'./images/favico.ico'</span>,   </span><br><span class="line"><span class="string">minify:</span>是否压缩  <span class="literal">true</span> <span class="literal">false</span>   </span><br><span class="line"><span class="string">hash:</span>是否hash化 <span class="literal">true</span> <span class="literal">false</span> ,     </span><br><span class="line"><span class="string">cache:</span>是否缓存,   </span><br><span class="line"><span class="string">showErrors:</span>是否显示错误,  </span><br><span class="line"><span class="string">chunks:</span>目前没太明白  </span><br><span class="line"><span class="string">xhtml:</span>是否自动毕业标签 默认<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h4 id="3-提取样式插件"><a href="#3-提取样式插件" class="headerlink" title="3. 提取样式插件"></a>3. 提取样式插件</h4><p>extract-text-webpack-plugin  </p>
<blockquote>
<p>官网是这么解释的<code>Extract text from bundle into a file.</code>,把额外的数据加到编译好的文件中</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="keyword">module</span>: &#123;</span><br><span class="line">        loaders: [</span><br><span class="line">            &#123; test: <span class="regexp">/\.css$/</span>, loader: ExtractTextPlugin.extract(<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>) &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">                template: <span class="string">'./src/public/index.html'</span>,</span><br><span class="line">                inject: <span class="string">'body'</span></span><br><span class="line">            &#125;),</span><br><span class="line">        <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"[name].[hash].css"</span>)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明：将css放到index.html的body上面</p>
<h4 id="4-拷贝资源插件"><a href="#4-拷贝资源插件" class="headerlink" title="4. 拷贝资源插件"></a>4. 拷贝资源插件</h4><p> copy-webpack-plugin   </p>
<blockquote>
<p>官方这样解释 <code>Copy files and directories in webpack</code>,在webpack中拷贝文件和文件夹</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">cnpm <span class="keyword">install</span> <span class="comment">--save-dev copy-webpack-plugin</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> CopyWebpackPlugin([&#123;</span><br><span class="line">    <span class="keyword">from</span>: __dirname + <span class="string">'/src/public'</span></span><br><span class="line">&#125;]),</span><br></pre></td></tr></table></figure>
<blockquote>
<p>作用：把public 里面的内容全部拷贝到编译目录</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">作用</th>
<th style="text-align:center">其他说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">from</td>
<td style="text-align:center">定义要拷贝的源目录</td>
<td style="text-align:center">from: __dirname + ‘/src/public’</td>
</tr>
<tr>
<td style="text-align:center">to</td>
<td style="text-align:center">定义要烤盘膛的目标目录</td>
<td style="text-align:center">from: __dirname + ‘/dist’</td>
</tr>
<tr>
<td style="text-align:center">toType</td>
<td style="text-align:center"><code>file</code> 或者 <code>dir</code></td>
<td style="text-align:center">可选，默认是文件</td>
</tr>
<tr>
<td style="text-align:center">force</td>
<td style="text-align:center">强制覆盖先前的插件</td>
<td style="text-align:center">可选 默认false</td>
</tr>
<tr>
<td style="text-align:center">context</td>
<td style="text-align:center">不知道作用</td>
<td style="text-align:center">可选 默认 base context 可用  specific context</td>
</tr>
<tr>
<td style="text-align:center">flatten</td>
<td style="text-align:center">只拷贝文件不管文件夹</td>
<td style="text-align:center">默认是false</td>
</tr>
<tr>
<td style="text-align:center">ignore</td>
<td style="text-align:center">忽略拷贝指定的文件</td>
<td style="text-align:center">可以用模糊匹配</td>
</tr>
</tbody>
</table>
<h4 id="5-全局挂载插件"><a href="#5-全局挂载插件" class="headerlink" title="5. 全局挂载插件"></a>5. 全局挂载插件</h4><p>webpack.ProvidePlugin [webpack内置插件 ]    </p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">    $: <span class="string">"jquery"</span>,</span><br><span class="line">    jQuery: <span class="string">"jquery"</span>,</span><br><span class="line">    <span class="string">"window.jQuery"</span>: <span class="string">"jquery"</span></span><br><span class="line">&#125;))</span><br><span class="line"><span class="built_in">new</span> webpack.NoErrorsPlugin(),</span><br><span class="line"><span class="built_in">new</span> webpack.<span class="built_in">optimize</span>.DedupePlugin(),</span><br><span class="line"><span class="built_in">new</span> webpack.<span class="built_in">optimize</span>.UglifyJsPlugin(),</span><br><span class="line"><span class="built_in">new</span> webpack.<span class="built_in">optimize</span>.CommonsChunkPlugin('common.js')</span><br></pre></td></tr></table></figure>
<p>作用: 和上面5个一一对应  </p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">把一些需要的东西绑定到<span class="built_in">window</span>上，暴露出来 成为全局变量</span><br><span class="line">不显示错误插件</span><br><span class="line">具体不是太清楚，先记录着</span><br><span class="line">丑化js 混淆代码而用</span><br><span class="line">提取公共代码的插件</span><br></pre></td></tr></table></figure>
<h3 id="二、一个完整的栗子"><a href="#二、一个完整的栗子" class="headerlink" title="二、一个完整的栗子"></a>二、一个完整的栗子</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Modules</span></span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Env</span></span><br><span class="line"><span class="comment"> * Get npm lifecycle event to identify the environment</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> ENV = process.env.npm_lifecycle_event;</span><br><span class="line"><span class="keyword">var</span> isTest = ENV === <span class="string">'test'</span> || ENV === <span class="string">'test-watch'</span>;</span><br><span class="line"><span class="keyword">var</span> isProd = ENV === <span class="string">'build'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">makeWebpackConfig</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> config = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    config.entry = isTest ? &#123;&#125; : &#123;</span><br><span class="line">        app: <span class="string">'./src/app/app.js'</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    config.output = isTest ? &#123;&#125; : &#123;</span><br><span class="line">        <span class="comment">// Absolute output directory</span></span><br><span class="line">        path: __dirname + <span class="string">'/dist'</span>,</span><br><span class="line"></span><br><span class="line">        publicPath: isProd ? <span class="string">'/'</span> : <span class="string">'http://localhost:8080/'</span>,</span><br><span class="line"></span><br><span class="line">        filename: isProd ? <span class="string">'[name].[hash].js'</span> : <span class="string">'[name].bundle.js'</span>,</span><br><span class="line"></span><br><span class="line">        chunkFilename: isProd ? <span class="string">'[name].[hash].js'</span> : <span class="string">'[name].bundle.js'</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isTest) &#123;</span><br><span class="line">        config.devtool = <span class="string">'inline-source-map'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isProd) &#123;</span><br><span class="line">        config.devtool = <span class="string">'source-map'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        config.devtool = <span class="string">'eval-source-map'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    config.module = &#123;</span><br><span class="line">        preLoaders: [],</span><br><span class="line">        loaders: [&#123;</span><br><span class="line">            test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            loader: <span class="string">'babel'</span>,</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.css/</span>,</span><br><span class="line">            loader: isTest ? <span class="string">'null'</span> : ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css?sourceMap!postcss'</span>)</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpg|jpeg|gif|svg|woff|woff2|ttf|eot)$/</span>,</span><br><span class="line">            loader: <span class="string">'file'</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.json$/</span>,</span><br><span class="line">            loader: <span class="string">'json'</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.scss/</span>,</span><br><span class="line">            loader: <span class="string">'style!css!sass'</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.html$/</span>,</span><br><span class="line">            loader: <span class="string">'raw'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (isTest) &#123;</span><br><span class="line">        config.module.preLoaders.push(&#123;</span><br><span class="line">            test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            exclude: [</span><br><span class="line">                /node_modules/,</span><br><span class="line">                /\.spec\.js$/</span><br><span class="line">            ],</span><br><span class="line">            loader: <span class="string">'isparta-instrumenter'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    config.postcss = [</span><br><span class="line">        autoprefixer(&#123;</span><br><span class="line">            browsers: [<span class="string">'last 2 version'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    config.plugins = [];</span><br><span class="line">    <span class="keyword">if</span> (!isTest) &#123;</span><br><span class="line">        config.plugins.push(</span><br><span class="line">            <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">                template: <span class="string">'./src/public/index.html'</span>,</span><br><span class="line">                inject: <span class="string">'body'</span></span><br><span class="line">            &#125;),</span><br><span class="line"></span><br><span class="line">            <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].[hash].css'</span>, &#123;<span class="attr">disable</span>: !isProd&#125;)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isProd) &#123;</span><br><span class="line">        config.plugins.push(</span><br><span class="line">            <span class="keyword">new</span> webpack.NoErrorsPlugin(),</span><br><span class="line"></span><br><span class="line">            <span class="keyword">new</span> webpack.optimize.DedupePlugin(),</span><br><span class="line"></span><br><span class="line">            <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(),</span><br><span class="line"></span><br><span class="line">            <span class="keyword">new</span> CopyWebpackPlugin([&#123;</span><br><span class="line">                <span class="keyword">from</span>: __dirname + <span class="string">'/src/public'</span></span><br><span class="line">            &#125;]),</span><br><span class="line">            <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">                $: <span class="string">"jquery"</span>,</span><br><span class="line">                jQuery: <span class="string">"jquery"</span>,</span><br><span class="line">                <span class="string">"window.jQuery"</span>: <span class="string">"jquery"</span></span><br><span class="line">            &#125;))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    config.devServer = &#123;</span><br><span class="line">        contentBase: <span class="string">'./src/public'</span>,</span><br><span class="line">        stats: <span class="string">'minimal'</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<h3 id="三、调试技巧"><a href="#三、调试技巧" class="headerlink" title="三、调试技巧"></a>三、调试技巧</h3><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isTest) &#123;</span><br><span class="line">    <span class="built_in">config</span>.devtool = <span class="string">'inline-source-map'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (isProd) &#123;</span><br><span class="line">    <span class="built_in">config</span>.devtool = <span class="string">'source-map'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">config</span>.devtool = <span class="string">'eval-source-map'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>作用: 使用source-map可以在debug的时候看到源代码，方便 查错</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> webpack </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> webpack </tag>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack进阶之loader篇]]></title>
      <url>https://blog.xiaomo.info/2016/WebpackLLink/</url>
      <content type="html"><![CDATA[<p>webpack的loaders是一大特色，也是很重要的一部分。这遍博客我将分类讲解一些常用的laoder<br><a id="more"></a></p>
<h3 id="一、loaders之-预处理"><a href="#一、loaders之-预处理" class="headerlink" title="一、loaders之 预处理"></a>一、loaders之 预处理</h3><ul>
<li>css-loader 处理css中路径引用等问题</li>
<li>style-loader 动态把样式写入css</li>
<li>sass-loader scss编译器</li>
<li>less-loader less编译器</li>
<li>postcss-loader scss再处理</li>
</ul>
<p><code>npm install --save -dev css-loader style-loader sass-loader less-loader postcss-loader</code>  </p>
<p>栗子:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">module</span>: &#123;</span><br><span class="line">  <span class="attribute">loaders</span>: [</span><br><span class="line">    &#123;test: /\.css$/, loader: <span class="string">"style!css?sourceMap!postcss"</span>&#125;,</span><br><span class="line">    &#123;<span class="attribute">test</span>: /\.less$/, loader: <span class="string">"style!css!less|postcss"</span>&#125;,</span><br><span class="line">    &#123;<span class="attribute">test</span>: /\.scss$/, loader: <span class="string">"style!css!sass|postcss"</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、loaders之-js处理"><a href="#二、loaders之-js处理" class="headerlink" title="二、loaders之 js处理"></a>二、loaders之 js处理</h3><ul>
<li>babel-loader</li>
<li>jsx-loader</li>
</ul>
<p><code>npm install --save-dev babel-core babel-preset-es2015  babel-loader jsx-loader</code></p>
<p>栗子  </p>
<p>新建一个名字为<code>.babelrc</code>的文件</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [<span class="string">"es2015"</span>,<span class="string">"react"</span>],</span><br><span class="line">  <span class="attr">"plugins"</span>:[<span class="string">"antd"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新建一个名字为<code>webpack.config.js</code>文件</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">module.exports =&#123;</span><br><span class="line"><span class="symbol"> entry:</span> <span class="string">'./entry.js'</span>,</span><br><span class="line"><span class="symbol"> output:</span> &#123; <span class="string">path:</span> __dirname,</span><br><span class="line"><span class="symbol"> filename:</span> <span class="string">'bundle.js'</span></span><br><span class="line"> &#125;,</span><br><span class="line"><span class="symbol"> module:</span> &#123;</span><br><span class="line"><span class="string">loaders:</span> [</span><br><span class="line">  &#123;<span class="string">test:</span> <span class="regexp">/\.js$/</span>, <span class="string">loader:</span> <span class="string">"babel"</span>, <span class="string">exclude:</span> <span class="regexp">/node_modules/</span>&#125;,</span><br><span class="line">  &#123;<span class="string">test:</span> <span class="regexp">/\.jsx$/</span>, <span class="string">loader:</span> <span class="string">"jsx-loader"</span>&#125;</span><br><span class="line">  &#123;<span class="string">test:</span> <span class="regexp">/.css$/</span>, <span class="string">loader:</span> <span class="string">'style!css'</span>&#125; ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="三、loaders之-图片处理"><a href="#三、loaders之-图片处理" class="headerlink" title="三、loaders之 图片处理"></a>三、loaders之 图片处理</h3><ul>
<li>url-loader</li>
</ul>
<p><code>npm install --save-dev url-loadr</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">module</span>: &#123;</span><br><span class="line">  <span class="attribute">loaders</span>: [</span><br><span class="line">    &#123;test: /\.(jpg|png)$/, loader: <span class="string">"url?limit=8192"</span>&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="四、loaders之-文件处理"><a href="#四、loaders之-文件处理" class="headerlink" title="四、loaders之 文件处理"></a>四、loaders之 文件处理</h3><ul>
<li>file-loader</li>
</ul>
<p><code>npm install --save-dev file-loader</code></p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">  loaders: [</span><br><span class="line">    &#123;</span><br><span class="line">      test: /\.(png|<span class="type">jpg</span>|<span class="type">jpeg</span>|<span class="type">gif</span>|<span class="type">svg</span>|<span class="type">woff</span>|<span class="type">woff2</span>|<span class="type">ttf</span>|<span class="type">eot</span>)$/,</span><br><span class="line">      loader: 'file'</span><br><span class="line">      &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五、loaders之-json处理"><a href="#五、loaders之-json处理" class="headerlink" title="五、loaders之 json处理"></a>五、loaders之 json处理</h3><ul>
<li>json-loader</li>
</ul>
<p><code>npm install --save-dev json-loader</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">module</span>: &#123;</span><br><span class="line">  <span class="attribute">loaders</span>: [</span><br><span class="line">    &#123;test: /\.json$/,loader: <span class="string">'json'</span>&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="六、loaders之-html处理"><a href="#六、loaders之-html处理" class="headerlink" title="六、loaders之 html处理"></a>六、loaders之 html处理</h3><ul>
<li>raw-loader</li>
</ul>
<p><code>npm install --save-dev raw-loader</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">module</span>: &#123;</span><br><span class="line">  <span class="attribute">loaders</span>: [</span><br><span class="line">    &#123; test: /\.html$/,loader: <span class="string">'raw'</span>&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> webpack </tag>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack相关命令参数]]></title>
      <url>https://blog.xiaomo.info/2016/WebpackParams/</url>
      <content type="html"><![CDATA[<p>使用webpack的同学，你真的熟练应用webpack么？其实直接<code>webpack --help</code>就可以看到，但是有很多人还是在网上到处搜相关参数<br><a id="more"></a></p>
<h3 id="一、webpack相关参数"><a href="#一、webpack相关参数" class="headerlink" title="一、webpack相关参数"></a>一、webpack相关参数</h3><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">webpack <span class="params">--config</span> webpack.config.dev.js   <span class="string">//</span>使用另一份配置文件（比如webpack.config2.js）来打包</span><br><span class="line">webpack <span class="params">--watch</span>   <span class="string">//</span>监听变动并自动打包</span><br><span class="line">webpack <span class="string">//</span>执行一次开发时的编译</span><br><span class="line">webpack -p <span class="string">//</span>执行一次生成环境的编译（压缩）</span><br><span class="line">webpack <span class="params">--watch</span> <span class="string">//</span>在开发时持续监控增量编译（很快）</span><br><span class="line">webpack -d <span class="string">//</span>让他生成SourceMaps</span><br><span class="line">webpack <span class="params">--progress</span> <span class="string">//</span>显示编译进度</span><br><span class="line">webpack <span class="params">--colors</span> <span class="string">//</span>显示静态资源的颜色</span><br><span class="line">webpack <span class="params">--sort-modules-by</span>, <span class="params">--sort-chunks-by</span>, <span class="params">--sort-assets-by</span> <span class="string">//</span>将modules/chunks/assets进行列表排序</span><br><span class="line">webpack <span class="params">--display-chunks</span> <span class="string">//</span>展示编译后的分块</span><br><span class="line">webpack <span class="params">--display-reasons</span> <span class="string">//</span>显示更多引用模块原因</span><br><span class="line">webapck <span class="params">--display-error-details</span> <span class="string">//</span>显示更多报错信息</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[用 Excel 生成和管理 Markdown 表格]]></title>
      <url>https://blog.xiaomo.info/2016/ExcelMarkdownTable/</url>
      <content type="html"><![CDATA[<p></p><h2 id="intro">前言</h2>Markdown 作为一种轻量级的标记语言，用来进行简单的文本排版，确实方便快捷。但 Markdown 标记语言的属性，也使得其在表格处理上略显繁琐且不直观。而 Excel 几乎就是表格的代名词，借助 Excel，可以改善我们在 Markdown 中使用表格的体验。下文将简单介绍怎么使用 Excel 生成和管理可用于 Markdown 文章的表格。<p></p>
<a id="more"></a>
<h3 id="填写表格"><a href="#填写表格" class="headerlink" title="填写表格"></a>填写表格</h3><p>在 Excel 中正常填写你的表格内容，之后在标题行下插入一行，要居中的填入 <strong><code>:-:</code></strong>，要右对齐的填<strong><code>-:</code></strong>，其它全部填上<strong><code>-</code></strong>。</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>左对齐</th>
<th style="text-align:center">居中对齐</th>
<th style="text-align:right">右对齐</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>:-:</strong></td>
<td><strong>-</strong></td>
<td style="text-align:center"><strong>:-:</strong></td>
<td style="text-align:right"><strong>-</strong>:</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
</tbody>
</table>
<ul>
<li>如图左上角，表头也不要留空，填上<code>-</code>提高兼容性。</li>
</ul>
<h3 id="生成表格"><a href="#生成表格" class="headerlink" title="生成表格"></a>生成表格</h3><p>选中表格，复制，然后粘贴到 Markdown 编辑器中</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-	</span>左对齐	居中对齐	右对齐</span><br><span class="line"><span class="meta">:-:</span>	:-	:-:	-:</span><br><span class="line">1	Left	Center	Right</span><br><span class="line">2	Left	Center	Right</span><br><span class="line">3	Left	Center	Right</span><br></pre></td></tr></table></figure>
<p>复制出来的 Excel 默认以<code>tab</code>作为单元格分隔符，而 Markdown 则以<code>|</code>为分隔符。顺理成章，当我们使用 <code>|</code> 对原<code>tab</code>分隔符进行替换后，即可生成 Markdown 化的表格。</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">-|<span class="string">默认左对齐</span>|<span class="string">居中对齐</span>|<span class="string">内容右对齐</span></span><br><span class="line"><span class="string">:-:</span>|<span class="string">-</span>|<span class="string">:-:</span>|<span class="string">-:</span></span><br><span class="line"><span class="string">1</span>|<span class="string">Left</span>|<span class="string">Center</span>|Right</span><br><span class="line">2|<span class="string">Left</span>|<span class="string">Center</span>|Right</span><br><span class="line">3|<span class="string">Left</span>|<span class="string">Center</span>|Right</span><br></pre></td></tr></table></figure>
<p>表格效果大致如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th>左对齐</th>
<th style="text-align:center">居中对齐</th>
<th style="text-align:right">右对齐</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td>Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
</tbody>
</table>
<h3 id="处理表格"><a href="#处理表格" class="headerlink" title="处理表格"></a>处理表格</h3><p>在 Excel 中，处理表格灵活方便，调整好后再按上面方法重新生成表格即可。</p>
<ul>
<li>可以对表格进行快速拖拽排序；</li>
<li>可以用公式 <code>=row()</code> 给表格添加自动序号；</li>
<li>当然我们也可以使用 Markdown 语法为单元格内容设置格式，添加超链接等；</li>
</ul>
<h3 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a>其他说明</h3><ul>
<li>Markdown 默认语法不支持单元格合并，更复杂的表格不适合用在 Markdown 中；</li>
<li>这种写法的表格，目前已知在 GitHub 上不能正确解析；</li>
<li><a href="/2015/09/20/windows-mac-software/">自用 Windows 和 Mac 软件推荐</a>，这些表格处理经验基本是为了写左边这篇文章而积累的，大家可以看看效果。</li>
<li>顺便推荐一个在线表格生成网站，<a href="http://www.tablesgenerator.com/markdown_tables" target="_blank" rel="noopener">Tables Generator.com</a>，在上面也可以快速生成通用的 Markdown 表格。使用网站的不便之处就是需要联网，而且这个网站还在[墙外]。</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[nodejs的process模块]]></title>
      <url>https://blog.xiaomo.info/2016/NodeProcess/</url>
      <content type="html"><![CDATA[<p>我们在使用webpack的时候经常会有两套配置，一套生产环境和一套测试环境。因此我们会用到一些系统变量，我们就需要用到process。process模块用来与当前进程互动，可以通过全局变量process访问，不必使用require命令加载。它是一个EventEmitter对象的实例。<br><a id="more"></a></p>
<h3 id="一、process属性。"><a href="#一、process属性。" class="headerlink" title="一、process属性。"></a>一、process属性。</h3><ul>
<li>process.pid：当前进程的进程号。</li>
<li>process.version：Node的版本，比如v0.10.18。</li>
<li>process.platform：当前系统平台，比如Linux。</li>
<li>process.title：默认值为“node”，可以自定义该值。</li>
<li>process.argv：当前进程的命令行参数数组。</li>
<li>process.env：指向当前shell的环境变量，比如process.env.HOME。</li>
<li>process.execPath：运行当前进程的可执行文件的绝对路径。</li>
<li>process.stdout：指向标准输出。</li>
<li>process.stdin：指向标准输入。</li>
<li>process.stderr：指向标准错误。</li>
</ul>
<p>下面是主要属性的介绍。</p>
<h4 id="1-stdout"><a href="#1-stdout" class="headerlink" title="1. stdout"></a>1. stdout</h4><p>process.stdout用来控制标准输出，也就是在命令行窗口向用户显示内容。它的write方法等同于console.log。</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">exports.<span class="built_in">log</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    process.<span class="built_in">stdout</span>.<span class="built_in">write</span>(<span class="built_in">format</span>.apply(this, arguments) + <span class="string">'\n'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="2-argv"><a href="#2-argv" class="headerlink" title="2. argv"></a>2. argv</h4><p>process.argv返回命令行脚本的各个参数组成的数组。</p>
<p>先新建一个脚本文件argv.js。</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">// argv.js</span></span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">"argv: "</span>,<span class="built_in">process</span>.argv);</span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">"argc: "</span>,<span class="built_in">process</span>.argc);</span><br></pre></td></tr></table></figure>
<p>在命令行下调用这个脚本，会得到以下结果。<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">node</span> <span class="selector-tag">argv</span><span class="selector-class">.js</span> <span class="selector-tag">a</span> <span class="selector-tag">b</span> <span class="selector-tag">c</span></span><br><span class="line"># <span class="selector-attr">[ <span class="string">'node'</span>, <span class="string">'/path/to/argv.js'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span> ]</span></span><br></pre></td></tr></table></figure></p>
<p>上面代码表示，argv返回数组的成员依次是命令行的各个部分。要得到真正的参数部分，可以把argv.js改写成下面这样。</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">// argv.js</span></span><br><span class="line">var myArgs = <span class="built_in">process</span>.argv.slice(<span class="number">2</span>);</span><br><span class="line">console.<span class="built_in">log</span>(myArgs);</span><br></pre></td></tr></table></figure>
<h4 id="3-方法"><a href="#3-方法" class="headerlink" title="3.方法"></a>3.方法</h4><ul>
<li>process对象提供以下方法：</li>
<li>process.cwd()：返回运行当前脚本的工作目录的路径。_</li>
<li>process.chdir()：改变工作目录。</li>
<li>process.exit()：退出当前进程。</li>
<li>process.nextTick()：将一个回调函数放在下次事件循环的顶部。</li>
</ul>
<p>process.chdir()改变工作目录的例子。  </p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="built_in">process</span>.cwd()</span><br><span class="line"><span class="comment"># '/home/aaa'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">process</span>.chdir(<span class="string">'/home/bbb'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">process</span>.cwd()</span><br><span class="line"><span class="comment"># '/home/bbb'</span></span><br></pre></td></tr></table></figure>
<p>process.nextTick()的例子，指定下次事件循环首先运行的任务。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Next event loop!'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上面代码可以用setTimeout改写，但是nextTick的效果更高、描述更准确。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'Next event loop!'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h4 id="4-事件"><a href="#4-事件" class="headerlink" title="4. 事件"></a>4. 事件</h4><p>（1）exit事件<br>当前进程退出时，会触发exit事件，可以对该事件指定回调函数。这一个用来定时检查模块的状态的好钩子(hook)(例如单元测试),当主事件循环在执行完’exit’的回调函数后将不再执行,所以在exit事件中定义的定时器可能不会被加入事件列表.</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">process.on(<span class="string">'exit'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  fs.writeFileSync(<span class="string">'/tmp/myfile'</span>, <span class="string">'This MUST be saved on exit.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>（2）uncaughtException事件<br>当前进程抛出一个没有被捕捉的意外时，会触发uncaughtException事件。  </p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">process.<span class="keyword">on</span>('uncaughtException', function (<span class="keyword">err</span>) &#123;</span><br><span class="line">  console.<span class="keyword">error</span>('<span class="keyword">An</span> uncaught <span class="keyword">error</span> occurred!');</span><br><span class="line">  console.<span class="keyword">error</span>(<span class="keyword">err</span>.<span class="keyword">stack</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>摘自阮老师博客   <a href="http://javascript.ruanyifeng.com/nodejs/basic.html#toc22" target="_blank" rel="noopener">Node.js 概述</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> node </tag>
            
            <tag> es6 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack使用之基础篇]]></title>
      <url>https://blog.xiaomo.info/2016/WebpackBasicUse/</url>
      <content type="html"><![CDATA[<p>说到自动化构建，你想到了什么？基于AMD的requirejs？还是基于commoJS的browserify？他们都在各自的领域或者说时代发挥了很重要的作用。但是时代的变迁，webpack成了现在的佼佼者，我们不知道什么时候wepback也会被取代，但是现在我们必须要掌握。我不担心我学完webpack新东西来了就没用了，相反的我很期待也很高兴有新的东西来取代webpack，因为如果能取代，必然是更好的东西。如果是更好的，那又为什么要拒绝呢？活在当下，认真学习。</p>
<a id="more"></a>
<h3 id="一、基本简介"><a href="#一、基本简介" class="headerlink" title="一、基本简介"></a>一、基本简介</h3><p>webpack和requirejs browserify一样，都是一款打包工具，那为什么要选这个？我们进行一个对比</p>
<h4 id="1-requirejs"><a href="#1-requirejs" class="headerlink" title="1. requirejs"></a>1. requirejs</h4><p>很老的产物了，它兴起的时候web模块化的标准都还没有完善。那个时候出了一款基于AMD的打包工具，<br>不得不说对前端的发展起到了至关重要的作用，如果它可以功成身退了。</p>
<h4 id="2-browserify"><a href="#2-browserify" class="headerlink" title="2. browserify"></a>2. browserify</h4><p>是一个和webpack差不多同时代的产物，但是它只支持基于commonJS，对于AMD来说只能兴叹了。<br>并且它只支持打包js,如果你对这两个缺点不那么在意，那么就是它了。</p>
<h4 id="3-webpack"><a href="#3-webpack" class="headerlink" title="3. webpack"></a>3. webpack</h4><p>支持AMD和commonJS,以模块化为起点,我们不仅可以用它打包js，也可以打包css，<br>包括图片。webpack把任何一个文件都看成一个模块，因此你准备好要迎接模块化的挑战了吗？</p>
<h3 id="二、环境搭建"><a href="#二、环境搭建" class="headerlink" title="二、环境搭建"></a>二、环境搭建</h3><h4 id="1-IDE推荐"><a href="#1-IDE推荐" class="headerlink" title="1. IDE推荐"></a>1. IDE推荐</h4><p> <code>IDEA</code>、<code>webstrom</code>、<code>sublime</code>、<code>atom</code>  都是很不错的编辑工具，<code>idea</code>大而全，<code>webstrom</code>是<code>idea</code>的简化版、<code>sublime</code>轻量但不失稳重、<code>atom</code>新兴但不失典雅，东西不分上下，重在自己喜欢。找一个自己顺手的就好，顺便一提，我现在主要使用<code>IDEA</code>、辅助<code>atom</code>。因为我是一个<code>java</code>党啊，少不了<code>IDEA</code>，<code>atom</code>的界面是我最喜欢的。</p>
<h4 id="2-开始建项目写配置"><a href="#2-开始建项目写配置" class="headerlink" title="2. 开始建项目写配置"></a>2. 开始建项目写配置</h4><p> a.新建项目 <code>mkdir webpack-study &amp;&amp; cd webpack-study</code><br> b.初始化环境 <code>npm init -y</code><br> c.安装工具(如果你没安装taobao源，把cnpm换成npm)  <code>npm install --save-dev webpack webpack-dev-server</code><br>说明:webpack是核心文件、wepback-dev-server是类http-server的web启动工具，建议安装一下这个server<br>d.新建配置文件  (名字一定不能换) <code>touch webpack.config.js</code><br>e. 配置webpack</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">module.exprots=&#123;</span><br><span class="line">  entry:<span class="string">'./index.js'</span>,</span><br><span class="line">  <span class="built_in">output</span>:&#123;</span><br><span class="line">    <span class="built_in">path</span>:__dirname+<span class="string">'/dist'</span>,</span><br><span class="line">    filename:<span class="string">'bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明:<br>模块化<code>module.export</code><br>入口文件:<code>entry</code> 有几个页面就有几个entry 如果是单页面（spa)，一个entry就够了<br>输出 <code>output</code>,<code>path</code>是输出路径,<code>__dirname</code>是nodejs的全局变量，表示当前目录, <code>filename</code>，打包后的文件名</p>
<h3 id="三、-写一个小测试"><a href="#三、-写一个小测试" class="headerlink" title="三、 写一个小测试"></a>三、 写一个小测试</h3><h4 id="1-新建入口文件并写入文件"><a href="#1-新建入口文件并写入文件" class="headerlink" title="1. 新建入口文件并写入文件"></a>1. 新建入口文件并写入文件</h4><p><code>vim index.js</code><br><code>document.write(&#39;Hello world&#39;);</code>  </p>
<h4 id="2-新建一个css"><a href="#2-新建一个css" class="headerlink" title="2. 新建一个css"></a>2. 新建一个css</h4><p><code>touch style.css</code><br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>:pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-新建一个html"><a href="#3-新建一个html" class="headerlink" title="3.新建一个html"></a>3.新建一个html</h4><p><code>touch index.html</code><br>写下以下内容<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello webpack<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"dist/bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>说明:<br>模块化<code>module.export</code><br>入口文件:<code>entry</code> 有几个页面就有几个entry 如果是单页面（spa)，一个entry就够了<br>输出 <code>output</code>,<code>path</code>是输出路径,<code>__dirname</code>是nodejs的全局变量，表示当前目录, <code>filename</code>，打包后的文件名</p>
<h3 id="三、-写一个小测试-1"><a href="#三、-写一个小测试-1" class="headerlink" title="三、 写一个小测试"></a>三、 写一个小测试</h3><h4 id="1-新建入口文件并写入文件-1"><a href="#1-新建入口文件并写入文件-1" class="headerlink" title="1. 新建入口文件并写入文件"></a>1. 新建入口文件并写入文件</h4><p><code>vim index.js</code>  <code>document.write(&#39;Hello world&#39;);</code>  </p>
<h4 id="2-新建一个css-1"><a href="#2-新建一个css-1" class="headerlink" title="2. 新建一个css"></a>2. 新建一个css</h4><p><code>touch style.css</code>  </p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>:pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-新建一个html-1"><a href="#3-新建一个html-1" class="headerlink" title="3.新建一个html"></a>3.新建一个html</h4><p><code>touch index.html</code><br>写下以下内容<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello webpack<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"dist/bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="4-webpack的重头戏"><a href="#4-webpack的重头戏" class="headerlink" title="4.webpack的重头戏"></a>4.webpack的重头戏</h4><p>那就是loaders，wepback的一大特色就是可以将一些浏览器不能原生支持的文件通过loaders编译成浏览器可以支持的文件<br>a.安装loaders<br><code>npm install style-loader css-loader</code><br>b.打开<code>webpack.config.js</code><br>添加模块<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">module</span>:&#123;</span><br><span class="line">  <span class="attribute">loaders</span>:[</span><br><span class="line">  &#123;</span><br><span class="line">    test:/\.css$/,</span><br><span class="line">    loaders:[<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>说明：<br>模块下定义大的loaders去loader需要的东西，它是一个数组，意味着它可以定义多个<br>一个对象就是一个loader，<code>test</code>用正则匹配文件后缀<br>loaders指定采用哪个loader,注意它是从右往左执行，所以这里先执行css-loader<br><code>css-loader</code>处理css的一些url，包括相对的绝对的之类的东西<br><code>style-loader</code> 是将css文件采用js动态写入html页面<br>c.使用css<br>打开<code>index.js</code>  (因为我们这里没有用babel,所以就用es5来写)<br><code>require(&#39;./style.css&#39;);</code></p>
<h3 id="四、查看效果"><a href="#四、查看效果" class="headerlink" title="四、查看效果"></a>四、查看效果</h3><p>我们现在可以使用<code>webpack-dev-server</code>这个东西了<br>如果你己经全局安装了(<code>cnpm install -g webpack-dev-server</code>),直接命令<code>webpack-dev-server</code>就可以开起来了，当然你也可以在package.json文件里面添加script，文件如下</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"name"</span>: <span class="string">"webpack-study"</span>,</span><br><span class="line"><span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line"><span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line"><span class="attr">"scripts"</span>: &#123;</span><br><span class="line"><span class="attr">"start"</span>:<span class="string">"webpack-dev-server --progcess"</span>,</span><br><span class="line"><span class="attr">"build"</span>:<span class="string">"webpack --progress"</span>,</span><br><span class="line"><span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">"keywords"</span>: [],</span><br><span class="line"><span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line"><span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line"><span class="attr">"css-loader"</span>: <span class="string">"^0.23.1"</span>,</span><br><span class="line"><span class="attr">"style-loader"</span>: <span class="string">"^0.13.1"</span>,</span><br><span class="line"><span class="attr">"webpack"</span>: <span class="string">"^1.13.0"</span>,</span><br><span class="line"><span class="attr">"webpack-dev-server"</span>: <span class="string">"^1.14.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我们就可以使用<code>npm run build</code>来编译，使用<code>npm run start</code>来开启服务器  </p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">➜</span>  <span class="string">webpack-study</span> <span class="string">git:(master)</span> <span class="string">✗</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line"><span class="string">&gt;</span> <span class="string">webpack-study@1.0.0</span> <span class="string">build</span> <span class="string">/Users/xiaomo/workspace/webpack-study</span></span><br><span class="line"><span class="string">&gt;</span> <span class="string">webpack</span> <span class="string">--progress</span></span><br><span class="line"><span class="attr">Hash:</span> <span class="string">11ffef2911f2436a3948</span></span><br><span class="line"><span class="attr">Version:</span> <span class="string">webpack</span> <span class="number">1.13</span><span class="number">.0</span></span><br><span class="line"><span class="attr">Time:</span> <span class="string">64ms</span></span><br><span class="line">    <span class="string">Asset</span>     <span class="string">Size</span>  <span class="string">Chunks</span>             <span class="string">Chunk</span> <span class="string">Names</span></span><br><span class="line"><span class="string">bundle.js</span>  <span class="number">1.42</span> <span class="string">kB</span>       <span class="number">0</span>  <span class="string">[emitted]</span>  <span class="string">main</span></span><br><span class="line">   <span class="string">[0]</span> <span class="string">./index.js</span> <span class="number">30</span> <span class="string">bytes</span> <span class="string">&#123;0&#125;</span> <span class="string">[built]</span></span><br><span class="line">   <span class="string">➜</span>  <span class="string">webpack-study</span> <span class="string">git:(master)</span> <span class="string">✗</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">start</span></span><br><span class="line"></span><br><span class="line">   <span class="string">&gt;</span> <span class="string">webpack-study@1.0.0</span> <span class="string">start</span> <span class="string">/Users/xiaomo/workspace/webpack-study</span></span><br><span class="line">   <span class="string">&gt;</span> <span class="string">webpack-dev-server</span> <span class="string">--progcess</span></span><br><span class="line"></span><br><span class="line">   <span class="string">http://localhost:8080/webpack-dev-server/</span></span><br><span class="line">   <span class="string">webpack</span> <span class="string">result</span> <span class="string">is</span> <span class="string">served</span> <span class="string">from</span> <span class="string">/</span></span><br><span class="line">   <span class="string">content</span> <span class="string">is</span> <span class="string">served</span> <span class="string">from</span> <span class="string">/Users/xiaomo/workspace/webpack-study</span></span><br><span class="line">   <span class="attr">Hash:</span> <span class="string">11ffef2911f2436a3948</span></span><br><span class="line">   <span class="attr">Version:</span> <span class="string">webpack</span> <span class="number">1.13</span><span class="number">.0</span></span><br><span class="line">   <span class="attr">Time:</span> <span class="string">80ms</span></span><br><span class="line">       <span class="string">Asset</span>     <span class="string">Size</span>  <span class="string">Chunks</span>             <span class="string">Chunk</span> <span class="string">Names</span></span><br><span class="line">   <span class="string">bundle.js</span>  <span class="number">1.42</span> <span class="string">kB</span>       <span class="number">0</span>  <span class="string">[emitted]</span>  <span class="string">main</span></span><br><span class="line">   <span class="string">chunk</span>    <span class="string">&#123;0&#125;</span> <span class="string">bundle.js</span> <span class="string">(main)</span> <span class="number">30</span> <span class="string">bytes</span> <span class="string">[rendered]</span></span><br><span class="line">       <span class="string">[0]</span> <span class="string">./index.js</span> <span class="number">30</span> <span class="string">bytes</span> <span class="string">&#123;0&#125;</span> <span class="string">[built]</span></span><br><span class="line">   <span class="attr">webpack:</span> <span class="string">bundle</span> <span class="string">is</span> <span class="string">now</span> <span class="string">VALID.</span></span><br></pre></td></tr></table></figure>
<p>b.然后访问 <a href="http://locahost:8080" target="_blank" rel="noopener">http://locahost:8080</a> 就可以看到效果了</p>
<h3 id="五、动态效果展示和总结"><a href="#五、动态效果展示和总结" class="headerlink" title="五、动态效果展示和总结"></a>五、动态效果展示和总结</h3><h4 id="1-总共有5个文件"><a href="#1-总共有5个文件" class="headerlink" title="1. 总共有5个文件"></a>1. 总共有5个文件</h4><p><code>webpack.config.ks</code>、<code>index.js</code>、<code>index.html</code>、<code>style.css</code>、<code>package.json</code>，编译好要使用的只有<code>index.html</code>和<code>dist/bundle.js</code>两个文件</p>
<h4 id="2-gif动画"><a href="#2-gif动画" class="headerlink" title="2. gif动画"></a>2. gif动画</h4><p>会展示一下5个文件的内容</p>
<h4 id="3-演示一下效果"><a href="#3-演示一下效果" class="headerlink" title="3. 演示一下效果"></a>3. 演示一下效果</h4><p><img src="https://image.xiaomo.info/banner/webpack.gif" alt="webpack的简单使用"><br>如果觉得图小可以点击下面链接查看大图<br><a href="https://image.xiaomo.info/webpack/webpack.gif" target="_blank" rel="noopener">webpack的简单使用</a></p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用nodejs搭建一个简易的即时聊天软件]]></title>
      <url>https://blog.xiaomo.info/2016/NodeOnlineChat/</url>
      <content type="html"><![CDATA[<p>最近在学习node，跟着书上的例子写的一个基于net模块的tcp服务器，感觉挺有意思在此分享一下。<br><a id="more"></a></p>
<h3 id="一、搭建简易的服务器"><a href="#一、搭建简易的服务器" class="headerlink" title="一、搭建简易的服务器"></a>一、搭建简易的服务器</h3><p><code>vim server.js</code><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入node的net模块</span></span><br><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="comment">//创建一个服务器</span></span><br><span class="line"><span class="keyword">var</span> chatServer = net.createServer();</span><br><span class="line"><span class="comment">//定义一个客户端列表</span></span><br><span class="line"><span class="keyword">var</span> clientList = [];</span><br><span class="line"><span class="comment">//监听连接...</span></span><br><span class="line">chatServer.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">client</span>) </span>&#123;</span><br><span class="line"><span class="comment">//给客户端反馈</span></span><br><span class="line">client.name = client.remoteAddress+<span class="string">':'</span>+client.remotePort;</span><br><span class="line">client.write(<span class="string">'Hi!'</span>+client.name+<span class="string">',您己成功连接服务器，可以正常通讯了..\n'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(client.name+<span class="string">'加入了聊天...'</span>)</span><br><span class="line"><span class="comment">//将客户端放到客户端列表中</span></span><br><span class="line">clientList.push(client);</span><br><span class="line"><span class="comment">//监听客户端信信息并给出反馈</span></span><br><span class="line">client.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line"><span class="comment">// 把数据发送给所有客户端</span></span><br><span class="line">      broadcast(data,client);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//监听离线事件</span></span><br><span class="line">client.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(client.name+<span class="string">'quit...'</span>)</span><br><span class="line">    clientList.splice(clientList.indexOf(client),<span class="number">1</span>);</span><br><span class="line">    client.write(<span class="string">'用户:'</span>+client.name+<span class="string">'退出了当前服务\n'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="comment">//监听错误事件</span></span><br><span class="line">client.on(<span class="string">'error'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  广播消息</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">broadcast</span>(<span class="params">message,client</span>)</span>&#123;</span><br><span class="line">     <span class="keyword">var</span> cleanUp=[];</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;clientList.length;i++) &#123;</span><br><span class="line">         <span class="keyword">if</span>(clientList[i]!==client[i])&#123;</span><br><span class="line">             <span class="keyword">if</span>(clientList[i].writable)&#123;</span><br><span class="line">             clientList[i].write(client.name+<span class="string">'说:'</span>+message);</span><br><span class="line">             &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                 cleanUp.push(clientList[i]);</span><br><span class="line">                 clientList[i].destroy();</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">//在写入循环中删除死节点，消除垃圾索引</span></span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>;i&lt;cleanUp.length;i++)&#123;</span><br><span class="line">         clientList.splice(clientList.indexOf(cleanUp[i],i));</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>开启服务器<br><code>node server.js</code><br><code>chatServer is running at port 9000...</code><br>此时服务己经成功开启</p>
<h3 id="二、客户端连接"><a href="#二、客户端连接" class="headerlink" title="二、客户端连接"></a>二、客户端连接</h3><p>格式： <code>telnet host port</code><br>例如我在本地再开启一个shell窗口<br> <code>telnet localhost 9000</code><br> Hi!127.0.0.1:43358,您己成功连接服务器，可以正常通讯了..</p>
<h3 id="三、测试效果"><a href="#三、测试效果" class="headerlink" title="三、测试效果"></a>三、测试效果</h3><h4 id="1-开启服务器"><a href="#1-开启服务器" class="headerlink" title="1. 开启服务器"></a>1. 开启服务器</h4><h4 id="2-客户端连接"><a href="#2-客户端连接" class="headerlink" title="2. 客户端连接"></a>2. 客户端连接</h4><h4 id="3-测试通讯"><a href="#3-测试通讯" class="headerlink" title="3. 测试通讯"></a>3. 测试通讯</h4><p>下面是gif效果图<br><img src="https://image.xiaomo.info/linux/tcpServer.gif" alt="tcp在线聊天服务器"></p>
]]></content>
      
        <categories>
            
            <category> nodejs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> linux </tag>
            
            <tag> node </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[linux下使用定时器跑任务]]></title>
      <url>https://blog.xiaomo.info/2016/LinuxCrontab/</url>
      <content type="html"><![CDATA[<p>我打算把github的代码用jenkins实时同步到线上，但是因为买的阿里云是个学习机内存太小容易跌机，因此打算使用linux的定时任务来做同步。<br><a id="more"></a></p>
<h3 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h3><ol>
<li>选好一个目录放shell脚本</li>
<li>写一个shell,注意最好是echo一句话，方便测试</li>
<li>确保你的机器上装了crontab服务且处于开启状态</li>
</ol>
<h3 id="二、正式开工"><a href="#二、正式开工" class="headerlink" title="二、正式开工"></a>二、正式开工</h3><h4 id="1-检查crontab服务"><a href="#1-检查crontab服务" class="headerlink" title="1. 检查crontab服务"></a>1. 检查crontab服务</h4><p>键入命令 <code>/sbin/service crond status</code><br>返回结果:  <code>crond (pid  6621) is running...</code>  如果是运行状态就是可以的    </p>
<h4 id="2-写shell的目录"><a href="#2-写shell的目录" class="headerlink" title="2. 写shell的目录"></a>2. 写shell的目录</h4><p>切换到目标目录 <code>cd /data2/xiaomo.info/java/bin</code></p>
<h4 id="3-开始写shell"><a href="#3-开始写shell" class="headerlink" title="3. 开始写shell"></a>3. 开始写shell</h4><p>创建文件：<code>$: touch gitpull.sh</code><br>打开文件：<code>$: vim gitpull.sh</code><br>粘入以下内容<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">cd</span> /data2/xiaomo.info/myBlog</span><br><span class="line">git pull</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'当前时间'</span>`date <span class="string">'+%Y-%m-%d %H:%M:%S'</span>`<span class="string">'执行git clone 命令'</span>;</span><br></pre></td></tr></table></figure></p>
<h4 id="4-写定时任务"><a href="#4-写定时任务" class="headerlink" title="4. 写定时任务"></a>4. 写定时任务</h4><p>查看定时任务 <code>$: crontab -l</code><br>创建定时任务 <code>$: crontab -e</code><br>粘入下面的内容<br><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"> <span class="comment">#每分钟 执行git clone 命令</span></span><br><span class="line">*<span class="regexp">/1 * * * * /</span>bin<span class="regexp">/sh /</span>data2<span class="regexp">/xiaomo.info/</span>java<span class="regexp">/bin/gi</span>tpull.sh &gt;&gt;<span class="regexp">/data2/</span>xiaomo.info<span class="regexp">/java/</span>bin<span class="regexp">/git.log &amp;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="三、验证设置的定时任务是否生效"><a href="#三、验证设置的定时任务是否生效" class="headerlink" title="三、验证设置的定时任务是否生效"></a>三、验证设置的定时任务是否生效</h3><p>说明：在定时任务中 使用 <code>&gt;&gt;</code> 可以将<code>echo</code>的内容转到日志中，因此 我们只需要查看日志中有没有输出对应的话就可以判断是否生效。   </p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">tail -f <span class="regexp">/data2/</span>xiaomo.info<span class="regexp">/java/</span>bin<span class="regexp">/git.log</span></span><br></pre></td></tr></table></figure>
<p>观察一下一分钟后是否有日志打出，有的话就代表执行成功！！</p>
<h3 id="四、参考文档"><a href="#四、参考文档" class="headerlink" title="四、参考文档"></a>四、参考文档</h3><blockquote>
<p><a href="http://www.cnblogs.com/joer/archive/2010/09/23/1841240.html" target="_blank" rel="noopener">定时任务参考文档</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[第三方组件ui-router的简单使用]]></title>
      <url>https://blog.xiaomo.info/2016/AngularUiRouter/</url>
      <content type="html"><![CDATA[<p>因为1.x的angularjs自带的ng-router功能比较弱，不支持路由嵌套。因些我们要使用到ui-router这个组件<br><a id="more"></a></p>
<h3 id="一、ui-router基本思路"><a href="#一、ui-router基本思路" class="headerlink" title="一、ui-router基本思路"></a>一、ui-router基本思路</h3><ol>
<li>多视图用@，嵌套用parent.child这种子路由</li>
<li>要切换的视图(main)用ui-view,始终不会变成其他内容的不需要路由  </li>
<li>要切换的路由ui-sref用子路由   </li>
</ol>
<ul>
<li>main.a</li>
<li>main.b</li>
<li>main.c</li>
<li>main.d</li>
<li>….</li>
</ul>
<h3 id="二、效果图"><a href="#二、效果图" class="headerlink" title="二、效果图"></a>二、效果图</h3><p><img src="https://image.xiaomo.info/angular/uirouter.gif" alt="uirouter效果"></p>
<h3 id="三、代码实例"><a href="#三、代码实例" class="headerlink" title="三、代码实例"></a>三、代码实例</h3><h4 id="1-html-使用ui-sref"><a href="#1-html-使用ui-sref" class="headerlink" title="1. html 使用ui-sref"></a>1. html 使用ui-sref</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-1 list-group"</span> <span class="attr">style</span>=<span class="string">"text-align: center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.authority"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>权限管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.blog"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>博客管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.user"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.tag"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>标签管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.changeLog"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>更新日志<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.links"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>友情连接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main.systemSet"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span>系统设置<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-app-js-路由配置"><a href="#2-app-js-路由配置" class="headerlink" title="2. app.js 路由配置"></a>2. app.js 路由配置</h4><figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">    myApp.config(function (<span class="variable">$stateProvider</span>, <span class="variable">$urlRouterProvider</span>) &#123;</span><br><span class="line">    <span class="variable">$urlRouterProvider</span>.otherwise('/login');</span><br><span class="line">    <span class="variable">$stateProvider</span></span><br><span class="line">    /* ===========================================================登录===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('login', &#123;//登录</span><br><span class="line">            url: '/login',</span><br><span class="line">            templateUrl: './login.html',</span><br><span class="line">            controller: 'AdminLoginController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main', &#123;//主界面</span><br><span class="line">            url: '/main',</span><br><span class="line">            templateUrl: './src/tpls/common/home.html',</span><br><span class="line">            controller: 'BasicInfoController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================博客===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.blog', &#123;//博客列表</span><br><span class="line">            url: '/blog',</span><br><span class="line">            templateUrl: './src/tpls/blog/blogList.html',</span><br><span class="line">            controller: 'B<span class="keyword">log</span>ListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addB<span class="keyword">log</span>', &#123;//添加博客</span><br><span class="line">            url: '/addB<span class="keyword">log</span>',</span><br><span class="line">            templateUrl: './src/tpls/blog/addB<span class="keyword">log</span>.html',</span><br><span class="line">            controller: 'B<span class="keyword">log</span>AddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editB<span class="keyword">log</span>', &#123;//编辑博客</span><br><span class="line">            url: '/editB<span class="keyword">log</span>/:id',</span><br><span class="line">            templateUrl: './src/tpls/blog/editB<span class="keyword">log</span>.html',</span><br><span class="line">            controller: 'B<span class="keyword">log</span>EditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================权限===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.authority', &#123;//权限列表</span><br><span class="line">            url: '/authority',</span><br><span class="line">            templateUrl: './src/tpls/authority/authorityList.html',</span><br><span class="line">            controller: 'AdminListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addAuthority', &#123;//添加权限</span><br><span class="line">            url: '/addAuthority',</span><br><span class="line">            templateUrl: './src/tpls/authority/AddAuthority.html',</span><br><span class="line">            controller: 'AdminAddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editAuthority', &#123;//编辑权限</span><br><span class="line">            url: '/editAuthority/:id',</span><br><span class="line">            templateUrl: './src/tpls/authority/authorityEdit.html',</span><br><span class="line">            controller: 'AdminEditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================用户===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.<span class="keyword">user</span>', &#123;//用户列表</span><br><span class="line">            url: '/<span class="keyword">user</span>',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">user</span>/<span class="keyword">user</span>List.html',</span><br><span class="line">            controller: 'UserListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addUser', &#123;//添加用户</span><br><span class="line">            url: '/addUser',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">user</span>/addUser.html',</span><br><span class="line">            controller: 'UserAddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editUser', &#123;//编辑用户</span><br><span class="line">            url: '/editUser/:id',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">user</span>/editUser.html',</span><br><span class="line">            controller: 'UserEditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================标签===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.<span class="keyword">tag</span>', &#123;//标签列表</span><br><span class="line">            url: '/<span class="keyword">tag</span>',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">tag</span>/<span class="keyword">tag</span>List.html',</span><br><span class="line">            controller: 'TagListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addTag', &#123;//添加标签</span><br><span class="line">            url: '/addTag',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">tag</span>/addTag.html',</span><br><span class="line">            controller: 'TagAddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editTag', &#123;//编辑标签</span><br><span class="line">            url: '/editTag',</span><br><span class="line">            templateUrl: './src/tpls/<span class="keyword">tag</span>/editTag.html',</span><br><span class="line">            controller: 'TagEditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================日志===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.changeLog', &#123;//更新日志列表</span><br><span class="line">            url: '/changeLog',</span><br><span class="line">            templateUrl: './src/tpls/changeLog/changeLog.html',</span><br><span class="line">            controller: 'ChangeLogListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addChangeLog', &#123;//添加更新日志</span><br><span class="line">            url: '/addChangeLog',</span><br><span class="line">            templateUrl: './src/tpls/changeLog/addChangeLog.html',</span><br><span class="line">            controller: 'ChangeLogAddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editChangeLog', &#123;//编辑更新日志</span><br><span class="line">            url: '/editChangeLog',</span><br><span class="line">            templateUrl: './src/tpls/changeLog/editChangeLog.html',</span><br><span class="line">            controller: 'ChangeLogEditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================友链===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.links', &#123;//友情链接列表</span><br><span class="line">            url: '/links',</span><br><span class="line">            templateUrl: './src/tpls/links/linkList.html',</span><br><span class="line">            controller: 'LinkListController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.addLink', &#123;//添加友情链接</span><br><span class="line">            url: '/addLink',</span><br><span class="line">            templateUrl: './src/tpls/links/addLink.html',</span><br><span class="line">            controller: 'LinkAddController'</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">state</span>('main.editLink', &#123;//编辑友情链接</span><br><span class="line">            url: '/editLink',</span><br><span class="line">            templateUrl: './src/tpls/links/editLink.html',</span><br><span class="line">            controller: 'LinkEditController'</span><br><span class="line">        &#125;)</span><br><span class="line">        /* ===========================================================系统===========================================================================*/</span><br><span class="line">        .<span class="keyword">state</span>('main.systemSet', &#123;//系统设置</span><br><span class="line">            url: '/systemSet',</span><br><span class="line">            templateUrl: './src/tpls/systemSet/systemSet.html'</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="四、-github"><a href="#四、-github" class="headerlink" title="四、 github"></a>四、 github</h3><p>附上我github的地址<br>   <a href="https://github.com/houko" target="_blank" rel="noopener">https://github.com/houko</a></p>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[markdown语法]]></title>
      <url>https://blog.xiaomo.info/2016/MarkdownSyntax/</url>
      <content type="html"><![CDATA[<p>markdown的一些基本语法，大致够用了<br><a id="more"></a></p>
<h3 id="1-标题-h标签"><a href="#1-标题-h标签" class="headerlink" title="1.标题(h标签)"></a>1.标题(h标签)</h3><p>h1-h6对应1-6个#</p>
<h3 id="2-列表-li-gt-li"><a href="#2-列表-li-gt-li" class="headerlink" title="2.列表(li&gt;li)"></a>2.列表(li&gt;li)</h3><h4 id="1-无序列表"><a href="#1-无序列表" class="headerlink" title="1. 无序列表"></a>1. 无序列表</h4><h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">* </span>1</span><br><span class="line"><span class="bullet">* </span>2</span><br><span class="line"><span class="bullet">* </span>3</span><br></pre></td></tr></table></figure>
<h5 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h5><ul>
<li>1</li>
<li>2</li>
<li>3</li>
</ul>
<h4 id="2-有序列表"><a href="#2-有序列表" class="headerlink" title="2. 有序列表"></a>2. 有序列表</h4><h5 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h5><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="number">1</span></span><br><span class="line"><span class="number">2.</span> <span class="number">2</span></span><br><span class="line"><span class="number">3.</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h4 id="效果图-1"><a href="#效果图-1" class="headerlink" title="效果图"></a>效果图</h4><ol>
<li>1</li>
<li>2</li>
<li>3</li>
</ol>
<h3 id="3-引用-blockquote"><a href="#3-引用-blockquote" class="headerlink" title="3.引用(blockquote)"></a>3.引用(blockquote)</h3><h4 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">这个是引用的内容</span></span><br></pre></td></tr></table></figure>
<h4 id="效果图-2"><a href="#效果图-2" class="headerlink" title="效果图"></a>效果图</h4><blockquote>
<p>这个是引用的内容</p>
</blockquote>
<h3 id="4-图片与链接"><a href="#4-图片与链接" class="headerlink" title="4.图片与链接"></a>4.图片与链接</h3><h4 id="1-图片"><a href="#1-图片" class="headerlink" title="1. 图片"></a>1. 图片</h4><p>名字、url</p>
<h5 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">小莫</span>](<span class="link">http://mouapp.com/Mou_128.png</span>)</span><br></pre></td></tr></table></figure>
<h5 id="效果图-3"><a href="#效果图-3" class="headerlink" title="效果图"></a>效果图</h5><p><img src="http://mouapp.com/Mou_128.png" alt="小莫"></p>
<h4 id="2-链接"><a href="#2-链接" class="headerlink" title="2.链接"></a>2.链接</h4><h5 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">小莫的主页</span>](<span class="link">http://www.xiaomo.info</span>)</span><br></pre></td></tr></table></figure>
<h5 id="效果图-4"><a href="#效果图-4" class="headerlink" title="效果图"></a>效果图</h5><p><a href="http://www.xiaomo.info" target="_blank" rel="noopener">小莫的主页</a></p>
<h3 id="5-粗体与斜体"><a href="#5-粗体与斜体" class="headerlink" title="5.粗体与斜体"></a>5.粗体与斜体</h3><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>用两个 <em> 包含一段文本就是粗体的语法，用一个 </em> 包含一段文本就是斜体的语法。</p>
<h5 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h5><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">*<span class="strong">*这里是粗体*</span><span class="strong">*</span></span><br><span class="line"><span class="strong">*</span>这里是斜体<span class="strong">*</span></span><br></pre></td></tr></table></figure>
<h5 id="效果图-5"><a href="#效果图-5" class="headerlink" title="效果图"></a>效果图</h5><p><strong>这里是粗体</strong><br><em>这里是斜体</em></p>
<h3 id="6-表格"><a href="#6-表格" class="headerlink" title="6.表格"></a>6.表格</h3><h4 id="说明："><a href="#说明：" class="headerlink" title="说明："></a>说明：</h4><h5 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h5><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">冒号控制居中样式 连续三根短横线表格</span><br><span class="line">| Tables        | Are           | Cool  |</span><br><span class="line">| <span class="symbol">:-----------</span>: |<span class="symbol">:--------</span>:  | <span class="symbol">:---</span><span class="symbol">:|</span></span><br><span class="line">| col <span class="number">3</span> is      | right-aligned | <span class="variable">$1600</span> |</span><br><span class="line">| col <span class="number">2</span> is      | centered      |   <span class="variable">$12</span> |</span><br><span class="line">| zebra stripes | are neat      |    <span class="variable">$1</span> |</span><br></pre></td></tr></table></figure>
<h5 id="效果图-6"><a href="#效果图-6" class="headerlink" title="效果图"></a>效果图</h5><p>冒号控制居中样式 连续三根短横线表格<br>| Tables        | Are           | Cool  |<br>| :———–: |:——–:  | :—:|<br>| col 3 is      | right-aligned | $1600 |<br>| col 2 is      | centered      |   $12 |<br>| zebra stripes | are neat      |    $1 |</p>
<h3 id="7-代码框"><a href="#7-代码框" class="headerlink" title="7.代码框"></a>7.代码框</h3><p>（一个tab即可,如果没效果用3个飘号[esc下面那个]）</p>
<pre><code>function Hello(){
        console.log(&quot;hello&quot;);
    }
</code></pre><h3 id="8-分割线-hr"><a href="#8-分割线-hr" class="headerlink" title="8.分割线(hr)"></a>8.分割线(hr)</h3><p>三个或三个以上的星号、减号或者下划线</p>
<h3 id="9-换行、分段"><a href="#9-换行、分段" class="headerlink" title="9.换行、分段"></a>9.换行、分段</h3><p>行末加两个或以上个空格<br>分段：两个回车</p>
<h3 id="10-带url的目录"><a href="#10-带url的目录" class="headerlink" title="10. 带url的目录"></a>10. 带url的目录</h3><h4 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h4><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">1. 安装</span>][<span class="symbol">1</span>]  </span><br><span class="line">[<span class="string">2. 目录结构</span>][<span class="symbol">2</span>]  </span><br><span class="line">[<span class="string">3. 配置说明</span>][<span class="symbol">3</span>]  </span><br><span class="line">[<span class="string">4. 编写博客</span>][<span class="symbol">4</span>]  </span><br><span class="line"></span><br><span class="line">[<span class="symbol">1</span>]:<span class="link">http://gitblogdoc.sinaapp.com/blog/gitblog/install.html</span></span><br><span class="line">[<span class="symbol">2</span>]:<span class="link">http://gitblogdoc.sinaapp.com/blog/gitblog/struct.html</span></span><br><span class="line">[<span class="symbol">3</span>]:<span class="link">http://gitblogdoc.sinaapp.com/blog/gitblog/config.html</span></span><br><span class="line">[<span class="symbol">4</span>]:<span class="link">http://gitblogdoc.sinaapp.com/blog/gitblog/edit.html</span></span><br></pre></td></tr></table></figure>
<h4 id="效果图-7"><a href="#效果图-7" class="headerlink" title="效果图"></a>效果图</h4><p><a href="http://gitblogdoc.sinaapp.com/blog/gitblog/install.html" target="_blank" rel="noopener">1. 安装</a><br><a href="http://gitblogdoc.sinaapp.com/blog/gitblog/struct.html" target="_blank" rel="noopener">2. 目录结构</a><br><a href="http://gitblogdoc.sinaapp.com/blog/gitblog/config.html" target="_blank" rel="noopener">3. 配置说明</a><br><a href="http://gitblogdoc.sinaapp.com/blog/gitblog/edit.html" target="_blank" rel="noopener">4. 编写博客</a>  </p>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angularjs复选框]]></title>
      <url>https://blog.xiaomo.info/2016/NgCheckbox/</url>
      <content type="html"><![CDATA[<p>使用angularjs做复选框，这也是一个常见的需求。<br><a id="more"></a></p>
<h3 id="一、代码"><a href="#一、代码" class="headerlink" title="一、代码"></a>一、代码</h3><h4 id="1-html"><a href="#1-html" class="headerlink" title="1. html"></a>1. html</h4><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">"tag in tags.content track by $index "</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span></span></span></span><br><span class="line"><span class="xml">               title="标签"</span></span><br><span class="line"><span class="xml">               class="btn "</span></span><br><span class="line"><span class="xml">               id="</span><span class="template-variable">&#123;&#123;tag.id&#125;&#125;</span><span class="xml">"</span></span><br><span class="line"><span class="xml">               name="</span><span class="template-variable">&#123;&#123;tag.name&#125;&#125;</span><span class="xml">"</span></span><br><span class="line"><span class="xml">               ng-checked="isSelected(tag.id)" //动态 true false</span></span><br><span class="line"><span class="xml">               ng-click="updateSelection($event,tag.id)" //将id添加到Array中</span></span><br><span class="line"><span class="xml">               ng-model="tags"&gt;</span></span><br><span class="line"><span class="xml">        </span><span class="template-variable">&#123;&#123;tag.name&#125;&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="2-controller"><a href="#2-controller" class="headerlink" title="2. controller"></a>2. controller</h4><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line"><span class="variable">$scope</span>.selected = [];</span><br><span class="line"><span class="variable">$scope</span>.selectedTags = [];</span><br><span class="line"></span><br><span class="line">//实际操作数组的方法</span><br><span class="line">var updateSelected = <span class="keyword">function</span> (action,<span class="built_in"> id</span>,<span class="built_in"> name</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (action == <span class="string">'add'</span> &amp;&amp; <span class="variable">$scope</span>.selected.indexOf<span class="built_in">(id</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable">$scope</span>.selected.push<span class="built_in">(id</span>);</span><br><span class="line">        <span class="variable">$scope</span>.selectedTags.push<span class="built_in">(name</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (action == <span class="string">'remove'</span> &amp;&amp; <span class="variable">$scope</span>.selected.indexOf<span class="built_in">(id</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">        var idx = <span class="variable">$scope</span>.selected.indexOf<span class="built_in">(id</span>);</span><br><span class="line">        <span class="variable">$scope</span>.selected.splice(idx, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$scope</span>.selectedTags.splice(idx, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(<span class="variable">$scope</span>.selected);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//根据传入的动作和要操作<span class="built_in">的id</span>更新Array</span><br><span class="line"><span class="variable">$scope</span>.updateSelection = <span class="keyword">function</span> (<span class="variable">$event</span>,<span class="built_in"> id</span>) &#123;</span><br><span class="line">    var checkbox = <span class="variable">$event</span>.target;</span><br><span class="line">    var action = (checkbox.checked ? <span class="string">'add'</span> : <span class="string">'remove'</span>);</span><br><span class="line">    updateSelected(action,<span class="built_in"> id</span>, checkbox<span class="built_in">.name</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//返<span class="built_in">回true</span><span class="built_in"> false</span></span><br><span class="line"><span class="variable">$scope</span>.isSelected = <span class="keyword">function</span> <span class="built_in">(id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$scope</span>.selected.indexOf<span class="built_in">(id</span>) &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="二、效果图"><a href="#二、效果图" class="headerlink" title="二、效果图"></a>二、效果图</h3><p><img src="https://image.xiaomo.info/angular/checkbox.gif" alt="checkbox效果图"></p>
<h3 id="三、参考文档"><a href="#三、参考文档" class="headerlink" title="三、参考文档"></a>三、参考文档</h3><blockquote>
<p><a href="http://www.cnblogs.com/CheeseZH/p/4517701.html" target="_blank" rel="noopener">ZH奶酪：AngularJS判断checkbox/复选框是否选中并实时显示</a></p>
</blockquote>
<h3 id="四、-附上我github的地址"><a href="#四、-附上我github的地址" class="headerlink" title="四、 附上我github的地址"></a>四、 附上我github的地址</h3><p>   <a href="https://github.com/houko" target="_blank" rel="noopener">https://github.com/houko</a></p>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angularjs键盘事件]]></title>
      <url>https://blog.xiaomo.info/2016/AngularKeyboardEvent/</url>
      <content type="html"><![CDATA[<p> 使用angularjs的键盘事件来增强用户体验。<br><a id="more"></a></p>
<h3 id="一、绑定键盘事件"><a href="#一、绑定键盘事件" class="headerlink" title="一、绑定键盘事件"></a>一、绑定键盘事件</h3><p>（尤其注意：不能用a标签，不然会失效）</p>
<blockquote>
<p>推荐button</p>
</blockquote>
<h4 id="方法一：ng内置指令"><a href="#方法一：ng内置指令" class="headerlink" title="方法一：ng内置指令"></a>方法一：ng内置指令</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"login()"</span> <span class="attr">ng-keypress</span>=<span class="string">"todoSomething($event)"</span> <span class="attr">class</span>=<span class="string">"btn btn-success btn-lg"</span> <span class="attr">ng-disabled</span>=<span class="string">"loginForm.$invalid"</span>&gt;</span></span><br><span class="line">    登录</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：在对应的控制器中的$scope上绑定一个todoSomething方法<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$scope.todoSomething=<span class="function"><span class="keyword">function</span><span class="params">($event)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($event.keyCode==<span class="number">13</span>)&#123;<span class="comment">//回车</span></span><br><span class="line">        login();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="方法二：自定义指令"><a href="#方法二：自定义指令" class="headerlink" title="方法二：自定义指令"></a>方法二：自定义指令</h4><blockquote>
<p>html<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"login()"</span> <span class="attr">ng-enter</span>=<span class="string">"login()"</span> <span class="attr">class</span>=<span class="string">"btn btn-success btn-lg"</span> <span class="attr">ng-disabled</span>=<span class="string">"loginForm.$invalid"</span>&gt;</span></span><br><span class="line">    登录</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>指令<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">myApp.directive(<span class="string">'ngEnter'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(scope, element, attrs)</span> </span>&#123;</span><br><span class="line">            element.bind(<span class="string">"keydown keypress"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (event.which === <span class="number">13</span>) &#123;</span><br><span class="line">                    scope.$apply(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">                        scope.$eval(attrs.ngEnter);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    event.preventDefault();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="二、总结"><a href="#二、总结" class="headerlink" title="二、总结"></a>二、总结</h3><p>两种方法都能实现敲回车登录的功能，不过推荐指令的方式，对$scope的污染比较低</p>
<blockquote>
<p>参考文档：<a href="https://segmentfault.com/a/1190000002634554#articleHeader8" target="_blank" rel="noopener">angularjs学习笔记—事件指令</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[表单添加之ng-options]]></title>
      <url>https://blog.xiaomo.info/2016/ngOptions/</url>
      <content type="html"><![CDATA[<p>我们在使用select&gt;option的时候经常会遇到一些问题，这里是对ng-options使用的一些总结。<br><a id="more"></a></p>
<h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p>这个ng-options感觉略坑啊，跟原生的select、option不太一样</p>
<h3 id="二、-要解决的几个问题"><a href="#二、-要解决的几个问题" class="headerlink" title="二、 要解决的几个问题"></a>二、 要解决的几个问题</h3><h4 id="1-select下拉框的默认值"><a href="#1-select下拉框的默认值" class="headerlink" title="1. select下拉框的默认值"></a>1. select下拉框的默认值</h4><h4 id="2-通过选择不同的值传给后台"><a href="#2-通过选择不同的值传给后台" class="headerlink" title="2. 通过选择不同的值传给后台"></a>2. 通过选择不同的值传给后台</h4><h4 id="3-ng-options的值要设置在-scope中"><a href="#3-ng-options的值要设置在-scope中" class="headerlink" title="3. ng-options的值要设置在$scope中"></a>3. ng-options的值要设置在$scope中</h4><h3 id="三、-代码实例"><a href="#三、-代码实例" class="headerlink" title="三、 代码实例"></a>三、 代码实例</h3><h4 id="1-html中的展示"><a href="#1-html中的展示" class="headerlink" title="1.html中的展示"></a>1.html中的展示</h4><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-md-2 control-label"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        权限：</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">title</span>=<span class="string">"权限"</span> <span class="attr">ng-model</span>=<span class="string">"adminUser.authLevel"</span></span></span></span><br><span class="line"><span class="xml">                ng-options="authLevel.name for authLevel in adminUser.authLevels"&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>-- 请选择 --<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-variable">&#123;&#123;adminUser.authLevel&#125;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>代码解释：ng-options类似于ng-repeat,把$scope中的内容循环展示出来,设置一个ng-model</p>
</blockquote>
<h4 id="2-controller"><a href="#2-controller" class="headerlink" title="2. controller"></a>2. controller</h4><p> controller中设置ng-options的默认值</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">$scope.adminUser = &#123;&#125;<span class="comment">;</span></span><br><span class="line">$scope.adminUser.authLevels = [&#123;<span class="string">'id'</span>: <span class="number">1</span>, <span class="string">'name'</span>: <span class="string">'超级管理员'</span>&#125;, &#123;<span class="string">'id'</span>: <span class="number">2</span>, <span class="string">'name'</span>: <span class="string">'普通管理员'</span>&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>controller中接收设置的ng-model,就可以解决html和controller之间的通讯了</p>
</blockquote>
<h3 id="三、参考文档"><a href="#三、参考文档" class="headerlink" title="三、参考文档"></a>三、参考文档</h3><p>参考自 ：<a href="http://runjs.cn/code/nhi8ubrb" target="_blank" rel="noopener">runjs源码</a></p>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用angularjs的$http异步删除数据]]></title>
      <url>https://blog.xiaomo.info/2016/AngularHttp/</url>
      <content type="html"><![CDATA[<p>因为我在使用angularjs做异步删除数据的时候遇到了一些问题，所以把这些问题记录下面供大家参考，也加深自己的印象。</p>
<a id="more"></a>
<h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p>有人会说删除这东西有什么可讲的，写个删除的service，controller调用一下不就完了。<br>嗯…看起来是这样，但是具体实现起来真的有这么简单吗？首先有以下几个坑</p>
<ul>
<li>怎么确定数据是否删除成功？</li>
<li>怎么同步视图的数据库的内容？</li>
</ul>
<h3 id="二、-思路"><a href="#二、-思路" class="headerlink" title="二、 思路"></a>二、 思路</h3><h4 id="1-实现方式一"><a href="#1-实现方式一" class="headerlink" title="1.实现方式一"></a>1.实现方式一</h4><p>删除数据库中对应的内容,然后将$scope中的对应的内容splice</p>
<h4 id="2-实现方式二"><a href="#2-实现方式二" class="headerlink" title="2.实现方式二"></a>2.实现方式二</h4><p>删除数据库中对应的内容，然后再reload一下数据(也就是再调用一次查询方法，这种消耗可想而知，并且还要保证先删除数据再查询)</p>
<h3 id="三、-具体实现方式"><a href="#三、-具体实现方式" class="headerlink" title="三、 具体实现方式"></a>三、 具体实现方式</h3><blockquote>
<p>删除数据的service：用异步，返回promise<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">service(<span class="string">'deleteBlogService'</span>,<span class="comment">//删除博客</span></span><br><span class="line">        [<span class="string">'$rootScope'</span>,</span><br><span class="line">            <span class="string">'$http'</span>,</span><br><span class="line">            <span class="string">'$q'</span>,</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="params">($rootScope, $http, $q)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> result = &#123;&#125;;</span><br><span class="line">                result.operate = <span class="function"><span class="keyword">function</span> <span class="params">(blogId)</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> deferred = $q.defer();</span><br><span class="line">                    $http(&#123;</span><br><span class="line">                        headers: &#123;</span><br><span class="line">                            <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        url: $rootScope.$baseUrl + <span class="string">"/admin/blog/deleteBlogById"</span>,</span><br><span class="line">                        method: <span class="string">'GET'</span>,</span><br><span class="line">                        dataType: <span class="string">'json'</span>,</span><br><span class="line">                        params: &#123;</span><br><span class="line">                            id: blogId</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                        .success(<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span><br><span class="line">                            deferred.resolve(data);</span><br><span class="line">                            console.log(<span class="string">"删除成功！"</span>);</span><br><span class="line">                        &#125;)</span><br><span class="line">                        .error(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">                            deferred.reject();</span><br><span class="line">                            alert(<span class="string">"删除失败！"</span>)</span><br><span class="line">                        &#125;);</span><br><span class="line">                    <span class="keyword">return</span> deferred.promise;</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;])</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>controller里面注意事项</p>
<blockquote>
<p>要特别注意执行顺序：确保己经删除完成之后再去reload数据，不然会出来视图不更新</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除博客</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$scope.deleteBlog = <span class="function"><span class="keyword">function</span> <span class="params">(blogId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> deletePromise = deleteBlogService.operate(blogId);</span><br><span class="line">    deletePromise.then(<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (data.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> promise = getBlogListService.operate($scope.currentPage);</span><br><span class="line">            promise.then(<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span><br><span class="line">                $scope.blogs = data.blogs;</span><br><span class="line">                $scope.pageCount = $scope.blogs.totalPages;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[angularjs的验证系统]]></title>
      <url>https://blog.xiaomo.info/2016/AngularValidate/</url>
      <content type="html"><![CDATA[<p>使用angularjs的验证系统来做前端验证需要注意的一些地方<br><a id="more"></a></p>
<h3 id="一、-效果图"><a href="#一、-效果图" class="headerlink" title="一、 效果图"></a>一、 效果图</h3><p> <img src="https://image.xiaomo.info/angular/validate.gif" alt="angularjs验证效果图"></p>
<h3 id="二、-要点"><a href="#二、-要点" class="headerlink" title="二、 要点"></a>二、 要点</h3><h4 id="1：form"><a href="#1：form" class="headerlink" title="1：form"></a>1：form</h4><p>给form起一个名字,并禁掉原生的验证</p>
<h4 id="2-显示时机"><a href="#2-显示时机" class="headerlink" title="2. 显示时机"></a>2. 显示时机</h4><p>这个div是要在内容发生变化且不合法才会显示</p>
<figure class="highlight ceylon"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"error"</span> ng-show=<span class="string">"addBlogForm.title.$dirty &amp;&amp; addBlogForm.title.$invalid"</span>&gt;</span><br><span class="line">                 &lt;<span class="keyword">small</span> <span class="keyword">class</span>=<span class="string">"error"</span> ng-show=<span class="string">"addBlogForm.title.$error.required"</span>&gt;请输入标题内容&lt;/<span class="keyword">small</span>&gt;</span><br><span class="line">                 &lt;<span class="keyword">small</span> <span class="keyword">class</span>=<span class="string">"error"</span> ng-show=<span class="string">"addBlogForm.title.$error.minlength"</span>&gt;标题内容最少长度为<span class="number">3</span>&lt;/<span class="keyword">small</span>&gt;</span><br><span class="line">                 &lt;<span class="keyword">small</span> <span class="keyword">class</span>=<span class="string">"error"</span> ng-show=<span class="string">"addBlogForm.title.$error.maxlength"</span>&gt;标题最大长度为<span class="number">64</span>&lt;/<span class="keyword">small</span>&gt;</span><br><span class="line">                 &lt;<span class="keyword">small</span> <span class="keyword">class</span>=<span class="string">"error"</span> ng-show=<span class="string">"addBlogForm.title.$error.unique"</span>&gt;</span><br><span class="line">                     这个标题己经被用过了，请换一个标题吧</span><br><span class="line">                 &lt;/<span class="keyword">small</span>&gt;</span><br><span class="line">  &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3-格式"><a href="#3-格式" class="headerlink" title="3. 格式"></a>3. 格式</h4><p>格式为fromName.inputName.$error.xxx   例子如上</p>
<h4 id="4-判断"><a href="#4-判断" class="headerlink" title="4. 判断"></a>4. 判断</h4><p>将提交按钮是否可用交给ng来判断:合法的时候才可用</p>
<blockquote>
<p>代码示例</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;button <span class="attribute">ng-click</span>=<span class="string">"addBlog()"</span> <span class="attribute">class</span>=<span class="string">"btn btn-info"</span> <span class="attribute">ng-disabled</span>=<span class="string">"addBlogForm.<span class="variable">$invalid</span>"</span>&gt;添加博客</span><br></pre></td></tr></table></figure>
<h3 id="三、插件"><a href="#三、插件" class="headerlink" title="三、插件"></a>三、插件</h3><p> 以上介绍的是angularjs的原生的验证，下面是一些关于验证的扩展插件</p>
<table>
<thead>
<tr>
<th style="text-align:center">所属</th>
<th style="text-align:center">名字</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">angular-ui</td>
<td style="text-align:center">ng-messages</td>
</tr>
<tr>
<td style="text-align:center">第三方扩展</td>
<td style="text-align:center">w5cValidator</td>
</tr>
<tr>
<td style="text-align:center">jquery-validate</td>
<td style="text-align:center">JQ的插件</td>
</tr>
</tbody>
</table>
<h3 id="四、-github"><a href="#四、-github" class="headerlink" title="四、 github"></a>四、 github</h3><p>附上我github的地址<br>   <a href="https://github.com/houko" target="_blank" rel="noopener">https://github.com/houko</a></p>
]]></content>
      
        <categories>
            
            <category> angularjs </category>
            
        </categories>
        
        
        <tags>
            
            <tag> angular </tag>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
